<html>
<head>
  <title>BUUCTF Misc 6（65-72）</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/605894 (zh-CN, DDL); Windows/6.1.1 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="1731"/>
<h1>BUUCTF Misc 6（65-72）</h1>
<h2><a href="https://DemonStarAlgol.github.io/Misc/">[无关链接]</a></h2>

<div>
<span><div><span style="font-weight: bold;">65 [HBNIS2018]excel破解</span></div><div><br/></div><div>下载得到xls格式文件，直接打开提示需要密码。十六进制编辑器打开，搜索字符串flag：</div><div><img src="BUUCTF Misc 6（65-72）_files/Image.png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>flag：CTF{office_easy_cracked}</div><div><br/></div><div><span style="font-weight: bold;">66 [SWPU2019]伟大的侦探</span></div><div><br/></div><div>下载得到rar格式压缩包，内含misc文件夹（里面是18张加密压缩的jpg）和密码.txt。后者内容为：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>压缩包密码:摂m墷m卪倕ⅲm仈Z</div><div>呜呜呜,我忘记了压缩包密码的编码了,大家帮我解一哈。</div></div><div>用Microsoft Word打开该txt文件，选择编码。尝试到EBCDIC时得到压缩包密码。</div><div><img src="BUUCTF Misc 6（65-72）_files/Image [1].png" type="image/png" data-filename="Image.png"/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>wllm_is_the_best_team!</div></div><div><br/></div><div>解压得到misc文件夹。</div><div><img src="BUUCTF Misc 6（65-72）_files/Image [2].png" type="image/png" data-filename="Image.png"/></div><div>显然是福尔摩斯系列中的跳舞小人密码，对照表如下：</div><div><img src="BUUCTF Misc 6（65-72）_files/1697845-20191210130506154-1244972742.png" type="image/png" data-filename="1697845-20191210130506154-1244972742.png"/></div><div>对照解码得到flag。</div><div><br/></div><div>flag：iloveholmesandwllm</div><div><br/></div><div><span style="font-weight: bold;">67 弱口令</span></div><div><br/></div><div>下载得到zip格式压缩包，有加密。</div><div><img src="BUUCTF Misc 6（65-72）_files/Image [3].png" type="image/png" data-filename="Image.png"/></div><div>注意到注释栏有空白不可见字符，由空格和Tab组成。替换空格为0，Tab为1：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>0000</div><div>0</div><div>0100</div><div>0100</div><div>11111</div><div>0010</div><div>111</div><div>010</div><div>001</div><div>11</div></div><div>再以1为长音，0为短音，摩斯电码解码得到：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>HELL0FORUM</div></div><div><br/></div><div>以此作为密码解压得到女神.png。<span style="font-size: unset; color: unset; font-family: unset;">使用lsb.py解密，根据题目提示弱密码，使用密码123456。</span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop/lsb# python lsb.py extract 1.png flag.txt 123456</div><div>[+] Image size: 500x500 pixels.</div><div>[+] Written extracted data to flag.txt.</div></div><div>得到flag。</div><div><br/></div><div>flag：flag{jsy09-wytg5-wius8}</div><div><br/></div><div><span style="font-weight: bold;">68 [ACTF新生赛2020]base64隐写</span></div><div><br/></div><div>下载得到ComeOn!.txt，内容为多行base64密文：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>STJsdVkyeDFaR1U4YVc5emRISmxZVzArQ2c9PQ1=</div><div>STJsdVkyeDFaR1U4YzNSeWFXNW5QZ289DQ==</div><div>STJsdVkyeDFaR1U4WTNOMGNtbHVaejRLDV==</div><div>STJsdVkyeDFaR1U4WTNOMFpHbHZQZ289DQ==</div><div>STJSbFptbHVaU0J0WVhodUlEazVPUW89Dd==</div><div>Q2c9PQ1=</div><div>ZFhOcGJtY2dibUZ1WlhOd1lXTmxJSE4wWkRzSw1=</div><div>Q2c9PQ0=</div><div>WTJoaGNpUmpZVnR0WVhodVhTd2dZMkpiYldGNGJsMDdDZz09DU==</div><div>Q2c9PQ1=</div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">……</span></div></div><div>对于此类情况，可以尝试base64隐写。特别是可以进行如下操作：任选一行末尾带有=的密文，解密后重新加密，如果得到的结果末尾几个字符与原始密文不同，基本上可以判断是base64隐写。</div><div>运行base64隐写解密脚本：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>import re</div><div>import base64</div><div><br/></div><div>b64chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'</div><div><br/></div><div>f = open('base!.txt','r')</div><div>base64str = f.readline()</div><div><br/></div><div>pattern2 = r'(\S)==$'</div><div>pattern1 = r'(\S)=$'</div><div><br/></div><div>binstring = ''</div><div><br/></div><div>while(base64str):</div><div>    if re.compile(pattern2).findall(base64str):</div><div>        mstr = re.compile(pattern2).findall(base64str)[0]</div><div>        mbin = bin(b64chars.find(mstr))</div><div>        mbin2 = mbin[0:2] + mbin[2:].zfill(6)</div><div>        stegobin = mbin2[-4:]</div><div>        binstring += stegobin</div><div>    elif re.compile(pattern1).findall(base64str):</div><div>        mstr = re.compile(pattern1).findall(base64str)[0]</div><div>        mbin = bin(b64chars.find(mstr))</div><div>        mbin2 = mbin[0:2] + mbin[2:].zfill(6)</div><div>        stegobin = mbin2[-2:]</div><div>        binstring += stegobin</div><div>    base64str = f.readline()</div><div>for i in range(0,len(binstring),8):</div><div>    print(chr(int(binstring[i:i+8],2)),end='')</div></div><div>输出结果即flag。</div><div><br/></div><div>flag：ACTF{6aseb4_f33!}</div><div><br/></div><div><span style="font-weight: bold;">69 黑客帝国</span></div><div><br/></div><div>下载得到txt格式文件，内容为大量十六进制数字，在十六进制编辑器中将其转为文件，得到RAR压缩包。</div><div><a href="BUUCTF Misc 6（65-72）_files/1.rar"><img src="BUUCTF Misc 6（65-72）_files/72a7ef82ee047b5543747407ada60e61.png" alt="1.rar"></a></div><div><br/></div><div>压缩包是加密的，尝试4位数字爆破：</div><div><img src="BUUCTF Misc 6（65-72）_files/Image [4].png" type="image/png" data-filename="Image.png"/></div><div>解压得到png图片，显示损坏无法打开。十六进制编辑器查看，有JFIF等字符串，实际是jpg图片的文件头被改成了png：</div><div><img src="BUUCTF Misc 6（65-72）_files/Image [5].png" type="image/png" data-filename="Image.png"/></div><div>将文件头修复为FF D8 FF E0，然后重命名（不重命名也没事），得到flag。</div><div><img src="BUUCTF Misc 6（65-72）_files/729ec4d72da9599a308c64fe40156201.jpg" type="image/jpeg" data-filename="729ec4d72da9599a308c64fe40156201.jpg"/></div><div><br/></div><div>flag：flag{57cd4cfd4e07505b98048ca106132125}</div><div><br/></div><div><span style="font-weight: bold;">70 zip</span></div><div><br/></div><div>下载得到out0-out67.zip共68个压缩包，每个均包含加密的data.txt，且文件长度为4，可以采取CRC32爆破得到内容。</div><div><img src="BUUCTF Misc 6（65-72）_files/Image [6].png" type="image/png" data-filename="Image.png"/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div># 需要用python2运行</div><div><br/></div><div>import zipfile</div><div>import string</div><div>import binascii</div><div>def CrackCrc(crc):</div><div>    for i in dic:</div><div>        for j in dic:</div><div>            for p in dic:</div><div>                for q in dic:</div><div>                    s = i + j + p + q</div><div>                    s = s.encode('utf-8')</div><div>                    if crc == (binascii.crc32(s) &amp; 0xffffffff):</div><div>                        #print s</div><div>                        f.write(s+&quot;\n&quot;)</div><div>                        return</div><div><br/></div><div>def CrackZip():</div><div>    for I in range(68):</div><div>        file = 'out' + str(I) + '.zip'</div><div>        f = zipfile.ZipFile(file, 'r')</div><div>        GetCrc = f.getinfo('data.txt')</div><div>        crc = GetCrc.CRC</div><div>        #以上3行为获取压缩包CRC32值的步骤</div><div>        #print hex(crc)</div><div>        CrackCrc(crc)</div><div>dic = string.ascii_letters + string.digits + '+/='</div><div>f = open('out.txt', 'wb')</div><div>CrackZip()</div><div>f.close()</div></div><div>得到68串长度为4的字符串，拼接后得到base64密文：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>z5BzAAANAAAAAAAAAKo+egCAIwBJAAAAVAAAAAKGNKv+a2MdSR0zAwABAAAAQ01UCRUUy91BT5UkSNPoj5hFEVFBRvefHSBCfG0ruGnKnygsMyj8SBaZHxsYHY84LEZ24cXtZ01y3k1K1YJ0vpK9HwqUzb6u9z8igEr3dCCQLQAdAAAAHQAAAAJi0efVT2MdSR0wCAAgAAAAZmxhZy50eHQAsDRpZmZpeCB0aGUgZmlsZSBhbmQgZ2V0IHRoZSBmbGFnxD17AEAHAA==</div></div><div>base64解码后得到开头几个字符十六进制为CF 90 73，且能看到flag.txt和fix the file and get the flag字符串：</div><div><img src="BUUCTF Misc 6（65-72）_files/Image [7].png" type="image/png" data-filename="Image.png"/></div><div>判断为rar格式，在文件头部插入7个字节52 61 72 21 1A 07 00修复文件。</div><div><img src="BUUCTF Misc 6（65-72）_files/Image [8].png" type="image/png" data-filename="Image.png"/></div><div>注释中得到flag。</div><div><br/></div><div>flag：flag{nev3r_enc0de_t00_sm4ll_fil3_w1th_zip}</div><div><br/></div><div><span style="font-weight: bold;">71 [WUSTCTF2020]find_me</span></div><div><br/></div><div>下载得到jpg格式文件，EXIF信息中找到一段字符：</div><div><img src="BUUCTF Misc 6（65-72）_files/Image [9].png" type="image/png" data-filename="Image.png"/></div><div>可以确定是盲文。借助<a href="https://www.qqxiuzi.cn/bianma/wenbenjiami.php?s=mangwen">在线盲文解密</a>得到flag。</div><div><img src="BUUCTF Misc 6（65-72）_files/Image [10].png" type="image/png" data-filename="Image.png"/></div><div><span style="font-weight: bold; color: rgb(255, 0, 0);">怀疑这并不是真正的盲文，仅是使用盲文字符来进行某种加密而已，因此只能用原在线加密进行解密。</span></div><div><br/></div><div>flag：wctf2020{y$0$u_f$1$n$d$_M$e$e$e$e$e}</div><div><br/></div><div><span style="font-weight: bold;">72 [HBNIS2018]来题中等的吧</span></div><div><br/></div><div>下载得到png格式文件。</div><div><img src="BUUCTF Misc 6（65-72）_files/附件5.png" type="image/png" data-filename="附件5.png"/></div><div>首先尝试摩斯电码，记录如下：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>.- .-.. .--. .... .- .-.. .- -...</div></div><div>转码得到：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>ALPHALAB</div></div><div><br/></div><div>flag：flag{alphalab}</div></span>
</div></body></html> 