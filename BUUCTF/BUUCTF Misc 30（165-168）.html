<html>
<head>
  <title>BUUCTF Misc 30（165-168）</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/605894 (zh-CN, DDL); Windows/6.1.1 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="1432"/>
<h1>BUUCTF Misc 30（165-168）</h1>
<h2><a href="https://DemonStarAlgol.github.io/Misc/">[无关链接]</a></h2>

<div>
<span><div><span style="font-weight: bold;">165 [INSHack2019]gflag</span></div><div><br/></div><div>下载得到md格式文件和没有后缀名的gflag文件。前者是题目说明：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>My brother likes esoteric programming. He sent me this file but I don't see what it is for. Could you help me ?</div></div><div>esoteric programming language简称esolang，大概可以理解成比较奇特的编程语言的意思。</div><div><br/></div><div>gflag实际上是个文本，内容为：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>M73 P0 R2</div><div>M201 X9000 Y9000 Z500 E10000</div><div>M203 X500 Y500 Z12 E120</div><div>M204 P2000 R1500 T2000</div><div>M205 X10.00 Y10.00 Z0.20 E2.50</div><div>M205 S0 T0</div><div>M107</div><div>M115 U3.1.0</div><div>M83</div><div>M204 S2000 T1500</div><div>……（后略）</div></div><div>比较明显的特征是有非常多的行以G1开头：</div><div><img src="BUUCTF Misc 30（165-168）_files/Image.png" type="image/png" data-filename="Image.png"/></div><div>搜索一下发现这是G代码（G-code），主要是用来控制数控机床的。找到一个<a href="https://ncviewer.com/">在线解释器</a>。</div><div><br/></div><div>输入代码，点PLOT运行，生成了某种图像。</div><div><img src="BUUCTF Misc 30（165-168）_files/Image [1].png" type="image/png" data-filename="Image.png"/></div><div>调整一下大小和角度：</div><div><img src="BUUCTF Misc 30（165-168）_files/Image [2].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>flag：NSA{3d_pr1nt3d_fl49}</div><div><br/></div><div><span style="font-weight: bold;">166 [HDCTF2019]信号分析</span></div><div><span style="color: rgb(255, 0, 0);">原题：Hackcube 抓到的汽车遥控杆的信号，能看出其中有啥嘛？</span></div><div><br/></div><div>下载得到wav格式文件。以Hackcube为关键词搜索到<a href="https://unicorn.360.com/hackcube/forum.php?mod=viewthread&amp;tid=13">这篇文章</a>。</div><div>audacity打开wav文件，波形视图下什么都没有（倒也不一定，如果把纵向拉得够长的话还是能看到东西的），可以切换到波形（dB）视图看到更明显的图像。</div><div><img src="BUUCTF Misc 30（165-168）_files/Image [3].png" type="image/png" data-filename="Image.png"/></div><div>然后放大查看，注意到每个周期的信号大体上是一致的，所以只需要读其中某个周期即可。</div><div><img src="BUUCTF Misc 30（165-168）_files/Image [4].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>根据文章里关于信号脉冲比特的说明（本题显然适用左半边）：</div><div>连续两个信号表示1bit，连续两个长信号为1，连续两个短信号为0，先短后长为F，先长后短为无效。</div><div><img src="BUUCTF Misc 30（165-168）_files/56787737.png" type="image/png" data-filename="56787737.png"/></div><div>以及关于固定码遥控信息的构成（这部分在<a href="https://app.yinxiang.com/shard/s39/nl/30668439/590ecf74-81c7-4e02-b657-b14d58838c37">电动车题</a>里也涉及过）：</div><div>整段信息包括4bit同步码（本题中没有）、8bit地址位、4bit数据位和停止码（单个短信号）。</div><div><img src="BUUCTF Misc 30（165-168）_files/Image [5].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>将信号转写如下：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>FFFFFFFF（地址位）0001（数据位）（停止码）</div></div><div><br/></div><div>flag：flag{FFFFFFFF0001}</div><div><br/></div><div><span style="font-weight: bold;">167 [QCTF2018]X-man-Keyword</span></div><div><br/></div><div>下载得到png格式文件。</div><div><img src="BUUCTF Misc 30（165-168）_files/Image [6].png" type="image/png" data-filename="Image.png"/></div><div>Stegsolve打开，在R/G/B Plane 0处左上方有黑白相间小点，是LSB隐写的特征。</div><div><img src="BUUCTF Misc 30（165-168）_files/Image [7].png" type="image/png" data-filename="Image.png"/></div><div>结合图片上的keyword，尝试有密码的LSB隐写：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop/lsb# python lsb.py extract attachment.png flag.txt lovekfc</div><div>[+] Image size: 360x245 pixels.</div><div>[+] Written extracted data to flag.txt.</div></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>PVSF{vVckHejqBOVX9C1c13GFfkHJrjIQeMwf}</div></div><div>已经接近flag格式，还需要进一步解密。首先对比一下正确的flag格式，编制<span style="font-size: unset; color: unset; font-family: unset;">对应表：</span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>ABCDEFGHIJKLMNOPQRSTUVWXYZ</div><div>  V  F          P T</div></div><div>联系到图片给出的keyword，判定对应表为：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>ABCDEFGHIJKLMNOPQRSTUVWXYZ</div><div><span style="color: rgb(255, 0, 0);">LOVEKFC</span>ABDGHIJMNPQRSTUWXYZ</div></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>import string</div><div><br/></div><div>a = 'PVSF{vVckHejqBOVX9C1c13GFfkHJrjIQeMwf}'</div><div>b = 'LOVEKFCABDGHIJMNPQRSTUWXY'</div><div>flag = ''</div><div><br/></div><div>for i in a:</div><div>    if i in string.ascii_lowercase:</div><div>        index = b.lower().index(i)</div><div>        flag += string.ascii_lowercase[index]</div><div>    elif i in string.ascii_uppercase:</div><div>        index = b.upper().index(i)</div><div>        flag += string.ascii_uppercase[index]</div><div>    else:</div><div>        flag += i</div><div>print(flag)</div></div><div>得到flag。</div><div><br/></div><div>flag：QCTF{cCgeLdnrIBCX9G1g13KFfeLNsnMRdOwf}</div><div><br/></div><div><span style="font-weight: bold;">168 [MRCTF2020]寻找xxx</span></div><div><br/></div><div>下载得到wav格式文件。音量调大听一下，感觉是拨号音，用dtmf2num提取。</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>E:\dtmf2num&gt;dtmf2num.exe 1.wav</div><div><br/></div><div>DTMF2NUM 0.1.1</div><div>by Luigi Auriemma</div><div>e-mail: aluigi@autistici.org</div><div>web:    aluigi.org</div><div><br/></div><div>- open 1.wav</div><div>  wave size      2633728</div><div>  format tag     1</div><div>  channels:      2</div><div>  samples/sec:   48000</div><div>  avg/bytes/sec: 192000</div><div>  block align:   4</div><div>  bits:          16</div><div>  samples:       1316864</div><div>  bias adjust:   2</div><div>  volume peaks:  -388 388</div><div>  normalize:     32379</div><div>  resampling to: 8000hz</div><div><br/></div><div>- MF numbers:    44</div><div><br/></div><div>- DTMF numbers:  18688422216D09</div></div><div>好像不太对，多了几位甚至还出现了字母……在audacity里选择效果-增幅（放大），并切换到频谱图：</div><div><img src="BUUCTF Misc 30（165-168）_files/Image [8].png" type="image/png" data-filename="Image.png"/></div><div>配合拨号音的双音频率表：</div><div><img src="BUUCTF Misc 30（165-168）_files/v2-74732484054fecaec02fe93969160cd4_720w.jpg" type="image/jpeg" data-filename="v2-74732484054fecaec02fe93969160cd4_720w.jpg"/></div><div>得到正确的拨号号码：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>186884221609</div></div><div><br/></div><div>接下来是本题最坑的一步，把这串号码发给天璇Merak微信公众号……</div><div><img src="BUUCTF Misc 30（165-168）_files/微信图片_20201016151447.jpg" type="image/jpeg" data-filename="微信图片_20201016151447.jpg"/></div><div><img src="BUUCTF Misc 30（165-168）_files/微信图片_20201016151452.jpg" type="image/jpeg" data-filename="微信图片_20201016151452.jpg"/></div><div><br/></div><div>flag：MRCTF{Oh!!!!!_Y0u_f1nd_my_secret}</div></span>
</div></body></html> 