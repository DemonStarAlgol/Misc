<html>
<head>
  <title>BUUCTF Misc 57（273-276）</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/605894 (zh-CN, DDL); Windows/6.1.1 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="683"/>
<h1>BUUCTF Misc 57（273-276）</h1>
<h2><a href="https://DemonStarAlgol.github.io/Misc/">[无关链接]</a></h2>

<div>
<span><div><span style="font-weight: bold;">273 [INSHack2018]Visual hashing - easy</span></div><div><br/></div><div>下载得到md格式文件和nsa.rar。前者是题目说明：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>We managed to capture the video feed on one of the top Institute of NSA officials.</div><div>Our intel forces told us the target is using [this Chrome extension].</div><div>(https://chrome.google.com/webstore/detail/visual-hashing/lkoelcpcjjehbjcchcbddggjmphfaiie).</div><div>Please help us retrieve the password.</div></div><div><br/></div><div>解压nsa.rar得到nsa.avi，内容为在密码输入框中输入了25位长度的密码，且输入框会随着输入不断变换显示颜色。</div><div><img src="BUUCTF Misc 57（273-276）_files/Image.png" type="image/png" data-filename="Image.png" width="762"/></div><div><br/></div><div>输入框变换颜色显然是题目给出的Chrome浏览器扩展的效果。因此本题可以通过爆破方式解决：</div><div>1、下载扩展并安装；</div><div>2、打开任意带有密码输入框的页面；</div><div>3、输入任意字符并与视频比对，如果出现相同的输入框颜色模式，说明第一位字符爆破正确；</div><div>4、事实上前5位字符和最后一位是flag格式INSA{}；</div><div>5、随着爆破位数增加可以发现规律，flag是由小写字母、数字和下划线组成的LEET；</div><div>6、爆破全部25位字符即得到flag。</div><div><br/></div><div>flag：INSA{w0w_v1su4l_h4sh1ngz}</div><div><br/></div><div><span style="font-weight: bold;">274 [BSidesSF2019]dawnupshaw</span></div><div>题目：Description: Much range, such octaves, wow!</div><div><br/></div><div>下载得到don.flac文件。BUUCTF附件里的下载地址似乎已失效，可以从<a href="https://github.com/BSidesSF/ctf-2019-release/tree/master/challenges/dawnupshaw/challenge">Github</a>上下载。audacity打开，切换到频谱图：</div><div><img src="BUUCTF Misc 57（273-276）_files/Image [1].png" type="image/png" data-filename="Image.png" width="977"/></div><div>注意到20000Hz附近有可疑信息。可以看到单位长度的较高频率和较低频率音波间隔出现，很可能携带了某种二进制数据信息。在Linux下使用sox工具，对don.flac进行高通滤波，过滤掉较低频率的音乐部分，然后生成频谱图：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop# sox don.flac -n highpass 16k spectrogram -x 4000 -y 200 -o spec.png</div></div><div><img src="BUUCTF Misc 57（273-276）_files/spec.png" type="image/png" data-filename="spec.png" width="4144"/></div><div>其中高频部分比较清晰，单比特信息间可以看出间隔。低频部分的比特位数可以通过与最小单位长度的比较得出。尝试以高频信号为1，低频信号为0，记录开头的6个字节得到：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>111111010011011101111010010110000101101000000000</div></div><div>转为十六进制：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>FD 37 7A 58 5A 00</div></div><div>这是xz格式压缩包的文件头，说明高频和低频信号分别对应1和0是正确的。记录所有信号得到800比特数据：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>11111101001101110111101001011000010110100000000000000000000001001110011011010110101101000100011000000010000000000010000100000001000111000000000000000000000000000001000011001111010110001100110000000001000000000010101101000011010101000100011001111011011011000110100101100111011010000111010001011111011010110110100101110011011100110110010101110011010111110111010001101000011001010101111101101100011000010110111001100111011101010110100101100100010111110110110001101001011100000111001101011111011011110110011001011111011011100110100101100111011010000111010001111101000010100000000000101100010111101010010111101101010010010010111010101001111011110000000000000001010001000010110011001001010100110100101110000110000111111011011011110011011111010000000100000000000000000000000000000000000001000101100101011010</div></div><div>写Python脚本将其转为文件：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>f1 = open('C:/Users/Administrator/Desktop/data.txt', 'r').read()</div><div>f2 = open('C:/Users/Administrator/Desktop/data.xz', 'wb')</div><div><br/></div><div>res = b''</div><div>for i in range(100):</div><div>    t = f1[i*8 : i*8+8]</div><div>    b = int(t, 2).to_bytes(1, 'big')</div><div>    res += b</div><div>f2.write(res)</div></div><div>解压得到flag：</div><div><img src="BUUCTF Misc 57（273-276）_files/Image [2].png" type="image/png" data-filename="Image.png" width="1080"/></div><div><br/></div><div>因为flag文件事实上没有被压缩，所以直接将二进制数据转十六进制，然后ASCII转码也能看到flag：</div><div><img src="BUUCTF Misc 57（273-276）_files/Image [3].png" type="image/png" data-filename="Image.png" width="828"/></div><div><br/></div><div>flag：CTF{light_kisses_the_languid_lips_of_night}</div><div><br/></div><div><span style="font-weight: bold;">275 [WMCTF2020]Dalabengba</span></div><div>题目：Play game and get flag！</div><div>The flag was divided into three parts, the format is WMCTF{part1+part2=part3} .</div><div><br/></div><div>给出的附件下载地址已经失效，包括WMCTF2020的比赛页面给出的也是同一个下载地址。通过搜索找到了题目的作者，但他也回复说已经没有这个附件文件了……最后加了BUUCTF的QQ群，问好心群友要到了文件。</div><div>总之通过上述步骤得到exe格式文件：</div><div><img src="BUUCTF Misc 57（273-276）_files/Image [4].png" type="image/png" data-filename="Image.png" width="113"/></div><div>从图标和版权信息可以看出这是RPG Maker MV对游戏工程打包输出后生成的游戏exe文件。但直接运行会报错：</div><div><img src="BUUCTF Misc 57（273-276）_files/Image [5].png" type="image/png" data-filename="Image.png" width="1039"/></div><div>单纯从报错信息来看是缺少图像素材文件。（话说这游戏标题也是默认的……大概是用Project1练了练软件操作然后又开了个工程Project2正式制作吧。）如果是不涉及具体游戏内容的UI等不重要素材，理论上可以找软件自带的默认素材或者随便一张符合格式要求的图片替换进去，但需要先对游戏进行解包。</div><div>搜索“RPG Maker MV 解包”，得知RPG Maker MV打包输出的单exe形式游戏文件是用Enigma Virtual Box虚拟打包的（用7-Zip直接打开exe文件也能看到扩展名为enigma的文件），由此找到EnigmaVBUnpacker。</div><div><br/></div><div>解包，得到文件夹和Dalabengba_unpacked.exe，后者就是RPG Maker MV的Game.exe，前者是游戏文件夹：</div><div><img src="BUUCTF Misc 57（273-276）_files/Image [6].png" type="image/png" data-filename="Image.png" width="596"/></div><div>将文件夹随便重命名一下，Dalabengba_unpacked.exe改名为Game.exe扔进文件夹里，再运行一下，又报错了：</div><div><img src="BUUCTF Misc 57（273-276）_files/Image [7].png" type="image/png" data-filename="Image.png" width="515"/></div><div>而且每次运行报错提示缺失的都是不同素材文件。进素材文件夹看一下：</div><div><img src="BUUCTF Misc 57（273-276）_files/Image [8].png" type="image/png" data-filename="Image.png" width="1005"/></div><div>文件倒是都在，但大部分都用RPG Maker MV默认加密方式加了密。所以大概是解密步骤出了问题。事实上这里是解密密钥被删掉了，可以通过解密工具<a href="https://github.com/Petschko/RPG-Maker-MV-Decrypter">RPG-Maker-MV-Decrypter</a>的源码得到加密原理，然后从RPG Maker MV的自带素材中得到加密前文件，和加密文件对比，计算出密钥，写进System.json里就可以运行游戏了。参见<a href="http://www.ga1axy.top/index.php/archives/47/">官方Writeup</a>。</div><div><br/></div><div>这里容易想到一种非预期解法。RPG Maker MV的游戏工程文件夹（对于已经输出的游戏，是www文件夹）中，所有的游戏数据，包括地图构成、事件内容、数据库等，都保存在data文件夹中。同时可以看出，被加密的素材文件其实大部分都是软件自带的默认素材或者官方DLC提供的素材。所以只需要新建一个游戏工程，把data文件夹复制过去，就能双击打开Game.rpgproject文件启动RPG Maker MV，查看游戏工程了。</div><div>但是因为出题人自行添加了一些素材，所以游戏还是缺少素材没法运行：</div><div><img src="BUUCTF Misc 57（273-276）_files/Image [9].png" type="image/png" data-filename="Image.png" width="566"/></div><div>又容易想到，可以用<a href="https://github.com/Petschko/RPG-Maker-MV-Decrypter">RPG-Maker-MV-Decrypter</a>把缺少的素材个别解密然后再复制到新的工程里。<span style="font-size: unset; color: unset; font-family: unset;">然后又发现部分关键对话也是被加密的（方法是先用javascript脚本操作变量，然后在对话里引用变量）：</span></div><div><img src="BUUCTF Misc 57（273-276）_files/Image [10].png" type="image/png" data-filename="Image.png" width="1050"/></div><div><br/></div><div>所以还是得老老实实把加密密钥算出来。从游戏文件夹和RPG Maker MV安装文件夹取得同一个素材文件的未加密和已加密版本，这里选择地图图块Dungeon_A1：</div><div><img src="BUUCTF Misc 57（273-276）_files/Image [11].png" type="image/png" data-filename="Image.png" width="206"/></div><div>十六进制编辑器打开：</div><div><img src="BUUCTF Misc 57（273-276）_files/Image [12].png" type="image/png" data-filename="Image.png" width="815"/></div><div><img src="BUUCTF Misc 57（273-276）_files/Image [13].png" type="image/png" data-filename="Image.png" width="820"/></div><div>容易发现，加密文件第33字节开始的数据，和未加密文件第17字节开始的数据，是完全一致的。实际上，加密文件的前16个字节是RPG Maker MV加密文件的固定文件头，第17-32字节则是未加密文件前16个字节和密钥异或的结果。从而可以得到密钥：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>p = '89 50 4E 47 0D 0A 1A 0A 00 00 00 0D 49 48 44 52'.split(' ')</div><div>c = '7E 15 DC 75 87 1C 96 F2 58 E7 27 0D 31 9C B2 F9'.split(' ')</div><div><br/></div><div>for i in range(16):</div><div>    a = int(p[i], 16)</div><div>    b = int(c[i], 16)</div><div>    print(hex(a ^ b)[2:].zfill(2), end = '')</div></div><div>得到结果：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>f74592328a168cf858e7270078d4f6ab</div></div><div>然后打开data/System.json，在最后一个变量处填入密钥：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>&quot;encryptionKey&quot;:&quot;f74592328a168cf858e7270078d4f6ab&quot;</div></div><div>接下来即可正常运行游戏。当然想节约时间也可以开工程看或者修改或者开挂……很多事件都是靠玩家自己按确定键触发的，所以直接看事件非常方便。部分带有加密内容的事件也可以直接把玩家初始位置设定到该地图，然后通过“测试游戏”进入直接触发。</div><div><br/></div><div>首先注意到地图010:偏远美丽村庄，地图上的阴影写着2PART，可能和flag的第二部分有关：</div><div><img src="BUUCTF Misc 57（273-276）_files/Image [14].png" type="image/png" data-filename="Image.png" width="1920"/></div><div>在村庄范围内查看事件，发现每个房间的宝箱事件都包含加密对话：</div><div><img src="BUUCTF Misc 57（273-276）_files/Image [15].png" type="image/png" data-filename="Image.png" width="1050"/></div><div>进游戏依次触发，发现很友好地标注了序号：</div><div><img src="BUUCTF Misc 57（273-276）_files/Image [16].png" type="image/png" data-filename="Image.png" width="1039"/></div><div>总共七处宝箱，连接起来得到：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>Do you know j a v a</div></div><div>联想到游戏文件夹下有part2.jpg文件，猜测是某种和java有关的单图片隐写。最后找到<a href="https://github.com/ww23/BlindWatermark">Java盲水印</a>。</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>D:\CTFToolkit-v1.1.0\信息隐藏\JavaBlindWaterMark&gt;java -jar BlindWatermark.jar decode -c part2.jpg wm.jpg</div></div><div>得到水印图片：</div><div><span style="font-weight: bold;"><img src="BUUCTF Misc 57（273-276）_files/wm.jpg" type="image/jpeg" data-filename="wm.jpg" width="1000"/></span></div><div>感觉上是某种不认识的二维码，反色之后强行加了个定位符：</div><div><img src="BUUCTF Misc 57（273-276）_files/Image [17].png" type="image/png" data-filename="Image.png" width="357"/></div><div>然后用<a href="http://ancc.org.cn/Service/Book.aspx?classid=1">中国编码手机APP</a>来扫，发现是阿兹特克码：</div><div><img src="BUUCTF Misc 57（273-276）_files/Image [18].png" type="image/png" data-filename="Image.png" width="510"/></div><div>从而得到flag part2：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>W@rR1or</div></div><div><br/></div><div>根据part2中得到的加密对话这条线索，找到地图028:王宫2 3F的事件011：</div><div><img src="BUUCTF Misc 57（273-276）_files/Image [19].png" type="image/png" data-filename="Image.png" width="1050"/></div><div><img src="BUUCTF Misc 57（273-276）_files/Image [20].png" type="image/png" data-filename="Image.png" width="1039"/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>54651A6252C6f5f653f55E62704f55F70395</div></div><div>去掉大写字母：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>5465162526f5f653f5562704f5570395</div></div><div>试着每两位十六进制ASCII转码，但发现有16和f5。再观察一下发现先倒序再转码就全部为可打印字符了：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>5930755f4072655f356f5f6252615645</div><div>Y0u_@re_5o_bRaVE</div></div><div>一开始以为结束了，后来发现游戏文件夹下还有个s3cr3t.crypto。用Encrypto打开，把上面这段字符串作为密码，解密：</div><div><img src="BUUCTF Misc 57（273-276）_files/Image [21].png" type="image/png" data-filename="Image.png" width="438"/></div><div>得到的实际是个文本，内容为大量空格和Tab：</div><div><img src="BUUCTF Misc 57（273-276）_files/Image [22].png" type="image/png" data-filename="Image.png" width="1095"/></div><div>尝试后发现空格和Tab分别对应0和1：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>100110101111011010101110000001000001011010000110011011101010011000000100011001101111011010101110011101100010011000000100100101100010111010000100100001001000010010000100100001001000010001010000</div><div>01010000</div><div>01010000</div><div>01010000</div><div>000011101000011001001110001011101100110001011100111010100001011001001110010010100100111001001110010011100111111001010000</div></div><div>然后同样需要倒序再二进制ASCII转码：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>~rrrRrhW:3trap</div><div><br/></div><div><br/></div><div><br/></div><div>!!!!!!ti dnuof evah uoY</div></div><div>再倒序一次：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>You have found it!!!!!!</div><div><br/></div><div><br/></div><div><br/></div><div>part3:WhrRrrr~</div></div><div>从而得到flag part3：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>WhrRrrr~</div></div><div><br/></div><div>最后还剩part1。继续找加密对话，在地图006:道具商店：</div><div><img src="BUUCTF Misc 57（273-276）_files/Image [23].png" type="image/png" data-filename="Image.png" width="1050"/></div><div><img src="BUUCTF Misc 57（273-276）_files/Image [24].png" type="image/png" data-filename="Image.png" width="1039"/></div><div>注意到数据库里有这个道具：</div><div><img src="BUUCTF Misc 57（273-276）_files/Image [25].png" type="image/png" data-filename="Image.png" width="1182"/></div><div>继续寻找用到这个道具的事件，在地图032:武器商店2：</div><div><img src="BUUCTF Misc 57（273-276）_files/Image [26].png" type="image/png" data-filename="Image.png" width="1050"/></div><div>进入空中神殿-神殿内部地图：</div><div><img src="BUUCTF Misc 57（273-276）_files/Image [27].png" type="image/png" data-filename="Image.png" width="1920"/></div><div>果然又有加密对话，而且有两处：</div><div><img src="BUUCTF Misc 57（273-276）_files/Image [28].png" type="image/png" data-filename="Image.png" width="1039"/></div><div><img src="BUUCTF Misc 57（273-276）_files/Image [29].png" type="image/png" data-filename="Image.png" width="1039"/></div><div>说明线索很可能在这张地图中，但其他事件的对话里找不到线索。包括那些窗户上的对话……虽然出题人说它们是镜子，但它们确实是窗户，其实在RPG Maker MV里鼠标指向一个地图图块后，编辑器左下角会给出图块内容提示的：</div><div><img src="BUUCTF Misc 57（273-276）_files/Image [30].png" type="image/png" data-filename="Image.png" width="279"/></div><div>总之对话文本中没有线索，那就看一下其他事件，注意到这些没有对话的NPC：</div><div><img src="BUUCTF Misc 57（273-276）_files/Image [31].png" type="image/png" data-filename="Image.png" width="1050"/></div><div>事件页完全是空白的，更改过事件设置的内容唯有行走图和自主移动中的自定义路线：</div><div><img src="BUUCTF Misc 57（273-276）_files/Image [32].png" type="image/png" data-filename="Image.png" width="900"/></div><div>共有八个这样的NPC，把它们的移动路线画出来：</div><div><img src="BUUCTF Misc 57（273-276）_files/Image [33].png" type="image/png" data-filename="Image.png" width="974"/></div><div>大小写字母勉强可以靠字体大小区分，就是数字5和字母S真的分不清……尝试后得到flag part1：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>Pr1nCe5s</div></div><div><br/></div><div>最后根据题目说明组合三个part得到flag。</div><div><br/></div><div>flag：WMCTF{Pr1nCe5s+W@rR1or=WhrRrrr~}</div><div><br/></div><div><span style="font-weight: bold;">276 [BSidesSF2020]fortune-cookie</span></div><div><br/></div><div>下载得到txt格式文件，内容为题目说明：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>Fortune Cookies are believed to have been invented by Asian-American immigrants here on the west coast.  It's not certain exactly when or where, but what is known is that they're a staple in the wonderful restaurants of San Francisco's Chinatown.  They're also floating around the conference!  If you find one, it might hold more than a fortune for you.</div></div><div><br/></div><div>根据题目说明，会议周围（可能）可以找到幸运饼干，其中（可能）有题目的线索。怀疑本题是线下题，理由如下：</div><div>1、官方在<a href="https://github.com/BSidesSF/ctf-2020-release/tree/master/fortune-cookie">Github</a>上放出了本次比赛的所有题目，但本题仅给出了题目名称、内容、作者、flag、分值等信息，没有相关文件和解答；</div><div>2、搜索关键词“BSidesSF2020 fortune-cookie”可以找到<a href="https://twitter.com/BSidesSFCTF">官方twitter</a>，注意到2月25日的转推：</div><div><img src="BUUCTF Misc 57（273-276）_files/Image [34].png" type="image/png" data-filename="Image.png" width="730"/></div><div>事实上，<a href="https://twitter.com/iagox86">@iagox86</a>就是本题作者。<a href="https://twitter.com/iagox86/status/1232077150670356481">该推文</a>附带了一张图片：</div><div><img src="BUUCTF Misc 57（273-276）_files/ERk3oE6U8AAkJGK.jpg" type="image/jpeg" data-filename="ERk3oE6U8AAkJGK.jpg" width="2048"/></div><div>图中有一篮幸运饼干和从饼干中取出的字条，放大字条内容并锐化：</div><div><img src="BUUCTF Misc 57（273-276）_files/Image [35].png" type="image/png" data-filename="Image.png" width="960"/></div><div>可以大致看出MDP和QKWO}的字样。对两段字符均进行密钥为10的移位密码解密，得到CTF和GAME}。其中前者是本次比赛的flag格式，后者也确实是本题flag的最后一部分。</div><div><br/></div><div>结合推文内容（“有多少CTF比赛会给你一个幸运饼干呢？”），猜测本题的形式为：在比赛现场提供幸运饼干，其中的签语字条内容为MDP{CRKVVGOZVKIKQKWO}，对其进行密钥为10的移位密码解密就得到flag。也因此本题无法在线上提供相关文件或其他信息。</div><div><br/></div><div>当然，本题也可能是社工类题目，twitter上的这张图片是线索之一。但如果注意到<a href="https://twitter.com/iagox86/status/1231629981748326400">这条推文</a>：</div><div><img src="BUUCTF Misc 57（273-276）_files/Image [36].png" type="image/png" data-filename="Image.png" width="722"/></div><div>2月24日比赛的线上部分就已经上线，而幸运饼干的照片是2月25日发布的，社工题的线索不可能比题目发布还迟。同时本条推文也确认了大部分题目都可以线上完成，但的确有部分题目要求在现场才能做。</div><div><br/></div><div>flag：CTF{shallweplayagame}</div></span>
</div></body></html> 