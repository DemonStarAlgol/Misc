<html>
<head>
  <title>BUUCTF Misc 21（129-132）</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/605894 (zh-CN, DDL); Windows/6.1.1 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="1528"/>
<h1>BUUCTF Misc 21（129-132）</h1>
<h2><a href="https://DemonStarAlgol.github.io/Misc/">[无关链接]</a></h2>

<div>
<span><div><span style="font-weight: bold;">129 voip</span></div><div><br/></div><div>下载得到voip.pcap文件。本题不知道为什么Kali自带的wireshark一直卡死，用了Windows下的2.0.2旧版。</div><div>根据题目名称提示，wireshark打开后点击菜单栏-电话-VOIP通话：</div><div><img src="BUUCTF Misc 21（129-132）_files/Image.png" type="image/png" data-filename="Image.png"/></div><div><img src="BUUCTF Misc 21（129-132）_files/Image [1].png" type="image/png" data-filename="Image.png"/></div><div>点击“播放流”。</div><div><img src="BUUCTF Misc 21（129-132）_files/Image [2].png" type="image/png" data-filename="Image.png"/></div><div>再点击播放按钮，就能听到电话内容。本题的音频中读出了flag内容。</div><div><br/></div><div>flag：flag{9001IVR}</div><div><br/></div><div><span style="font-weight: bold;">130 hashcat</span></div><div><br/></div><div>下载得到名为“What kind of document is this?”的文件，十六进制编辑器查看，文件头为D0 CF 11 E0，是Microsoft Office 2003以前版本的doc/xls/ppt文档。</div><div>从题目hashcat可以猜测需要爆破文件密码。但Office 2007打开并不会提示需要密码，而是直接无反应，可能是版本问题。经测试WPS会提示密码，Office 2003暂未尝试。</div><div>这里尝试使用Accent OFFICE Password Recovery来进行密码爆破。</div><div><img src="BUUCTF Misc 21（129-132）_files/Image [3].png" type="image/png" data-filename="Image.png"/></div><div>得到密码为9919。</div><div>尝试在Kali中用LibreOffice打开，提示输入密码。</div><div><img src="BUUCTF Misc 21（129-132）_files/Image [4].png" type="image/png" data-filename="Image.png"/></div><div>打开后自动判断是Powerpoint文档。</div><div><img src="BUUCTF Misc 21（129-132）_files/Image [5].png" type="image/png" data-filename="Image.png"/></div><div>搜索字符串flag，定位到了第7张：</div><div><img src="BUUCTF Misc 21（129-132）_files/Image [6].png" type="image/png" data-filename="Image.png"/></div><div>修改字体颜色或者直接把内容复制出来得到flag。</div><div><br/></div><div>flag：Flag{okYOUWIN}</div><div><br/></div><div><span style="font-weight: bold;">131 [湖南省赛2019]Findme</span></div><div><br/></div><div>下载得到Findme文件夹，内含1-5.png五张png图片。一张一张来看。</div><div><br/></div><div>1.png用010Editor打开提示CRC错误，爆破一下高度和宽度：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>import zlib</div><div>import struct</div><div><br/></div><div># 同时爆破宽度和高度</div><div>filename = 'C:/Users/Administrator/Desktop/Findme/1.png'</div><div>with open(filename, 'rb') as f:</div><div>    all_b = f.read()</div><div>    crc32key = int(all_b[29:33].hex(), 16)</div><div>    data = bytearray(all_b[12:29])</div><div>    n = 4095</div><div>    for w in range(n):</div><div>        width = bytearray(struct.pack('&gt;i', w))</div><div>        for h in range(n):</div><div>            height = bytearray(struct.pack('&gt;i', h))</div><div>            for x in range(4):</div><div>                data[x+4] = width[x]</div><div>                data[x+8] = height[x]</div><div>            crc32result = zlib.crc32(data)</div><div>            if crc32result == crc32key:</div><div>                print(&quot;宽为：&quot;, end = '')</div><div>                print(width, end = ' ')</div><div>                print(int.from_bytes(width, byteorder='big'))</div><div>                print(&quot;高为：&quot;, end = '')</div><div>                print(height, end = ' ')</div><div>                print(int.from_bytes(height, byteorder='big'))</div></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>宽为：bytearray(b'\x00\x00\x00\xe3') 227</div><div>高为：bytearray(b'\x00\x00\x01\xc5') 453</div></div><div>在010Editor中修改宽高，但打开后仍然无法显示完整图像：</div><div><img src="BUUCTF Misc 21（129-132）_files/Image [7].png" type="image/png" data-filename="Image.png"/></div><div>继续在010Editor中查看，发现有两个数据块缺少IDAT标识：</div><div><img src="BUUCTF Misc 21（129-132）_files/Image [8].png" type="image/png" data-filename="Image.png"/></div><div>如图将其补全：</div><div><img src="BUUCTF Misc 21（129-132）_files/Image [9].png" type="image/png" data-filename="Image.png"/></div><div>可以正常显示后，Stegsolve打开，在Blue plane 2处找到二维码：</div><div><img src="BUUCTF Misc 21（129-132）_files/Image [10].png" type="image/png" data-filename="Image.png"/></div><div>扫码得到：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>ZmxhZ3s0X3</div></div><div>base64解码：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>flag{4_</div></div><div><br/></div><div>2.png用十六进制编辑器打开，文件尾后有7z字样的文件头。</div><div><img src="BUUCTF Misc 21（129-132）_files/Image [11].png" type="image/png" data-filename="Image.png"/></div><div>但再仔细观察一下会发现，后面跟的是03 04，后续字节也是zip格式的特征。实际上这里是把zip格式的50 4B字节全部替换成了37 7A。将这段数据提取后重新替换回50 4B，得到zip压缩包。内含0-999.txt共1000个文本文件。</div><div><img src="BUUCTF Misc 21（129-132）_files/Image [12].png" type="image/png" data-filename="Image.png"/></div><div>观察发现618.txt的修改时间和大小都与其他文件不同，打开得到：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>You find it: 1RVcmVfc</div></div><div><br/></div><div>3.png同样提示CRC错误。爆破宽高无结果，修改高度也得不到线索，观察一下CRC值本身：</div><div><img src="BUUCTF Misc 21（129-132）_files/Image [13].png" type="image/png" data-filename="Image.png"/></div><div>chunk[0]到[6]的CRC值分别是0x33、0x52、0x6C、0x5A、0x33、0x30、0x3D，注意到都是两位十六进制数，且在ASCII可打印字符范围内，尝试转码为ASCII字符：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>3RlZ30=</div></div><div><br/></div><div>4.png用zsteg查看：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop# zsteg 4.png</div><div>meta Artist         .. text: <font style="color: rgb(255, 0, 0);">&quot;another part:cExlX1BsY&quot;</font></div><div>imagedata           .. text: &quot;&amp;&amp;(\&quot;\&quot; $#%&quot;</div><div>b2,g,msb,xy         .. text: &quot;X+aO!66'`&quot;</div><div>b3,bgr,msb,xy       .. file: TeX virtual font data</div><div>b4,r,lsb,xy         .. text: &quot;vCfUC33333-&quot;</div><div>b4,g,lsb,xy         .. text: &quot;T2#\&quot;\&quot;\&quot;\&quot;!&quot;</div><div>b4,b,lsb,xy         .. text: &quot;UhUUUUEh&quot;</div><div>b4,rgb,lsb,xy       .. text: &quot;rw'rw'rw'rw'&quot;</div><div>b4,bgr,lsb,xy       .. text: &quot;rw'rw'rw'rw'&quot;</div></div><div>或者使用exiftool命令也可以找到这段信息。得到：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>cExlX1BsY</div></div><div><br/></div><div>5.png用十六进制编辑器查看，尾部有字符串。</div><div><img src="BUUCTF Misc 21（129-132）_files/Image [14].png" type="image/png" data-filename="Image.png"/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>Yzcllfc0lN</div></div><div><br/></div><div>最后得到了五段base64编码的片段：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>1、ZmxhZ3s0X3</div><div>2、1RVcmVfc</div><div>3、3RlZ30=</div><div>4、cExlX1BsY</div><div>5、Yzcllfc0lN</div></div><div>可以确定1是开头，3是末尾，剩下三段尝试之后发现应以1-5-4-2-3的顺序拼接，得到：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>ZmxhZ3s0X3Yzcllfc0lNcExlX1BsY1RVcmVfc3RlZ30=</div></div><div>解码得到flag。</div><div><br/></div><div>flag：flag{4_v3rY_sIMpLe_PlcTUre_steg}</div><div><br/></div><div><span style="font-weight: bold;">132 [UTCTF2020]zero</span></div><div><br/></div><div>下载得到txt格式文件。</div><div><img src="BUUCTF Misc 21（129-132）_files/Image [15].png" type="image/png" data-filename="Image.png"/></div><div>从这段文字中无法得到更多信息，但考虑到字符数量和文件大小（1952字节）并不匹配，且用方向键移动光标时会在某些位置停留，猜测是零宽字符隐写。<span style="color: unset; font-family: unset; font-size: unset;">然后使用</span><a href="https://330k.github.io/misc_tools/unicode_steganography.html" style="font-family: unset; font-size: unset;">在线工具</a><span style="color: unset; font-family: unset; font-size: unset;">解码即可。</span></div><div><img src="BUUCTF Misc 21（129-132）_files/Image [16].png" type="image/png" data-filename="Image.png"/></div><div><span style="font-size: unset;"><br/></span></div><div><span style="font-size: unset; color: unset; font-family: unset;">flag：</span>utflag{whyNOT@sc11_4927aajbqk14}</div></span>
</div></body></html> 