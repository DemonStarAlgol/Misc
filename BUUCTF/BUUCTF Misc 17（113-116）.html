<html>
<head>
  <title>BUUCTF Misc 17（113-116）</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/605894 (zh-CN, DDL); Windows/6.1.1 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="1581"/>
<h1>BUUCTF Misc 17（113-116）</h1>
<h2><a href="https://DemonStarAlgol.github.io/Misc/">[无关链接]</a></h2>

<div>
<span><div><span style="font-weight: bold;">113 派大星的烦恼</span></div><div>题目：派大星最近很苦恼，因为它的屁股上出现了一道疤痕！我们拍下了它屁股一张16位位图，0x22，0x44代表伤疤两种细胞，0xf0则是派大星的赘肉。还原伤疤，知道是谁打的派大星！（答案为32位的一串字符串）</div><div><br/></div><div>下载得到bmp格式文件，如果用肉眼看全是品红色，根据题目，需要从十六进制字节中提取信息。</div><div><img src="BUUCTF Misc 17（113-116）_files/Image.png" type="image/png" data-filename="Image.png"/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>&quot;DD&quot;DD&quot;&quot;&quot;&quot;D&quot;DD&quot;&quot;&quot;&quot;&quot;&quot;DD&quot;&quot;&quot;DD&quot;DD&quot;&quot;D&quot;&quot;DDD&quot;&quot;D&quot;D&quot;DD&quot;&quot;&quot;&quot;&quot;&quot;DD&quot;&quot;D&quot;&quot;&quot;&quot;DD&quot;D&quot;D&quot;DD&quot;&quot;&quot;&quot;D&quot;DD&quot;&quot;D&quot;&quot;&quot;DD&quot;&quot;&quot;&quot;&quot;DDD&quot;&quot;&quot;&quot;D&quot;DD&quot;&quot;&quot;D&quot;&quot;&quot;DD&quot;&quot;&quot;D&quot;&quot;DD&quot;D&quot;D&quot;DD&quot;&quot;&quot;DD&quot;&quot;DD&quot;D&quot;D&quot;&quot;DD&quot;&quot;DD&quot;DD&quot;&quot;&quot;D&quot;&quot;&quot;DD&quot;&quot;DD&quot;DD&quot;&quot;D&quot;D&quot;&quot;DD&quot;D&quot;D&quot;DD&quot;&quot;&quot;D&quot;&quot;&quot;DD&quot;&quot;&quot;D&quot;DD&quot;&quot;DD&quot;&quot;&quot;DD&quot;D&quot;D&quot;&quot;DD&quot;&quot;&quot;D&quot;DD&quot;&quot;DD&quot;&quot;DD&quot;&quot;&quot;&quot;&quot;DDD&quot;&quot;DD&quot;&quot;DD&quot;&quot;&quot;D&quot;&quot;DD&quot;&quot;</div></div><div>两种字符代表两种伤疤，长度为256，已知答案是32位，猜测是二进制ASCII码。以0x22（&quot;）为0，0x44（D）为1：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>01101100 00101100 00001100 01101100 10011100 10101100 00001100 10000110 10101100 00101100 10001100 00011100 00101100 01000110 00100110 10101100 01100110 10100110 01101100 01000110 01101100 10100110 10101100 01000110 00101100 11000110 10100110 00101100 11001100 00011100 11001100 01001100</div></div><div>但无法正确转码为字符，事实上可以看到存在1开头位于不可打印区间的字符。再仔细观察，发现每段的末尾都是0，考虑将每段倒转后再ASCII转码。有两种可能性，每段分别倒转，或者整段倒转。尝试后发现是前者。</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>a = '01101100 00101100 00001100 01101100 10011100 10101100 00001100 10000110 10101100 00101100 10001100 00011100 00101100 01000110 00100110 10101100 01100110 10100110 01101100 01000110 01101100 10100110 10101100 01000110 00101100 11000110 10100110 00101100 11001100 00011100 11001100 01001100'</div><div>a = a.split(' ')</div><div><br/></div><div>for i in a:</div><div>    print(i[::-1], end = ' ')</div><div>print('\n')</div><div>for i in a:</div><div>    print(chr(int(i[::-1], 2)), end = '')</div></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>00110110 00110100 00110000 00110110 00111001 00110101 00110000 01100001 00110101 00110100 00110001 00111000 00110100 01100010 01100100 00110101 01100110 01100101 00110110 01100010 00110110 01100101 00110101 01100010 00110100 01100011 01100101 00110100 00110011 00111000 00110011 00110010</div><div><br/></div><div>6406950a54184bd5fe6b6e5b4ce43832</div></div><div><br/></div><div>flag：flag{6406950a54184bd5fe6b6e5b4ce43832}</div><div><br/></div><div><span style="font-weight: bold;">114 [XMAN2018排位赛]通行证</span></div><div><br/></div><div>下载得到txt格式文件，内容：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>a2FuYmJyZ2doamx7emJfX19ffXZ0bGFsbg==</div></div><div>base64解码：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>kanbbrgghjl{zb____}vtlaln</div></div><div>看起来像是栅栏，做起来也像是栅栏，然而本题是用<span style="font-weight: bold; color: rgb(255, 0, 0);">无法整除长度的密钥</span>对字符串进行<span style="color: rgb(255, 0, 0); font-weight: bold;">W形栅栏 </span><span style="color: rgb(255, 0, 0); font-weight: bold;">加密</span>。</div><div>也就是说要把原字符串排成这样然后横向读，如果没有正好找到刚刚好的工具手工肯定解不出来。</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>k     z     n</div><div>a   {   b   l</div><div>n   l   _   a</div><div>b   j   _   l</div><div>b   h   _   t</div><div>r   g   _   v</div><div>  g       }</div></div><div>总之得到：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>kzna{blnl_abj_lbh_trg_vg}</div></div><div>然后凯撒移位爆破一下：</div><div><img src="BUUCTF Misc 17（113-116）_files/Image [1].png" type="image/png" data-filename="Image.png"/></div><div>看得出来实际上就是ROT13。</div><div><br/></div><div>flag：<span style="text-indent: 0px;">xman{oyay_now_you_get_it}</span></div><div><span style="text-indent: 0px;">甚至懒得吐槽这应该是Crypto的古典密码题了，估计这题就是直接用</span><a href="https://github.com/guyoung/CaptfEncoder">CaptfEncoder</a>出的，别的地方没有这么坑的栅栏。</div><div><br/></div><div><span style="font-weight: bold;">115 [GKCTF2020]Harley Quinn</span></div><div><br/></div><div>下载得到zip格式文件。</div><div><img src="BUUCTF Misc 17（113-116）_files/Image [2].png" type="image/png" data-filename="Image.png"/></div><div>解压得到jpeg格式图片和wav格式音频。根据注释中的提示，用FreeFileCamouflage可以提取图片中的隐藏信息，但尝试后发现可能需要密码。</div><div>先看wav音频，听一遍能发现末尾有一串急促的拨号音。此外从属性中可以知道音频中藏着21位的密文。</div><div><img src="BUUCTF Misc 17（113-116）_files/Image [3].png" type="image/png" data-filename="Image.png"/></div><div>用audacity提取出最后的拨号音频，再用dtmf2num工具转码：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>E:\dtmf2num&gt;dtmf2num.exe new.wav<br/></div><div><br/></div><div>DTMF2NUM 0.1.1</div><div>by Luigi Auriemma</div><div>e-mail: aluigi@autistici.org</div><div>web:    aluigi.org</div><div><br/></div><div>- open new.wav</div><div>  wave size      498708</div><div>  format tag     1</div><div>  channels:      2</div><div>  samples/sec:   44100</div><div>  avg/bytes/sec: 176400</div><div>  block align:   4</div><div>  bits:          16</div><div>  samples:       249354</div><div>  bias adjust:   13</div><div>  volume peaks:  -31205 31205</div><div>  normalize:     1562</div><div>  resampling to: 8000hz</div><div><br/></div><div>- MF numbers:    844477</div><div><br/></div><div>- DTMF numbers:  #<font color="#FF0000">222833344477773338866</font>#</div></div><div>正好21位长，明显是手机键盘密码，转码得到：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>ctfisfun</div></div><div><br/></div><div>用FreeFileCamouflage和这段密码，提取jpg图片。</div><div><img src="BUUCTF Misc 17（113-116）_files/Image [4].png" type="image/png" data-filename="Image.png"/></div><div>得到flag.txt。</div><div><br/></div><div>flag：flag{Pudd1n!!_y0u_F1nd_m3!}</div><div><br/></div><div><b>116 [MRCTF2020]Unravel!!</b></div><div><br/></div><div>下载得到Unravel文件夹，内含JM.png、Look_at_the_file_ending.wav和win-win.zip。</div><div><br/></div><div>先看JM.png，010Editor和zsteg都提示文件尾后有其它数据。foremost分离，得到aes.png。</div><div><img src="BUUCTF Misc 17（113-116）_files/aes.png" type="image/png" data-filename="aes.png"/></div><div>根据文件名猜测是密钥。</div><div><br/></div><div>再看Look_at_the_file_ending.wav，根据文件名提示，在十六进制模式下去看文件末尾。</div><div><img src="BUUCTF Misc 17（113-116）_files/Image [5].png" type="image/png" data-filename="Image.png"/></div><div>得到：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>U2FsdGVkX1/nSQN+hoHL8OwV9iJB/mSdKk5dmusulz4=</div></div><div>用Tokyo作为密钥解密<b><font style="color: rgb(255, 0, 0);">（U2Fs开头的base64格式AES密文可以用CaptfEncoder解密）</font></b>：</div><div><img src="BUUCTF Misc 17（113-116）_files/Image [6].png" type="image/png" data-filename="Image.png"/></div><div>得到：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>CCGandGulu</div></div><div><br/></div><div>以CCGandGulu为密码解压win-win.zip，得到Ending.wav。用Silenteye提取隐写信息得到flag。</div><div><img src="BUUCTF Misc 17（113-116）_files/Image [7].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>flag：<span style="text-indent: 0px;">MRCTF{Th1s_is_the_3nd1n9}</span></div><div><br/></div></span>
</div></body></html> 