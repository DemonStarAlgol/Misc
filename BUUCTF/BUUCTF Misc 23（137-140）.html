<html>
<head>
  <title>BUUCTF Misc 23（137-140）</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/605894 (zh-CN, DDL); Windows/6.1.1 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="1504"/>
<h1>BUUCTF Misc 23（137-140）</h1>
<h2><a href="https://DemonStarAlgol.github.io/Misc/">[无关链接]</a></h2>

<div>
<span><div><span style="font-weight: bold;">137 我爱Linux</span></div><div><br/></div><div>下载得到png格式文件。十六进制编辑器打开，发现这不是png，是改了文件头的jpg。</div><div><img src="BUUCTF Misc 23（137-140）_files/Image.png" type="image/png" data-filename="Image.png"/></div><div>把文件头修复为FF D8 FF E0，得到jpg格式图片。继续十六进制编辑器查看，发现文件尾后还有数据。</div><div><img src="BUUCTF Misc 23（137-140）_files/Image [1].png" type="image/png" data-filename="Image.png"/></div><div>这段数据是Python序列化对象：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>Python中的Pickle模块实现了基本的数据序列与反序列化。</div><div>一、dump()方法 pickle.dump(obj, file, [,protocol])</div><div>注释：序列化对象，将对象obj保存到文件file中去。参数protocol是序列化模式，默认是0（ASCII协议，表示以文本的形式进行序列化），protocol的值还可以是1和2（1和2表示以二进制的形式进行序列化。其中，1是老式的二进制协议；2是新二进制协议）。file表示保存到的类文件对象，file必须有write()接口，file可以是一个以’w’打开的文件或者是一个StringIO对象，也可以是任何可以实现write()接口的对象。</div><div>二、load()方法 pickle.load(file)</div><div>注释：反序列化对象，将文件中的数据解析为一个python对象。file中有read()接口和readline()接口。</div></div><div>用脚本将其读取后反序列化，再保存成文本：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>import pickle</div><div><br/></div><div>f = open('C:/Users/Administrator/Desktop/1', 'rb')</div><div>a = pickle.load(f)</div><div><br/></div><div>out = open('C:/Users/Administrator/Desktop/out.txt', 'w')</div><div>out.write(str(a))</div><div>out.close()</div></div><div>得到：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>[[(3, 'm'), (4, '&quot;'), (5, '&quot;'), (8, '&quot;'), (9, '&quot;'), (10, '#'), (31, 'm'), (32, '&quot;'), (33, '&quot;'), (44, 'm'), (45, 'm'), (46, 'm'), (47, 'm'), (50, 'm'), (51, 'm'), (52, 'm'), (53, 'm'), (54, 'm'), (55, 'm'), (58, 'm'), (59, 'm'), (60, 'm'), (61, 'm'), (66, 'm'), (67, '&quot;'), (68, '&quot;'), (75, '#')], [(1, 'm'), (2, 'm'), (3, '#'), (4, 'm'), (5, 'm'), (10, '#'), (16, 'm'), (17, 'm'), (18, 'm'), (23, 'm'), (24, 'm'), (25, 'm'), (26, 'm'), (31, '#'), (37, 'm'), (38, 'm'), (39, 'm'), (43, '&quot;'), (47, '&quot;'), (48, '#'), (54, '#'), (55, '&quot;'), (57, '&quot;'), (61, '&quot;'), (62, '#'), (64, 'm'), (65, 'm'), (66, '#'), (67, 'm'), (68, 'm'), (72, 'm'), (73, 'm'), (74, 'm'), (75, '#')], [(3, '#'), (10, '#'), (15, '&quot;'), (19, '#'), (22, '#'), (23, '&quot;'), (25, '&quot;'), (26, '#'), (29, 'm'), (30, 'm'), (31, '&quot;'), (36, '&quot;'), (40, '#'), (47, 'm'), (48, '&quot;'), (53, 'm'), (54, '&quot;'), (59, 'm'), (60, 'm'), (61, 'm'), (62, '&quot;'), (66, '#'), (71, '#'), (72, '&quot;'), (74, '&quot;'), (75, '#')], [(3, '#'), (10, '#'), (15, 'm'), (16, '&quot;'), (17, '&quot;'), (18, '&quot;'), (19, '#'), (22, '#'), (26, '#'), (31, '#'), (36, 'm'), (37, '&quot;'), (38, '&quot;'), (39, '&quot;'), (40, '#'), (45, 'm'), (46, '&quot;'), (52, 'm'), (53, '&quot;'), (61, '&quot;'), (62, '#'), (66, '#'), (71, '#'), (75, '#')], [(3, '#'), (10, '&quot;'), (11, 'm'), (12, 'm'), (15, '&quot;'), (16, 'm'), (17, 'm'), (18, '&quot;'), (19, '#'), (22, '&quot;'), (23, '#'), (24, 'm'), (25, '&quot;'), (26, '#'), (31, '#'), (36, '&quot;'), (37, 'm'), (38, 'm'), (39, '&quot;'), (40, '#'), (43, 'm'), (44, '#'), (45, 'm'), (46, 'm'), (47, 'm'), (48, 'm'), (51, 'm'), (52, '&quot;'), (57, '&quot;'), (58, 'm'), (59, 'm'), (60, 'm'), (61, '#'), (62, '&quot;'), (66, '#'), (71, '&quot;'), (72, '#'), (73, 'm'), (74, '#'), (75, '#')]</div><div>……（后略）</div></div><div>观察一下，发现是多个子列表组成的列表。每个子列表由多个对象组成，每个对象有两个值，前者为1-75间的数字，后者为字符。猜测每个子列表代表76长度的一行，其中每个对象代表某位上的字符，无对象对应的位置为空格。</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>data = list()</div><div>for i in range(len(a)):</div><div>    temp = [' '] * 77</div><div>    data.append(temp)</div><div># 生成和a的行数相同，列数为77，全部用空格填充的矩阵（以列表形式储存）</div><div># 77是为了把0位空出来，避免从0开始和从1开始计数的差异，设更大也没问题</div><div><br/></div><div>for i, j in enumerate(a):</div><div>    for m in j:</div><div>        data[i][m[0]] = m[1]</div><div># 把a中的内容按对应位置填到data中</div><div><br/></div><div>res = open('C:/Users/Administrator/Desktop/res.txt', 'w')</div><div>for i in data:</div><div>    res.write(''.join(i))</div><div>    res.write('\n')</div><div>res.close()</div><div># 逐行输出data到文本文件中</div></div><div><img src="BUUCTF Misc 23（137-140）_files/Image [2].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>flag：flag{a273fdedf3d746e97db9086ebbb195d6}</div><div><br/></div><div><span style="font-weight: bold;">138 [MRCTF2020]pyFlag</span></div><div><br/></div><div>下载得到Furan.jpg、Miku.jpg和Setsuna.jpg。总之全部十六进制编辑器打开看看：</div><div><img src="BUUCTF Misc 23（137-140）_files/Image [3].png" type="image/png" data-filename="Image.png"/></div><div>在Setsuna.jpg中找到Secret File Part 1，在Furan和Miku中分别找到Part 2和3。拼接起来得到zip格式压缩包。</div><div><br/></div><div>压缩包内含.hint.txt和flag.txt，均为加密。Ziperello爆破一下：</div><div><img src="BUUCTF Misc 23（137-140）_files/Image [4].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>.hint.txt（这文件名大概是想在Linux下隐藏……）内容：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>我用各种baseXX编码把flag套娃加密了，你应该也有看出来。</div><div>但我只用了一些常用的base编码哦，毕竟我的智力水平你也知道...像什么base36base58听都没听过</div><div>提示：0x10,0x20,0x30,0x55</div></div><div>十六进制数字转十进制依次是：16、32、48、85。</div><div><br/></div><div>flag.txt内容：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>G&amp;eOhGcq(ZG(t2*H8M3dG&amp;wXiGcq(ZG&amp;wXyG(j~tG&amp;eOdGcq+aG(t5oG(j~qG&amp;eIeGcq+aG)6Q&lt;G(j~rG&amp;eOdH9&lt;5qG&amp;eLvG(j~sG&amp;nRdH9&lt;8rG%++qG%__eG&amp;eIeGc+|cG(t5oG(j~sG&amp;eOlH9&lt;8rH8C_qH9&lt;8oG&amp;eOhGc+_bG&amp;eLvH9&lt;8sG&amp;eLgGcz?cG&amp;3|sH8M3cG&amp;eOtG%_?aG(t5oG(j~tG&amp;wXxGcq+aH8V6sH9&lt;8rG&amp;eOhH9&lt;5qG(&lt;E-H8M3eG&amp;wXiGcq(ZG)6Q&lt;G(j~tG&amp;eOtG%+&lt;aG&amp;wagG%__cG&amp;eIeGcq+aG&amp;M9uH8V6cG&amp;eOlH9&lt;8rG(&lt;HrG(j~qG&amp;eLcH9&lt;8sG&amp;wUwGek2)</div></div><div>首先base85解码：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>475532444B4E525549453244494E4A57475132544B514A54473432544F4E4A5547515A44474D4A5648415A54414E4257473434544B514A5647595A54514D5A5147553444474D5A5547453355434E5254475A42444B514A57494D3254534D5A5447555A444D4E5256494532444F4E4A57475A41544952425547343254454E534447595A544D524A5447415A55493D3D3D</div></div><div>然后base16解码（其实就是十六进制ASCII转码）：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>GU2DKNRUIE2DINJWGQ2TKQJTG42TONJUGQZDGMJVHAZTANBWG44TKQJVGYZTQMZQGU4DGMZUGE3UCNRTGZBDKQJWIM2TSMZTGUZDMNRVIE2DONJWGZATIRBUG42TENSDGYZTMRJTGAZUI===</div></div><div>然后base32解码：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>54564A4456455A3757544231583046795A5638305833417A636B5A6C593352665A47566A4D47526C636E303D</div></div><div>然后继续base16解码：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>TVJDVEZ7WTB1X0FyZV80X3AzckZlY3RfZGVjMGRlcn0=</div></div><div>然后base64解码：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>MRCTF{Y0u_Are_4_p3rFect_dec0der}</div></div><div><br/></div><div>flag：MRCTF{Y0u_Are_4_p3rFect_dec0der}</div><div><br/></div><div><span style="font-weight: bold;">139 [GUET-CTF2019]soul sipse</span></div><div><br/></div><div>下载得到out.wav，隐写内容不在波形里，而是用steghide隐写的。</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>D:\CTFToolkit-v1.1.0\信息隐藏\steghide&gt;steghide.exe extract -sf out.wav</div><div>Enter passphrase:（本题没有密码）</div><div>wrote extracted data to &quot;download.txt&quot;.</div></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>https://share.weiyun.com/5wVTIN3</div></div><div>从这个地址下载得到GUET.png，打开提示图片损坏。十六进制编辑器查看：</div><div><img src="BUUCTF Misc 23（137-140）_files/Image [5].png" type="image/png" data-filename="Image.png"/></div><div>第四个字节被改了，修复回47得到正常图片文件。</div><div><img src="BUUCTF Misc 23（137-140）_files/GUET.png" type="image/png" data-filename="GUET.png"/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>\u0034\u0030\u0037\u0030\u000d\u000a\u0031\u0032\u0033\u0034\u000d\u000a</div></div><div>这是Unicode编码，转码得到：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>4070</div><div>1234</div><div><br/></div></div><div>神奇的事情发生了，把两行当作竖式加起来得到flag……</div><div><br/></div><div>flag：flag{5304}</div><div><br/></div><div><span style="font-weight: bold;">140 [RCTF2019]disk</span></div><div><span style="color: rgb(255, 0, 0);">原题：An otaku used VeraCrypt to encrypt his favorites.</span></div><div><span style="color: rgb(255, 0, 0);">Password: rctf</span></div><div><span style="color: rgb(255, 0, 0); font-weight: bold;">（没有原题的信息难以想象要怎么做……）</span></div><div><br/></div><div>下载得到encrypt.vmdk文件，根据题目提示知道这是用VeraCrypt加密过的磁盘文件。先用7-Zip解压依次得到0.fat，说明外层的vmdk是容器。0.dat无法再次用7-Zip解压，说明是真正的VeraCrypt加密磁盘文件。</div><div><br/></div><div>先尝试性用十六进制编辑器打开0.fat，搜索字符串rctf：</div><div><img src="BUUCTF Misc 23（137-140）_files/Image [6].png" type="image/png" data-filename="Image.png"/></div><div>得到半段flag：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>rctf{unseCure_quick_form4t_vo1ume</div></div><div><br/></div><div>所以还是要装VeraCrypt……<span style="font-size: unset; color: unset; font-family: unset;">用VeraCrypt加载0.fat。</span></div><div><img src="BUUCTF Misc 23（137-140）_files/Image [7].png" type="image/png" data-filename="Image.png"/></div><div>进入Z盘，发现两个文件。左边的文件名说跟CTF无关可以忽略，那就先相信它，看右边的password.txt：</div><div><img src="BUUCTF Misc 23（137-140）_files/Image [8].png" type="image/png" data-filename="Image.png"/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>Password 2: RCTF2019</div><div><br/></div><div>You're late... So sad</div></div><div>又给了一个密码，把0.fat卸载后用这个密码重新加载。</div><div><img src="BUUCTF Misc 23（137-140）_files/Image [9].png" type="image/png" data-filename="Image.png"/></div><div>注意到这次得到了一个隐藏分区。隐藏分区是无法直接访问的，用DiskGenius以十六进制视图查看该分区。</div><div><img src="BUUCTF Misc 23（137-140）_files/Image [10].png" type="image/png" data-filename="Image.png"/></div><div>注意到如图位置，与前半段flag类似模式，同样的字符串重复多遍。得到了后半段flag。</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>_and_corrupted_1nner_v0lume}</div></div><div><br/></div><div>flag：rctf{unseCure_quick_form4t_vo1ume_and_corrupted_1nner_v0lume}</div></span>
</div></body></html> 