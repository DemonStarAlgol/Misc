<html>
<head>
  <title>BUUCTF Misc 33（177-180）</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/605894 (zh-CN, DDL); Windows/6.1.1 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="1380"/>
<h1>BUUCTF Misc 33（177-180）</h1>
<h2><a href="https://DemonStarAlgol.github.io/Misc/">[无关链接]</a></h2>

<div>
<span><div><span style="font-weight: bold;">177 [INSHack2018]42.tar.xz</span></div><div><br/></div><div>下载得到md格式文件和42.tar.xz。前者是题目说明：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>This file is very deep. Will you dare dig in it ?</div></div><div><br/></div><div>再看42.tar.xz，压缩包里包含1-42.tar.xz共42个文件，大小均相同。随便打开一个，其中又包含1-42.tar.xz共42个文件，如此重复，层数至少在40以上。</div><div><img src="BUUCTF Misc 33（177-180）_files/Image.png" type="image/png" data-filename="Image.png" width="1051"/></div><div>利用bash命令进行循环解压：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop/42# while [ &quot;`find . -type f -name '*.tar.xz' | wc -l`&quot; -gt 0 ]; do</div><div>&gt; find -type f -name &quot;*.tar.xz&quot; -exec tar xf '{}' \;</div><div>&gt; -exec rm -- '{}' \;;</div><div>&gt; done;</div></div><div>如此不断循环解压所有.tar.xz文件，直到得到其他格式的文件为止，并将过程中得到且已解压的压缩包删除，最后会得到flag文件和flag+数字命名的其他文件。flag在前者中。</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop/42# cat flag</div><div>INSA{04ebb0d6a87f9771f2eea4dce5b91a85e7623c13301a8007914085a91b3ca6d9}</div></div><div>本题心得是虚拟机硬盘空间要稍微留大一点。</div><div><br/></div><div>flag：INSA{04ebb0d6a87f9771f2eea4dce5b91a85e7623c13301a8007914085a91b3ca6d9}</div><div><br/></div><div><span style="font-weight: bold;">178 [De1CTF2019]Mine Sweeping</span></div><div><br/></div><div>下载得到Mine Sweeping，其中是个Unity编写的扫雷游戏。</div><div>随意尝试几局后发现，雷的位置每次开局不会改变，且雷的位置似乎排列成了二维码的形状：</div><div><img src="BUUCTF Misc 33（177-180）_files/Image [1].png" type="image/png" data-filename="Image.png" width="1042"/></div><div>接下来有两种方法，暴力尝试所有雷的位置并记录，或者先逆向找到游戏是否结束的判断代码（在Mine Sweeping\Mine Sweeping_Data\Managed\Assembly-CSharp.dll中），修改代码令点击到雷后游戏仍然继续，再手工点出所有雷得到二维码。尝试了寻找雷位置的数据（猜测可能在Mine Sweeping\Mine Sweeping_Data\level0中），但没有找到。</div><div>得到数据如下，其中0为雷：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>00000001000100000001000011010</div><div>01111101110010011001000001100</div><div>01000101101111011011010111111</div><div>01000101011011110101111101111</div><div>01000101111011100101000000010</div><div>01111101101010101101011101101</div><div>00000001101000000010010101110</div><div>11111111010110010001011101011</div><div>00000101000011010110000001010</div><div>10100010100101111010110111110</div><div>11000001110011010111110010101</div><div>11110111100010110001110110101</div><div>11100101010101111000000010011</div><div>11111110101001010110001111110</div><div>01011001010011101001100001111</div><div>00100111010111101101100000101</div><div>01101100111000001110111101000</div><div>11010110011110001001101010000</div><div>00011001110110011100001111111</div><div>10011011010010000101110101001</div><div>01101101111101011110101001011</div><div>11111111111011110101011111111</div><div>00000001010101010101010000000</div><div>01111101010011101010010111110</div><div>01000101011010010101010100010</div><div>01000101111110001001110100010</div><div>01000101001001011011010100010</div><div>01111101110101010110110111110</div><div>00000001100101111101010000000</div></div><div>作图，以0为黑色，1为白色：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>from PIL import Image</div><div><br/></div><div>f = open('C:/Users/Administrator/Desktop/1.txt', 'r').read().replace('\n', '')</div><div>img = Image.new('RGB', (29, 29))</div><div>for i in range(len(f)):</div><div>    x = i % 29</div><div>    y = i // 29</div><div>    if f[i] == '0':</div><div>        img.putpixel((x, y), (0, 0, 0))</div><div>    elif f[i] == '1':</div><div>        img.putpixel((x, y), (255, 255, 255))</div><div>img.show()</div></div><div>得到二维码（已放大）：</div><div><img src="BUUCTF Misc 33（177-180）_files/Image [2].png" type="image/png" data-filename="Image.png"/></div><div>扫码得到：<a href="http://qr02.cn/FeJ7dU">http://qr02.cn/FeJ7dU</a>。访问网址得到flag。</div><div><br/></div><div>flag：de1ctf{G3t_F1@g_AFt3R_Sw3ep1ng_M1n3s}</div><div><br/></div><div><span style="font-weight: bold;">179 [INSHack2018](not) so deep</span></div><div><br/></div><div>下载得到md格式文件和final_flag.wav。前者是题目说明：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>We captured strange sound while exploring seafloor.</div><div>If you are stuck maybe just go deeper..</div></div><div><br/></div><div>再看final_flag.wav，audacity打开，切换到频谱图，可以看到已经出现了类似文字下半部分的图像：</div><div><img src="BUUCTF Misc 33（177-180）_files/Image [3].png" type="image/png" data-filename="Image.png"/></div><div>在左边频率部分右键，选择“缩放到合适大小”，调整频率范围，得到完整图像：</div><div><img src="BUUCTF Misc 33（177-180）_files/Image [4].png" type="image/png" data-filename="Image.png"/></div><div>得到前半段flag：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>INSA{Aud1o_st3G4n</div></div><div><br/></div><div>联想到题目名称，搜索“deep 音频隐写”找到名为DeepSound的工具，打开原wav文件。</div><div><img src="BUUCTF Misc 33（177-180）_files/Image [5].png" type="image/png" data-filename="Image.png"/></div><div>使用Python脚本提取文件hash值，然后在Kali下用john爆破密码：</div><div><a href="BUUCTF Misc 33（177-180）_files/deepsound2john.py"><img src="BUUCTF Misc 33（177-180）_files/886905c9e5a4990fbbfdcf41cbf731f5.png" alt="deepsound2john.py"></a></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop# python3 deepsound2john.py final_flag.wav</div><div>final_flag.wav:$dynamic_1529$b8f858d9deb0b805797cef03299e3bdd8990f48a</div><div><br/></div><div>root@kali:~/Desktop# python3 deepsound2john.py final_flag.wav &gt; 1.txt</div><div><br/></div><div>root@kali:~/Desktop# john 1.txt</div><div>Using default input encoding: UTF-8</div><div>Loaded 1 password hash (dynamic_1529 [sha1($p null_padded_to_len_32) (DeepSound) 128/128 AVX 4x1])</div><div>Warning: no OpenMP support for this hash type, consider --fork=4</div><div>Proceeding with single, rules:Single</div><div>Press 'q' or Ctrl-C to abort, almost any other key for status</div><div>Warning: Only 22 candidates buffered for the current salt, minimum 24 needed for performance.</div><div>Almost done: Processing the remaining buffered candidate passwords, if any.</div><div>Warning: Only 12 candidates buffered for the current salt, minimum 24 needed for performance.</div><div>Proceeding with wordlist:/usr/share/john/password.lst, rules:Wordlist</div><div>Proceeding with incremental:ASCII</div><div><font color="#FF0000">azerty</font>           (final_flag.wav)</div><div>1g 0:00:00:03 DONE 3/3 (2020-10-17 02:18) 0.2525g/s 4678Kp/s 4678Kc/s 4678KC/s azuerz..azelux</div><div>Use the &quot;--show --format=dynamic_1529&quot; options to display all of the cracked passwords reliably</div><div>Session completed</div></div><div>用DeepSound和爆破得到的密码提取出flag2.txt文件：</div><div><img src="BUUCTF Misc 33（177-180）_files/Image [6].png" type="image/png" data-filename="Image.png"/></div><div>得到后半段flag：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>0_1s_4lwayS_Th3_S4me}</div></div><div><br/></div><div>flag：INSA{Aud1o_st3G4n0_1s_4lwayS_Th3_S4me}</div><div><br/></div><div><span style="font-weight: bold;">180 [*CTF2019]She</span></div><div><br/></div><div>下载得到She文件夹：</div><div><img src="BUUCTF Misc 33（177-180）_files/Image [7].png" type="image/png" data-filename="Image.png"/></div><div>这就触及到我的专业领域了，很明显是用RPG Maker XP（RPGツクールXP、RPG制作大师XP）1.03版制作的一款游戏。</div><div><br/></div><div>那么用RPG Maker XP打开这个游戏的工程（虽然买了Steam的正版，但不支持中文，此处用汉化版演示）。具体方法是新建一个游戏工程，然后把其中的Game.rxproj文件复制到游戏文件夹下，双击打开即可。</div><div><img src="BUUCTF Misc 33（177-180）_files/Image [8].png" type="image/png" data-filename="Image.png"/></div><div>顺着找到010号地图ROOM4，查看事件内容：</div><div><img src="BUUCTF Misc 33（177-180）_files/Image [9].png" type="image/png" data-filename="Image.png"/></div><div>大意：把宝箱里拿到的数字拼起来，计算MD5值然后提交。那么回头看宝箱。</div><div><br/></div><div>ROOM1、2、3共有九个小房间，每个房间宝箱事件对话里有一个数字。</div><div><img src="BUUCTF Misc 33（177-180）_files/Image [10].png" type="image/png" data-filename="Image.png"/></div><div>但同时注意到每个房间的门上还有比较复杂的开关判断。</div><div><img src="BUUCTF Misc 33（177-180）_files/Image [11].png" type="image/png" data-filename="Image.png"/></div><div>那么换个方式，把三个房间里会导致游戏结束的吸血鬼事件删掉。</div><div><img src="BUUCTF Misc 33（177-180）_files/Image [12].png" type="image/png" data-filename="Image.png"/></div><div>然后把主角开始地点设置在007号Start地图。</div><div><img src="BUUCTF Misc 33（177-180）_files/Image [13].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>然后开始测试游戏（顺便把脚本编辑器里的自动全屏脚本也删了），先从8号房间得到7。</div><div><img src="BUUCTF Misc 33（177-180）_files/Image [14].png" type="image/png" data-filename="Image.png"/></div><div>接下来依次是：3号房间得到3，2号房间得到1，1号房间得到2，5号房间得到6，7号房间得到9。9号房间的门不能互动，否则会导致其他门打不开。按房间顺序把数字连起来得到213697，计算MD5得到flag。</div><div><br/></div><div>flag：*ctf{d6f3fdffbcb462607878af65d059f274}</div></span>
</div></body></html> 