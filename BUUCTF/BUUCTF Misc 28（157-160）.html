<html>
<head>
  <title>BUUCTF Misc 28（157-160）</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/605894 (zh-CN, DDL); Windows/6.1.1 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="1454"/>
<h1>BUUCTF Misc 28（157-160）</h1>
<h2><a href="https://DemonStarAlgol.github.io/Misc/">[无关链接]</a></h2>

<div>
<span><div><span style="font-weight: bold;">157 [XMAN2018排位赛]file</span></div><div><br/></div><div>下载得到img格式文件，Linux下file命令查看，发现是ext4文件系统镜像，用mount命令挂载。</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop# file attachment.img</div><div>attachment.img: Linux rev 1.0 ext4 filesystem data, UUID=2d362e1b-69ae-4137-bdbb-4fde2775ac91 (extents) (huge files)</div><div>root@kali:~/Desktop# mkdir mnt （建立mnt文件夹）</div><div>root@kali:~/Desktop# mount attachment.img ./mnt （挂载镜像）</div><div>root@kali:~/Desktop# cd mnt</div><div>root@kali:~/Desktop/mnt# ls -a</div><div>.         cat3.jpg  cat6.jpg  catcuddle.gif     catgif.gif       catsipsip.gif  lost+found</div><div>..        cat4.jpg  cat7.jpg  catdog.gif        cat.jpg          catwindow.jpg</div><div>cat2.jpg  cat5.jpg  cat8.jpg  catfunnyface.jpg  catreindeer.jpg  catyum.gif</div></div><div>ls命令查看，只能找到一些图片，图片里也找不到进一步的线索。尝试恢复被删除的文件：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop# extundelete attachment.img --restore-all</div><div>NOTICE: Extended attributes are not restored.</div><div>Loading filesystem metadata ... 2 groups loaded.</div><div>Loading journal descriptors ... 151 descriptors loaded.</div><div>Searching for recoverable inodes in directory / ...</div><div>2 recoverable inodes found.</div><div>Looking through the directory structure for deleted files ...</div><div>1 recoverable inodes still lost.</div></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop# cd RECOVERED_FILES</div><div>root@kali:~/Desktop/RECOVERED_FILES# ls</div><div>file.17</div><div>root@kali:~/Desktop/RECOVERED_FILES# cat file.17</div><div>b0VIM 7.4�</div><div>U3210#&quot;! Utpad���f l a g { f u g l y _ c a t s _ n e e d _ l u v _ 2 }</div></div><div><br/></div><div>flag：flag{fugly_cats_need_luv_2}</div><div><br/></div><div><span style="font-weight: bold;">158 [ACTF新生赛2020]frequency</span></div><div><br/></div><div>下载得到easy.doc文件。先打开看看：</div><div><img src="BUUCTF Misc 28（157-160）_files/Image.png" type="image/png" data-filename="Image.png"/></div><div>全选-右键-字体-取消隐藏，找到隐藏文字：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>a2draGxmY290bnRpdWZwZ2hodGN3dWprY2ttb3ducGNrbXdseWd0bHBtZmtneWFhaWh1Y2RsYXRveXVjb2lnZ3JwbGt2a2Ftcmt0cXp4ZW1taXdrbGh1YWVrY2VvbHBvY2ZtdGFobWdmbWF2YWpuYmNwbWx0anRwdWZqY2FwY3RvanBqYmZmYmpid2h1YWxnZ3lqbmFtY2JmeWFjamJheGtpeGxtbXFpa3NtcHRxeW9qZXJ0Zm</div><div>……（后略）</div></div><div>然后在右键-属性-详细信息里找到另一段字符串：</div><div><img src="BUUCTF Misc 28（157-160）_files/Image [1].png" type="image/png" data-filename="Image.png"/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>0ZWZtemNxaWRvZmd0ZnFnYmFkaWNubWhvdGlvbm9iZnlubGdvenRkYXZ2aW14b2JvdGlra2Z4d2lyb3JwZmNjdXpob3BoZmRjaWVrY2p5b21lamtjZ2Zmam51bmhvcGFkdGZndG1sdA==</div></div><div>两段连起来得到base64密文，解码得到：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>kgkhlfcotntiufpghhtcwujkckmownpckmwlygtlpmfkgyaaihucdlatoyucoiggrplkvkamrktqzxemmiwklhuaekceolpocfmtahmgfmavajnbcpmltjtpufjcapctojpjbffbjbwhualggyjnamcbfyacjbaxkixlmmqiksmptqyojertfektdxdxxbtrxcangymsimhvuwktexsglrtpgaktbmfucgvnmtjufoekymtlimxdijjpxyitabpmkuccnlkpoetgcdcposkizvyxrtzxraxtnoihqcxfoaaalpajyckek……（后略）</div></div><div>基本看不出什么规律，但除了{和}各1个外，全都是小写字母，先尝试一下字频统计：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>from collections import Counter</div><div><br/></div><div>c = open('C:/Users/Administrator/Desktop/1.txt').read()</div><div>c = Counter(c)</div><div>c = c.most_common()</div><div><br/></div><div>for i in range(len(c)):</div><div>    print(c[i][0], end = '')</div></div><div>输出：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>actfplokmijnuhbygvrdxeszwq}{</div></div><div>根据flag格式把{放回去，得到flag。</div><div><br/></div><div>flag：actf{plokmijnuhbygvrdxeszwq}</div><div><br/></div><div><span style="font-weight: bold;">159 [INSHack2018]Self Congratulation</span></div><div><br/></div><div>下载得到png格式文件。</div><div><img src="BUUCTF Misc 28（157-160）_files/0mzTgcC.png" type="image/png" data-filename="0mzTgcC.png"/></div><div>首先就看见I的左上角有黑白小方块。由于尝试了其他隐写方法都没有更多线索，还是从这里入手。放大一点：</div><div><img src="BUUCTF Misc 28（157-160）_files/Image [2].png" type="image/png" data-filename="Image.png"/></div><div>总共11x6=66个小方块，以白色为0、黑色为1转码：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>00110001001</div><div>10010001100</div><div>11001101000</div><div>01101010011</div><div>01100011011</div><div>10011100000</div></div><div>尝试发现，去掉最后的两位0，剩余64位每8位1组，则开头均为0，在ASCII可打印字符范围内：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>00110001 00110010 00110011 00110100 00110101 00110110 00110111 00111000</div></div><div>二进制ASCII转码得到：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>12345678</div></div><div><br/></div><div>flag：INSA{12345678}</div><div><br/></div><div><span style="font-weight: bold;">160 key不在这里</span></div><div><br/></div><div>下载得到png格式文件。</div><div><img src="BUUCTF Misc 28（157-160）_files/1564386056.png" type="image/png" data-filename="1564386056.png"/></div><div>是个反色二维码，直接扫码得到一个网址：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>https://cn.bing.com/search?q=key%E4%B8%8D%E5%9C%A8%E8%BF%99%E9%87%8C&amp;<font style="color: rgb(255, 0, 0);">m=10210897103375566531005253102975053545155505050521025256555254995410298561015151985150375568</font>&amp;qs=n&amp;form=QBRE&amp;sp=-1&amp;sc=0-38&amp;sk=&amp;cvid=2CE15329C18147CBA4C1CA97C8E1BB8C</div></div><div>访问这个URL，是用Bing搜索“key不在这里”的结果页面。但仔细观察会发现URL中标红的m参数很可疑。如果自己尝试用Bing搜索某个关键词，URL中是不会出现m参数的。再观察一下这个参数，尝试将其分段：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>102 108 97 103 37 55 66 53 100 52 53 102 97 50 53 54 51 55 50 50 50 52 102 52 56 55 52 54 99 54 102 98 56 101 51 51 98 51 50 37 55 68</div></div><div>十进制ASCII转码得到：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>flag%7B5d45fa256372224f48746c6fb8e33b32%7D</div></div><div>再经过URL编码转码一次得到flag。</div><div><br/></div><div>flag：flag{5d45fa256372224f48746c6fb8e33b32}</div></span>
</div></body></html> 