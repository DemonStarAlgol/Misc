<html>
<head>
  <title>BUUCTF Misc 15（105-108）</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/605894 (zh-CN, DDL); Windows/6.1.1 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="1603"/>
<h1>BUUCTF Misc 15（105-108）</h1>
<h2><a href="https://DemonStarAlgol.github.io/Misc/">[无关链接]</a></h2>

<div>
<span><div><span style="font-weight: bold;">105 [WUSTCTF2020]girlfriend</span></div><div><br/></div><div>下载得到girlfriend.wav，audacity打开。</div><div><img src="BUUCTF Misc 15（105-108）_files/Image.png" type="image/png" data-filename="Image.png"/></div><div>看起来像是摩斯电码但其实不是，听一下会发现类似电话拨号音。<span style="font-size: unset; color: unset; font-family: unset;">可以用</span><a href="http://aluigi.altervista.org/mytoolz.htm#dtmf2num" style="font-size: unset; font-family: unset;">dtmf2num</a><span style="font-size: unset; color: unset; font-family: unset;">识别。</span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>E:\dtmf2num&gt;dtmf2num.exe girlfriend.wav</div><div><br/></div><div>DTMF2NUM 0.1.1</div><div>by Luigi Auriemma</div><div>e-mail: aluigi@autistici.org</div><div>web:    aluigi.org</div><div><br/></div><div>- open girlfriend.wav</div><div>  wave size      7466540</div><div>  format tag     1</div><div>  channels:      2</div><div>  samples/sec:   44100</div><div>  avg/bytes/sec: 176400</div><div>  block align:   4</div><div>  bits:          16</div><div>  samples:       3733270</div><div>  bias adjust:   215</div><div>  volume peaks:  -12024 12025</div><div>  normalize:     20742</div><div>  resampling to: 8000hz</div><div><br/></div><div>- MF numbers:    47777777</div><div><br/></div><div>- DTMF numbers:  <font color="#FF0000">999*666*88*2*777*33*6*999*4*4444*777*555*333*777*444*33*66*3*7777</font></div></div><div>得到拨号数字，明显是手机键盘密码，解码得到（其中4444可能是识别错误，应为444）：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>youaremygirlfriends</div></div><div><br/></div><div>flag：flag{youaremygirlfriends}</div><div><br/></div><div><span style="font-weight: bold;">106 [GUET-CTF2019]虚假的压缩包</span></div><div><br/></div><div>下载得到 虚假的压缩包.zip 和 真实的压缩包.zip 。虚假的压缩包是伪加密，ZipCenOp处理，解压得到Key.txt：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>数学题</div><div>n = 33</div><div>e = 3</div><div>解26</div><div><br/></div><div>-------------------------</div><div>答案是</div></div><div>RSA，解密脚本：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>import gmpy2 as gp</div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;"><br/></span></div><div>p =  gp.mpz(3)</div><div>q =  gp.mpz(11)</div><div>e =  gp.mpz(3)</div><div>c =  gp.mpz(26)</div><div>n = p*q</div><div>phi = (p-1) * (q-1)</div><div>d = gp.invert(e, phi)</div><div>m = pow(c, d, n)</div><div>print(m)</div></div><div>输出结果为5，所以密码是“答案是5”。解压 真实的压缩包.zip 得到 亦真亦假 ，这是一个文本：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>051e5651415553555d55555574558af1……</div></div><div>保存成十六进制文件：</div><div><img src="BUUCTF Misc 15（105-108）_files/Image [1].png" type="image/png" data-filename="Image.png"/></div><div>可以看到文件中有大量的字节为55。正常文件二进制一般最多的字节是00，猜测文件被异或加密过。</div><div>对每个字节异或55，会发现开头得到50 4B 03 04，确定整个文件被异或了55。写python脚本还原：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>f = open('C:/Users/Administrator/Desktop/1', 'rb').read()</div><div>out = open('C:/Users/Administrator/Desktop/out。zip', 'wb')</div><div>for i in range(len(f)):</div><div>    nb = f[i] ^ 0x55</div><div>    out.write(bytes([nb]))</div><div>out.close()</div></div><div>打开out.zip，发现了word文件夹等，实际上是个docx文件。重命名后打开，字体颜色调节为黑色，找到flag。</div><div><img src="BUUCTF Misc 15（105-108）_files/Image [2].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>flag：FLAG{_th2_7ru8_2iP_}</div><div><br/></div><div><b>107 寂静之城</b></div><div><br/></div><div>题目仅给出一个网址：<a href="https://www.douban.com/group/topic/5221588/">https://www.douban.com/group/topic/5221588/</a>。打开后是一篇豆瓣小组贴子，内容为马伯庸的《寂静之城》。</div><div>往下拉看到点赞列表里有线索（好像不能算预期线索）：</div><div><img src="BUUCTF Misc 15（105-108）_files/Image [3].png" type="image/png" data-filename="Image.png"/></div><div>往后翻找到：</div><div><img src="BUUCTF Misc 15（105-108）_files/Image [4].png" type="image/png" data-filename="Image.png"/></div><div>点进出题人的主页（还要注册豆瓣）：<a href="https://www.douban.com/people/143987042/">https://www.douban.com/people/143987042/</a>。</div><div><img src="BUUCTF Misc 15（105-108）_files/Image [5].png" type="image/png" data-filename="Image.png"/></div><div>可以得到三个线索：163邮箱、邮箱的密码是密钥和一串密文。显然需要通过社工库找到邮箱密码……</div><div>总之通过查Writeup的方式找到密码是63542021127，解码得到<a href="http://weibo.com/u/3192503722">http://weibo.com/u/3192503722</a>。</div><div>接下来的线索已经断了，原本的解法大概是从微博的相册找到提示，去查开房记录。</div><div><img src="BUUCTF Misc 15（105-108）_files/image.png" type="image/png" data-filename="image.png"/></div><div>另一张图片的评论里找到提示，flag是身份证号和密钥的组合。</div><div><img src="BUUCTF Misc 15（105-108）_files/image [1].png" type="image/png" data-filename="image.png"/></div><div>最后通过名字缩写DJ和开房时间查找到开房记录，并得到身份证号310104199208314813。</div><div><br/></div><div>flag：flag{31010419920831481363542021127}</div><div>这种已经做不了的题目下次就别放上来了啦……</div><div><br/></div><div><b>108 [GKCTF2020]code obfuscation</b></div><div><br/></div><div>下载得到flag4.png，内容是被变形和改动过的二维码。先十六进制编辑器查看，文件末尾有RAR压缩包。</div><div>将其提取，发现解压需要密码，猜测密码线索在二维码中。先手动把二维码复原：</div><div><img src="BUUCTF Misc 15（105-108）_files/20200524175040209.png" type="image/png" data-filename="20200524175040209.png"/></div><div>然后扫码得到：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>base(gkctf)</div></div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">猜测是把gkctf进行base加密后作为压缩包的密码。逐个尝试，发现base58的结果是正确密码：</span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>CfjxaPF</div></div><div>解压得到flag3.png和无后缀名文件1，其中后者实际上是文本：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>eval(function(p,a,c,k,e,d){e=function(c){return(c&lt;a?&quot;&quot;:e(parseInt(c/a)))+((c=c%a)&gt;35?String.fromCharCode(c+29):c.toString(36))};if(!''.replace(/^/,String)){while(c--)d[e(c)]=k[c]||e(c);k=[function(e){return d[e]}];e=function(){return'\\w+'};c=1;};while(c--)if(k[c])p=p.replace(new RegExp('\\b'+e(c)+'\\b','g'),k[c]);return p;}('15 n 14 a b c d e f g h i j k l m n o p q r s t u v w x y z 10 11 17=&quot;n&quot;12 15 n 14 A B C D E F G H I J K L M N O P Q R S T U V W X Y Z 10 11 17=&quot;n&quot;12 13=0 15 n 14 a b c d e f g h i j 10 11 16=&quot;n&quot;13=$((13+1))12 1g(&quot;1f=\' \';1e=\'&quot;\';16=\'#\';1j=\'(\';1i=\')\';1h=\'.\';1a=\';\';19=\'&lt;\';18=\'&gt;\';1d=\'1c\';1b=\'{\';1k=\'}\';1t=\'0\';1u=\'1\';1s=\'2\';1r=\'3\';1n=\'4\';1m=\'5\';1l=\'6\';1q=\'7\';1p=\'8\';1o=\'9\';&quot;)',62,93,'||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||do|eval|done|num|in|for|Bn|An|Ce|Cc|Cb|Cn|_|Cl|Bm|Bk|alert|By|Bt|Bs|Cp|Dg|Df|De|Dj|Di|Dh|Dd|Dc|Da|Db'.split('|'),0,{}))</div></div><div>这是一段被混淆的Javascript代码，解除混淆后可以得到一些对应关系：</div><div>$Aa-$Az对应字母a-z，$Da-$Dj对应数字0-9；</div><div>$B(k, m, n, s, t, y)分别对应空格和&quot;#(). ，$C(b, c, e, l, n, p)分别对应空字符串和&lt;&gt;_{} 。</div><div><br/></div><div>接下来看flag3.png。</div><div><img src="BUUCTF Misc 15（105-108）_files/flag3.png" type="image/png" data-filename="flag3.png"/></div><div>根据以上对应关系可以得到：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>#include &lt;stdio.h&gt;int main(){print(&quot;w3lc0me_4o_9kct5&quot;);return 0;}</div></div><div><br/></div><div>flag：flag{w3lc0me_4o_9kct5}</div></span>
</div></body></html> 