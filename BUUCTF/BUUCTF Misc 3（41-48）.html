<html>
<head>
  <title>BUUCTF Misc 3（41-48）</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/605894 (zh-CN, DDL); Windows/6.1.1 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="1784"/>
<h1>BUUCTF Misc 3（41-48）</h1>
<h2><a href="https://DemonStarAlgol.github.io/Misc/">[无关链接]</a></h2>

<div>
<span><div><span style="font-weight: bold;">41 菜刀666</span></div><div><br/></div><div>下载得到pcapng文件，wireshark打开。首先过滤http协议，逐项追踪HTTP流，在9号流发现可疑信息。</div><div><img src="BUUCTF Misc 3（41-48）_files/Image.png" type="image/png" data-filename="Image.png"/></div><div>从中可以得到以下信息：</div><div>1、通过菜刀列出了某个目录的文件列表。</div><div>从POST指令内容来看，1.php应该是上传的Webshell。其他三个文件6666.jpg、flag.txt和hello.zip可能与flag有关。</div><div>2、通过菜刀下载了某个文件。</div><div>从PK文件头和其他字符串来看，应该是个zip压缩包，其中包含flag.txt文件，且注释内容为“well,you need passwd!”，很可能是hello.zip。</div><div>提取之后发现确实如此，下一步需要找到压缩包的密码。</div><div><img src="BUUCTF Misc 3（41-48）_files/Image [1].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>考虑6666.jpg。首先在wireshark里过滤目标地址 ip.dst == 192.168.43.83，再搜索jpg十六进制文件头FF D8 FF无结果，尝试搜索字符串FFD8FF，找到884号数据包。追踪TCP流。</div><div><img src="BUUCTF Misc 3（41-48）_files/Image [2].png" type="image/png" data-filename="Image.png"/></div><div>可以发现菜刀命令中的参数z2正是jpg图片的十六进制转码。将其提取后保存为jpg文件。</div><div><img src="BUUCTF Misc 3（41-48）_files/6666.jpg" type="image/jpeg" data-filename="6666.jpg"/></div><div>得到密码是Th1s_1s_p4sswd_!!!，解压hello.zip得到flag。</div><div><br/></div><div>flag：flag{3OpWdJ-JP6FzK-koCMAK-VkfWBq-75Un2z}</div><div><br/></div><div><span style="font-weight: bold;">42 [BJDCTF 2nd]EasyBaBa</span></div><div><br/></div><div>下载得到jpg文件。十六进制编辑器打开，提取文件尾之后的zip压缩包，解压得到里面都是出题人.jpg。file命令看类型：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop# file 1.jpg</div><div>1.jpg: RIFF (little-endian) data, AVI, 720 x 480, ~30 fps, video: uncompressed, audio: uncompressed PCM (stereo, 48000 Hz)</div></div><div>重命名为avi，将其逐帧转换成图片，可以看到部分帧中带有二维码。</div><div><span style="font-weight: bold;"><img src="BUUCTF Misc 3（41-48）_files/1 129.jpg" type="image/jpeg" data-filename="1 129.jpg"/></span></div><div>其中125帧扫码得到：6167696E5F6C，转码为agin_l；</div><div>129帧扫码得到：6F76655F59，转码为ove_Y；</div><div>133帧扫码得到：424A447B696D，转码为BJD{im；</div><div>136帧扫码得到：316E677D，转码为1ng}。</div><div>拼接得到BJD{imagin_love_Y1ng}，即为flag。</div><div><br/></div><div>flag：BJD{imagin_love_Y1ng}</div><div><br/></div><div><span style="font-weight: bold;">43 被偷走的文件</span></div><div>题目：一黑客入侵了某公司盗取了重要的机密文件，还好管理员记录了文件被盗走时的流量，请分析该流量，分析出该黑客盗走了什么文件。</div><div><br/></div><div>下载得到pcapng格式文件，wireshark打开。观察协议，发现存在ftp-data协议，且55号包下载了flag.rar文件。</div><div><img src="BUUCTF Misc 3（41-48）_files/Image [3].png" type="image/png" data-filename="Image.png"/></div><div>追踪TCP流并将原始数据保存为flag.rar，打开发现存在加密，尝试4位以下数字爆破。</div><div><img src="BUUCTF Misc 3（41-48）_files/Image [4].png" type="image/png" data-filename="Image.png"/></div><div>解压得到flag。</div><div><br/></div><div>flag：flag{6fe99a5d03fb01f833ec3caa80358fa3}</div><div><br/></div><div><span style="font-weight: bold;">44 [SWPU2019]神奇的二维码</span></div><div><br/></div><div>下载得到BitcoinPay.png，扫码得到swpuctf{flag_is_not_here}，并非flag。</div><div>十六进制编辑器打开，文件尾后有RAR压缩包。<span style="font-size: unset; color: unset; font-family: unset;">用binwalk处理，得到4个RAR压缩包。逐个查看。</span></div><div><span style="font-size: unset;"><br/></span></div><div><span style="font-size: unset; color: unset; font-family: unset;">第一个压缩包解压得到encode.txt，内容为：</span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>YXNkZmdoamtsMTIzNDU2Nzg5MA==</div></div><div>base64解码得到：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>asdfghjkl1234567890</div></div><div><br/></div><div>第二个压缩包包含flag.jpg和 看看flag在不在里面^_^.rar 。后者内含加密的 flag.jpg。尝试用asdfghjkl1234567890解压，成功得到两个flag.jpg。对比一下会发现两张图片是完全一致的。</div><div><br/></div><div>第三个压缩包解压得到flag.doc，实际是文本文件，内容是长串base64密文。base64解码20次得到：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>comEON_YOuAreSOSoS0great</div></div><div><br/></div><div>第四个压缩包包含加密的good.mp3，用comEON_YOuAreSOSoS0great作为密码解压。audacity打开：</div><div><img src="BUUCTF Misc 3（41-48）_files/Image [5].png" type="image/png" data-filename="Image.png"/></div><div>很明显是摩斯电码，整理得到：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>-- --- .-. ... . .. ... ...- . .-. -.-- ...- . .-. -.-- . .- ... -.--</div></div><div>解码得到：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>MORSEISVERYVERYEASY</div></div><div>转小写后添加flag格式得到最终flag。</div><div><br/></div><div>flag：swpuctf{morseisveryveryeasy}</div><div><br/></div><div><span style="font-weight: bold;">45 穿越时空的思念</span></div><div><br/></div><div>下载得到mp3文件，audacity打开。</div><div><img src="BUUCTF Misc 3（41-48）_files/Image [6].png" type="image/png" data-filename="Image.png"/></div><div>明显有摩斯电码，记录得到：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>..-. ----- ..--- ----. -... -.. -.... ..-. ..... ..... .---- .---- ...-- ----. . . -.. . -... ---.. . ....- ..... .- .---- --... ..... -... ----- --... ---.. -....</div></div><div>转码，根据题目要求转小写：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>f029bd6f551139eedeb8e45a175b0786</div></div><div><br/></div><div>flag：flag{f029bd6f551139eedeb8e45a175b0786}</div><div><br/></div><div><span style="font-weight: bold;">46 秘密文件</span></div><div><br/></div><div>下载得到pcapng文件，wireshark打开。先看http协议，导出HTTP对象，发现没有线索。观察其他协议，注意到FTP协议。</div><div>过滤ftp协议，注意到95号数据包，显示通过FTP协议传输了一个RAR压缩包。</div><div><img src="BUUCTF Misc 3（41-48）_files/Image [7].png" type="image/png" data-filename="Image.png"/></div><div>搜索RAR格式文件头“Rar!”，定位到97号数据包，导出分组字节流。</div><div><img src="BUUCTF Misc 3（41-48）_files/Image [8].png" type="image/png" data-filename="Image.png"/></div><div>导出该压缩包，发现存在加密，尝试四位数字爆破。</div><div><img src="BUUCTF Misc 3（41-48）_files/Image [9].png" type="image/png" data-filename="Image.png"/></div><div>解压得到flag。</div><div><br/></div><div>flag：flag{d72e5a671aa50fa5f400e5d10eedeaa5}</div><div><br/></div><div><span style="font-weight: bold;">47 [BJDCTF2020]认真你就输了</span></div><div><br/></div><div>下载得到10.xls。16进制编辑器查看发现实际为zip格式，因此将后缀名改为xlsx再次打开。提示需要修复，修复完得到表格：</div><div><img src="BUUCTF Misc 3（41-48）_files/Image [10].png" type="image/png" data-filename="Image.png"/></div><div>某两张工作表中均有提示：flag在chart下。以压缩包形式打开原文件，进入\xl\charts目录，发现flag.txt。</div><div><img src="BUUCTF Misc 3（41-48）_files/Image [11].png" type="image/png" data-filename="Image.png"/></div><div>打开得到flag。</div><div><br/></div><div>flag：flag{M9eVfi2Pcs#}</div><div><br/></div><div><span style="font-weight: bold;">48 [GXYCTF2019]佛系青年</span></div><div><br/></div><div>下载得到zip压缩包，内含1.png和加密的fo.txt。分析图片没有线索，尝试爆破密码时，Ziperello提示加密文件数为0。这是因为fo.txt实际上是伪加密。ZipCenOp处理后解压得到fo.txt，打开后最后一行为：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>佛曰：遮等諳勝能礙皤藐哆娑梵迦侄羅哆迦梵者梵楞蘇涅侄室實真缽朋能。奢怛俱道怯都諳怖梵尼怯一罰心缽謹缽薩苦奢夢怯帝梵遠朋陀諳陀穆諳所呐知涅侄以薩怯想夷奢醯數羅怯諸</div></div><div><a href="http://www.keyfc.net/bbs/tools/tudoucode.aspx">与佛论禅</a>解密，得到flag。</div><div><br/></div><div>flag：flag{w0_fo_ci_Be1}</div></span>
</div></body></html> 