<html>
<head>
  <title>BUUCTF Misc 34（181-184）</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/605894 (zh-CN, DDL); Windows/6.1.1 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="1366"/>
<h1>BUUCTF Misc 34（181-184）</h1>
<h2><a href="https://DemonStarAlgol.github.io/Misc/">[无关链接]</a></h2>

<div>
<span><div><span style="font-weight: bold;">181 [SUCTF2019]protocol</span></div><div><br/></div><div>下载得到usbtraffic.pcapng文件，wireshark打开，发现大量USB协议数据包。查看数据包大小，发现有一些大小为7845的数据包，且其分组字节流很明显包含PNG文件头。</div><div><img src="BUUCTF Misc 34（181-184）_files/Image.png" type="image/png" data-filename="Image.png"/></div><div>用foremost分离，得到115张png格式图片。</div><div><img src="BUUCTF Misc 34（181-184）_files/Image [1].png" type="image/png" data-filename="Image.png"/></div><div>每15个左右翻转的字符后跟着10张纯黑色图片，总共重复了6次。</div><div>回到wireshark中，仍然按大小排列数据包，从第1个7845大小的1441号包开始看。往下到1493号包为止的15个数据包，对应最开始的15张有字符png图片。</div><div><img src="BUUCTF Misc 34（181-184）_files/Image [2].png" type="image/png" data-filename="Image.png"/></div><div>接下来1989-5135共10个数据包，其分组字节流中png图片的字节是完全一致的，对应接下来10张纯黑png图片。</div><div><img src="BUUCTF Misc 34（181-184）_files/Image [3].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>观察这10个包的数据流，发现虽然图片内容都保持一致，但分组字节流的第二位（如图中的0b）一直在变化。</div><div><img src="BUUCTF Misc 34（181-184）_files/Image [4].png" type="image/png" data-filename="Image.png"/></div><div>记录1989-5135这10个包的分组字节流第2位，依次得到：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>06 07 0e 04 01 0d 00 02 0b 09</div></div><div>另一方面，记录1441-1493这15个包的分组字节流第2位，依次得到：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>04 03 02 01 00 09 08 07 06 05 0e 0d 0c 0b 0a</div></div><div>如果把两者一一对应起来，会发现10张纯黑图片对应了这10张字符图片：</div><div><span style="font-weight: bold;"><img src="BUUCTF Misc 34（181-184）_files/Image [5].png" type="image/png" data-filename="Image.png"/></span></div><div>即suctf{My_u，显然，这就是flag的前10位字符。</div><div><br/></div><div>重复以上步骤，从前三组15字符+10纯黑依次得到：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>suctf{My_u</div><div>sb_pr0toco</div><div>1_s0_w3ak}</div></div><div>flag到此为止，从第四组开始是乱码。</div><div><br/></div><div>flag：suctf{My_u<span style="font-size: unset; color: unset; font-family: unset;">sb_pr0toco</span><span style="font-size: unset; color: unset; font-family: unset;">1_s0_w3ak}</span></div><div><span style="font-size: unset;"><br/></span></div><div><span style="font-size: unset; font-weight: bold; color: unset; font-family: unset;">182 </span><span style="font-weight: bold;">[INSHack2017]10-cl0v3rf13ld-lane-signal</span></div><div><br/></div><div>下载得到md格式文件和find_me.unk，前者是题目说明：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>Caasi Vomisa built a bunker years ago because he already knew mankind was too dumb not to use nuclear warheads.</div><div>Today he is testing it again because he fears Pmurt or Nitup could push the wrong button on their coffee machines.</div><div><br/></div><div>He was testing the bunker radio receiver when he received a strange transmission...</div><div>Can you help him find out what the transmission is about ?</div></div><div><br/></div><div>再看find_me.unk。十六进制编辑器或Linux下file命令判断它是jpg格式图片，但文件尾后还有数据。利用010Editor的模板功能判断文件尾位置，依次提取出一个png格式图片和一个ogg格式音频。</div><div><img src="BUUCTF Misc 34（181-184）_files/Image [6].png" type="image/png" data-filename="Image.png"/></div><div><img src="BUUCTF Misc 34（181-184）_files/Image [7].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>png图像是一份摩斯电码表：</div><div><img src="BUUCTF Misc 34（181-184）_files/1.png" type="image/png" data-filename="1.png"/></div><div>ogg音频用audacity打开，看到了很明显的摩斯电码：</div><div><img src="BUUCTF Misc 34（181-184）_files/Image [8].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>记录摩斯电码：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>.. -. ... .- -.--. -- ----- .-. ..... ...-- ..--.- .-- .---- .-.. .-.. ..--.- -. ...-- ...- ...-- .-. ..--.- ....- --. ...-- -.-.-- -.--.-</div></div><div>转码：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>INSA(M0R53_W1LL_N3V3R_4G3!)</div></div><div><br/></div><div>flag：INSA(M0R53_W1LL_N3V3R_4G3!)</div><div><span style="font-weight: bold; color: rgb(255, 0, 0);">（所以为啥是括号……）</span></div><div><br/></div><div><span style="font-weight: bold;">183 [RCTF2019]printer</span></div><div><br/></div><div>下载得到Printer.pcapng文件，wireshark打开，发现全部为USB协议流量包。根据题目名称猜测可能是USB接口打印机的数据，按大小排列，找到675号数据包比较可疑。显示分组字节流，发现了BITMAP、BAR、PRINT等命令。</div><div><img src="BUUCTF Misc 34（181-184）_files/Image [9].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>搜索相关命令，找到<a href="https://postorg.com.ua/published/file/TSC/TSPL_TSPL2_Programming.pdf">TSPL/TSPL2 Programming Language</a>的手册，需要根据手册自己复现这段打印命令，得到所打印的内容。这里记录一下Python脚本：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>from PIL import Image</div><div>from pwn import *</div><div><br/></div><div>img = Image.new( '1', (1000,1000),color=1)</div><div>pixels = img.load()</div><div><br/></div><div>data1 = 'FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF 00FFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFC3FF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF E7FFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFE7FF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF E7FFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFE7FF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF E7FFE3FF FE1FFFFF FFFFF807 C03C603F C07C07E0 007F7FF0 1F8067FF 007FF803 FC07C03F FF1FF1F0 4F8FF1FF 1FFF1FFF 3FFCFF1F 27FC7F1F F3E1FF1F F9FFFF1F F1FC1FCF F8FF1FFF 1FFF3FFE FE3F87F8 FF9FEFF8 FF1FF9FF FF8FF1FC 3FC7FCFF 1FFF1FFF 1FFEFC7F C7F9FF8F DFFC7F1F F9FFFF8F F1FC7FE3 FC7F1FFF 1FFF1FFE FCFFE7F1 FF8F9FFC 3F1FF9FF FFC7F1FC 7FE3FE3F 1FFF1FFF 0FFEF8FF E7F1FF0F BFFE3F1F F9FFFFC7 F1FC7FE3 FE3F1FFF 1FFF0FFE F8FFE7E1 FF8F3FFE 3F1FF9FF FFE3F1FC 7FE3FF1F 1FFF1FFF 47FEF8FF E7E3FF9F 7FFE1F1F F9FFFFE3 F1FC7FF3 FF8E1FFF 1FFF47FE F9FFE7E3 FFFFFFFF 1F1FF9FF FFF1F1FC 7FF3FF8C 1FFF1FFF 63FEF9FF E7F1FFFF FFFF1F1F F9FFFFF1 F1FC7FF3 FFC11FFF 1FFF63FE F9FFE7F1 FFFFFFFF 1F1FF9FF FFF1F1FC 7FE3FFE3 1FFF1FFF 71FEF9FF E7F1FFFF FFFF1F1F F9FFFFF8 F1FC7FE3 FFE71FFF 1FFF71FE F8FFE7F8 FFFFFFFF 0F1FF9FF FFF8F1FC 7FE3FFCF 1FFF1FFF 78FEF8FF E7FCFFFF FFFF0F1F F9FFFFFC 61FC7FE7 FF9F1FFF 1FFF78FE F8FFC7FE 3FFFFFFF 0F1FF9FF FFFC41FC 7FC7FF3F 1FFF1FFF 7C7EFCFF C7FF83FF FFFF0F9F F1FFFFFE 11FC3F8F FF7F1FFF 1FFF7C7E FC7FA7FF 87FFFFFF 0F9FE9FF FFFE31FC 1F1FFE7F 1FFF1FFF 7E3EFE3E 67FE3FFF FFFF1F8F 99FFFFFF 31FC403F E01F1FFF 1FFF7E3E FF80E0FC 7FFFFFFF 1FC039FF FFFE71FC 79FFFFFF 1FFF1FFF 7F1EFFF3 EFF8FFFF FFFF1FF0 F9FFFFFE F1FC7FFF FFFF1FFF 1FFF7F0E FFFFFFF8 FFFFFFFF 1FFFF9FF FFFCF1FC 7FFFFFFF 1FFF1FFF 7F8EFFFF FFF8FFFF FFFE1FFF F9FFFFF9 F1FC7FFF FFFF1FFF 1FFF7F86 FFFFFFF8 FF9F7FFE 3FFFF9FF FFFBF1FC 7FFFFFFF 1FFF1FFF 7FC6FFFF FFF8FF0F 3FFE3FFF F9FFFFF7 F1FC7FFF FFFF1FFF 1FFF7FC2 FFFFFFF8 FF8FBFFC 7FFFF9FF FFE7F1FC 7FFFFFFF 1FFF1FFF 7FE2FFFF FFF8FF8F 9FFC7FFF F9FFFFCF F1FC7FFF FFFF1FFF 1FFF7FF0 FFFFFFFC FF9F9FF8 FFFFF9FF FF8FF1FC 7FFFFFFF 1FFF1FFF 7FF0FFFF FFFC7F9F 8FF1FFFF F9FFFF0F F0FC3FFF FFFF1FFF 0FFE7FF8 FFFFFFFE 1E7F83E3 FFFFF8FF FC03C03C 0FFFFFFF 03E00078 0FF83FFF FFFF80FF F80FFFFF F83FFFFF FFFDFFFF FFFF3FFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFBFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF'</div><div>data1 = bits(int(data1.replace(' ', '').strip(), 16))</div><div><br/></div><div>data2 = 'FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF C7FFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FE38FFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFDFF7F FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFF9FF 3FFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFF9 FF3FFFFF FFFFFFFF 9FFEFBFF C7FFFFFF E1FFF8FF FFFFFC3F FFFFFFFF F9FF3FF8 FFFFFFFF FF0FFEFB FF39FF00 7F9C7FE7 2FFFFFF3 C3FC07FF FFF87E78 463F803F F01F0FFE 7BFEFEFF F7FF3F3F 9F8FFFFF EFF3FFBF FFFFFC01 FA3F9FFB FFFE7F9F FE71FCFE 7FF7FF7F 9F9FCFFF FFEFFBFF BFFFFFFF C07E7F9F FBFFFE7F FFFC71F9 FF3FF7FE FF9F3FCF FFFFEFFB FFBFFFFF FFFE7E7F 8FFBFFFE 7FFFFD75 F9FF3FF7 FFFFCF3F CFFFFFE7 FFFFBFFF FFFFFE7E 7F9FFBFF FE7FFFFD 35F9FF3F F7FFFFCF 3FCFFFFF E3FFFFBF FFFFFF80 FE7F9FFB FFFE7FFF FD2CF9FF 3FF7FFFF CF3FCFFF FFF07FFF BFFFFFFF 7CFE7F3F FBFFFE7F FFFB2CF9 FF3FF7FE 000F3FCF FFFFFC1F FFBFFFFF FE7E7E7C 7FFBFFFE 7FFFFBAC F9FF3FF7 FE7FCF3F CFFFFFFF 87FFBFFF FFFE7E7E 03FFFBFF FE7FFFFB 9EF9FF3F F7FE7FCF 3FCFFFFF FFE7FFBF FFFFFEFE 7E7FFFFB FFFE7FFF FB9E79FF 3FF7FE7F 9F3FCFFF FFEFF3FF BFFFFFFE FE7E7F9F FBFFFE7F FFF79E7C FE7FF7FF 3F9F9F8F FFFFEFF3 FFBFFFFF FE7E7F7F 1FFBFFFE 7F1FF79E 7EFCFFF7 FF3F3F9F 0FFFFFE7 F7FFBFFF FFF27EFF 3F3FFBFF FE7F0FE3 8E3F39FF F7FFCE7F C04FFFFF E1CFFF9F FFFFF019 FF9E7FFB FFFE7F1F FFFFFFC7 FFF7FFF1 FFFBCFFF FFEE3FFF 87FFFFFB E7FFE1FF FBFFE00F FFFFFFFF FFFFF7FF FFFFFFCF FFFFFFFF FFFFFFFF FFFFFFFF FFFBFFFE 7FFFFFFF FFFFFFF7 FFFFFFFF CFFFFFFF FFFFFFFF FFFFFFFF FFFFFBFF FE7FFFFF FFFFFFFF F7FFFFFF FFCFFFFF FFFFFFFF FFFFFFFF FFFFFFFB FFFE7FFF FFFFFFFF FFF7FFFF FFFFCFFF FFFFFFFF FFFFFFFF FFFFFFFF FBFE7E7F FFFFFFFF FFFFF7FF FFFFFFCF FFFFFFFF FF3FFFFF FFFFFFFF FFFBFE7E FFFFFFFF FFFFFFF7 FFFFFFFF CFFFFFFF FFFF1FFF FFFFFFFF FFFFFBFE 7CFFFFFF FFFFFFFF F03FFFFF FFC3FFFF FFFFFF1F FFFFFFFF FFFFFFF8 1F03FFFF FFFFFFFF FFF3FFFF FFFFCFFF FFFFFFFF BFFFFFFF FFFFFFFF F9FFFFFF'</div><div>data2 = bits(int(data2.replace(' ', '').strip(), 16))</div><div><br/></div><div>cmds = '''</div><div>BAR 348, 439, 2, 96</div><div>BAR 292, 535, 56, 2</div><div>BAR 300, 495, 48, 2</div><div>BAR 260, 447, 2, 88</div><div>BAR 204, 447, 56, 2</div><div>BAR 176, 447, 2, 96</div><div>BAR 116, 455, 2, 82</div><div>BAR 120, 479, 56, 2</div><div>BAR 44, 535, 48, 2</div><div>BAR 92, 455, 2, 80</div><div>BAR 20, 455, 72, 2</div><div>BAR 21, 455, 2, 40</div><div>BAR 21, 495, 24, 2</div><div>BAR 45, 479, 2, 16</div><div>BAR 36, 479, 16, 2</div><div>BAR 284, 391, 40, 2</div><div>BAR 324, 343, 2, 48</div><div>BAR 324, 287, 2, 32</div><div>BAR 276, 287, 48, 2</div><div>BAR 52, 311, 48, 2</div><div>BAR 284, 239, 48, 2</div><div>BAR 308, 183, 2, 56</div><div>BAR 148, 239, 48, 2</div><div>BAR 196, 191, 2, 48</div><div>BAR 148, 191, 48, 2</div><div>BAR 68, 191, 48, 2</div><div>BAR 76, 151, 40, 2</div><div>BAR 76, 119, 2, 32</div><div>BAR 76, 55, 2, 32</div><div>BAR 76, 55, 48, 2</div><div>BAR 112, 535, 64, 2</div><div>BAR 320, 343, 16, 2</div><div>BAR 320, 319, 16, 2</div><div>BAR 336, 319, 2, 24</div><div>BAR 56, 120, 24, 2</div><div>BAR 56, 87, 24, 2</div><div>BAR 56, 88, 2, 32</div><div>BAR 224, 247, 32, 2</div><div>BAR 256, 215, 2, 32</div><div>BAR 224, 215, 32, 2</div><div>BAR 224, 184, 2, 32</div><div>BAR 224, 191, 32, 2</div><div>BAR 272, 311, 2, 56</div><div>BAR 216, 367, 56, 2</div><div>BAR 216, 319, 2, 48</div><div>BAR 240, 318, 2, 49</div><div>BAR 184, 351, 2, 16</div><div>BAR 168, 351, 16, 2</div><div>BAR 168, 311, 2, 40</div><div>BAR 152, 351, 16, 2</div><div>BAR 152, 351, 2, 16</div><div>'''</div><div>cmds = cmds.strip().split('\n')</div><div><br/></div><div>def draw_bitmap(pixels, x, y, width, height, data):</div><div>  # len(data1) = 9984 = height*width*8 = 1248 * 8</div><div>  width *= 8</div><div>  for w in range(width):</div><div>    for h in range(height):</div><div>      rw = w + x</div><div>      rh = h + y</div><div>      pixels[rw, rh] = data1[w+h*width]</div><div><br/></div><div>def draw_bar(pixels, x, y, width, height):</div><div>  for w in range(width):</div><div>    for h in range(height):</div><div>      rw = w + x</div><div>      rh = h + y</div><div>      # 0表示黑</div><div>      pixels[rw, rh] = 0</div><div><br/></div><div>draw_bitmap(pixels, 138, 75, 26, 48, data1)</div><div>draw_bitmap(pixels, 130,579,29,32, data2)</div><div><br/></div><div>for each in cmds:</div><div>  params = each.replace('BAR ','').split(', ')</div><div>  params = map(int, params)</div><div>  x, y, width, height = params</div><div>  draw_bar(pixels, x, y, width, height)</div><div><br/></div><div>img.save('C:/Users/Administrator/Desktop/test.png')</div></div><div>输出图像如下：</div><div><img src="BUUCTF Misc 34（181-184）_files/test.png" type="image/png" data-filename="test.png"/></div><div>翻转180度即得到可读取的flag。</div><div><br/></div><div>flag：flag{my_tsc_hc3pnikdk}</div><div><span style="font-weight: bold; color: rgb(255, 0, 0);">（所以为啥要小写……）</span></div><div><br/></div><div><span style="font-weight: bold;">184 [V&amp;N2020 公开赛]ML 第一步</span></div><div><br/></div><div>太过分了，对菜鸟太不友好了，Misc题目还给靶机的……总之得到靶机地址和端口，nc连接。</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop# nc node3.buuoj.cn 29724</div><div>hello,whats your name?</div><div>cheyenne</div><div>hi,cheyenne</div><div>There is a func and some data to train,please guess my func and answer my question:</div><div>When you need help,please take this num to ask for help:-5</div><div>Now I will give you 70 data:[ENTER]</div><div><br/></div><div>x=0.3642020225452377,y=-0.9819285667024051;</div><div>x=0.5501729548296749,y=-1.3519458187250553;</div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">（总共70组数据）</span></div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;"><br/></span></div><div>okay,do you guess my func?I will ask you 10 questions.If your loss less than 0.06,i will give you the FLAG[ENTER]</div><div><br/></div><div>When x=0.04110140907423632,y=?</div><div>（接下来是10个给出x，求y的问题）</div></div><div>猜测10个问题回答正确后可以得到flag，因为不会pwn，尝试用脚本拟合函数曲线然后手动跟靶机互动。</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>import numpy as np</div><div>f = open('C:/Users/Administrator/Desktop/1.txt', 'r').readlines() # 1.txt里是给出的70组数据</div><div>s = []</div><div>for i in f:</div><div>    s.append(i)</div><div><br/></div><div>def process(s):</div><div>    xa = []</div><div>    ya = []</div><div>    for i in s:</div><div>        v = i.split(',')</div><div>        x = float(v[0][2:])</div><div>        y = float(v[1][2:-2])</div><div>        xa.append(x)</div><div>        ya.append(y)</div><div>    return (np.array(xa), np.array(ya))</div><div><br/></div><div>(x, y) = process(s)</div><div>z1 = np.polyfit(x, y, 10)</div><div>p1 = np.poly1d(z1)</div><div>print(p1)</div></div><div>输出拟合函数：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>       10             9             8             7             6</div><div>-3508 x  + 1.844e+04 x - 4.124e+04 x + 5.119e+04 x - 3.857e+04 x</div><div>             5        4         3         2</div><div>+ 1.81e+04 x - 5211 x + 870.1 x - 73.54 x - 0.5878 x - 0.001924</div></div><div>接下来对于靶机给出的x，运行：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>print(p1(0.04110140907423632))</div></div><div>就能得到拟合的y：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>-0.10283508222809148</div></div><div>手动在nc会话中输入，然后继续下一个问题，回答正确10个后得到flag。</div><div><br/></div><div>当然本题还有非预期解法，对于每个给出的x，肉眼在70组数据中寻找最接近的一个x，然后回答同组对应的y。</div><div><img src="BUUCTF Misc 34（181-184）_files/Image [10].png" type="image/png" data-filename="Image.png"/></div><div>因为题目给出的允许误差比较大，所以大部分情况下这种解法都能用……</div><div><br/></div><div>flag：flag{76bdba1d-3f1f-423c-bed7-2ecb4e93b949}</div></span>
</div></body></html> 