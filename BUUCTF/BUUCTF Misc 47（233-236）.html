<html>
<head>
  <title>BUUCTF Misc 47（233-236）</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/605894 (zh-CN, DDL); Windows/6.1.1 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="827"/>
<h1>BUUCTF Misc 47（233-236）</h1>
<h2><a href="https://DemonStarAlgol.github.io/Misc/">[无关链接]</a></h2>

<div>
<span><div><span style="color: rgb(255, 0, 0); font-weight: bold;">233 [CFI-CTF 2018]UnixDrive</span></div><div><br/></div><div><span style="color: rgb(255, 0, 0);">和213、221题同样情况，因为比赛官方在将赛题上传github时使用了Git LFS大文件扩展，所以github上的文件只有指针，实际的文件并没有被上传，使用git lfs clone时会提示服务器上找不到文件，导致下载不到真实的题目。BUUCTF上的附件下载下来也只有Git LFS指针，暂时找不到有效文件可以下载。</span></div><div><br/></div><div><span style="color: rgb(255, 0, 0);">根据</span><a href="https://github.com/CFI-UL/2018-CFI-CTF/tree/master/unix_drive" style="color: rgb(255, 0, 0);">官方Writeup</a><span style="color: rgb(255, 0, 0);">，本</span><span style="color: rgb(255, 0, 0);">题给出的是包含隐藏文件的ext2磁盘镜像，需要在Linux下安装</span><span style="color: rgb(255, 0, 0);">libewf后用</span><span style="color: rgb(255, 0, 0);">ewfmount命令</span><span style="color: rgb(255, 0, 0);">将其挂载，得到</span><span style="color: rgb(255, 0, 0);">ewf1文件后再次挂载，在隐藏文件夹</span><span style="color: rgb(255, 0, 0);">.private中找到隐藏文件</span><span style="color: rgb(255, 0, 0);">.flag.txt。</span><span style="color: rgb(255, 0, 0);">等找到题目文件下载后再来做。</span></div><div><br/></div><div><span style="color: rgb(255, 0, 0);">flag：</span><span style="color: rgb(255, 0, 0);">CFI{Hidden_F1l3s_F0ld3rs_D3c3pt1on}</span></div><div><br/></div><div><span style="font-weight: bold;">234 [网鼎杯 2020 青龙组]Teslaaaaa</span></div><div><br/></div><div>下载得到Teslaaaaa.png和ecu_can_log.asc。前者：</div><div><img src="BUUCTF Misc 47（233-236）_files/Teslaaaaa.png" type="image/png" data-filename="Teslaaaaa.png"/></div><div>后者实际上是个文本：</div><div><img src="BUUCTF Misc 47（233-236）_files/Image.png" type="image/png" data-filename="Image.png"/></div><div>是智能汽车CAN bus通讯协议的传输日志，后续还涉及ARM逆向，做不来，告辞！</div><div><br/></div><div>记录一下Writeup：</div><div><a href="https://bbs.pediy.com/thread-259472.htm">https://bbs.pediy.com/thread-259472.htm</a></div><div><a href="https://blog.csdn.net/Breeze_CAT/article/details/106156567">https://blog.csdn.net/Breeze_CAT/article/details/106156567</a></div><div><br/></div><div>flag：flag{3dad13db-cb48-495d-b023-3231d80f1713}</div><div><br/></div><div><span style="font-weight: bold;">235 [NPUCTF2020]OI的梦</span></div><div><br/></div><div>下载得到OI の梦.pdf 和 yyh.in，前者是题目：</div><div><img src="BUUCTF Misc 47（233-236）_files/Image [1].png" type="image/png" data-filename="Image.png"/></div><div>后者就是输入数据，n、m和k分别为100、8260、9232645。</div><div>简而言之，存在一个顶点数为100的无向图，共有8260条边（实际上必然有部分是重复的），求从S点到T点共经过k条边的路径数量。</div><div><br/></div><div>考虑将该无向图用100x100矩阵D表示，若i点和j点间存在边，D[i, j]=1，否则D[i, j]=0。显然，若i=j，D[i, j]=0。同时，在k=1时，D[S, T]就是从S点到T点经过1条边的方法数。将D记为D(1)。</div><div>再考虑矩阵D(k)，其中D(k)[i, j]是从i点到j点经过k条边的方案数。接下来计算从i点到j点经过k+1条边的方案数，显然可以分为两步进行，首先从i点到任意m点经过k条边有D(k)[i, m]种方案，然后从m点到j点经过1条边有D(1)[m, j]种方案。即：</div><div><img src="BUUCTF Misc 47（233-236）_files/Image [2].png" type="image/png" data-filename="Image.png"/></div><div>换言之，我们有：</div><div><img src="BUUCTF Misc 47（233-236）_files/Image [3].png" type="image/png" data-filename="Image.png"/></div><div>根据该递推关系可以得到：</div><div><img src="BUUCTF Misc 47（233-236）_files/Image [4].png" type="image/png" data-filename="Image.png"/></div><div>从而可以用矩阵快速幂的算法得到D(k)。</div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div># 带模运算的100阶矩阵乘法</div><div>def matrix_mul(A, B, n):</div><div>    C = [[0] * 100 for i in range(100)]</div><div>    for i in range(100):</div><div>        for j in range(100):</div><div>            for k in range(100):</div><div>                C[i][j] = (C[i][j] + A[i][k] * B[k][j]) % n</div><div>    return C</div><div><br/></div><div>mod = 10003</div><div># 矩阵快速幂运算</div><div>def matrix_pow(A, x):</div><div>    C = [[0] * 100 for i in range(100)]</div><div>    for i in range(100):</div><div>        C[i][i] = 1</div><div>    while x &gt; 0:</div><div>        if x &amp; 1:</div><div>            C = matrix_mul(C, A, mod)</div><div>        A = matrix_mul(A, A, mod)</div><div>        x //= 2</div><div>    return C</div><div><br/></div><div># 获取初始矩阵</div><div>D = [[0] * 100 for i in range(100)]</div><div>data = open('C:/Users/Administrator/Desktop/yyh.in', 'r').readlines()[1:]</div><div>for line in data:</div><div>    x = int(line.split(' ')[0]) - 1</div><div>    y = int(line.split(' ')[1][:-1]) - 1</div><div>    D[x][y] = 1</div><div>    D[y][x] = 1</div><div><br/></div><div># 开始幂</div><div>k = 9232645</div><div>Dk = matrix_pow(D, k)</div><div>print(Dk[0][99]) # 虽然题目没说明白，但最后发现要求的就是从第1点到最后1点之间走k步的方案数</div></div><div>输出结果为5174。</div><div><br/></div><div>flag：flag{5174}</div><div><br/></div><div><span style="font-weight: bold;">236 [CFI-CTF 2018]CFI-in-Kotlin</span></div><div><span style="color: rgb(255, 0, 0);">原题：Q-Q-Q-Q-uack? CFI has is first mobile Apppp! Try to get his se-se-se-cret Try to be M-M-Me To wi-n-n-n... Experieeence? QUACKKKK!</span></div><div><br/></div><div>下载得到apk格式文件……为什么要把安卓逆向题放在Misc里啦x4。总而言之先在模拟器里安装了一下：</div><div><img src="BUUCTF Misc 47（233-236）_files/Image [5].png" type="image/png" data-filename="Image.png"/></div><div>只有登陆界面，如果选择游客身份连接只能看到一个LOGO。结合题目里Try to be Me To win的提示，猜测可能要正常登陆后才能得到flag。jadx打开apk文件，在com.sagold.cfievent.LoginActivity找到邮件地址和密码：</div><div><img src="BUUCTF Misc 47（233-236）_files/Image [6].png" type="image/png" data-filename="Image.png"/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>alerionMascot@CFIUL.com:HappyFirstYear</div></div><div>但登陆之后仍然没有进一步的线索。查了一下<a href="https://github.com/CFI-UL/2018-CFI-CTF/tree/master/CFI-in-Kotlin">官方Writeup</a>，登陆后必须要联网才能显示flag。<span style="color: rgb(255, 0, 0);">所以是不是网络连接或者服务器出现了问题。</span></div><div><br/></div><div>flag：CFI{DOUMMY_creeeeeddddd_issSoFriENDlieee_QUACKKKK}</div></span>
</div></body></html> 