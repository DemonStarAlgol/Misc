<html>
<head>
  <title>BUUCTF Misc 16（109-112）</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/605894 (zh-CN, DDL); Windows/6.1.1 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="1591"/>
<h1>BUUCTF Misc 16（109-112）</h1>
<h2><a href="https://DemonStarAlgol.github.io/Misc/">[无关链接]</a></h2>

<div>
<span><div><span style="font-weight: bold;">109 [RCTF2019]draw</span></div><div><br/></div><div>下载得到txt格式文件，内容：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>cs pu lt 90 fd 500 rt 90 pd fd 100 rt 90 repeat 18[fd 5 rt 10] lt 135 fd 50 lt 135 pu bk 100 pd setcolor pick [ red orange yellow green blue violet ] repeat 18[fd 5 rt 10] rt 90 fd 60 rt 90 bk 30 rt 90 fd 60 pu lt 90 fd 100 pd rt 90 fd 50 bk 50 setcolor pick [ red orange yellow green blue violet ] lt 90 fd 50 rt 90 fd 50 pu fd 50 pd fd 25 bk 50 fd 25 rt 90 fd 50 pu setcolor pick [ red orange yellow green blue violet ] fd 100 rt 90 fd 30 rt 45 pd fd 50 bk 50 rt 90 fd 50 bk 100 fd 50 rt 45 pu fd 50 lt 90 pd fd 50 bk 50 rt 90 setcolor pick [ red orange yellow green blue violet ] fd 50 pu lt 90 fd 100 pd fd 50 rt 90 fd 25 bk 25 lt 90 bk 25 rt 90 fd 25 setcolor pick [ red orange yellow green blue violet ] pu fd 25 lt 90 bk 30 pd rt 90 fd 25 pu fd 25 lt 90 pd fd 50 bk 25 rt 90 fd 25 lt 90 fd 25 bk 50 pu bk 100 lt 90 setcolor pick [ red orange yellow green blue violet ] fd 100 pd rt 90 arc 360 20 pu rt 90 fd 50 pd arc 360 15 pu fd 15 setcolor pick [ red orange yellow green blue violet ] lt 90 pd bk 50 lt 90 fd 25 pu home bk 100 lt 90 fd 100 pd arc 360 20 pu home</div></div><div>可以看出这是<a href="https://personal.utdallas.edu/~veerasam/logo/">LOGO语言</a>的一系列命令，尝试使用<a href="https://www.calormen.com/jslogo/">在线解释器</a>来运行。</div><div><img src="BUUCTF Misc 16（109-112）_files/Image.png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>flag：flag{RCTF_HeyLogo}</div><div><br/></div><div><span style="font-weight: bold;">110 [SUCTF2018]followme</span></div><div><br/></div><div>下载得到pcapng格式文件，wireshark打开，先导出HTTP对象。</div><div><img src="BUUCTF Misc 16（109-112）_files/Image [1].png" type="image/png" data-filename="Image.png"/></div><div>注意到从95336号包开始一直在尝试访问同一个login页面，重复了很多次。选几个此类包追踪HTTP流：</div><div><img src="BUUCTF Misc 16（109-112）_files/Image [2].png" type="image/png" data-filename="Image.png"/></div><div><img src="BUUCTF Misc 16（109-112）_files/Image [3].png" type="image/png" data-filename="Image.png"/></div><div>可以看出，是在不断暴力尝试admin账户的密码。继续查看，找到97385号包：</div><div><img src="BUUCTF Misc 16（109-112）_files/Image [4].png" type="image/png" data-filename="Image.png"/></div><div>这段密码就是flag。</div><div><br/></div><div>flag：<span style="font-size: unset; color: unset; font-family: unset;">SUCTF{password_is_not_weak}</span></div><div><br/></div><div><span style="font-weight: bold;">111 [MRCTF2020]不眠之夜</span></div><div><br/></div><div>下载得到 不眠夜之WA 文件夹，内含121张jpg图片（有一张格式损坏无法打开）：</div><div><img src="BUUCTF Misc 16（109-112）_files/Image [5].png" type="image/png" data-filename="Image.png"/></div><div>看起来感觉应该是要拼图，手动拼也可以，这里尝试一下github上的自动拼图工具<a href="https://github.com/nemanja-m/gaps">gaps</a>。</div><div><br/></div><div>首先用ImageMagick的montage命令把120张图片（删掉格式损坏的非jpg图片）拼成10x12的一整张：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>C:\Users\Administrator\Desktop\不眠夜之WA&gt;magick montage *jpg -tile 10x12 -geometry 200x100+0+0 out.jpg</div><div>*jpg：                   本目录下的jpg图片</div><div>-tile 10x12：            按纵向10块、横向12块拼成大图</div><div>-geometry 200x100+0+0：  单张图片大小是200x100</div><div>out.jpg：                输出文件名</div></div><div><span style="font-weight: bold;"><img src="BUUCTF Misc 16（109-112）_files/out.jpg" type="image/jpeg" data-filename="out.jpg"/></span></div><div>然后转到Linux下，用gaps来拼图：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop/gaps/bin# python gaps --image=out.jpg --generations=50 --population=120 --size=100</div><div>--image           需要拼图的原图</div><div>--size            拼图块的像素尺寸</div><div>--generations     遗传算法的代的数量</div><div>--population      个体数量</div><div>--verbose         每一代训练结束后展示最佳结果</div><div>--save            将拼图还原为图像</div><div><br/></div><div>=== Population:  120</div><div>=== Generations: 50</div><div>=== Piece size:  100 px</div><div>=== Pieces:      240</div><div><br/></div><div>=== Analyzing image: ██████████████████████████████████████████████████ 100.0%</div><div>=== Solving puzzle:  █████████████------------------------------------- 26.5%</div><div><br/></div><div>=== GA terminated</div><div>=== There was no improvement for 10 generations</div><div><br/></div><div>=== Done in 11.010 s</div><div>=== Close figure to exit</div></div><div><img src="BUUCTF Misc 16（109-112）_files/Image [6].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>flag：MRCTF{Why_4re_U_5o_ShuL1an??}</div><div><br/></div><div><span style="font-weight: bold;">112 [安洵杯 2019]easy misc</span></div><div><br/></div><div>下载得到小姐姐.png、decode.zip和文件夹read，其中有1-29.txt共29个文本文件和hint.txt。</div><div><br/></div><div>先看decode.zip：</div><div><img src="BUUCTF Misc 16（109-112）_files/Image [7].png" type="image/png" data-filename="Image.png"/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>FLAG IN ((√2524921X85÷5+2)÷15-1794)+NNULLULL,</div></div><div>计算前面的式子得到7，猜测密码是（7位数字+NNULLULL,），尝试掩码爆破。</div><div><img src="BUUCTF Misc 16（109-112）_files/Image [8].png" type="image/png" data-filename="Image.png"/></div><div>解压得到decode.txt，内容：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>a = dIW b = sSD c = adE d = jVf e = QW8 f = SA= g = jBt h = 5RE i = tRQ j = SPA k = 8DS l = XiE</div><div>m = S8S n = MkF o = T9p p = PS5 q = E/S r = -sd s = SQW t = obW u = /WS v = SD9 w = cw= x = ASD</div><div>y = FTa z = AE7</div></div><div><br/></div><div>再看小姐姐<span style="font-size: unset; color: unset; font-family: unset;">.png，十六进制编辑器打开，会发现文件尾后还有一个PNG文件头，foremost分离。得到两张内容相同的图片，猜测可能是盲水印。</span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop/blind-watermark-python3/BlindWaterMark# python bwm.py decode 00000000.png 00000232.png out.png</div><div>image&lt;00000000.png&gt; + image(encoded)&lt;00000232.png&gt; -&gt; watermark&lt;out.png&gt;</div></div><div><img src="BUUCTF Misc 16（109-112）_files/out.png" type="image/png" data-filename="out.png"/></div><div><br/></div><div>找到read文件夹内的11.txt，hint.txt提示取前16个字符，尝试字频分析取前16位高频字符：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>from collections import Counter</div><div>import string</div><div><br/></div><div>c = open('C:/Users/Administrator/Desktop/attachment/read/11.txt').read()</div><div>c = Counter(c)</div><div>print(c.most_common())</div><div><br/></div><div>for i in range(16):</div><div>    print(c.most_common()[i][0], end = '')</div></div><div>输出：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div> etaonrhisdluygw</div></div><div>根据decode.txt进行替换：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>rep = ['dIW', 'sSD', 'adE', 'jVf', 'QW8', 'SA=', 'jBt', '5RE', 'tRQ', 'SPA', '8DS', 'XiE', 'S8S', 'MkF', 'T9p', 'PS5', 'E/S', '-sd', 'SQW', 'obW', '/WS', 'SD9', 'cw=', 'ASD', 'FTa', 'AE7']</div><div>for i in 'etaonrhisdluygwm':</div><div>    j = ord(i) - ord('a')</div><div>    print(rep[j], end = '')</div></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>QW8obWdIWT9pMkF-sd5REtRQSQWjVfXiE/WSFTajBtcw=</div></div><div><font color="#FF0000"><b>这里得到的字符串和官方Writeup给出的不一样，网上也有人提出疑问，这里是否替换表有问题？至少按这个替换表是不可能得出两个连续=号的。</b></font><b style="color: rgb(255, 0, 0); font-family: unset; font-size: unset;">暂时先接着官方Writeup给的字符串往下做：</b></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>QW8obWdIWT9pMkFSQWtRQjVfXiE/WSFTajBtcw==</div></div><div>base64解码：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>Ao(mgHY?i2ARAkQB5_^!?Y!Sj0ms</div></div><div>base85（ASCII85）解码：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>import base64</div><div><br/></div><div>a = b&quot;Ao(mgHY?i2ARAkQB5_^!?Y!Sj0ms&quot;</div><div>print(base64.a85decode(a))</div></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>b'flag{have_a_good_day1}'</div></div><div><br/></div><div>flag：flag{have_a_good_day1}</div></span>
</div></body></html> 