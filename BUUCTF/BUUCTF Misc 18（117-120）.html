<html>
<head>
  <title>BUUCTF Misc 18（117-120）</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/605894 (zh-CN, DDL); Windows/6.1.1 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="1568"/>
<h1>BUUCTF Misc 18（117-120）</h1>
<h2><a href="https://DemonStarAlgol.github.io/Misc/">[无关链接]</a></h2>

<div>
<span><div><span style="font-weight: bold;">117 粽子的来历</span></div><div>题目：曹操的私生子曹小明因为爸爸活着的时候得罪太多人，怕死后被抄家，所以把财富保存在一个谁也不知道的地方。曹小明比较喜欢屈原，于是把地点藏在他的诗中。三千年后，小明破译了这个密码，然而却因为担心世界因此掀起战争又亲手封印了这个财富并仿造当年曹小明设下四个可疑文件，找到小明喜欢的DBAPP标记，重现战国辉煌。答案为正确值（不包括数字之间的空格）的小写32位md5值。</div><div><br/></div><div>下载得到我是A-我是D.doc四个doc格式文件，直接打开均显示格式损坏。十六进制编辑器查看：</div><div><img src="BUUCTF Misc 18（117-120）_files/Image.png" type="image/png" data-filename="Image.png"/></div><div>注意到大量FF中间出现了无关的字符，四个文件开头附近不同位置分别为IComeFromAlibaba、IComeFromQihooDP、IComeFromDbappah和IComeFromWindows。说明这段字符是被人为修改过的，<span style="font-size: unset; color: unset; font-family: unset;">尝试全部改成FF，文件可以正常打开。对四个doc文件执行同样的修复，然后打开。</span></div><div><span style="font-size: unset;"><br/></span></div><div><img src="BUUCTF Misc 18（117-120）_files/Image [1].png" type="image/png" data-filename="Image.png"/></div><div>可以看到四个文件是同样的文字内容，但行间距各自不同，说明信息可能隐藏在行间距中。考虑到题目提示“小明喜欢的DBAPP标记”，而C文件中的损坏数据正是“IComeFromDbappah”，所以C中隐藏的是正确线索。</div><div>打开我是C.doc，逐行查看行间距设置，将1.5倍记为1，单倍记为0，得到：</div><div><img src="BUUCTF Misc 18（117-120）_files/Image [2].png" type="image/png" data-filename="Image.png"/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>100100100001</div></div><div>计算其MD5值得到flag。</div><div><br/></div><div>flag：flag{d473ee3def34bd022f8e5233036b3345}</div><div><br/></div><div><span style="font-weight: bold;">118 [ACTF新生赛2020]明文攻击</span></div><div><br/></div><div>下载得到res.zip和woo.jpg，前者是加密压缩包，内含flag.txt和secret.txt。根据题目名称猜测需要从woo.jpg中找到线索对其进行明文攻击后解压。</div><div>十六进制编辑器打开woo.jpg，在文件尾后找到数据：</div><div><img src="BUUCTF Misc 18（117-120）_files/Image [3].png" type="image/png" data-filename="Image.png"/></div><div>注意到03 04，结合后面的50 4B 01 02和50 4B 05 06，可以判断这是一个缺少了头部字节的zip压缩包。将其提取并修复文件头。得到内含flag.txt的zip格式压缩包。</div><div>直接用该压缩包作为明文，用ARCHPR对res.zip进行明文攻击。计算密钥需要比较久的时间，可以中途停止，如果已经解密成功，软件会提示保存已解密的压缩包。解压后从secret.txt得到flag。</div><div><br/></div><div>flag：ACTF{3te9_nbb_ahh8}</div><div><br/></div><div><span style="font-weight: bold;">119 [SCTF2019]电单车</span></div><div><span style="color: rgb(255, 0, 0);">原题：截获了一台电动车的钥匙发出的锁车信号，3分钟之内，我要获得它地址位的全部信息。flag内容二进制表示即可。</span></div><div><br/></div><div>下载得到sctf.wav，audacity打开：</div><div><img src="BUUCTF Misc 18（117-120）_files/Image [4].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>记录信号得到：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>0 011101001010101001100010</div></div><div><br/></div><div>PT2242信号：前面4bit表示同步码，中间的20bit表示地址码，后面的4bit表示功能码，最后一位是停止码。</div><div><img src="BUUCTF Misc 18（117-120）_files/Image [5].png" type="image/png" data-filename="Image.png"/></div><div>从而地址码部分是01110100101010100110。</div><div><br/></div><div>flag：sctf{01110100101010100110}</div><div><br/></div><div><b>120 [MRCTF2020]Hello_ misc</b></div><div><br/></div><div>下载得到hello文件夹，内含try to restore it.png和加密压缩包flag.rar。</div><div>先看前者，十六进制编辑器查看，尾部有zip压缩包，提取得到又一个加密zip压缩包。然后ztseg查看：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop# zsteg try\ to\ restore\ it.png</div><div>[?] 294 bytes of extra data after image end (IEND), offset = 0x578d</div><div>extradata:0         .. file: Zip archive data, at least v2.0 to extract</div><div>    00000000: 50 4b 03 04 14 00 09 00  63 00 7b 9e 78 50 3e a0  |PK......c.{.xP&gt;.|</div><div>    00000010: 43 2a 6c 00 00 00 96 01  00 00 07 00 0b 00 6f 75  |C*l...........ou|</div><div>    00000020: 74 2e 74 78 74 01 99 07  00 01 00 41 45 03 08 00  |t.txt......AE...|</div><div>    00000030: 81 1e 0a f2 f2 e6 76 47  b3 bb 97 11 74 be fe 37  |......vG....t..7|</div><div>    00000040: 72 32 b0 0b 53 66 c5 84  dd 96 83 fe 64 b5 d5 ce  |r2..Sf......d...|</div><div>    00000050: 93 34 54 63 d8 81 17 8e  0e 09 fb 7f 68 05 a3 30  |.4Tc........h..0|</div><div>    00000060: 52 06 31 20 7b 44 74 02  1f a9 70 e4 00 7e 63 be  |R.1 {Dt...p..~c.|</div><div>    00000070: 60 ce ba 24 bc a5 d6 c4  eb 79 f8 76 e2 fa 96 c1  |`..$.....y.v....|</div><div>    00000080: 64 ee 6f 3e 0a fd 9e 4b  dd e1 23 bf 72 c4 a4 bd  |d.o&gt;...K..#.r...|</div><div>    00000090: 9e 3d 4b b1 60 0c 7e d4  b3 16 62 c4 50 4b 07 08  |.=K.`.~...b.PK..|</div><div>    000000a0: 3e a0 43 2a 6c 00 00 00  96 01 00 00 50 4b 01 02  |&gt;.C*l.......PK..|</div><div>    000000b0: 1f 00 14 00 09 00 63 00  7b 9e 78 50 3e a0 43 2a  |......c.{.xP&gt;.C*|</div><div>    000000c0: 6c 00 00 00 96 01 00 00  07 00 2f 00 00 00 00 00  |l........./.....|</div><div>    000000d0: 00 00 20 00 00 00 00 00  00 00 6f 75 74 2e 74 78  |.. .......out.tx|</div><div>    000000e0: 74 0a 00 20 00 00 00 00  00 01 00 18 00 fb b2 95  |t.. ............|</div><div>    000000f0: 9d d2 01 d6 01 fd 99 a2  9f d2 01 d6 01 fb b2 95  |................|</div><div>b1,r,lsb,xy         .. file: PNG image data, 526 x 298, 8-bit/color RGB, non-interlaced</div><div>b1,bgr,msb,xy       .. text: &quot;C2dB2IH&amp;$&quot;</div></div><div>在R通道最低位有LSB隐写（实际上应该是把图像上端的蓝点视作0、红点视作1得到的）。Stegsolve提取：</div><div><img src="BUUCTF Misc 18（117-120）_files/1.png" type="image/png" data-filename="1.png"/></div><div>zip压缩包的密码是<font style="color: rgb(255, 0, 0);">!@#$%67*()-+</font>，解压得到out.txt：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>127 255 63 191 127 191 63 127 127 255 63 191 63 191 255 127 127 255 63 63 127 191 63 127 127 255 63 255 127 255 63 255 127 255 127 255 127 191 127 63 63 255 191 191 63 255 63 63 127 191 63 127 127 191 63 255 63 255 63 127 127 191 127 191 127 191 127 127 63 255 127 191 127 191 63 191 63 255 127 255 63 255 127 255 127 191 63 191 127 191 127 127 63 255 127 127 127 191 127 63 127 191 63 191 127 191 127 127</div></div><div>四个数字，全部转换成二进制后取前两位，即63-00,、127-01、191-10、255-11，得到：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>011100100110000101110010001011010111000001100001011100110111001101110111011001000011101000110000011000010110001100110001011001100110010100110110011000100011011100110111011000100110010100110101011001000110001001100101</div></div><div>二进制ASCII转码：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>rar-passwd:0ac1fe6b77be5dbe</div></div><div>解压flag.rar得到fffflag.zip，打开看到文件结构发现是Microsoft Word文档：</div><div><img src="BUUCTF Misc 18（117-120）_files/Image [6].png" type="image/png" data-filename="Image.png"/></div><div>重命名为.docx，打开：</div><div><img src="BUUCTF Misc 18（117-120）_files/Image [7].png" type="image/png" data-filename="Image.png"/></div><div>下方显然有空白字符或白色字符，设置一下字体颜色：</div><div><img src="BUUCTF Misc 18（117-120）_files/Image [8].png" type="image/png" data-filename="Image.png"/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>MTEwMTEwMTExMTExMTEwMDExMTEwMTExMTExMTExMTExMTExMTExMTExMTExMTExMTAxMTEwMDAwMDAxMTExMTExMTExMDAxMTAx</div><div>MTEwMTEwMTEwMDAxMTAxMDExMTEwMTExMTExMTExMTExMTExMTExMTExMTExMTExMTExMTAxMTExMTExMTExMTExMTEwMTEwMDEx</div><div>MTEwMDAwMTAxMTEwMTExMDExMTEwMTExMTExMTAwMDExMTExMTExMTExMDAxMDAxMTAxMTEwMDAwMDExMTExMDAwMDExMTExMTEx</div><div>MTEwMTEwMTAwMDAxMTExMDExMTEwMTExMTExMDExMTAxMTExMTExMTEwMTEwMTEwMTAxMTExMTExMTAwMTEwMTExMTExMTExMTEx</div><div>MTEwMTEwMTAxMTExMTExMDExMTEwMTExMTAxMDExMTAxMTExMTExMTEwMTEwMTEwMTAxMTAxMTExMTAwMTEwMTExMTExMTExMTEx</div><div>MTEwMTEwMTAwMDAxMTAwMDAwMTEwMDAwMDAxMTAwMDExMTAwMDAwMTEwMTEwMTEwMTAxMTEwMDAwMDAxMTExMDAwMDExMTExMTEx</div></div><div>base64解码：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>110110111111110011110111111111111111111111111111101110000001111111111001101110110110001101011110111111111111111111111111111111101111111111111110110011110000101110111011110111111100011111111111001001101110000011111000011111111110110100001111011110111111011101111111110110110101111111100110111111111111110110101111111011110111101011101111111110110110101101111100110111111111111110110100001100000110000001100011100000110110110101110000001111000011111111</div></div><div>长度为450，尝试黑白像素绘图，尺寸根据450的因数尝试，最后确定高为6：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>from PIL import Image</div><div>a = '110110111111110011110111111111111111111111111111101110000001111111111001101110110110001101011110111111111111111111111111111111101111111111111110110011110000101110111011110111111100011111111111001001101110000011111000011111111110110100001111011110111111011101111111110110110101111111100110111111111111110110101111111011110111101011101111111110110110101101111100110111111111111110110100001100000110000001100011100000110110110101110000001111000011111111'</div><div><br/></div><div>w = 75</div><div>h = 6</div><div>img = Image.new('RGB', (w, h))</div><div><br/></div><div>for i in range(len(a)):</div><div>    x = i % w</div><div>    y = i // w</div><div>    if a[i] == '1':</div><div>        img.putpixel((x, y), (255, 255, 255))</div><div>    elif a[i] == '0':</div><div>        img.putpixel((x, y), (0, 0, 0))</div><div>img.show()</div></div><div><img src="BUUCTF Misc 18（117-120）_files/Image [9].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>flag：MRCTF{He1Lo_mi5c~}</div><div><b><font style="color: rgb(255, 0, 0);">（这是5？！你确定不是S？！）</font></b></div></span>
</div></body></html> 