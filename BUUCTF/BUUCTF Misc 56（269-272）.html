<html>
<head>
  <title>BUUCTF Misc 56（269-272）</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/605894 (zh-CN, DDL); Windows/6.1.1 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="725"/>
<h1>BUUCTF Misc 56（269-272）</h1>
<h2><a href="https://DemonStarAlgol.github.io/Misc/">[无关链接]</a></h2>

<div>
<span><div><span style="font-weight: bold;">269 [INSHack2017]smart-sensors-api</span></div><div><br/></div><div>下载得到md格式文件和backup.zip。前者是题目说明：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>Caasi Vomisa bought a set of sensors and asked his friend, John, to build an API so that</div><div>Caasi can aggregate the data coming from them using third party services. Yet John Doe is</div><div>- sometimes - really stupid and he made two big mistakes...</div><div><br/></div><div>Can you show Caasi that you are a brilliant Git user ?</div></div><div><br/></div><div>解压backup.zip得到.git文件夹。需要从中找到漏洞并获取API的用户权限，然后找到flag。但flag并不在本地文件中，需要调用API连接靶机获取。当然服务器似乎已经失效了……先记录一下Writeup：</div><div><a href="https://github.com/HugoDelval/inshack-2017/blob/master/challenges/misc/smart-sensors-api-125/writeup.md">https://github.com/HugoDelval/inshack-2017/blob/master/challenges/misc/smart-sensors-api-125/writeup.md</a></div><div><br/></div><div>flag：<span style="font-size: unset; color: unset; font-family: unset;">INSA{Dumb_4nd_Dumb3r!Cl34n_G1t_H1st0rY!}</span></div><div><span style="font-size: unset;"><br/></span></div><div><span style="font-size: unset; color: unset; font-family: unset; font-weight: bold;">270 </span><span style="font-weight: bold;">[INSHack2017]lost-file</span></div><div><br/></div><div>下载得到md格式文件，内容是题目说明：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>Heeelp! I did a `rm` on my python file. All my work is gone! Would you help me restore it?</div><div><br/></div><div>I usually work with a &lt;a href=&quot;http://docs.python-guide.org/en/latest/dev/virtualenvs/&quot;&gt;virtualenv&lt;/a&gt; if this info can help you..</div><div>&lt;code&gt;ssh lost-file@lost-file.ctf.insecurity-insa.fr&lt;/code&gt; (password lost-file)</div></div><div><br/></div><div>服务器已经连不上了……先记录一下Writeup：</div><div><a href="https://github.com/HugoDelval/inshack-2017/blob/master/challenges/forensics/lost-file-225/writeup.md">https://github.com/HugoDelval/inshack-2017/blob/master/challenges/forensics/lost-file-225/writeup.md</a></div><div><br/></div><div>flag：INSA{N1ce_Pl4y_W1th_P1th0N}</div><div><br/></div><div><span style="font-weight: bold;">271 [BSidesSF2020]mini-matroyshka</span></div><div>题目：A lot of the computer world is just layers of abstraction.  Layers and layers and layers and layers and layers and layers and layers and layers and ... layers and layers and ...</div><div><br/></div><div>下载得到flag.txt，内容：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>b'U0RSelNVRkdibUpNTVRSREwzcFRaRmRhWW10UGJ6VkZkRGhUV2pCcFprZ3ZVemh3TnpWV1NHUndNU3RXVXpoNmQyd3dhVUZaVFZwRFNVUjRVR3BOT0Vsa1VqTjZNMVJ5UTJWdVpYVk9ObmcxZEhaSGVVTlBWMVYyVGs1Nk4xQTFiMlpwYlZoSGNYUndXbUZ1ZGtOWGJHdG1TaXNyU2taUlV6TnVVR2xVWm1WdGRuWndkRGRZZUhKelJVaDRTRUppVUZjeVYwMHlXbU5KS3l0a04zVjZPREJVY0dwMFZHcGhjVVJ0VHpCc1l5OWhObVlyZUhCdVNIVTVPVFZrZFhZek5XSlFTMlV6Wm5SaVpEVTNTbXdyWlU5eUsza3dkMjh6Ym1SYVEyMUxTSFV5S3pkNmJrWj</div><div>……（后略）</div></div><div>显然是base64编码。尝试将开头部分进行base64解码，解码后仍然得到base64编码。重复解码到第三次时，得到了类似字节数据的结果。将flag.txt去掉开头和结尾的b''后，在Linux下对整段文件进行三次解码：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop# cat flag.txt | base64 -d &gt; 1.txt</div><div>root@kali:~/Desktop# cat 1.txt | base64 -d &gt; 2.txt</div><div>root@kali:~/Desktop# cat 2.txt | base64 -d &gt; 3</div></div><div>再用file命令判断结果文件的类型：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop# file 3</div><div>3: gzip compressed data, last modified: Tue Jan 28 06:57:29 2020, max compression, original size modulo 2^32 66620</div></div><div>解压得到文本，内容：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>1F8B080059DB2F5E02FF1C9ACB96AA3A14453F288D80019234555454849422A23D814405449EE1F1F537E7F66A9CAAA310F65E6B4EAB1CA3DD2FB765ECEAC61A6A531A47C7ECD2791B3A9D9BED67F937</div><div>……（后略）</div></div><div>显然是gzip格式压缩文件的十六进制数据，用十六进制编辑器将其保存为gz格式文件。解压得到文本：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>H4sIAFnbL14C/0ydbXKjStNE9yRrFiAQwkiBFICQDftfyFvnJL7P++PGjZmx9dF0V1dlZWb1t+t1mubp+7JdL8/7PszNtZvnz7Bu9f+l77vTdZmWa7+e3910//T19+3YrP20r+Or2frL6T3O93W4t10/Prr+1q7dWD8/buswPprv7mtt53ketq/rOLf8e9c/21v91z2mRzM8m/dr3D9D93UdnrzP/m5fzW9/a9b2u</div><div>……（后略）</div></div><div>继续base64转码：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop# cat 4 | base64 -d &gt; 5</div><div>root@kali:~/Desktop# file 5</div><div>5: gzip compressed data, last modified: Tue Jan 28 06:57:29 2020, max compression, original size modulo 2^32 68480</div></div><div>解压得到文本：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>GFDDQQRQHAYDANJZIRBDERRVIUYDERSGGE2DSQSDGU4TEQJVGUYDCMBUGQZUMOBYGA2TMRJUIJCEGMKEGFCUEMSDGMYUIMKBHE3UCRRRIY3DMRCEGFCEGNCFGNCEKQKBINBTOMZVIE3DINSDGUZTCOBXGFBUCNZUGE4EKM2DGAZTOMSDIMZDENCDIUYTKNJXGEYTKNSDIEZEEMRZIEYUKN2DIE4ECRKBHFCUMOBVIVCEKRJUG42DGRBRGM4DCN2CHE3EIMZUIJCTIMJVGU3DCMRWHAYUCOJYHE3UCQSEIQ4EGN</div><div>……（后略）</div></div><div>显然是base32编码，转码：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop# cat 5 | base32 -d &gt; 6.txt</div></div><div>得到文本：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>1F8B080059DB2F5E02FF149BC592A55010443F88056E4BDC1D1EB2C31D1A97AF1F66DD1DC4E3DEAACC735A646C531871CA7418E3C0372CC224CE15571156CA2B29A1E7CA8AEA9EF85EDEE4743D13817B96D34BE4155612681A9897ABDD8C7CA8AB4CB</div><div>……（后略）</div></div><div>十六进制编辑器保存为gz格式压缩包，解压得到文本：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>H4sIAFnbL14C/zWdWZYcIRIEr8Se8EkCef8jyYxqzZvRSN21kBCLe2zEr7+hh1DHftNXT0jfN/hH2/2ckns4pcyvlJpSeaov/Np3yrNnPC3sOHJsX4krl9PK12INY5/6llb7CGu18nzf83xjfN+X1ndi3u376n7bM0/ld9/X8pe/+b38yX/G+c63+CkL802nLn9/nj4Hrx5v/g</div><div>……（后略）</div></div><div>base64解码：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop# cat 7 | base64 -d &gt; 8</div><div>root@kali:~/Desktop# file 8</div><div>8: gzip compressed data, last modified: Tue Jan 28 06:57:29 2020, max compression, original size modulo 2^32 36792</div></div><div>解压得到文本：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>1F8B080059DB2F5E02FF959D6D8EE4380E44AF445224758005F6FE47DA1E60D19316F41C34E64F61509DE5B465890CC647FF77F99FFF2CFE13D6FF5DB67AE5FF7FF63F3FAFBF3FFFF9EFEFCFF6F8B9FFFE5C3F3FE78A9</div><div>……（后略）</div></div><div>十六进制编辑器保存为gz格式压缩包，解压得到文本：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>6F3131302C206F3036342C206F3136332C206F3131312C206F3130312C206F3130362C206F3135362C206F3134322C206F3131342C206F3036312C206F3036342C206F3130332C206F3035372C206F3037302C206F3132362C206F3134342C206F3132342C206F</div><div>……（后略）</div></div><div>十六进制ASCII转码得到文本：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>o110, o064, o163, o111, o101, o106, o156, o142, o114, o061, o064, o103, o057, o070,</div><div>o126, o144, o124, o127, o057, o162, o171, o113, o067, o070, o123, o065, o141, o143,</div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">……（后略）</span></div></div><div>八进制ASCII转码：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>f = open('C:/Users/Administrator/Desktop/10.txt').read()</div><div>f = f.replace('o', '').split(', ')</div><div>for i in f:</div><div>    print(chr(int(i, 8)), end = '')</div></div><div>输出结果：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>H4sIAFnbL14C/8VdTW/ryK78S5acLN8icIzAF08OdBzNgbL1AI7teHUXifTr30TdbhbZ7C/Z580ySBTLUjebLFYVt2/NfzfP7fi/q6dqu/s6bMfzPz//Ov/83Az//PzW/fPz3x/Tz8efn/f//Nw//PPzop9+v7n</div><div>……（后略）</div></div><div>base64解码：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop# cat 11.txt | base64 -d &gt; 12</div><div>root@kali:~/Desktop# file 12</div><div>12: gzip compressed data, last modified: Tue Jan 28 06:57:29 2020, max compression, original size modulo 2^32 79700</div></div><div>解压得到文本：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>NTMsIDQzLCA1NSwgNzksIDRkLCA1MywgNTUsIDdhLCA1MiwgNTcsIDY4LCA0YywgNTIsIDdhLCA2YywgNTgsIDU1LCA1NSwgNDYsIDQ5LCA0ZSwgNmMsIDRkLCA3NCwgNTQsIDQ1LCA0NiwgNTUsIDY2LCA2YSwgNjcsIDc4LCA1M</div><div>……（后略）</div></div><div>base64解码：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop# cat 12.txt | base64 -d &gt; 13</div></div><div>得到文本：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>53, 43, 55, 79, 4d, 53, 55, 7a, 52, 57, 68, 4c, 52, 7a, 6c, 58, 55, 55, 46, 49, 4e, 6c, 4d, 74, 54, 45, 46, 55, 66, 6a, 67, 78, 53, 43, 55, 79, 4d, 58, 5a, 57, 52, 55,</div><div>……（后略）</div></div><div>十六进制ASCII转码：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>SCUyMSUzRWhLRzlXUUFINlMtTEFUfjgxSCUyMXZWRUYlMjklMjQlMjFHSTNQRFJBVCUyNjgzSDhMUEpIeSU3QyU2ME9BVCUzRCUzRCU3Qkk1JTIxJTdDVUZkJTIzVEhBVCUzRCU2MCU3REglMjNRJTI4S0ZnR0FLSHklN0QxT0FUY21CQVR</div><div>……（后略）</div></div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">base64解码：</span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop# cat 14.txt | base64 -d &gt; 15</div></div><div>得到文本：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>H%21%3EhKG9WQAH6S-LAT~81H%21vVEF%29%24%21GI3PDRAT%2683H8LPJHy%7C%60OAT%3D%3D%7BI5%21%7CUFd%23THAT%3D%60%7DH%23Q%28KFgGAKHy%7D1OATcmBAT~K5F%29%3DhCH8dbNGaxrGAU8H3F%29%25nFHZ%3EqIGB6-9F%2A6%60FG9WQAFd%2388F%285H9Fd%23TFAT%3D</div><div>……（后略）</div></div><div>URL转码：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>H!&gt;hKG9WQAH6S-LAT~81H!vVEF)$!GI3PDRAT&amp;83H8LPJHy|`OAT=={I5!|UFd#THAT=`}H#Q(KFgGAKHy}1OATcmBAT~K5F)=hCH8dbNGaxrGAU8H3F)%nFHZ&gt;qIGB6-</div><div>……（后略）</div></div><div>base85解码：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>import base64</div><div><br/></div><div>f = open('C:/Users/Administrator/Desktop/16.txt', 'rb').read()</div><div>print(base64.b85decode(f))</div></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>b'72 52 115 73 65 70 110 98 76 49 52 67 47 51 87 90 83 53 76 107 77 65 104 69 114 54 83 70 76 108 65 120 113 52 110 111 110 81 53 82 111 98 49 48 47 120 110 98 102 70 52 105 57 54 112 43 116 103</div><div>……（后略）</div></div><div>十进制ASCII转码：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>H4sIAFnbL14C/3WZS5LkMAhEr6SFLlAxq4nonQ5Rob10/xnbfF4i96p+tgwJJAn1M/r6+6fvn9G/P/H+s39m+97fzb7//mn++fp9/Uz7ffr7uP76vO7rx2f9/7zv82Zb9nrdc12371c/+352s2vv764z7rOee6/3zzXPs9zW63t77vW8</div><div>……（后略）</div></div><div>base64解码：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop# cat 18.txt | base64 -d &gt; 19</div><div>root@kali:~/Desktop# file 19</div><div>19: gzip compressed data, last modified: Tue Jan 28 06:57:29 2020, max compression, original size modulo 2^32 7456</div></div><div>解压得到文本：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>LS4tIC4uLS4gLS4tIC4uLSAuLi0gLS4gLi4uIC0uLi0gLS4tIC4tLiAuLi0gLi4tLiAuLiAuLi0gLS4tLiAtIC0uLSAtLS4uIC4uLi0tIC4uLi0gLi4gLS4uLi4gLi4uIC0uLS4gLS0uIC4uLi4uIC0tIC0tLiAtLi0tIC0tLi4gLS0uLiAuLi4g</div><div>……（后略）</div></div><div>base64解码：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>-.- ..-. -.- ..- ..- -. ... -..- -.- .-. ..- ..-. .. ..- -.-. - -.- --.. ...-- ...- .. -.... ... -.-. --. ..... -- --. -.-- --.. --.. ... -.- --.- -.-- -.. ... ....- - ..-. --. .--- -..- - .- - ..--- . -.- </div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">……（后略）</span></div></div><div>摩斯电码，转码：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>KFKUUNSXKRUFIUCTKZ3VI6SCG5MGYZZSKQYDS4TFGJXTAT2EKF2FKMDMNRIFKTJSJFLUUU2MLBFHUSTKHFLE6MTDG5RFMTRZKZCFSMTBNVITCUJSOA3GK3JZOVIVGRRXKZMFEV2OKRKXSYZTIVWVIQZRI5MGYVSJJNWXQSCTNVNGUS3KLIZE66KOGBSUQ2CYMJLVMM2QK5WEOYKHJZTFS6TUJJJG2SJTKFLE44KJGJYEYU3OKF4E2MLMMZLUKWSJJJCXI5KJPJNGWWKYJJIE2RKRNJRDA5ZUJFMEERSYPIYTEZSHPB4E2V2BOJNFMOJQKRWXA4SOKRDE6SSTOQ2FIR2CIRRTGSSLJJMFEUSSK5WFQVKEKEVVK3LMOFLFMZBQK5XHQVSUJA2UCUKTKZXUSM2CIJJFIQRVKFCXQOCNKZTTSTRTJJUFG2KNNVQVOQLNMVKFMN2WNF2FOZCDGFMU43CWGNGTGULULAZEUMKJKRSGQTTLKJDGKRSWNVRG2SLMLJLWYUKQPFGTQZDNN4ZVI3JVNRKVIQSPKZDXAMCYGNKSWUKXJE4FCVBRNNNEIQTMMFEFSNCRKRLGKVRSJI3VURSKPBLDGMJTJJLVCN22KRFE4S2GGVCU4VBYOFJFOY3NKMZWI6KSK5NGWUKIKJ3FOVS2MZSFMWTYKVDXI4KKKVWFMV2TNRXGCV2ZPFHEOWLKKZCXA6SXNFNEYUTKGF2GMWCSHBSFKNKHKZLFMSSSKY4XOZKDM4VU4RCSORKDCZCJKB4XA6S2IVNDOZCINB2U2WC2NJJDAUSTLAYWY22ZKNYDIZCGHFDFK3LILBSTESTWLFKXAOC2I5UEUZDOGRWE46KGORRVKUTJLJKHIUCWIZYDOTSYJZCFUVZZPBSDA2ZPJNWGIZ2OGNAXEY3LJJKGMRSCNBNFO6DRMJ4VETKSKZBHSYTKORJGGMSWLFGFKQSOLBWDSMCTNJ2HIURQOBWGK3KKNFKFK3DYKNWVUUCJGJSDMVSEKJHVKU3LNRNDEOLFKAZFC32NKZXWUTJSNB3VO2TYJRLUKQTLKBME4UKKKY4G2TCUHFZU6SCBPJKDCQLKMJCXI2LBKVLGYUBSKIVVS6JRJZJEI2DIJJCGY52LNJWFMU2FOBCUW6LQINRTARSHKB5HI2KOLBLDOZCIMRVVMSDENJSEI2DQJ4ZFCOKPLAYVSVCVGV3US6SCHFKTCVTKLEYHG3CJK5DDETT2KZSWMWDQINMXS3ZQKYZVK6KSGNITOSJRGVDVURLEOJIFKZDBLFCUCNCOKRAXOTKEIE6Q====</div></div><div>base32解码：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>QUJ6WThTPSVwTzB7Xlg2T09re2o0ODQtU0llPUM2IWJSLXJzJj9VO2c7bVN9VDY2amQ1Q2p6em9uQSF7VXRWNTUyc3EmTC1GXlVIKmxHSmZjKjZ2OyN0eHhXbWV3PWlGaGNfYztJRmI3QVNqI2pLSnQxM1lfWEZIJEtuIzZkYXJPMEQjb0w4IXBFXz12fGxxMWArZV90TmprNTFOJSt4TGBDc3JKJXRRRWlXUDQ+UmlqVVd0WnxVTH5AQSVoI3BBRTB5QEx8MVg9N3JhSiMmaWAmeTV7VitWdC1YNlV3M3QtX2J1ITdhNkRFeFVmbmIlZWlQPyM8dmo3Tm5lUTBOVGp0X3U+QWI8QT1kZDBlaHY4QTVeV2J7ZFJxV313JWQ7ZTJNKF5ENT8qRWcmS3dyRWZkQHRvWVZfdVZxUGtqJUlVWSlnaWYyNGYjVEpzWiZLRj1tfXR8dU5GVVVJRV9weCg+NDRtT1dIPypzZEZ7dHhuMXZjR0RSX1lkYSp4dF9FUmhXe2JvYUp8ZGhJdn4lNyFtcURiZTtPVFp7NXNDZW9xd0k/KldgN3ArckJTfFBhZWxqbyRMRVBybjtRc2VYLUBNXl90SjttR0plemJiTUlxSmZPI2d6VDROUSklZ29eP2QoMVojM2hwWjxLWEBkPXNQJV8mLT9sOHAzT1AjbEtiaUVlP2R+Yy1NRDhhJDlwKjlVSEpEKypCc0FGPztiNXV7dHdkVHdjdDhpO2Q9OX1YTU5wIzB9U1VjY0slIWF2NzVefXpCYyo0V3UyR3Q7I15GZEdrPUdaYEA4NTAwMDA=</div></div><div>base64解码：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>ABzY8S=%pO0{^X6OOk{j484-SIe=C6!bR-rs&amp;?U;g;mS}T66jd5CjzzonA!{UtV552sq&amp;L-F^UH*lGJfc*6v;#txxWmew=iFhc_c;IFb7ASj#jKJt13Y_XFH$Kn#6darO0D#oL8!pE_=v|lq1`+e_tNjk51N%+xL`CsrJ%tQEiWP4&gt;RijUWtZ|UL~@A%h#pAE0y@L|1X=7raJ#&amp;i`&amp;y5{V+Vt-X6Uw3t-_bu!7a6DExUfnb%eiP?#&lt;vj7NneQ0NTjt_u&gt;Ab&lt;A=dd0ehv8A5^Wb{dRqW}w%d;e2M(^D5?*Eg&amp;KwrEfd@toYV_uVqPkj%IUY)gif24f#TJsZ&amp;KF=m}t|uNFUUIE_px(&gt;44mOWH?*sdF{txn1vcGDR_Yda*xt_ERhW{boaJ|dhIv~%7!mqDbe;OTZ{5sCeoqwI?*W`7p+rBS|Paeljo$LEPrn;QseX-@M^_tJ;mGJezbbMIqJfO#gzT4NQ)%go^?d(1Z#3hpZ&lt;KX@d=sP%_&amp;-?l8p3OP#lKbiEe?d~c-MD8a$9p*9UHJD+*BsAF?;b5u{twdTwct8i;d=9}XMNp#0}SUccK%!av75^}zBc*4Wu2Gt;#^FdGk=GZ`@850000</div></div><div>base85解码，并保存为文件：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>import base64</div><div><br/></div><div>f = b'ABzY8S=%pO0（后略）'</div><div>res = open('C:/Users/Administrator/Desktop/20', 'wb')</div><div>res.write(base64.b85decode(f))</div></div><div>判断文件类型，为gzip格式压缩包，解压得到文本：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>MzYzOTIwMzQzNTIwMzEzMTMxMjAzNzM3MjAzMTMyMzYyMDM2MzkyMDM0MzMyMDM1MzYyMDMzMzMyMDMxMzIzNjIwMzYzOTIwMzEzMDMzMjAzMzM4MjAzMTMxMzcyMDM0MzMyMDM2MzkyMDMxMzAzNTIwMzYzOTIwMzUzNTIwMzEzMjM0MjAzNjM5MjAzNDM1MjAzMTMxMzEyMD</div><div>……（后略）</div></div><div>base64解码：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>36392034352031313120373720313236203639203433203536203333203132362036392031303320333820313137203433203639203130352036392035352031323420363920343520313131203337203639203635203834203636203739203438203639203130</div><div>……（后略）</div></div><div>十六进制ASCII转码：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>69 45 111 77 126 69 43 56 33 126 69 103 38 117 43 69 105 69 55 124 69 45 111 37 69 65 84 66 79 48 69 105 69 55 124 65 84 50 72 43 69 45 111 37 69 69 43 56 37 126 69 105 78 68 126 69 105 69 55 124 69 45 102 71 125 69 45 102 116 125 69 45 102 120 68 65 84 49 121 43 69 105 69 110 125 69 45 111 33 68 65 84 66 75 125 69 43 56 37 126 69 103 38 114 125 69 105 78 68 126 69 45 111 33 67 65 84 66 79 48 65 84 50 69 125 69 45 111 77 126 69 43 56 38 48 69 45 111 37 48 69 103 38 114 125 69 45 102 71 126 65 84 50 69 125 69 43 56 33 126 69 103 38 114 124 69 45 111 37 48 69 105 69 55 124 69 43 56 33 126 69 45 102 71 125 69 45 111 122 126 69 105 78 113 125 69 45 111 37 68 69 103 38 114 125 69 43 56 37 45 69 45 102 120 68 65 84 66 79 48 69 45 111 78 48 69 45 111 77 126 69 105 78 68 125 69 45 111 37 69 65 84 50 72 126 69 103 38 117 126 69 45 102 116 125 69 45 102 117 66 65 84 50 69 124 65 84 66 75 126 65 84 50 72 126 69 45 111 77 126 69 105 78 113 125 69 105 78 117 68 69 103 38 114 125 69 45 111 122 126 69 105 78 117 68 69 103 38 114 125 69 45 111 122</div></div><div>十进制ASCII转码：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>E-oM~E+8!~Eg&amp;u+EiE7|E-o%EATBO0EiE7|AT2H+E-o%EE+8%~EiND~EiE7|E-fG}E-ft}E-fxDAT1y+EiEn}E-o!DATBK}E+8%~Eg&amp;r}EiND~E-o!CATBO0AT2E}E-oM~E+8&amp;0E-o%0Eg&amp;r}E-fG~AT2E}E+8!~Eg&amp;r|E-o%0EiE7|E+8!~E-fG}E-oz~EiNq}E-o%DEg&amp;r}E+8%-E-fxDATBO0E-oN0E-oM~EiND}E-o%EAT2H~Eg&amp;u~E-ft}E-fuBAT2E|ATBK~AT2H~E-oM~EiNq}EiNuDEg&amp;r}E-oz~EiNuDEg&amp;r}E-oz</div></div><div>base85解码：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>import base64</div><div><br/></div><div>f = b'E-oM~E+8!~Eg&amp;u+EiE7|E-o%EATBO0EiE7|AT2H+E-o%EE+8%~EiND~EiE7|E-fG}E-ft}E-fxDAT1y+EiEn}E-o!DATBK}E+8%~Eg&amp;r}EiND~E-o!CATBO0AT2E}E-oM~E+8&amp;0E-o%0Eg&amp;r}E-fG~AT2E}E+8!~Eg&amp;r|E-o%0EiE7|E+8!~E-fG}E-oz~EiNq}E-o%DEg&amp;r}E+8%-E-fxDATBO0E-oN0E-oM~EiND}E-o%EAT2H~Eg&amp;u~E-ft}E-fuBAT2E|ATBK~AT2H~E-oM~EiNq}EiNuDEg&amp;r}E-oz~EiNuDEg&amp;r}E-oz'</div><div>print(base64.b85decode(f))</div></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>b'.. -. -.- . -- -.... ...-- - -. ..... .--. .-- -.- -.-- .-.. - .--. ..-. .--. .-- -.-. ...-- ... --... -. ..... - -..- . --.. -.- --... -- -. -..- -..- -.- ...-- -.. . .-.. ..... ... --. -.... -..- ...-- .--- --- .-. -.... --.- -...- -...- -...- -...-'</div></div><div>摩斯电码转码：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>INKEM63TN5PWKYLTPFPWC3S7N5TXEZK7MNXXK3DEL5SG6X3JOR6Q====</div></div><div>base32解码：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>CTF{so_easy_an_ogre_could_do_it}</div></div><div><br/></div><div>flag：CTF{so_easy_an_ogre_could_do_it}</div><div><br/></div><div><span style="font-weight: bold;">272 [INSHack2018]Taking a look inside</span></div><div><br/></div><div>下载得到md格式文件和taking-a-look-inside.zip。前者是题目说明：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>I acquired some information about my PC because I think someone messed up with it...</div><div>You can find everything [here](https://mega.nz/#!1ddgGKTB!Qf-BuTtP7FwsDuHAwmH5TJ7ZAbDnMtr3pSPQHgI7WWM).</div><div>Please find out what's wrong about these captures.</div><div>Have fun!</div></div><div><br/></div><div>解压taking-a-look-inside.zip得到pcap格式文件和dmp格式文件。</div><div>先看taking-a-look-inside.pcap文件，wireshark打开：</div><div><img src="BUUCTF Misc 56（269-272）_files/Image.png" type="image/png" data-filename="Image.png"/></div><div>共有943个数据包，均为TCP格式，是192.168.56.1和192.168.56.101之间的通信，属于同一条TCP流。追踪流，可以看到传输的数据是“SCN|……|NCS”形式的数据段，且开头还有4字节的长度数据。用tshark提取十六进制数据：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop# tshark -r taking-a-look-inside.pcap -T fields -e data -Y 'ip.src == 192.168.56.101 &amp;&amp; !(data.len == 4)' &gt; data</div></div><div>用xxd将十六进制数据转码：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop# xxd -r -p data &gt; SCN</div></div><div>分离“SCN|……|NCS”中的base64编码，尝试解码：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>import base64</div><div><br/></div><div>f = open('C:/Users/Administrator/Desktop/SCN', 'r').read()</div><div>f = f.split('|NCSSCN|')</div><div>f[0] = f[0][4:]</div><div>f[-1] = f[-1][:-4]</div><div><br/></div><div>d = []</div><div>for i in f:</div><div>    d += base64.b64decode(i)</div></div><div>但没有发现有效信息，猜测数据可能经过某种加密。</div><div><br/></div><div>再看taking-a-look-inside.dmp文件。尝试后发现不是磁盘镜像，可能为内存镜像。可以使用volatility进行分析，但本题直接通过strings命令也能找到线索：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop# strings taking-a-look-inside.dmp &gt; dump.txt</div></div><div>尝试搜索常见的密码名称，搜索AES时找到如下内容：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>screenshot</div><div>[0;1m</div><div>[36mimport</div><div>[39m</div><div>[m grab</div><div>[0;1m</div><div>[31m # PIL + imagemagick needed</div><div>[13d</div><div>[36mfrom</div><div>[39m</div><div>[m Crypto.Cipher</div><div>[0;1m</div><div>[36mimport</div><div>[39m</div><div>[m AES</div><div>[14d</div><div>[0;1m</div><div>[31m# =============================================================================</div><div>[15d#  CONFIGURATION</div><div>[16d# =============================================================================</div><div>[17d</div><div>[39m</div><div>[mAES_KEY =</div><div>[0;1m</div><div>[32m'd3Adb3Efc4Feb4Be'</div><div>[18d</div><div>[31m# =============================================================================</div><div>[19d#  FUNCTIONS</div><div>[20d# =============================================================================</div><div>[21d</div><div>[36mdef</div><div>[34m interrupt_hdlr</div><div>[39m</div><div>[m(*args):</div><div>[22;5Hexit(1)</div><div>[24d</div><div>[0;1m</div><div>[36mdef</div><div>[34m encrypt</div><div>[39m</div><div>[m(data):</div><div>[25;5Hcipher = AES.new(AES_KEY, AES.MODE_ECB)</div><div>[27;5Hpad_sz = 16 - len(data) % 16</div><div>[28;5Hpad_chr = hex(pad_sz)[2]</div><div>[29;5Hpad = pad_sz * pad_chr.encode()</div><div>[31;5H</div><div>[0;1m</div><div>[36mreturn</div><div>[39m</div><div>[m cipher.encrypt(data + pad)</div><div>[33d</div><div>[0;1m</div><div>[36mdef</div><div>[34m parse_args</div></div><div>大致可以看出是一段Python脚本，执行内容为ECB模式的AES加密，密钥为d3Adb3Efc4Feb4Be。</div><div><br/></div><div>用该密钥对之前从pcap文件中提取出的36段base64格式密文进行解密：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>import base64</div><div>from Crypto.Cipher import AES</div><div><br/></div><div>f = open('C:/Users/Administrator/Desktop/SCN', 'r').read()</div><div>f = f.split('|NCSSCN|')</div><div>f[0] = f[0][4:]</div><div>f[-1] = f[-1][:-4]</div><div><br/></div><div>key = b'd3Adb3Efc4Feb4Be'</div><div>for i in f:</div><div>    cipher = base64.decodebytes(bytes(i, encoding = 'utf-8'))</div><div>    aes = AES.new(key, AES.MODE_ECB)</div><div>    print(aes.decrypt(cipher))</div></div><div>输出结果中可以明显看到PNG文件头，修改脚本，将解密结果保存为png格式图片：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>for i in range(len(f)):</div><div>    cipher = base64.decodebytes(bytes(f[i], encoding = 'utf-8'))</div><div>    aes = AES.new(key, AES.MODE_ECB)</div><div>    res = aes.decrypt(cipher)</div><div>    img = open('C:/Users/Administrator/Desktop/img/' + str(i) + '.png', 'wb')</div><div>    img.write(res)</div></div><div>得到36张窗口截图：</div><div><img src="BUUCTF Misc 56（269-272）_files/Image [1].png" type="image/png" data-filename="Image.png"/></div><div>其中14-18.png、20-33.png和35.png等图片中可以看到flag：</div><div><img src="BUUCTF Misc 56（269-272）_files/14.png" type="image/png" data-filename="14.png"/></div><div><br/></div><div>记录一下用volatility进行Linux内存取证的Writeup：</div><div><a href="https://0x90r00t.com/2018/04/08/inshack-2018-forensics-400-taking-a-look-inside-write-up/">https://0x90r00t.com/2018/04/08/inshack-2018-forensics-400-taking-a-look-inside-write-up/</a></div><div><br/></div><div>flag：  <span style="font-size: unset; color: unset; font-family: unset;">INSA{aa80467558a76019b99ecec7b4f6d0c7}</span></div></span>
</div></body></html> 