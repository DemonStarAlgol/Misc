<html>
<head>
  <title>BUUCTF Misc 63（297-300）</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/605894 (zh-CN, DDL); Windows/6.1.1 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="2506"/>
<h1>BUUCTF Misc 63（297-300）</h1>
<h2><a href="https://DemonStarAlgol.github.io/Misc/">[无关链接]</a></h2>

<div>
<span><div>2020.12.27上线的羊城杯2020题目，序号接着前面的往下写，以题目名称为准。</div><div><br/></div><div><span style="font-weight: bold;">297 [羊城杯 2020]逃离东南亚</span></div><div><br/></div><div>下载得到日记1-3共三个zip压缩包。依次查看，日记1.zip中包含日记.md和img.png：</div><div><img src="BUUCTF Misc 63（297-300）_files/Image.png" type="image/png" data-filename="Image.png" width="1064"/></div><div>日记.md中是一些<a href="https://zhuanlan.zhihu.com/p/114503214">舔狗日记</a>的节选。查看img.png，Linux下显示CRC错误，说明高度被修改过，爆破高度：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>import struct</div><div>import binascii</div><div>from Crypto.Util.number import bytes_to_long</div><div><br/></div><div>img = open('C:/Users/Administrator/Desktop/img.png', 'rb').read()</div><div><br/></div><div>for i in range(0xFFFF):</div><div>    stream = img[12:20] + struct.pack('&gt;i', i) + img[24:29]</div><div>    crc = binascii.crc32(stream)</div><div>    if crc == bytes_to_long(img[29:33]):</div><div>        print(hex(i))</div></div><div>输出结果：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>0x12c</div></div><div>在十六进制编辑器中修改高度为0x12c (300)，得到图片：</div><div><img src="BUUCTF Misc 63（297-300）_files/img.png" type="image/png" data-filename="img.png" width="249"/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>zip_pwd: wdnmd</div></div><div><br/></div><div>接下来看日记2.zip，是一个加密压缩包：</div><div><img src="BUUCTF Misc 63（297-300）_files/Image [1].png" type="image/png" data-filename="Image.png" width="1064"/></div><div>密码为wdnmd，解压得到三个文件。日记.md里仍然是日记内容，提及了两个信息，打架.wav是日记主人录的音频，以及test是日记主人尝试信息隐藏写的程序。查看test，实际是个文本：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>[&gt;&gt;++&gt;++++&gt;++++++&gt;++++++++&gt;++++++++++&gt;++++++++++++&gt;++++++++++++++&gt;++++++++++++++++&gt;++++++++++++++++++&gt;++++++++++++++++++++&gt;++++++++++++++++++++++&gt;++++++++++++++++++++++++&gt;++++++++++++++++++++++++++&gt;++++++++++++++++++++++++++++&gt;++++++++++++++++++++++++++++++&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;&gt;&gt;&gt;++++++.&lt;&lt;&lt;.&gt;&gt;++++++.---------.+++++.&gt;+.</div><div>……（后略）</div></div><div>很明显是Brainfuck，但<a href="https://www.splitbrain.org/services/ook">在线工具</a>解码只能得到乱码。注意到这段代码的首个操作符是[，根据Brainfuck操作符的<a href="https://zh.wikipedia.org/wiki/Brainfuck">说明</a>，“[”的含义是“如果指针指向的单元值为零，向后跳转到对应的]指令的次一指令处”。由于在Brainfuck中，初始状态下数组的值为0，指针也指向该数组，因此在一开始就执行[操作符是没有意义的。事实上，如果用在线工具将字符串转为Brainfuck，会发现开头必然是数个+号后接[操作符。手动爆破一下，发现在开头添加8个+号即可正确转为字符串，结果为：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>f0VMRgIBAQAAAAAAAAAAAAIAPgABAAAAcARAAAAAAABAAAAAAAAAAJgaAAAAAAAAAAAAAEAAOAAJAEAAHwAcAAYAAAAFAAAAQAAAAAAAAABAAEAAAAAAAEAAQAAAAAAA+AEAAA</div><div>……（后略）</div></div><div>很明显是base64，直接转码，在开头发现ELF字样。将其转码为文件，提权后尝试运行：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop# cat 1.txt | base64 -d &gt; out</div><div>root@kali:~/Desktop# ./out</div><div>bash: ./out: 权限不够</div><div>root@kali:~/Desktop# chmod 755 ./out</div><div>root@kali:~/Desktop# ./out</div><div>hei~what you want??</div><div>want a flag?</div><div>sorry~there is no flag</div><div>but maybe your can find something useful!</div></div><div>没有更多信息了，尝试IDA打开，Shift+F12查看字符串：</div><div><img src="BUUCTF Misc 63（297-300）_files/Image [2].png" type="image/png" data-filename="Image.png" width="807"/></div><div>注意到最后一行is there anything?没有出现在运行结果中，双击跟踪：</div><div><img src="BUUCTF Misc 63（297-300）_files/Image [3].png" type="image/png" data-filename="Image.png" width="677"/></div><div>右键发现可疑信息：</div><div><img src="BUUCTF Misc 63（297-300）_files/Image [4].png" type="image/png" data-filename="Image.png" width="454"/></div><div>事实上，E4 B9 9F就是汉字“也”的UTF-8编码。这里可以直接利用IDA的快捷键A将全部十六进制数据转成对应汉字：</div><div><img src="BUUCTF Misc 63（297-300）_files/Image [5].png" type="image/png" data-filename="Image.png" width="622"/></div><div>提示LSB隐写，联想到打架.wav，以及在波形音频文件中进行LSB隐写的工具SilentEye：</div><div><img src="BUUCTF Misc 63（297-300）_files/Image [6].png" type="image/png" data-filename="Image.png" width="678"/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>This1sThe3rdZIPpwd</div></div><div><br/></div><div>用该字符串作为密码解压日记3.zip，得到日记.md和source_code文件夹。从日记.md得到提示，<span style="font-size: unset; color: unset; font-family: unset;">源码中包含隐藏信息，且隐藏信息不影响编译。因此编译结果中已经不包含隐藏信息，信息很可能在源码文件内容中。查看README文件：</span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>This directory contains the sources of the GNU C Library.</div><div>See the file &quot;version.h&quot; for what release version you have.</div><div>……（后略）</div></div><div><span style="font-size: unset; color: unset; font-family: unset;">以及ChangeLog文件：</span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>2018-08-01  Carlos O'Donel  &lt;carlos@redhat.com&gt;</div><div><br/></div><div>    * version.h (RELEASE): Set to &quot;stable&quot;.</div><div>    (VERSION): Set to &quot;2.28&quot;.</div><div>    * include/features.h (__GLIBC_MINOR__): Set to 2.28.</div><div>    * NEWS: Add the list of bugs fixed in 2.28.</div><div>……（后略）</div></div><div>所以这其实是GNU C Library的源码，且版本是2018年8月1日更新的2.28，在Github上搜索找到<a href="https://github.com/bminor/glibc/tree/3c03baca37fdcb52c3881e653ca392bba7a99c2b">该版本</a>，肉眼对比几个文件，确认内容是一致的。下载整个库，用Beyond Compare的“文件夹比较”功能：</div><div><img src="BUUCTF Misc 63（297-300）_files/Image [7].png" type="image/png" data-filename="Image.png" width="1632"/></div><div>结果Github上下载到的源码文件夹比较多……删掉这些文件夹，并在设置中取消“比较时间戳”：</div><div><img src="BUUCTF Misc 63（297-300）_files/Image [8].png" type="image/png" data-filename="Image.png" width="707"/></div><div>再比较一次：</div><div><img src="BUUCTF Misc 63（297-300）_files/Image [9].png" type="image/png" data-filename="Image.png" width="1632"/></div><div>只剩下3个文件存在差异，查看一下差异内容：</div><div><img src="BUUCTF Misc 63（297-300）_files/Image [10].png" type="image/png" data-filename="Image.png" width="1632"/></div><div>可以从下方的对比看出，两个文件的差异在于题目附件所给的源代码多出了大量空格和Tab。容易想到这些字符可能组成了二进制数字串/摩斯电码/培根密码等密文。进一步观察，发现这些多出的字符基本上都跟在 } 的后面，且均为8个一组，均以空格开头。很明显，应把空格替换为0，Tab替换为1，然后进行二进制ASCII转码。写Python脚本遍历这三个文件并转码：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>def decode(file):</div><div>    f = open(file).readlines()</div><div>    for l in f:</div><div>        res = ''</div><div>        if '} ' in l:</div><div>            s = l[l.find('}') + 1:]</div><div>            for i in s.replace('\n', ''):</div><div>                if i == ' ':</div><div>                    res += '0'</div><div>                elif i == '\t':</div><div>                    res += '1'</div><div>                else:</div><div>                    res = ''</div><div>            if len(res) == 8:</div><div>                print(chr(int(res, 2)), end = '')</div><div>    print('')</div><div><br/></div><div>decode('C:/Users/Administrator/Desktop/source_code/elf/rtld.c')</div><div>decode('C:/Users/Administrator/Desktop/source_code/malloc/arena.c')</div><div>decode('C:/Users/Administrator/Desktop/source_code/malloc/malloc.c')</div></div><div>输出结果：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>SOS! please help me -&gt; rtld.c</div><div>your flag is in malloc.c</div><div>GWCTF{code_steganography_1s_funny!}</div></div><div><br/></div><div>flag：GWCTF{code_steganography_1s_funny!}</div><div><br/></div><div><span style="font-weight: bold;">298 [羊城杯 2020]TCP_IP</span></div><div><br/></div><div>下载得到pcap格式文件，wireshark打开：</div><div><img src="BUUCTF Misc 63（297-300）_files/Image [11].png" type="image/png" data-filename="Image.png" width="910"/></div><div>先观察一下流量包内容，除开头两个ARP协议数据包外均为TCP协议，共有58条TCP流。追踪流发现每条流的内容均为一句英语听力对话，除此以外没有其他信息。根据流量分析题的经验，隐藏信息应该在数据包的其他属性中（例如数据包长度等）。依次查看数据包，重点关注每个数据包之间除了数据（Data）以外有变化的部分。首先是17-18字节：</div><div><img src="BUUCTF Misc 63（297-300）_files/Image [12].png" type="image/png" data-filename="Image.png" width="718"/></div><div>这两字节对应的是Total Length即数据包总长度，但容易发现33号包的长度为195，超出ASCII可打印字符范围。此外数据包中的英语听力对话语义上是连贯的，恐怕很难在长度上进行隐写。</div><div>接下来注意到第19-20字节：</div><div><img src="BUUCTF Misc 63（297-300）_files/Image [13].png" type="image/png" data-filename="Image.png" width="716"/></div><div>这两字节对应的是Identification。查询<a href="https://www.cnblogs.com/liquan2005/p/9113369.html">TCP/IP协议头部结构</a>，这一部分用来唯一地标识主机发送的每一份数据报，通常每发一份报文，它的值会加1。然而在本题的流量包中，前几个TCP包的Identification依次是64、105、72、60、44，不符合每一份报文加1的规律，甚至也不是单调递增的。另一方面，注意到所有TCP包的这一字段均在ASCII可打印字符范围内，非常可疑。用tshark将其提取：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop# tshark -r attachment.pcap -Y &quot;tcp&quot; -T fields -e ip.id | cut -c9- | xargs</div><div>Running as user &quot;root&quot; and group &quot;root&quot;. This could be dangerous.</div><div>40 69 48 3c 2c 7b 2a 3b 6f 55 70 2f 69 6d 22 51 50 6c 60 79 52 2a 69 65 7d 4e 4b 3b 2e 44 21 58 75 29 62 3a 4a 5b 52 6a 2b 36 4b 4b 4d 37 50 40 69 48 3c 2c 7b 2a 3b 6f 55 70 2f 69 6d 22 51 50 6c 60 79 52</div></div><div>十六进制ASCII转码：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>@iH&lt;,{*;oUp/im&quot;QPl`yR*ie}NK;.D!Xu)b:J[Rj+6KKM7P@iH&lt;,{*;oUp/im&quot;QPl`yR</div></div><div>看着就很像某种base，base全家桶的脚本跑一下：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>import base64</div><div>import base58</div><div>import base36</div><div>import base62</div><div>import base91</div><div>import py3base92</div><div><br/></div><div>encodeStr = b'@iH&lt;,{*;oUp/im&quot;QPl`yR*ie}NK;.D!Xu)b:J[Rj+6KKM7P@iH&lt;,{*;oUp/im&quot;QPl`yR'</div><div>try:</div><div>    print('base16decode:', base64.b16decode(encodeStr))</div><div>except:</div><div>    print('not base16')</div><div>try:</div><div>    print('base32decode:', base64.b32decode(encodeStr))</div><div>except:</div><div>    print('not base32')</div><div>try:</div><div>    print('base36decode:', base36.loads(encodeStr))</div><div>except:</div><div>    print('not base36')</div><div>try:</div><div>    print('base58decode:', base58.b58decode(encodeStr))</div><div>except:</div><div>    print('not base58')</div><div>try:</div><div>    print('base62decode:', base62.decode(encodeStr))</div><div>except:</div><div>    print('not base62')</div><div>try:</div><div>    print('base64decode:', base64.b64decode(encodeStr))</div><div>except:</div><div>    print('not base64')</div><div>try:</div><div>    print('base85decode:', base64.b85decode(encodeStr))</div><div>except:</div><div>    print('not base85')</div><div>try:</div><div>    print('ascii85decode:', base64.a85decode(encodeStr))</div><div>except:</div><div>    print('not ascii85')</div><div>try:</div><div>    print('base91decode:', base91.decode(encodeStr.decode()))</div><div>except:</div><div>    print('not base91')</div><div>try:</div><div>    print('base92decode:', py3base92.decode(encodeStr.decode()))</div><div>except:</div><div>    print('not base92')</div></div><div>输出结果：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>not base16</div><div>not base32</div><div>not base36</div><div>not base58</div><div>not base62</div><div>base64decode: b&quot;\x88z\x14\xa7\xf8\xa6@\xf9rF'\x8d(5\xeel\x94c\xfb\xa2\x8a3\xb3\xe2\x1e\x85)\xfe)\x90&gt;\\\x91&quot;</div><div>not base85</div><div>not ascii85</div><div>base91decode: bytearray(b'flag{wMt84iS06mCbbfuOfuVXCZ8MSsAFN1GA\xfd\xe3\x9f&quot;1w\xe3Aw\xea\xbe\x18\tXV\xb8|\x8f')</div><div>not base92</div></div><div>base91有结果，但末尾有大量不可打印字符，说明密文实际上没有那么长。可以尝试将密文末尾字符依次删除直到解码结果符合flag格式为止，也可以将这里的解码结果从第一个不可打印字符开始全部删掉，再补上半个大括号}。</div><div><br/></div><div>flag：flag{wMt84iS06mCbbfuOfuVXCZ8MSsAFN1GA}</div><div><br/></div><div><span style="font-weight: bold;">299 [羊城杯 2020]badapple</span></div><div><br/></div><div>下载得到mp4文件，总之先播放一下。视频内容就是正常的《Bad Apple》原版MV，但开头的音乐听起来像是有某种信号杂音。把音频部分提取出来，用audacity打开：</div><div><img src="BUUCTF Misc 63（297-300）_files/Image [14].png" type="image/png" data-filename="Image.png" width="823"/></div><div>没有找到单独的信号音声道，说明已经和原始音频合成了。再看一下频谱图：</div><div><img src="BUUCTF Misc 63（297-300）_files/Image [15].png" type="image/png" data-filename="Image.png" width="1058"/></div><div>可以看到明显的长音和短音，且基本为5个一组，很可能是摩斯电码。需要注意的是除了开头部分有摩斯电码，结尾部分也有：</div><div><img src="BUUCTF Misc 63（297-300）_files/Image [16].png" type="image/png" data-filename="Image.png" width="1466"/></div><div><br/></div><div>尝试了一下低通滤波后保存为频谱图：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop# sox badapple.wav -n lowpass 1k spectrogram -x 4000 -y 200 -o spec.png</div></div><div><img src="BUUCTF Misc 63（297-300）_files/spec.png" type="image/png" data-filename="spec.png" width="4135"/></div><div>可以看到结尾部分的摩斯电码还是比较清晰的，应该可以借助图像识别来处理。不过脚本写不来，徒手记录一下算了：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>开头：</div><div>.---- ----- .---- .-.-. ----. ----. .-.-. .---- .---- .---- .-.-. .---- .---- ----- .-.-. .---- ----- ----- .-.-. ..... ----- .-.-. ----. ----. .-.-. .---- .---- .---- .-.-. .---- ----- ----. .-.-. .---- ----- .---- .-.-. .---- .---- .....</div><div><br/></div><div>结尾：</div><div>.---- ----- ....- .-.-. .---- .---- -.... .-.-. .---- .---- -.... .-.-. .---- .---- ..--- .-.-. ..... ---.. .-.-. ....- --... .-.-. ....- --... .-.-. ....- ----. .-.-. ..... ----- .-.-. ..... --... .-.-. ....- -.... .-.-. ..... ----- .-.-. ....- ---.. .-.-. ..... ..--- .-.-. ....- -.... .-.-. ....- ----. .-.-. ..... -.... .-.-. ..... --... .-.-. ....- -.... .-.-. ..... ----- .-.-. ..... ...-- .-.-. ..... ..--- .-.-. ..... ---.. .-.-. ..... ....- .-.-. ..... ....- .-.-. ..... ....-</div><div><br/></div><div>..... ....- .-.-. ....- --... .-.-. .---- ----- ----. .-.-. .---- .---- .---- .-.-. .---- .---- .---- .-.-. .---- .---- ----- .-.-. ....- --... .-.-. ...-- ..--- .-.-. --... .---- .-.-. ---.. --... .-.-. --... ..--- .-.-. ---.. ....- .-.-. .---- ..--- ...-- .-.-. .---- ----- ..--- .-.-. .---- ----- ..... .-.-. .---- .---- ....- .-.-. .---- .---- ..... .-.-. .---- .---- -.... .-.-. ....- ----. .-.-. ----. --... .-.-. .---- .---- ..--- .-.-. .---- .---- ..--- .-.-. .---- ----- .---- .-.-. ----. --... .-.-. .---- .---- ....- .-.-. .---- .---- ..... .-.-. .---- ----- ....- .-.-. .---- ----- .---- .-.-. .---- .---- ....- .-.-. .---- ----- .---- .-.-. ----. ..... .-.-. .---- .---- ..... .- ....</div></div><div>转码：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>开头：</div><div>101+99+111+110+100+50+99+111+109+101+115</div><div>结尾：</div><div>104+116+116+112+58+47+47+49+50+57+46+50+48+52+46+49+56+57+46+50+53+52+58+54+54+54</div><div>54+47+109+111+111+110+47+32+71+87+72+84+123+102+105+114+115+116+49+97+112+112+101+97+114+115+104+101+114+101+95+115AH</div></div><div>以+号为分隔符，十进制ASCII转码：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>开头：</div><div>econd2comes</div><div>结尾：</div><div>http://129.204.189.254:666</div><div>6/moon/ GWHT{first1appearshere_s</div></div><div>得到了两段字符串和一个网址，但这个网址似乎已经上不去了，服务器也ping不通，可能已经关掉了……</div><div><br/></div><div>记录一下后续步骤的Writeup：</div><div><a href="https://blog.csdn.net/weixin_45883223/article/details/108532440">https://blog.csdn.net/weixin_45883223/article/details/108532440</a></div><div><br/></div><div>flag：GWHT{first1appearshere_second2comes_third3isnttheend_youwin!!!}</div><div>BUUCTF上需要交这个flag：flag{first1appearshere_second2comes_third3isnttheend_youwin}</div><div><br/></div><div><span style="font-weight: bold;">300 [羊城杯 2020]signin</span></div><div><br/></div><div>下载得到txt格式文件，内容：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>BCEHACEIBDEIBDEHBDEHADEIACEGACFIBDFHACEGBCEHBCFIBDEGBDEGADFGBDEHBDEGBDFHBCEGACFIBCFGADEIADEIADFH</div></div><div>是一串只有A-I九个字母的字符串，共96位。尝试搜索crypto with ABCDEFGHI、cipher only ABCDEFGHI等关键词都没有结果，最后发现这题原来是有提示的：toy密码。</div><div><br/></div><div>搜素toy cipher找到论文预印本：<a href="https://eprint.iacr.org/2020/301.pdf" style="font-size: unset; font-family: unset;">https://eprint.iacr.org/2020/301.pdf</a>。密码本身的算法原理和论文内容都不重要，注意到论文第二页给出的两个替换密码表：</div><div><img src="BUUCTF Misc 63（297-300）_files/Image [17].png" type="image/png" data-filename="Image.png" width="865"/></div><div>很明显题目给出的密文就是用这两个表加密的。（也因此直接根据密文特征搜索找不到任何信息，因为这两个替换表在论文中仅仅是作为举例给出的，并没有真正的刚好使用这两个替换表的某种成型的密码算法。）尝试解密：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>BCEH ACEI BDEI BDEH BDEH ADEI ACEG ACFI BDFH ACEG BCEH BCFI</div><div>L    D    V    U    U    C    M    E    X    M    L    Q</div><div>BDEG BDEG ADFG BDEH BDEG BDFH BCEG ACFI BCFG ADEI ADEI ADFH</div><div>S    S    F    U    S    X    K    E    O    C    C    G</div></div><div>直接包上flag格式提交提示错误。再观察一下这段解密结果，从其他题目已知羊城杯2020的flag格式是GW开头的，注意到G-L和W-D两组字母在上述替换表中正好都呈中心对称关系。尝试按同样的规律对其他字母也进行替换：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>s = 'LDVUUCMEXMLQSSFUSXKEOCCG'</div><div>dic = 'MADHTERBCFGIKLNOPQSUVWXY'</div><div><br/></div><div>for i in s:</div><div>    print(dic[len(dic) - 1 - dic.find(i)], end = '')</div></div><div>输出结果：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>GWHTTOYSAYGREENTEAISCOOL</div></div><div><br/></div><div>flag：GWHT{TOYSAYGREENTEAISCOOL}</div></span>
</div></body></html> 