<html>
<head>
  <title>CTFshow Misc 4（13-16）</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/605894 (zh-CN, DDL); Windows/6.1.1 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="2312"/>
<h1>CTFshow Misc 4（13-16）</h1>
<h2><a href="https://DemonStarAlgol.github.io/Misc/">[无关链接]</a></h2>

<div>
<span><div><span style="font-weight: bold;">13 stega11</span></div><div><br/></div><div>下载得到jpg格式文件，十六进制编辑器打开，文件尾后有额外数据：</div><div><img src="CTFshow Misc 4（13-16）_files/Image.png" type="image/png" data-filename="Image.png"/></div><div>提取得到一串疑似base32编码以及另一张jpg格式图片：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>MZWGCZ33GZTDCNZZG5SDIMBYGBRDEOLCGY2GIYJVHA4TONZYGA2DMM3FGMYH2</div></div><div>解码得到：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>flag{6f1797d4080b29b64da5897780463e30}</div></div><div><br/></div><div>flag：flag{6f1797d4080b29b64da5897780463e30}</div><div><br/></div><div><span style="font-weight: bold;">14 misc4</span></div><div><br/></div><div>下载得到doc格式文件，直接打开报错：</div><div><img src="CTFshow Misc 4（13-16）_files/Image [1].png" type="image/png" data-filename="Image.png"/></div><div>尝试修复或用LibreOffice打开均无效。十六进制编辑器查看，发现zip格式文件头，将其作为压缩包打开：</div><div><img src="CTFshow Misc 4（13-16）_files/Image [2].png" type="image/png" data-filename="Image.png"/></div><div>逐个查看文件，在\Documents\1\Pages\1.fpage找到线索：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>&lt;Glyphs Name=&quot;a4&quot; BidiLevel=&quot;0&quot; Fill=&quot;#FF000000&quot;</div><div>  FontUri=&quot;/Resources/71DC1C0E-6285-77FF-2208-3511F4077B72.odttf&quot;</div><div>  FontRenderingEmSize=&quot;10.56&quot; StyleSimulations=&quot;None&quot; OriginX=&quot;90.024&quot;</div><div>  OriginY=&quot;99.024&quot; <font color="#FF0000">UnicodeString=&quot;f&quot;</font> Indices=&quot;&quot; xml:lang=&quot;en-US&quot;&gt;</div><div>  &lt;/Glyphs&gt;</div><div>  &lt;Glyphs Name=&quot;a5&quot; BidiLevel=&quot;0&quot; Fill=&quot;#FF000000&quot;</div><div>  FontUri=&quot;/Resources/71DC1C0E-6285-77FF-2208-3511F4077B72.odttf&quot;</div><div>  FontRenderingEmSize=&quot;10.56&quot; StyleSimulations=&quot;None&quot; OriginX=&quot;93.264&quot;</div><div>  OriginY=&quot;99.024&quot; UnicodeString=&quot; &quot; Indices=&quot;&quot; xml:lang=&quot;en-US&quot;&gt;</div><div>  &lt;/Glyphs&gt;</div><div>  &lt;Glyphs Name=&quot;a6&quot; BidiLevel=&quot;0&quot; Fill=&quot;#FF000000&quot;</div><div>  FontUri=&quot;/Resources/71DC1C0E-6285-77FF-2208-3511F4077B72.odttf&quot;</div><div>  FontRenderingEmSize=&quot;10.56&quot; StyleSimulations=&quot;None&quot; OriginX=&quot;90.024&quot;</div><div>  OriginY=&quot;114.62&quot; <font color="#FF0000">UnicodeString=&quot;l&quot;</font> Indices=&quot;&quot; xml:lang=&quot;en-US&quot;&gt;</div><div>  &lt;/Glyphs&gt;</div><div>  &lt;Glyphs Name=&quot;a7&quot; BidiLevel=&quot;0&quot; Fill=&quot;#FF000000&quot;</div><div>  FontUri=&quot;/Resources/71DC1C0E-6285-77FF-2208-3511F4077B72.odttf&quot;</div><div>  FontRenderingEmSize=&quot;10.56&quot; StyleSimulations=&quot;None&quot; OriginX=&quot;92.424&quot;</div><div>  OriginY=&quot;114.62&quot; UnicodeString=&quot; &quot; Indices=&quot;&quot; xml:lang=&quot;en-US&quot;&gt;</div><div>  &lt;/Glyphs&gt;</div><div>  &lt;Glyphs Name=&quot;a8&quot; BidiLevel=&quot;0&quot; Fill=&quot;#FF000000&quot;</div><div>  FontUri=&quot;/Resources/71DC1C0E-6285-77FF-2208-3511F4077B72.odttf&quot;</div><div>  FontRenderingEmSize=&quot;10.56&quot; StyleSimulations=&quot;None&quot; OriginX=&quot;90.024&quot;</div><div>  OriginY=&quot;130.22&quot; <font color="#FF0000">UnicodeString=&quot;a&quot;</font> Indices=&quot;&quot; xml:lang=&quot;en-US&quot;&gt;</div><div>  &lt;/Glyphs&gt;</div><div>  &lt;Glyphs Name=&quot;a9&quot; BidiLevel=&quot;0&quot; Fill=&quot;#FF000000&quot;</div><div>  FontUri=&quot;/Resources/71DC1C0E-6285-77FF-2208-3511F4077B72.odttf&quot;</div><div>  FontRenderingEmSize=&quot;10.56&quot; StyleSimulations=&quot;None&quot; OriginX=&quot;95.064&quot;</div><div>  OriginY=&quot;130.22&quot; UnicodeString=&quot; &quot; Indices=&quot;&quot; xml:lang=&quot;en-US&quot;&gt;</div><div>  &lt;/Glyphs&gt;</div><div>  &lt;Glyphs Name=&quot;a10&quot; BidiLevel=&quot;0&quot; Fill=&quot;#FF000000&quot;</div><div>  FontUri=&quot;/Resources/71DC1C0E-6285-77FF-2208-3511F4077B72.odttf&quot;</div><div>  FontRenderingEmSize=&quot;10.56&quot; StyleSimulations=&quot;None&quot; OriginX=&quot;90.024&quot;</div><div>  OriginY=&quot;145.82&quot; <font color="#FF0000">UnicodeString=&quot;g&quot;</font> Indices=&quot;&quot; xml:lang=&quot;en-US&quot;&gt;</div><div>  &lt;/Glyphs&gt;</div></div><div>按照规律逐个提取字符，得到：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>flag{}{xps?Oh,Go0d!}</div></div><div><br/></div><div>flag：flag{xps?Oh,Go0d!}</div><div><br/></div><div><span style="font-weight: bold;">15 红包题第四弹</span></div><div><br/></div><div>这好像是道web题，至少是道Javascipt代码审计……</div><div>先记录一下Writeup：<a href="https://blog.csdn.net/qq_42016346/article/details/104910937">https://blog.csdn.net/qq_42016346/article/details/104910937</a></div><div><br/></div><div>flag：flag{hong_bao_wo_bu_ling_le}</div><div><br/></div><div><b>16 misc31</b></div><div><br/></div><div>下载得到zip格式文件：</div><div><img src="CTFshow Misc 4（13-16）_files/Image [3].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>先看未加密的文件，hint.txt：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>让你听歌识曲就听歌识曲哦，别想太多哦~</div></div><div>打开听歌识曲.mp3听一下，通过歌词搜索得到歌名和歌手：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>关键词（林俊杰）</div></div><div><br/></div><div>file实际也是个文本：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>/9j/4AAQSkZJRgABAQAASABIAAD/4QBYRXhpZgAATU0AKgAAAAgAAgESAAMAAAABAAEAAIdpAAQAAAABAAAAJgAAAAAAA6ABAAMAAAABAA</div><div>……（后略）</div></div><div>显然是base64编码后的jpg格式图片，解码成图片：</div><div><img src="CTFshow Misc 4（13-16）_files/download.jpg" type="image/jpeg" data-filename="download.jpg"/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>dlddddhm</div></div><div>用该密码解压得到送你几朵小fafa.pdf：</div><div><img src="CTFshow Misc 4（13-16）_files/Image [4].png" type="image/png" data-filename="Image.png"/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>✿✼✿❂❀❀✿✽✿✿✿❄✿❀❀❄❀❊✿✻=</div></div><div>看到这种末尾带=号的奇怪字符加密，基本上可以在<a href="https://www.qqxiuzi.cn/">千千秀字</a>找到<a href="https://www.qqxiuzi.cn/bianma/wenbenjiami.php?s=huaduo">解密工具</a>，解密得到：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>qwertyuiop</div></div><div>同时用wbStego还可以提取出该pdf文件中的隐写信息，密码留空：</div><div><img src="CTFshow Misc 4（13-16）_files/Image [5].png" type="image/png" data-filename="Image.png"/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>ENTYNSTLWNRNTKYW13287484</div></div><div><br/></div><div>整理一下，目前仍然未知的信息是xiaomotuo.wav的解压密码，已知的提示为“关键词”，已知的信息为从pdf文件中得到的两段字符串。猜测需要使用某种带密钥的密码，将两段字符串之一作为密文，另一端为密钥。搜索找到<a href="http://ctf.ssleye.com/keyword.html">关键字密码</a>，尝试后发现密文为ENTYNSTLWNRNTKYW13287484，密钥为qwertyuiop。解密得到：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>CVEFVWETBVDVESFB13287484</div></div><div>以此为密码解压得到xiaomotuo.wav，查看波形、频谱和文件信息均无可疑线索。尝试可用于wav音频的隐写工具，steghide发现隐藏信息：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>D:\CTFToolkit-v1.1.0\信息隐藏\steghide&gt;steghide.exe info xiaomotuo.wav</div><div>&quot;xiaomotuo.wav&quot;:</div><div>  format: wave audio, PCM encoding</div><div>  capacity: 352.1 KB</div><div>Try to get information about embedded data ? (y/n) y</div></div><div>提取隐写信息需要密码，尝试后发现密码为文件名xiaomotuo：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>Try to get information about embedded data ? (y/n) y</div><div>Enter passphrase:<font style="color: rgb(255, 0, 0);">（输入密码xiaomotuo）</font></div><div>  embedded file &quot;flag.txt&quot;:</div><div>    size: 17.0 Byte</div><div>    encrypted: rijndael-128, cbc</div><div>    compressed: yes</div></div><div>找到了隐写内容flag.txt，将其提取：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>D:\CTFToolkit-v1.1.0\信息隐藏\steghide&gt;steghide.exe extract -sf xiaomotuo.wav</div><div>Enter passphrase:<font color="#FF0000">（输入密码xiaomotuo）</font></div><div>wrote extracted data to &quot;flag.txt&quot;.</div></div><div>打开flag.txt得到flag。</div><div><br/></div><div>flag：flag{du_du_du_du}</div></span>
</div></body></html> 