<html>
<head>
  <title>CTFshow Misc 11（41-44）</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/605894 (zh-CN, DDL); Windows/6.1.1 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="2744"/>
<h1>CTFshow Misc 11（41-44）</h1>
<h2><a href="https://DemonStarAlgol.github.io/Misc/">[无关链接]</a></h2>

<div>
<span><div><span style="font-weight: bold;">41 Everyday One Cat</span></div><div>题目描述：图片无隐写，flag是图片发布日期</div><div><br/></div><div>下载得到gif格式文件：</div><div><img src="CTFshow Misc 11（41-44）_files/flagcat.gif" type="image/gif" data-filename="flagcat.gif"/></div><div><br/></div><div>Google图片搜索，得知该系列图片为#EVE ONE CAT或#everyday one cat。</div><div><img src="CTFshow Misc 11（41-44）_files/Image.png" type="image/png" data-filename="Image.png"/></div><div>根据常识可以知道这肯定是日本人画的，日本人画表情包多半就会发到twitter上，搜索到twitter账号：</div><div><img src="CTFshow Misc 11（41-44）_files/Image [1].png" type="image/png" data-filename="Image.png"/></div><div>在“媒体”分类里一路往下翻就找到了对应图片：</div><div><img src="CTFshow Misc 11（41-44）_files/Image [2].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>flag：flag{20190915}</div><div><br/></div><div><span style="font-weight: bold;">42 吾有一言</span></div><div><br/></div><div>下载得到无扩展名的文件wy，实质是个文本。开头内容：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>吾有一術。名之曰「獲取」</div><div>欲行是術。必先得一物。曰「對象」。一物。曰「域」。</div><div>乃行是術曰。</div><div>    乃得  對象[域]</div><div>是謂「獲取」之術也。</div><div><br/></div><div>批曰。「「============」」</div><div>吾有一術。名之曰「因戴克斯」</div><div>欲行是術。必先得一物。曰「爱特姆」。</div><div>乃行是術曰。</div><div>    吾有一言。曰「「鼠牛虎兔龍蛇马羊猴鸡狗猪」」。名之曰「忒博欧」</div><div>    夫「忒博欧」之長。    名之曰「难博」。</div><div>    吾有一數。名之曰「i」</div><div>    恆為是。</div></div><div>注意到存在类似于定义、赋值、注释、循环的语句，以及tabel、number、index等音。猜测这可能是一种把程序语言以文言文形式表现出来的esolang。搜索“文言 编程”找到<a href="https://github.com/wenyan-lang/wenyan">文言 wenyan-lang</a>，及其<a href="https://ide.wy-lang.org/">在线IDE</a>。</div><div><img src="CTFshow Misc 11（41-44）_files/Image [3].png" type="image/png" data-filename="Image.png"/></div><div>注意到原程序仅定义了方法，并未调用。用在线IDE转换得到js代码后，手动添加一行调用方法输出flag：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>弗萊格();</div></div><div>然后运行得到flag。</div><div><br/></div><div>flag：flag{can~you~speak~chi~ness~}</div><div><br/></div><div><span style="font-weight: bold;">43 红包题 九阴真经</span></div><div><br/></div><div>下载得到jpg格式文件，十六进制编辑器打开，文件尾后有额外数据：</div><div><img src="CTFshow Misc 11（41-44）_files/Image [4].png" type="image/png" data-filename="Image.png"/></div><div>将这段数据手动提取后保存为文件，在Linux下用file命令查看文件类型：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop# file 1</div><div>1: UTF-8 Unicode text, with CRLF line terminators</div></div><div>显然，这是一个在Windows下生成的UTF-8编码文本，打开：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>前言：</div><div>上个世纪末，考古工作者在登州栖霞镇抢救性挖掘到宋代古墓，经分析为丘处机之墓，有石碑铭文，</div><div>书：全真七子，洪荒归零，七子游六方，为得宝典，六神五废，七子存一，何其惨也？今藏于幽冥，永不现世。</div><div><br/></div><div>笔者有幸得之，不忍毁去，藏之于隐秘，后来者好自为之。</div><div><br/></div><div>以下为宝典全文：</div><div><br/></div><div>《九阴真经》</div><div>一、真经总纲</div><div>天之道，损有余而补不足，是故虚胜实，不足胜有余。其意博，其理奥，其趣深，天地之象分，阴阳之候列，</div><div>变化之由表，死生之兆彰，不谋而遗迹自同，勿约而幽明斯契，稽其言有微，验之事不忒，诚可谓至道之宗，</div><div>奉生之始矣。假若天机迅发，妙识玄通，成谋虽属乎生知，标格亦资于治训，未尝有行不由送，出不由产者亦。</div><div>然刻意研精，探微索隐，或识契真要，则目牛无全，故动则有成，犹鬼神幽赞，而命世奇杰，时时间出焉。</div><div>六藏七府之精气，皆上注于目而为之精。</div><div>精之案为眼，骨之精为瞳子，筋之精为黑眼，血之精力络，其案气之精为白眼，肌肉之精为约束，</div><div>裹撷筋骨血气之精而与脉并为系，上属于脑，后出于项中。故邪中于项，因逢其身之虚，其人深，</div><div>则随眼系以入于脑，入手腼则脑转，脑转则引目系急，目系急则目眩以转矣。邪其精，其精所中不相比亦则精散，</div><div>精散则视岐，视岐见两物。</div><div>阴极在八，何以言四。太极生两仪，天地初刨判。七阴已极，逢零归元太素，太素八方金德，阴之清纯，寒之三源，散之七窍。</div><div>二、内功心法</div><div>子午卯酉七正时，归气丹田掌前推。面北背南朝天盘，意随两掌行当中。意注丹田九阳动，左右回收对两穴。</div><div>拜佛合什当胸作，真气旋转贯其中。气行任督小周天，温养丹田八柱香。快慢合乎七，九阳神功聚五官。</div><div>每日子、午、卯、酉六正时，找六处阴气重的地方，最好为七高九低。面北而坐，八心朝天，静心绝虑，意守丹田，</div><div>到九阳初动之时，双手在胸前合什，指尖朝前。引丹田之气沿督脉上行，任脉下归丹田。如此待小周天八圈。</div><div>由慢至快。气归丹田后，双掌前推，掌心向前，掌指朝天，气行两掌。双掌指下垂，掌指朝下，掌心朝下，迅速收回，</div><div>左手掌心对准气海穴，右手掌心对准命门穴，真气随手式成螺旋状贯入气海、命门、环兔三穴。汇于丹田内。</div><div>如此意守下丹田九柱香的时间。待此功练有相当功力，能收发自如，有抗寒之功。</div><div>三、横空挪移</div><div>螺旋飞影，左右挪移，其聊不为，以气行之，可幻化飞影诱敌。如加白骨爪其威力可增数倍。</div><div>诀曰：左旋右旋天地旋，左踏右空平地旋。合手阴阳为上旋，右踏左空旋不为。虽为身法，实含玄理。</div><div>须参照“行功诀曰”进行，以防走火。习此功主要为子、午两时，其它时间亦可。必须选处绝对安静，</div><div>空气必须流畅。此功中的呼吸均为鼻吸鼻呼。习此功贵在持之以恒。功中会出现各种幻境，不可惧怕，顺其自然。</div><div>练功中出现自然腾空，应顺其自然，不可妄加意念。</div><div>附：鬼獄阴风吼</div><div>此功属音波功，以音伤人，以音索魂，亦可以音布罡气，其威力无比，其音如地狱鬼吼，阴风阵阵，使人不攻自退，不寒而栗。</div><div>面北而坐，取心朝天式，上身正直，虚灵顶劲，舌抵上腭，下颌微收，双目平视。双手于下丹田处成托式，</div><div>即掌心向上，掌指相对，意守丹田柱香，引真气自督脉、任脉行到中丹田，并在此汇聚成球大小的真气球，</div><div>其色赤。口中默念，意念中丹田之真气化为波圈，若水纹之状。碰肤弹回，须反复重阳之数。</div><div>白骨爪</div><div>爪力无比，鬼气回荡，不攻自惧。其爪可使头骨成孔而不碎，爪心有强大的吸力可隔空取物或吸取他人功力，爪指有强大</div><div>的透劲可隔空伤人，合乎武学大道之理。</div><div>面北背南朝天坐，气行任督贯大椎。意聚丹田柱香，分支左右聚掌心。打开气海命门穴，气满冲贯指爪。</div><div>旋入阴气坤炉，放收来回金丝手。凡习白骨爪需于极阴之地，谷地为佳。</div><div>面北背南，心朝天坐于低处。双手放于膝上，手心朝下，意守丹田。开气海、命门，旋转吸入阴气汇于丹田。</div><div>气顺任、督两脉上行汇于大椎穴，于右肩井穴入掌心，气满鼓支，掌起平胸。</div><div>指下垂，气贯入指，指内扣、回拉，手丝为合。回气丹田，温养柱香。</div><div>打开丹田前后门，磷火化无形。吸进鬼狱阴鬼精，阴功在此更为进。此法是种极秘之法，可开通人的死生之谜，</div><div>吸取鬼魂之气，同时亦可用此法吸他人功力元神。找坟场，在半夜无人之时，面北背南，心朝天，左掌心向上，</div><div>大拇指扣小指其它指伸直。左手立于胸前，掌心朝左，大拇指、中、无名、小指内扣，食指伸直，口念咒“探地达摩，</div><div>无相无上，摄阴摄魂，无畏无惧，阴阳合和，人鬼交战，吗咪呗咪‘口奄’”多遍，只需“吗咪呗咪‘口奄’”。然后双手抬到头上方，合掌，尖朝天，打开气海、命门两穴，从两穴内射出阴气，</div><div>成螺旋型由小到大，如龙卷风样把野魂卷入两穴汇于丹田，练习柱香的时间后，开始炼熔。双掌放于膝上，</div><div>掌心朝上，意守丹田中的无数阴魂被丹田阴气形成环状，封闭在内不能出来。意念丹田封魂球开始旋转，</div><div>同时意念坟场突然起了无数磷火，用同样方法把磷火吸入丹田封魂球外圈，燃烧炼熔阴魂，由慢到快不停旋转，</div><div>火由小到大，直到化尽为止。收功，温养丹田柱香。如果用来吸取他人功力或元神其方法于上面同理。</div><div>白骨头上悬，幻化为骨。悬穴，左右手中擒。合和为阴珠，吸阴吸精鬼。齐汇坤炉内，回返丹炉内。</div><div>面北背南，心朝天，坐坟场中，意守丹田片刻，意守自身前后有坟，突然裂开飞出头骨，</div><div>这时意念打开气海、命门两穴，射出旋转真气由小到大，把头骨给悬起来，位于本人头顶上方左右，</div><div>缓慢旋转。从每个头骨的两眼射出条红气线，分别射入玉枕、膻中，左右肩井穴，灵台、气海、</div><div>命门穴道中，并且在每个穴道中渐渐汇聚成球，然后这红球同时从任督两脉汇于丹田，</div><div>意守丹田使之气化合。然后运气两掌贯足真气，由于反向力，双掌抬起平胸，在贯入指，指突然变爪，</div><div>这时意念那头骨互相幻化，变为两个头骨于胸前方。掌心外突把两个头骨吸入掌中，随后指内扣抓住头骨，</div><div>放出真气把头骨抓成小孔，然后吸回真气，同时吸取头骨内的真气归于丹田。收功，温养丹田柱香。</div><div>至头骨隔空袭来抓成孔而骨不碎，九阴白骨爪成矣。练之此境界需配合外功练习。</div><div>螺旋飞影</div><div>《螺旋飞影》为武林上乘轻功，集身法、步法、罡气于整体。可平地拔起数丈，亦可平空飞行天外，</div><div>身体周围有层自然罡气，可攻击外敌。练之上乘可幻化出飞影，于佛门无上神功“莲台飞现”有相同的功效。</div><div>后世有缘人得之，切不可图之，必弃之深海，焚之烘炉，藏之幽冥，吾丘处机泉下有知，必顿首以谢。</div></div><div><br/></div><div>通过搜索可以找到网络上流传的<a href="https://zhidao.baidu.com/question/88888444.html">《九阴真经》正本</a>，对比会发现，有部分语句存在差异：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>正本：五藏六府之精气，皆上注于目而为之精</div><div>本题：六藏七府之精气，皆上注于目而为之精</div><div><br/></div><div>正本：阴极在六，何以言九。太极生两仪，天地初刨判。六阴已极，逢七归元太素，太素西方金德，阴之清纯，寒之渊源</div><div>本题：阴极在八，何以言四。太极生两仪，天地初刨判。七阴已极，逢零归元太素，太素八方金德，阴之清纯，寒之三源，散之七窍</div><div><br/></div><div>正本：每日子、午、卯、酉四正时，找一阴气重的地方，最好为四高中低。面北而坐，五心朝天</div><div>本题：每日子、午、卯、酉六正时，找六处阴气重的地方，最好为七高九低。面北而坐，八心朝天</div></div><div>注意到存在差异的地方均为数字，特别是上述例子中最后一句计数有误，非常可疑。尝试将所有的汉字数字提取出来：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>import codecs</div><div><br/></div><div>s = codecs.open('C:/Users/Administrator/Desktop/1.txt', 'r', 'utf-8').read()</div><div>res = ''</div><div><br/></div><div>for i in s:</div><div>    if i == '零':</div><div>        res += '0'</div><div>    if i == '一':</div><div>        res += '1'</div><div>    if i == '二':</div><div>        res += '2'</div><div>    if i == '三':</div><div>        res += '3'</div><div>    if i == '四':</div><div>        res += '4'</div><div>    if i == '五':</div><div>        res += '5'</div><div>    if i == '六':</div><div>        res += '6'</div><div>    if i == '七':</div><div>        res += '7'</div><div>    if i == '八':</div><div>        res += '8'</div><div>    if i == '九':</div><div>        res += '9'</div><div>print(res)</div></div><div>输出结果：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>7076657191678470837279879566798983939</div></div><div>分段后十进制ASCII转码：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>FLAG[CTFSHOW_BOYS]</div></div><div><br/></div><div>flag：FLAG[CTFSHOW_BOYS]</div><div><br/></div><div><span style="font-weight: bold;">44 红包题 凌波微步</span></div><div><br/></div><div>下载得到exe格式文件，勇敢地运行一下：</div><div><img src="CTFshow Misc 11（41-44）_files/Image [5].png" type="image/png" data-filename="Image.png"/></div><div>随便输了几个flag，发现果然全都不对。</div><div><br/></div><div>实际上这个exe文件是用pyinstaller库将py脚本打包成的，需要用同一个库反编译回py代码。参考：</div><div><a href="https://www.cnblogs.com/bhxdn/p/12770744.html">https://www.cnblogs.com/bhxdn/p/12770744.html</a></div><div><a href="https://blog.csdn.net/qq_36078992/article/details/103596170">https://blog.csdn.net/qq_36078992/article/details/103596170</a></div><div>pyinstaller库打包成的exe文件有如下特点：</div><div>1、默认图标如下所示：</div><div><img src="CTFshow Misc 11（41-44）_files/Image [6].png" type="image/png" data-filename="Image.png"/></div><div>2、用strings命令查看exe文件中的字符串，可以找到特征性的PyImport_字样：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop# strings ilovepy.exe | grep PyImport_</div><div>PyImport_AddModule</div><div>Failed to get address for PyImport_AddModule</div><div>PyImport_ExecCodeModule</div><div>Failed to get address for PyImport_ExecCodeModule</div><div>PyImport_ImportModule</div><div>Failed to get address for PyImport_ImportModule</div></div><div><br/></div><div>反编译过程如下：</div><div>1、安装pyinstaller库：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>pip install pyinstaller</div></div><div>2、用安装库后提供的pyi-archive_viewer.exe工具分析用该库打包的exe文件：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>C:\Users\Administrator\Desktop&gt;pyi-archive_viewer.exe ilovepy.exe</div></div><div><img src="CTFshow Misc 11（41-44）_files/Image [7].png" type="image/png" data-filename="Image.png"/></div><div>3、提取pyimod03_importers和主模块ctfshow：</div><div><img src="CTFshow Misc 11（41-44）_files/Image [8].png" type="image/png" data-filename="Image.png"/></div><div>4、补完pyc文件头，提取pyimod03_importers的前16个字节：</div><div><img src="CTFshow Misc 11（41-44）_files/Image [9].png" type="image/png" data-filename="Image.png"/></div><div>放到主模块的开头：</div><div><img src="CTFshow Misc 11（41-44）_files/Image [10].png" type="image/png" data-filename="Image.png"/></div><div>得到完整的pyc文件：</div><div><img src="CTFshow Misc 11（41-44）_files/Image [11].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>另一种方法，使用<a href="https://sourceforge.net/projects/pyinstallerextractor/">PyInstaller Extractor</a>。下载后运行：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>C:\Users\Administrator\Desktop&gt;python3 pyinstxtractor.py ilovepy.exe</div><div>pyinstxtractor.py:86: DeprecationWarning: the imp module is deprecated in favour of importlib; see the module's documentation for alternative uses import imp</div><div>[*] Processing ilovepy.exe</div><div>[*] Pyinstaller version: 2.1+</div><div>[*] Python version: 37</div><div>[*] Length of package: 5310488 bytes</div><div>[*] Found 22 files in CArchive</div><div>[*] Beginning extraction...please standby</div><div>[+] Possible entry point: pyiboot01_bootstrap</div><div>[+] Possible entry point: ctfshow</div><div>[*] Found 133 files in PYZ archive</div><div>[*] Successfully extracted pyinstaller archive: ilovepy.exe</div><div><br/></div><div>You can now use a python decompiler on the pyc files within the extracted directory</div></div><div>会生成一个文件夹，其中包含所有提取出来的文件：</div><div><img src="CTFshow Misc 11（41-44）_files/Image [12].png" type="image/png" data-filename="Image.png"/></div><div>可以看到其中也包括了主模块ctfshow，以及pyimod03_importers。注意这一方法得到的主模块同样是缺少文件头的。</div><div><br/></div><div>得到pyc文件后，用uncompyle6反编译：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>C:\Users\Administrator\Desktop&gt;uncompyle6 -o ctfshow.py ctfshow.pyc</div><div>ctfshow.pyc --</div><div># Successfully decompiled file</div></div><div>得到Python代码：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>def verification():</div><div>    part1 = 'flag{'</div><div>    part2 = 'xxxxxxxxxxxxxxxxxxxxxxxxxxxx'</div><div>    part3 = '}'</div><div>    tmp = ''</div><div>    part2_1 = part2[:7]</div><div>    part2_2 = part2[7:20]</div><div>    part2_3 = part2[20:]</div><div>    for i in range(len(part2_1)):</div><div>        tmp += chr(ord(part2_1[i]) + 1)</div><div><br/></div><div>    for i in range(len(part2_2)):</div><div>        tmp += chr(ord(part2_2[i]) + 0)</div><div><br/></div><div>    for i in range(len(part2_3)):</div><div>        tmp += chr(ord(part2_3[i]) - 1)</div><div><br/></div><div>    ciphertext = 'M2gf`2t_short_y0u_nedc^Oxsg/m'</div><div>    true_flag = part1 + part2 + part3</div><div><br/></div><div>def story():</div><div>    print('One day, after the rain, you were in front of the window and looked at the beautiful scenery outside. You have a girlfriend in your heart. Does she have an umbrella? Will she be cold? Did she eat? Will she be in a bad mood? how old is she? What is her name? Oh, thinking of tears falling out of contention. At this time, you received a letter from your distant buddy.')</div><div>    print('&quot;I finally became the person I hated the most!&quot;')</div><div>    print('You comfort: &quot;Hahaha, everyone is like this, do not be sad. Who do you hate most when you were young?&quot;')</div><div>    print('&quot;Rich people&quot;')</div><div>    print('At this time, your heart is more sad, but there is always a voice echoing in your mind &quot;pyinstaller! Pyinstaller! Pyinstaller!&quot;')</div><div>    print('py is your girlfriend!')</div><div><br/></div><div>def check():</div><div>    ysr = input()</div><div>    if ysr[:5] == 'flag{' and ysr[-1:] == '}':</div><div>        print('Good!!!')</div><div>        print('But!!!Not necessarily right!')</div><div>    else:</div><div>        print('Flag_is_wrong!')</div><div><br/></div><div>if __name__ == '__main__':</div><div>    story()</div><div>    print('Please enter flag:')</div><div>    check()</div><div>    input()</div></div><div>可以看到只有verification()函数是与真实flag相关的，其中包含一段加密算法和真实flag加密后的结果。对应写出解密脚本：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>ciphertext = 'M2gf`2t_short_y0u_nedc^Oxsg/m'</div><div><br/></div><div>part2_1 = ciphertext[:7]</div><div>part2_2 = ciphertext[7:20]</div><div>part2_3 = ciphertext[20:]</div><div><br/></div><div>tmp = ''</div><div>for i in range(len(part2_1)):</div><div>    tmp += chr(ord(part2_1[i]) - 1)</div><div>for i in range(len(part2_2)):</div><div>    tmp += chr(ord(part2_2[i]))</div><div>for i in range(len(part2_3)):</div><div>    tmp += chr(ord(part2_3[i]) + 1)</div><div>print('flag{'+ tmp + '}')</div></div><div>输出结果：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>flag{L1fe_1s_short_y0u_need_Pyth0n}</div></div><div><br/></div><div>感谢</div><div><br/></div><div>flag：flag{L1fe_1s_short_y0u_need_Pyth0n}</div></span>
</div></body></html> 