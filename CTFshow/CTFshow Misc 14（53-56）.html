<html>
<head>
  <title>CTFshow Misc 14（53-56）</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/605894 (zh-CN, DDL); Windows/6.1.1 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="2894"/>
<h1>CTFshow Misc 14（53-56）</h1>
<h2><a href="https://DemonStarAlgol.github.io/Misc/">[无关链接]</a></h2>

<div>
<span><div><span style="font-weight: bold;">53 来个初中题吧</span></div><div><br/></div><div>下载得到apk格式文件，jadx打开，找到com.example.myapplication.MainActivity：</div><div><img src="CTFshow Misc 14（53-56）_files/Image.png" type="image/png" data-filename="Image.png" width="1135"/></div><div><br/></div><div>查看关键代码：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>static class chkflag {</div><div>    private static final Integer[][] A = {new Integer[]{-101, -277, -181, -79, 53, -151, -277, 137, 229, -283, -29, -7, -281, 5, -71, -167, 227, 233, -197, 181, 277, 41, 109, -257, -307, -107, 97, 263, 241, -83, 131, 277}, new Integer[]{73, 101, 277, 109, 269, 307, -227, 269, 109, -241, 67, 101, 101, 281, 139, -269, -283, 223, -191, 197, -163, -211, -293, -173, -79, 277, -103, 113, 199, 73, -97, -281}, new Integer[]{167, 241, -89, 53, 211, -151, -223, 241, -311, -167, 263, -233, 157, -233, 7, 173, -79, 47, -307, -113, 193, -59, -173, -227, -211, 17, 109, -131, 293, 167, -167, 7}, new Integer[]{233, -17, -283, -157, 2, 311, -23, 149, -307, 5, -151, -11, -257, 181, 53, 269, 109, 281, 307, 193, -139, -41, 139, -229, 5, -2, 163, 241, -311, -29, -149, 67}, new Integer[]{-241, -307, 11, 103, -223, 29, 71, -277, -193, -103, -61, 59, -43, 61, -89, 307, -173, -173, -3, 79, 17, -101, 163, 269, -193, -17, 101, -191, 7, 3, -109, -23}, new Integer[]{-2, -167, -97, -2, -193, -53, -239, -83, -73, -181, 89, -137, 251, -29, -181, -131, -251, 101, 271, -59, 313, 193, -97, 2, 167, 5, -79, -137, 53, -53, -53, 83}, new Integer[]{-103, -241, -281, -151, 17, 67, 233, -109, 263, 59, -181, -233, 127, 197, -73, 47, -73, -277, 101, -17, 113, 193, 31, -107, 223, -41, -29, -163, 139, -229, 73, -2}, new Integer[]{-239, -239, 181, -179, 139, 23, -83, 239, -277, -239, 31, Integer.valueOf(InputDeviceCompat.SOURCE_KEYBOARD), -173, 251, 181, -293, 193, 193, -271, -229, -29, -311, -131, Integer.valueOf(InputDeviceCompat.SOURCE_KEYBOARD), -227, -59, -43, 127, -97, 271, -109, 67}, new Integer[]{-131, 19, 23, -233, 61, 59, -89, -151, -181, -211, -283, 61, 29, 263, -277, -229, -251, 109, -211, 239, -283, -269, 269, 281, -179, 283, 19, 83, -13, -139, 3, 89}, new Integer[]{-97, -151, 73, -17, 251, 251, -89, 281, -131, 73, -2, 151, -3, 283, 229, 29, 2, -199, 11, -113, -233, 251, 211, 23, 293, 271, -131, -43, -2, -163, 173, -167}, new Integer[]{-67, -211, -73, 37, -83, 103, -2, 263, 193, 107, 127, -23, 5, -173, 127, -89, 277, 23, 179, 71, 43, -23, -113, -73, -59, 31, 71, -41, -31, 3, 199, -29}, new Integer[]{-179, -107, 191, 227, 211, 199, -257, -257, -113, -3, -89, -109, -151, -257, -103, -31, 167, -271, 83, 241, 83, -127, -37, -193, -139, 193, 167, -103, -31, 61, 11, 31}, new Integer[]{-223, 7, 61, -31, -97, -59, 313, -251, -227, 229, -149, 167, -227, 199, 113, 29, -263, 59, -173, 269, 167, -167, 107, 127, 227, 17, -107, -17, 157, 7, -191, 137}, new Integer[]{-37, -227, -41, -53, 173, -241, -149, 167, -307, -41, 53, -179, -47, -239, 37, -277, 197, 181, 7, -53, 17, -37, 269, -127, 7, 227, 179, -23, 109, 101, -73, 61}, new Integer[]{-61, 97, 181, -109, -229, -89, 277, 2, -2, -41, -89, 269, 283, 281, 17, 19, 157, 13, 197, -277, -199, 139, 173, 47, 151, 193, -179, -109, -17, 29, -61, -191}, new Integer[]{-233, 223, 281, -11, 103, 241, 11, -97, 101, -79, 2, 227, 229, 173, -149, -277, 157, -13, 127, 163, -211, 181, 139, -239, -71, 197, -3, -293, 149, 293, 13, 13}, new Integer[]{-277, -29, 167, -107, -13, 3, -257, 211, 29, 313, -127, 59, 7, 23, 103, -3, 163, -277, 241, -67, 139, -307, -89, -307, 3, -47, -83, 71, 7, 211, 263, 17}, new Integer[]{-3, 163, -43, -11, 19, 263, -157, -151, -113, -127, 79, 233, -181, -229, 173, 97, 59, 307, 313, 163, -193, -181, 283, -131, 43, -7, -283, 31, -239, -263, -223, 97}, new Integer[]{251, 307, -163, 61, 53, 83, -67, 59, 193, -199, 239, -197, 107, 73, -53, -37, 239, -167, -227, -257, -271, -61, -17, -89, 271, 11, -5, -239, 113, -167, -83, -11}, new Integer[]{-67, -41, 59, 167, 193, -29, -7, -199, Integer.valueOf(InputDeviceCompat.SOURCE_KEYBOARD), -29, 127, -199, 313, 271, 313, -173, -2, -2, 227, 241, 271, -103, 53, 193, -53, -2, -131, 137, -83, 307, 139, 199}, new Integer[]{313, -163, 173, 19, -311, -7, -43, 29, -311, -67, -269, -2, 67, 191, 17, 31, -101, -71, -229, -181, -269, -163, 241, -79, 281, -139, -107, 3, 137, 193, -257, Integer.valueOf(InputDeviceCompat.SOURCE_KEYBOARD)}, new Integer[]{109, -97, -5, 229, 307, 227, -199, 83, 269, 277, 7, 277, -281, -53, 23, -7, 61, -277, 67, -199, -151, 67, -223, -311, 193, -191, -79, -239, 167, -83, 193, -79}, new Integer[]{149, -53, -67, 151, -109, 83, -179, -251, -47, 157, 7, 43, -103, -89, 13, 17, 263, -101, 151, -97, -163, 199, 233, -211, -223, 227, 101, 59, 263, 53, -271, 197}, new Integer[]{-7, 181, -5, -101, -311, 151, -2, 233, -19, 251, 313, -11, -113, 307, 13, 113, -19, 79, 43, 3, -43, 293, 269, 137, 167, 191, 29, 97, 11, 53, 47, -2}, new Integer[]{-47, -31, -13, 59, -163, -17, -271, 37, 197, -101, -131, -211, -73, 5, -311, 79, 199, -223, 97, -131, 307, 71, -263, -97, 199, 157, 307, 307, 71, 239, 127, 73}, new Integer[]{-5, -31, -181, 137, -239, Integer.valueOf(InputDeviceCompat.SOURCE_KEYBOARD), -113, -37, -191, 97, -47, 277, 239, 151, -239, -233, -223, -139, 191, 29, 13, 107, 7, 109, 211, -71, 3, 2, 283, 251, -7, -251}, new Integer[]{-19, 241, -233, -191, -37, -241, -283, -277, 101, -11, 269, 101, -17, -29, 2, -17, 43, 223, 79, 41, -3, -191, 7, -53, -67, -67, -239, -307, -181, -109, -17, 181}, new Integer[]{97, 223, -17, 307, -73, 79, 31, 283, 37, -137, 71, 109, -283, -17, -277, -163, -59, -79, -101, 17, 307, -223, -191, -181, 211, -283, 151, -283, 283, -47, -239, -163}, new Integer[]{-281, -59, -101, 53, -71, -73, -269, -23, 71, 149, 157, -197, 59, -197, 167, -263, 233, 41, 23, 103, -251, 281, 107, 233, 307, 277, 83, -131, -71, -131, 233, -163}, new Integer[]{211, 23, Integer.valueOf(InputDeviceCompat.SOURCE_KEYBOARD), -3, 109, 149, 307, -97, 223, -5, -5, -113, 113, 139, 67, -89, -131, -43, 281, 163, 191, 199, 283, -107, 191, -233, 283, 193, -223, -83, -193, -241}, new Integer[]{-23, -269, 139, -47, 19, 37, 307, -79, 67, -223, 271, 211, 311, 11, -19, -59, 179, -223, 193, -43, 37, 139, 47, -137, -127, 113, -263, 127, -307, -73, -139, -269}, new Integer[]{-79, -107, 239, 313, 13, -131, 197, -103, 311, 229, 239, 53, -67, 53, -43, 181, -7, 223, -223, 67, -53, -109, -41, -23, 71, 163, 79, 79, -2, -3, -229, 197}};</div><div>    private static final Integer[] B = {-3221, 7499, 5395, 2308, -7937, 620, -2129, -8319, -14285, 7490, 6883, 499, 1735, -1249, 579, 9039, 5459, -4841, -4405, 15322, -8005, 2427, 5213, 17993, 6549, 2926, -8073, -787, -1185, 11817, 379, 11174};</div><div>    public static String Errmsg = new String();</div><div><br/></div><div>    chkflag() {</div><div>    }</div><div><br/></div><div>    public static boolean check(String flag) {</div><div>        Integer[] X = new Integer[32];</div><div>        if (flag.length() != 38 || !flag.startsWith(&quot;flag{&quot;)) {</div><div>            Errmsg = &quot;flag格式为flag{32位16进制数字} 共38位&quot;;</div><div>            return false;</div><div>        }</div><div>        int i = 5;</div><div>        while (i &lt; 37) {</div><div>            try {</div><div>                X[i - 5] = Integer.valueOf(Integer.parseInt(flag.substring(i, i + 1), 16));</div><div>                i++;</div><div>            } catch (Exception e) {</div><div>                Errmsg = &quot;flag{} 内部仅接受16进制数字（0-f）&quot;;</div><div>            }</div><div>        }</div><div>        for (int i2 = 0; i2 &lt; 32; i2++) {</div><div>            Integer tx = 0;</div><div>            for (int j = 0; j &lt; 32; j++) {</div><div>                tx = Integer.valueOf(tx.intValue() + (A[i2][j].intValue() * X[j].intValue()));</div><div>            }</div><div>            if (!tx.equals(B[i2])) {</div><div>                Errmsg = &quot;线性方程验证失败&quot;;</div><div>                return false;</div><div>            }</div><div>        }</div><div>        return true;</div><div>    }</div><div>}</div></div><div>首先定义了由32个列表组成的列表A，每个子列表包含32个常数，以及32个常数组成的列表B。接下来给出flag格式为32位16进制数字，并用线性方程验证flag是否正确。具体来说，A的第i个子列表中32个常数与flag的32位分别相乘，其总和应等于B的第i位。此外，注意到A中有变量名称为Integer.valueOf(InputDeviceCompat.SOURCE_KEYBOARD)}，全局搜索这一字符串：</div><div><img src="CTFshow Misc 14（53-56）_files/Image [1].png" type="image/png" data-filename="Image.png" width="800"/></div><div>可以得到其值为257。</div><div><br/></div><div>写Python脚本解线性方程组：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>from scipy import linalg</div><div>import numpy as np</div><div><br/></div><div>A = np.array([[-101, -277, -181, -79, 53, -151, -277, 137, 229, -283, -29, -7, -281, 5, -71, -167, 227, 233, -197, 181, 277, 41, 109, -257, -307, -107, 97, 263, 241, -83, 131, 277], [73, 101, 277, 109, 269, 307, -227, 269, 109, -241, 67, 101, 101, 281, 139, -269, -283, 223, -191, 197, -163, -211, -293, -173, -79, 277, -103, 113, 199, 73, -97, -281], [167, 241, -89, 53, 211, -151, -223, 241, -311, -167, 263, -233, 157, -233, 7, 173, -79, 47, -307, -113, 193, -59, -173, -227, -211, 17, 109, -131, 293, 167, -167, 7], [233, -17, -283, -157, 2, 311, -23, 149, -307, 5, -151, -11, -257, 181, 53, 269, 109, 281, 307, 193, -139, -41, 139, -229, 5, -2, 163, 241, -311, -29, -149, 67], [-241, -307, 11, 103, -223, 29, 71, -277, -193, -103, -61, 59, -43, 61, -89, 307, -173, -173, -3, 79, 17, -101, 163, 269, -193, -17, 101, -191, 7, 3, -109, -23], [-2, -167, -97, -2, -193, -53, -239, -83, -73, -181, 89, -137, 251, -29, -181, -131, -251, 101, 271, -59, 313, 193, -97, 2, 167, 5, -79, -137, 53, -53, -53, 83], [-103, -241, -281, -151, 17, 67, 233, -109, 263, 59, -181, -233, 127, 197, -73, 47, -73, -277, 101, -17, 113, 193, 31, -107, 223, -41, -29, -163, 139, -229, 73, -2], [-239, -239, 181, -179, 139, 23, -83, 239, -277, -239, 31, 257, -173, 251, 181, -293, 193, 193, -271, -229, -29, -311, -131, 257, -227, -59, -43, 127, -97, 271, -109, 67], [-131, 19, 23, -233, 61, 59, -89, -151, -181, -211, -283, 61, 29, 263, -277, -229, -251, 109, -211, 239, -283, -269, 269, 281, -179, 283, 19, 83, -13, -139, 3, 89], [-97, -151, 73, -17, 251, 251, -89, 281, -131, 73, -2, 151, -3, 283, 229, 29, 2, -199, 11, -113, -233, 251, 211, 23, 293, 271, -131, -43, -2, -163, 173, -167], [-67, -211, -73, 37, -83, 103, -2, 263, 193, 107, 127, -23, 5, -173, 127, -89, 277, 23, 179, 71, 43, -23, -113, -73, -59, 31, 71, -41, -31, 3, 199, -29], [-179, -107, 191, 227, 211, 199, -257, -257, -113, -3, -89, -109, -151, -257, -103, -31, 167, -271, 83, 241, 83, -127, -37, -193, -139, 193, 167, -103, -31, 61, 11, 31], [-223, 7, 61, -31, -97, -59, 313, -251, -227, 229, -149, 167, -227, 199, 113, 29, -263, 59, -173, 269, 167, -167, 107, 127, 227, 17, -107, -17, 157, 7, -191, 137], [-37, -227, -41, -53, 173, -241, -149, 167, -307, -41, 53, -179, -47, -239, 37, -277, 197, 181, 7, -53, 17, -37, 269, -127, 7, 227, 179, -23, 109, 101, -73, 61], [-61, 97, 181, -109, -229, -89, 277, 2, -2, -41, -89, 269, 283, 281, 17, 19, 157, 13, 197, -277, -199, 139, 173, 47, 151, 193, -179, -109, -17, 29, -61, -191], [-233, 223, 281, -11, 103, 241, 11, -97, 101, -79, 2, 227, 229, 173, -149, -277, 157, -13, 127, 163, -211, 181, 139, -239, -71, 197, -3, -293, 149, 293, 13, 13], [-277, -29, 167, -107, -13, 3, -257, 211, 29, 313, -127, 59, 7, 23, 103, -3, 163, -277, 241, -67, 139, -307, -89, -307, 3, -47, -83, 71, 7, 211, 263, 17], [-3, 163, -43, -11, 19, 263, -157, -151, -113, -127, 79, 233, -181, -229, 173, 97, 59, 307, 313, 163, -193, -181, 283, -131, 43, -7, -283, 31, -239, -263, -223, 97], [251, 307, -163, 61, 53, 83, -67, 59, 193, -199, 239, -197, 107, 73, -53, -37, 239, -167, -227, -257, -271, -61, -17, -89, 271, 11, -5, -239, 113, -167, -83, -11], [-67, -41, 59, 167, 193, -29, -7, -199, 257, -29, 127, -199, 313, 271, 313, -173, -2, -2, 227, 241, 271, -103, 53, 193, -53, -2, -131, 137, -83, 307, 139, 199], [313, -163, 173, 19, -311, -7, -43, 29, -311, -67, -269, -2, 67, 191, 17, 31, -101, -71, -229, -181, -269, -163, 241, -79, 281, -139, -107, 3, 137, 193, -257, 257], [109, -97, -5, 229, 307, 227, -199, 83, 269, 277, 7, 277, -281, -53, 23, -7, 61, -277, 67, -199, -151, 67, -223, -311, 193, -191, -79, -239, 167, -83, 193, -79], [149, -53, -67, 151, -109, 83, -179, -251, -47, 157, 7, 43, -103, -89, 13, 17, 263, -101, 151, -97, -163, 199, 233, -211, -223, 227, 101, 59, 263, 53, -271, 197], [-7, 181, -5, -101, -311, 151, -2, 233, -19, 251, 313, -11, -113, 307, 13, 113, -19, 79, 43, 3, -43, 293, 269, 137, 167, 191, 29, 97, 11, 53, 47, -2], [-47, -31, -13, 59, -163, -17, -271, 37, 197, -101, -131, -211, -73, 5, -311, 79, 199, -223, 97, -131, 307, 71, -263, -97, 199, 157, 307, 307, 71, 239, 127, 73], [-5, -31, -181, 137, -239, 257, -113, -37, -191, 97, -47, 277, 239, 151, -239, -233, -223, -139, 191, 29, 13, 107, 7, 109, 211, -71, 3, 2, 283, 251, -7, -251], [-19, 241, -233, -191, -37, -241, -283, -277, 101, -11, 269, 101, -17, -29, 2, -17, 43, 223, 79, 41, -3, -191, 7, -53, -67, -67, -239, -307, -181, -109, -17, 181], [97, 223, -17, 307, -73, 79, 31, 283, 37, -137, 71, 109, -283, -17, -277, -163, -59, -79, -101, 17, 307, -223, -191, -181, 211, -283, 151, -283, 283, -47, -239, -163], [-281, -59, -101, 53, -71, -73, -269, -23, 71, 149, 157, -197, 59, -197, 167, -263, 233, 41, 23, 103, -251, 281, 107, 233, 307, 277, 83, -131, -71, -131, 233, -163], [211, 23, 257, -3, 109, 149, 307, -97, 223, -5, -5, -113, 113, 139, 67, -89, -131, -43, 281, 163, 191, 199, 283, -107, 191, -233, 283, 193, -223, -83, -193, -241], [-23, -269, 139, -47, 19, 37, 307, -79, 67, -223, 271, 211, 311, 11, -19, -59, 179, -223, 193, -43, 37, 139, 47, -137, -127, 113, -263, 127, -307, -73, -139, -269], [-79, -107, 239, 313, 13, -131, 197, -103, 311, 229, 239, 53, -67, 53, -43, 181, -7, 223, -223, 67, -53, -109, -41, -23, 71, 163, 79, 79, -2, -3, -229, 197]])</div><div>B = np.array([-3221, 7499, 5395, 2308, -7937, 620, -2129, -8319, -14285, 7490, 6883, 499, 1735, -1249, 579, 9039, 5459, -4841, -4405, 15322, -8005, 2427, 5213, 17993, 6549, 2926, -8073, -787, -1185, 11817, 379, 11174])</div><div><br/></div><div>x = linalg.solve(A, B)</div><div>flag = 'flag{'</div><div>for i in x:</div><div>    flag += hex(round(float(i)))[2:]</div><div>print(flag + '}')</div></div><div>输出结果：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>flag{84b169295de475692289f8124b739818}</div></div><div><br/></div><div>flag：flag{84b169295de475692289f8124b739818}</div><div><br/></div><div><span style="font-weight: bold;">54 你需要一台示波器</span></div><div><br/></div><div>下载得到wav格式文件，audacity打开：</div><div><img src="CTFshow Misc 14（53-56）_files/Image [2].png" type="image/png" data-filename="Image.png"/></div><div>音频长度总计为43.86秒左右。观察规律，音频可以很明显地分成26段，如上图中间为第2段，前后和别的段间有明显的间隔。每一段又是由相同的信号片段重复20次得到的。从题目名称可以看出，本题给出的波形很可能是来自示波器的信号，即每一个信号片段在示波器屏幕上显示为某个图形，重复20次是为了让图案在示波器屏幕上保留足够的时间。</div><div><br/></div><div>理论上所有的图案都可以通过将信号输入到示波器并直接观察屏幕得到。但在没有示波器也没有模拟示波器软件的情况下，可以先肉眼观察一下波形。例如第5段和第26段（即最后一段）：</div><div><img src="CTFshow Misc 14（53-56）_files/Image [3].png" type="image/png" data-filename="Image.png"/></div><div><img src="CTFshow Misc 14（53-56）_files/Image [4].png" type="image/png" data-filename="Image.png"/></div><div>基本上是完全对称的，可以猜测分别是左右大括号 { 和 }。从而判断前4段是“flag”。回到第一张截图：</div><div><img src="CTFshow Misc 14（53-56）_files/Image [5].png" type="image/png" data-filename="Image.png"/></div><div>图中的3段分别对应f、l和a。明显可以注意到，a对应的下方声道，信号波动范围较f和l更小。显然，下方声道对应的是图像的Y轴，从而上方声道是X轴。两条声道在每个大段开始时波形都在0处，显然为示波器扫描图案的原点。大部分情况下，Y轴信号在每个小片段开始时都位于最高点，然后逐渐降低到最低点，显然示波器在扫描形成图案时按照从上至下的顺序。</div><div>a和g的Y轴信号范围进一步验证了以上猜测，很明显可以看到g在下方比a多出一块扫描区域：</div><div><img src="CTFshow Misc 14（53-56）_files/Image [6].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>结合以上分析，注意到第7、12、16、21段，这四段信号的特征基本上完全一致。如图为第7段：</div><div><img src="CTFshow Misc 14（53-56）_files/Image [7].png" type="image/png" data-filename="Image.png"/></div><div>容易发现，其Y轴信号基本上位于最低点，而X轴信号在每个小片段内单调递增。很显然，这个信号对应的是下划线“_”。从而得到部分flag：flag{?_????_???_????_????}。</div><div><br/></div><div>目前仍然未知的是X轴信号在扫描形成图案时的顺序。根据常理和示波器原理推断，应为从左到右。也即X轴为负的，说明图案偏左，反之图案偏右。对比一下已经确定的左右大括号 { 和 } ：</div><div><img src="CTFshow Misc 14（53-56）_files/Image [8].png" type="image/png" data-filename="Image.png"/><img src="CTFshow Misc 14（53-56）_files/Image [9].png" type="image/png" data-filename="Image.png"/></div><div>左大括号 { 在Y轴最大时X轴为正，对应其图案最上方向左的凸出部分；在Y轴接近0时为负，对应其图案中间位置向右的凸出形状。右大括号亦然，说明猜测是正确的。</div><div>根据同样的逻辑，可以推测X轴信号波动越剧烈的，表明对应图案区域越“宽”。</div><div><br/></div><div>第5段，X轴信号基本对称，上下宽，中间窄，判定为大写字母“I”：</div><div><img src="CTFshow Misc 14（53-56）_files/Image [10].png" type="image/png" data-filename="Image.png"/></div><div>第8段，靠Y轴上方是靠左的窄竖条，最下方一小段宽度横跨整个图案区域，判定为大写字母“L”：</div><div><img src="CTFshow Misc 14（53-56）_files/Image [11].png" type="image/png" data-filename="Image.png"/></div><div>第9段，注意到整体图案非常对称，且与a和g的片段开头部分很相似，但范围更大，猜测这是绘制圆圈图案的特征信号。姑且猜测是大写字母“O”：</div><div><img src="CTFshow Misc 14（53-56）_files/Image [12].png" type="image/png" data-filename="Image.png"/></div><div>顺便放大一点看一下。图左为第9段末尾，右为第10段开头。观察第9段信号的特征，在某个很小的Y轴范围内，X轴信号先在负数（图案区域左方）波动，然后直线跳跃到正数（图案区域右方）波动。可以猜测，直线跳跃的部分说明在中间区域没有图案被绘制。和圆圈形状在大多数位置“两边有，中间空”的特征是符合的：</div><div><img src="CTFshow Misc 14（53-56）_files/Image [13].png" type="image/png" data-filename="Image.png"/></div><div>第10段，X轴信号基本对称。注意到这一段也存在X轴信号中途从负数直线跳跃到正数的情况，同时X轴波动剧烈程度整体随Y轴下降而下降，说明图案宽度是上宽下窄的。结合“两边有，中间空”的特征，判定为大写字母“V”：</div><div><img src="CTFshow Misc 14（53-56）_files/Image [14].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>到这里我突然发现，如果把每个小片段X轴的波形顺时针旋转90度，然后通过脑补去掉“直线跳跃”部分的线条，再结合Y轴扫描信号下降的速度，基本上就是示波器所显示的图案了。</div><div>第11段，Y轴上、中、下各有一处宽度横跨整个图案区域的条带，其余部分是靠左的竖窄条，判定为大写字母“E”：</div><div><img src="CTFshow Misc 14（53-56）_files/Image [15].png" type="image/png" data-filename="Image.png"/></div><div>第13段，Y轴基本匀速下降，把头朝左转90度看一眼X轴，猜测是数字“3”：</div><div><img src="CTFshow Misc 14（53-56）_files/Image [16].png" type="image/png" data-filename="Image.png"/></div><div>第14段，每个片段前半部分信号是从图案区域正上方指向正左方的一条斜窄带，后半部分信号是位于图案下半部分位置的一个圆圈，猜测为数字“6”：</div><div><img src="CTFshow Misc 14（53-56）_files/Image [17].png" type="image/png" data-filename="Image.png"/></div><div>第15段，Y轴基本匀速下降，X轴信号中间有“直线跳跃”特征，头歪过来看一下，判定为大写字母“D”：</div><div><img src="CTFshow Misc 14（53-56）_files/Image [18].png" type="image/png" data-filename="Image.png"/></div><div>第17和18段，之前已经辨识过了，是大写字母“VE”：</div><div><img src="CTFshow Misc 14（53-56）_files/Image [19].png" type="image/png" data-filename="Image.png"/></div><div>第19段，X轴信号几乎全程都有“直线跳跃”特征，前半部分类似D，后半部分类似一个整体更偏左的、倒过来的V。实际上这里没有猜到具体是哪个字符，结合后面的分析，猜测为大写字母“R”：</div><div><img src="CTFshow Misc 14（53-56）_files/Image [20].png" type="image/png" data-filename="Image.png"/></div><div>第20段，X轴信号整体对称，前半段类似V，后半段是一个位于图案区域下方正中间位置的短窄竖条，判定为大写字母“Y”：</div><div><img src="CTFshow Misc 14（53-56）_files/Image [21].png" type="image/png" data-filename="Image.png"/></div><div>第22段，看不出来，放弃：</div><div><img src="CTFshow Misc 14（53-56）_files/Image [22].png" type="image/png" data-filename="Image.png"/></div><div>第23段，X轴信号整体对称，是一个上半部分更宽、最下方收窄十分迅速的V，判定为大写字母“U”：</div><div><img src="CTFshow Misc 14（53-56）_files/Image [23].png" type="image/png" data-filename="Image.png"/></div><div>第24段，歪头一看，猜测是大写字母“C”：</div><div><img src="CTFshow Misc 14（53-56）_files/Image [24].png" type="image/png" data-filename="Image.png"/></div><div>第25段，X轴信号整体对称，图案正中间有一条宽度横跨整个区域的条带，上方和下方都有“直线跳跃”特征，且图案整体宽度上下一致，猜测为大写字母“H”：</div><div><img src="CTFshow Misc 14（53-56）_files/Image [25].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>拼接一下已知信息：flag{I_LOVE_36D_VERY_?UCH}。缺失字母猜测是M，尝试发现flag正确。</div><div><br/></div><div>flag：flag{I_LOVE_36D_VERY_MUCH}</div><div><br/></div><div><span style="font-weight: bold;">55 迷惑行为大赏（之）无中生you_菜鸡杯</span></div><div><br/></div><div>下载得到png格式文件，十六进制编辑器查看，文件尾后有额外数据：</div><div><img src="CTFshow Misc 14（53-56）_files/Image [26].png" type="image/png" data-filename="Image.png" width="838"/></div><div>提取得到RAR格式压缩包，打开发现需要密码，由于是RAR5压缩格式，暂时不考虑爆破。对png图片应用常见隐写工具和查看exif信息，均无结果。虽然本题附件图片在Linux或010Editor中不会报CRC错误，但如果在更改图片高度时同时修改了CRC校验位也可以达成这一效果，总之还是尝试一下修改图片高度：</div><div><img src="CTFshow Misc 14（53-56）_files/Image [27].png" type="image/png" data-filename="Image.png" width="530"/></div><div>1500有点太高了，用图像编辑器可以看出实际高度应该为1024。得到密码：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>没技术，是菜鸡</div></div><div>解压得到null.txt。</div><div><br/></div><div>null.txt是一个13692字节大小的文本，但用记事本打开后只能依稀看到五个空行，Notpad++连换行都看不到：</div><div><img src="CTFshow Misc 14（53-56）_files/Image [28].png" type="image/png" data-filename="Image.png" width="601"/></div><div>十六进制编辑器查看，整个文本是由 E2 80 8B/8C/8D/8E/8F等字符组成的：</div><div><img src="CTFshow Misc 14（53-56）_files/Image [29].png" type="image/png" data-filename="Image.png" width="814"/></div><div>查询<a href="https://www.utf8-chartable.de/unicode-utf8-table.pl?start=8192&amp;number=128">Unicode字符表</a>，这几个字符均为零宽度字符或控制符，所以不会在文本编辑器中显示：</div><div><img src="CTFshow Misc 14（53-56）_files/Image [30].png" type="image/png" data-filename="Image.png" width="889"/></div><div>考虑零宽字符隐写，首先尝试了在线工具<a href="http://330k.github.io/misc_tools/unicode_steganography.html">Unicode Steganography with Zero-Width Characters</a>，但解码结果是乱码：</div><div><img src="CTFshow Misc 14（53-56）_files/Image [31].png" type="image/png" data-filename="Image.png" width="1475"/></div><div>然后发现问题所在，这个工具支持的零宽字符里不包括U+200F：</div><div><img src="CTFshow Misc 14（53-56）_files/Image [32].png" type="image/png" data-filename="Image.png" width="457"/></div><div>于是换工具，使用<a href="https://offdev.net/demos/zwsp-steg-js">Offdev.net - Zero-width space steganography javascript demo</a>：</div><div><img src="CTFshow Misc 14（53-56）_files/Image [33].png" type="image/png" data-filename="Image.png" width="448"/></div><div>得到如下密文：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>U2FsdGVkX19VMkZzZEdWa1gxK3A4VGlVNGRKZng1ZUlkTi9XY2lDR3VCaDBXOStLVDVPT3hxT082NUo4RUsxMUFKNWptWGE5R1pwY2RVazhKNzNTSmJaREdyVVlVZHp0R2d0WWpQalN5dUJNYVkzeXowS1NxYkh5SE12VEhEYXcvVEhvMkJFN3hmcEJmVDBlY0syK3FJYzl5ZEdlV2w1VjhZcFAxSzA1a3FmRUhHUjQ0bmxNTEEyZDZhM1ZPbVVaNkg4V0xVU1lhL3NqdDV6TFV0bTM5UUloajdkbTluZlk5cEF6MHJVc3VscDdIcmlwUlNJOWJURGx1cXMvUnVWcnlGZHpLWS9kU0w2U2pUTmtyUzVpb3FqQjQ1L0lPNXM2U2lBWEwvQkpJVWczZ2t0MDNhMmRnMEJZSGJPSkFhdDlVQ2VEZ3BOeUFLZ1RWbS8xNXN3WUpWdWhTU1lNU3ppRzVWTTR6RmVGaDhpWDBkK200TitodDNneWhVcDhaSGdaK1hxMmRoajFkc1ZQMVZaU2ZoUkE3TzRRdm5LdGJIeDE5REdRT09vNndlZ1pxOXZuRDZjaVlDcFltWUpYcmMvaFpSUVA4WHdYRTNhZnhtdWpQSE8wOEpJZmhaMkNCeXZycjQ2a1BPR2s=</div></div><div>猜测是AES/DES等类型密码的base64形式密文，但尝试后发现需要先base64解码一次：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>Salted__U2FsdGVkX1+p8TiU4dJfx5eIdN/WciCGuBh0W9+KT5OOxqOO65J8EK11AJ5jmXa9GZpcdUk8J73SJbZDGrUYUdztGgtYjPjSyuBMaY3yz0KSqbHyHMvTHDaw/THo2BE7xfpBfT0ecK2+qIc9ydGeWl5V8YpP1K05kqfEHGR44nlMLA2d6a3VOmUZ6H8WLUSYa/sjt5zLUtm39QIhj7dm9nfY9pAz0rUsulp7HripRSI9bTDluqs/RuVryFdzKY/dSL6SjTNkrS5ioqjB45/IO5s6SiAXL/BJIUg3gkt03a2dg0BYHbOJAat9UCeDgpNyAKgTVm/15swYJVuhSSYMSziG5VM4zFeFh8iX0d+m4N+ht3gyhUp8ZHgZ+Xq2dhj1dsVP1VZSfhRA7O4QvnKtbHx19DGQOOo6wegZq9vnD6ciYCpYmYJXrc/hZRQP8XwXE3afxmujPHO08JIfhZ2CByvrr46kPOGk</div></div><div>再去掉开头的Salted__才是真正的密文，尝试发现是3DES加密，用在线工具及密钥“没技术，是菜鸡”解密得到：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>                                                            </div><div>                                                                              </div><div>                                                             </div><div>                                                                  </div><div>                                                                            </div><div>                                                                       </div><div>                                                               </div><div>                                                                   </div><div>    </div><div><br/></div></div><div>看起来可能是空白的，其实是09Tab、20空格和0D 0A换行三种不可见字符（串）组成。首先可以想到将Tab和空格分别对应长音/短音或1/0然后转换成常见密码，或作为<a href="https://zh.wikipedia.org/zh/Whitespace">Whitespace</a>程序<a href="https://vii5ard.github.io/whitespace/">运行</a>，但都没有找到有效信息。</div><div><br/></div><div>改变思路，尝试搜索“whitespace stego”（空白隐写），找到隐写工具<a href="http://www.darkside.com.au/snow/">SNOW</a>。然后发现这个工具我早就有了，就是没怎么用过……总之把上面那段空白字符保存为txt格式文本，然后用SNOW提取隐写信息，密码还是之前用过两次的那一段：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>D:\CTFToolkit-v1.1.0\信息隐藏\snow&gt;SNOW.EXE -C -p &quot;没技术，是菜鸡&quot; white.txt</div><div>flag{l0ts_0f_?????????????}</div></div><div>然后在这里卡了很久，想找到13个?代表的内容，结果最后发现，这就是最终flag……我现在也充满了问号。</div><div><br/></div><div>flag：flag{l0ts_0f_?????????????}</div><div><br/></div><div><span style="font-weight: bold;">56 麻辣兔头之看看我的小钥匙</span></div><div>题目描述：胡萝卜也是萝卜</div><div><br/></div><div>下载得到jpg格式文件，Stegsolve查看，在R/G/B Plane 0处可以看到不自然的方格状马赛克图案：</div><div><img src="CTFshow Misc 14（53-56）_files/Image [34].png" type="image/png" data-filename="Image.png"/></div><div>说明很可能使用了某种隐写工具，从文件名猜测可能是Outguess，但提取需要密码。尝试了胡萝卜不行，爆破也没有结果（可能是字典太小）。最后经好心人提醒，发现密码是萝卜的英文radish：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop# outguess -k radish -r out.jpg res</div><div>Reading out.jpg....</div><div>Extracting usable bits:   219663 bits</div><div>Steg retrieve: seed: 131, len: 589</div></div><div><br/></div><div>提取得到的隐写数据是一个文本文件，内容为：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>奇怪的菜单</div><div><br/></div><div>麻辣兔头</div><div>---------------------------------------------------------</div><div>14135 , 3|3103 , 3|4049 , 2|28037 , 3|1870 , 3|27391 , 3|24153 , 3|11337 , 2|29065 , 3|3630 , 3|23065 , 3|18013 , 2|30064 , 3|8240 , 3|8605 , 3|25091 , 3|26114 , 3|11763 , 2|27792 , 3|21324 , 2|25750 , 3|22047 , 2|9991 , 3|31036 , 3|23548 , 3|18608 , 3|31036 , 3|8829 , 2|7531 , 2|15500 , 2|31612 , 3|1488 , 3|24714 , 3|27650 , 3|9804 , 2|9991 , 3|14712 , 3|26374 , 3|28899 , 3|26079 , 2|29371 , 3|4202 , 3|4562 , 3|</div><div>---------------------------------------------------------</div><div>订餐电话:11235813213</div></div><div>首先可以发现订餐电话很明显是斐波那契数列前几位1、1、2、3、5、8、13、21、34拼接后的结果，说明本题的加密方式和斐波那契数列有关。上方以 | 分隔的43个数组很可能每组对应一个字符，注意到每组数字中后一个不是2就是3，联想到可打印字符的十进制ASCII码的位数。例如flag{的十进制ASCII码是102 108 97 103 123，正好与前五组3 3 2 3 3对应。那么每组数字的前一位很可能是用于从某个数组中定位这2或3位数字所在位置的。</div><div><br/></div><div>尝试按照订餐电话的形式，将斐波那契数列逐项拼接，然后对每个数组A,B，从拼接后的字符串第A位开始取B位：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>s = '14135 , 3|3103 , 3|4049 , 2|28037 , 3|1870 , 3|27391 , 3|24153 , 3|11337 , 2|29065 , 3|3630 , 3|23065 , 3|18013 , 2|30064 , 3|8240 , 3|8605 , 3|25091 , 3|26114 , 3|11763 , 2|27792 , 3|21324 , 2|25750 , 3|22047 , 2|9991 , 3|31036 , 3|23548 , 3|18608 , 3|31036 , 3|8829 , 2|7531 , 2|15500 , 2|31612 , 3|1488 , 3|24714 , 3|27650 , 3|9804 , 2|9991 , 3|14712 , 3|26374 , 3|28899 , 3|26079 , 2|29371 , 3|4202 , 3|4562 , 3|'</div><div>s = s.split('|')[:-1]</div><div>for i in range(len(s)):</div><div>    tmp = s[i].split(' , ')</div><div>    s[i] = [int(tmp[0]), int(tmp[1])]</div><div># print(max(i[0] for i in s))</div><div># 31612</div><div><br/></div><div>f, a1, a2 = '1', 1, 1</div><div>while len(f) &lt; 31612 + 2:</div><div>    f += str(a2)</div><div>    a1, a2 = a2, a1 + a2</div><div><br/></div><div>for i in s:</div><div>    print(f[i[0] : i[0] + i[1]], end = ' ')</div></div><div>输出结果：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>102 108 97 103 123 110 111 95 111 110 101 95 107 110 111 119 115 95 109 97 108 97 116 117 116 111 117 95 98 97 116 116 101 114 95 116 104 101 110 95 109 101 125</div></div><div>很显然前几个数字和flag格式前几位“flag{”的十进制ASCII码是完全一致的。将其转码：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>for i in s:</div><div>    print(chr(int(f[i[0] : i[0] + i[1]])), end = '')</div></div><div>输出结果：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>flag{no_one_knows_malatutou_batter_then_me}</div></div><div><br/></div><div>flag：flag{no_one_knows_malatutou_batter_then_me}</div></span>
</div></body></html> 