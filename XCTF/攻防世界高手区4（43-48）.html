<html>
<head>
  <title>攻防世界高手区4（43-48）</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/605894 (zh-CN, DDL); Windows/6.1.1 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="1144"/>
<h1>攻防世界高手区4（43-48）</h1>
<h2><a href="https://DemonStarAlgol.github.io/Misc/">[无关链接]</a></h2>

<div>
<span><div><span style="font-weight: bold;">043 奇怪的TTL字段</span></div><div>我们截获了一些IP数据报，发现报文头中的TTL值特别可疑，怀疑是通信方嵌入了数据到TTL，我们将这些TTL值提取了出来，你能看出什么端倪吗？</div><div><br/></div><div>下载得到ttl.txt，内容为大量TTL值：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>TTL=127</div><div>TTL=191</div><div>TTL=127</div><div>TTL=191</div><div>TTL=127</div><div>TTL=191</div><div>TTL=127</div><div>TTL=191</div><div>TTL=127</div><div>TTL=191</div><div>TTL=127</div><div>TTL=63</div><div>TTL=63</div><div>TTL=255</div><div>TTL=191</div><div>TTL=63</div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">...</span></div></div><div>首先注意到整段文件只有四种TTL值：63、127、191、255。</div><div>转换为十六进制：0x00111111、0x01111111、0x10111111、0x11111111。</div><div>只有最前两位不同，尝试一下提取前16行的最前两位：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>01100110 01100110 01100100 00111000</div></div><div>ASCII转码：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>FF D8</div></div><div>是jpeg格式文件头。<span style="font-size: unset; color: unset; font-family: unset;">写个脚本处理一下：</span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>file = open('C:/Users/Administrator/Desktop/ttl.txt', 'r')</div><div>line = file.readlines()</div><div>a = []</div><div>for i in line:</div><div>    a.append(int(i[4:]))</div><div>b = ''</div><div>for i in a:</div><div>    if i == 63:</div><div>        b += '00'</div><div>    if i == 127:</div><div>        b += '01'</div><div>    if i == 191:</div><div>        b += '10'</div><div>    if i == 255:</div><div>        b += '11'</div><div>print(b)</div><div><br/></div><div>import binascii</div><div>flag = ''</div><div>for i in range(0, len(b), 8):</div><div>    flag += chr(int(b[i : i+8], 2))</div><div>flag = binascii.unhexlify(flag)</div><div>print(flag)</div><div>img = open('C:/Users/Administrator/Desktop/flag.jpg', 'wb')</div><div>img.write(flag)</div><div>img.close()</div></div><div>得到图片：</div><div><img src="攻防世界高手区4（43-48）_files/flag.jpg" type="image/jpeg" data-filename="flag.jpg"/></div><div>是二维码的一部分，十六进制编辑器打开会发现文件中有多个jpeg文件头，foremost分离。</div><div><img src="攻防世界高手区4（43-48）_files/Image.png" type="image/png" data-filename="Image.png"/></div><div>最后拼起来得到完整二维码。</div><div><img src="攻防世界高手区4（43-48）_files/Image [1].png" type="image/png" data-filename="Image.png"/></div><div>扫码：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>key:AutomaticKey cipher:fftu{2028mb39927wn1f96o6e12z03j58002p}</div></div><div>用<a href="https://www.wishingstarmoye.com/ctf/autokey">autokey在线解密</a>（和维吉尼亚有点类似但不完全一样）：</div><div><img src="攻防世界高手区4（43-48）_files/Image [2].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>flag：flag{2028ab39927df1d96e6a12b03e58002e}</div><div><br/></div><div><span style="font-weight: bold;">044 2-1</span></div><div><br/></div><div>下载得到png文件，十六进制查看开头为80 59 4E 47，修复为89 50，但图片仍然打不开，这是因为文件头部数据出现问题导致CRC验证无法通过。</div><div><img src="攻防世界高手区4（43-48）_files/Image [3].png" type="image/png" data-filename="Image.png"/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>* （固定）八个字节89 50 4E 47 0D 0A 1A 0A为png的文件头</div><div>* （固定）四个字节00 00 00 0D（即为十进制的13）代表数据块的长度为13</div><div>* （固定）四个字节49 48 44 52（即为ASCII码的IHDR）是文件头数据块的标示（IDCH）</div><div>* （可变）13位数据块（IHDR)</div><div>    * 前四个字节代表该图片的宽</div><div>    * 后四个字节代表该图片的高</div><div>    * 后五个字节依次为： Bit depth、ColorType、Compression method、Filter method、Interlace method</div></div><div><img src="攻防世界高手区4（43-48）_files/Image [4].png" type="image/png" data-filename="Image.png"/></div><div>可以看出这个图片的宽度显示为0，显然有问题。用python脚本爆破正确的宽度：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>import struct</div><div>import binascii</div><div><br/></div><div>m = open('C:/Users/Administrator/Desktop/1.png', 'rb').read()</div><div>for i in range(1024):</div><div>    c = m[12 : 16] + struct.pack('&gt;i', i) + m[20 : 29]</div><div>    crc = binascii.crc32(c) &amp; 0xffffffff</div><div>    if crc == 0x932f8a6b:</div><div>        print(i)</div></div><div>结果为709=0x2C5，十六进制编辑器中修改图片宽度，修复完成。</div><div><img src="攻防世界高手区4（43-48）_files/1.png" type="image/png" data-filename="1.png"/></div><div>flag：wdflag{Png_C2c_u_kn0W}</div><div><br/></div><div><span style="font-weight: bold;">045 互相伤害!!!</span></div><div><br/></div><div>下载得到无后缀名的文件，file命令确定文件类型。</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop# file 6388679263e2e624b3c29e4671f6dc</div><div>6388679263e2e624b3c29e4671f6dc: pcapng capture file - version 1.0</div></div><div>binwalk或foremost均能发现数据包中存在多张图片。利用wireshark导出HTTP对象，将图片全部保存。</div><div><img src="攻防世界高手区4（43-48）_files/Image [5].png" type="image/png" data-filename="Image.png"/></div><div><img src="攻防世界高手区4（43-48）_files/Image [6].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>首先注意到如下图片。</div><div><img src="攻防世界高手区4（43-48）_files/seclover.php%3ffile=4356f2b426ad8355c99e9388a3189c89.jpg" type="image/jpeg" data-filename="seclover.php%3ffile=4356f2b426ad8355c99e9388a3189c89.jpg"/></div><div>二维码扫描得到：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>U2FsdGVkX1+VpmdLwwhbyNU80MDlK+8t61sewce2qCVztitDMKpQ4fUl5nsAZOI7bE9uL8lW/KLfbs33aC1XXw==</div></div><div>根据提示用CTF为密钥进行AES解密，得到：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>668b13e0b0fc0944daf4c223b9831e49</div></div><div><br/></div><div>接下来十六进制编辑器查看每张图片，发现末尾均藏有zip压缩包。但解压得到的均是无效信息二维码。</div><div><img src="攻防世界高手区4（43-48）_files/seclover.php%3ffile=70bf85eda6b86ee92a5f437f7d83b7e5.jpg" type="image/jpeg" data-filename="seclover.php%3ffile=70bf85eda6b86ee92a5f437f7d83b7e5.jpg"/></div><div>只有上述这张能够提取得到一个加密zip压缩包。<span style="font-size: unset; color: unset; font-family: unset;">用上述AES解密结果作为密码解压得到二维码。</span></div><div><img src="攻防世界高手区4（43-48）_files/a1d63bb3ed1f9df89b72375f1ed79e5d.jpg" type="image/jpeg" data-filename="a1d63bb3ed1f9df89b72375f1ed79e5d.jpg"/></div><div>发现其中心位置有小二维码，扫码得到flag。</div><div><br/></div><div>flag：flag{97d1-0867-2dc1-8926-144c-bc8a-4d4a-3758}</div><div><br/></div><div><span style="font-weight: bold;">046 我们的秘密是绿色的</span></div><div><br/></div><div>下载得到我们的秘密是green.jpg。根据题名提示，用oursecret隐写软件。密码是图片中的绿色数字，即0405111218192526。</div><div><img src="攻防世界高手区4（43-48）_files/Image [7].png" type="image/png" data-filename="Image.png"/></div><div>得到try.zip。</div><div><img src="攻防世界高手区4（43-48）_files/Image [8].png" type="image/png" data-filename="Image.png"/></div><div>既然密码是生日那么就暴力破解。先生成字典。</div><div><img src="攻防世界高手区4（43-48）_files/Image [9].png" type="image/png" data-filename="Image.png"/></div><div><img src="攻防世界高手区4（43-48）_files/Image [10].png" type="image/png" data-filename="Image.png"/></div><div>解压得到flag.zip。</div><div><img src="攻防世界高手区4（43-48）_files/Image [11].png" type="image/png" data-filename="Image.png"/></div><div>用上一步得到的readme.txt，明文破解。</div><div><img src="攻防世界高手区4（43-48）_files/Image [12].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>解压得到又一个flag.zip，这次是伪加密，ZipCenOp.jar处理即可。解压得到flag.txt：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>qddpqwnpcplen%prqwn_{_zz*d@gq}</div></div><div>大括号的位置比较可疑。试一下<a href="https://github.com/qianxiao996/CTF-Tools/releases/">CTF-tools</a>这款工具进行栅栏密码爆破，找到比较可疑的结果：</div><div><img src="攻防世界高手区4（43-48）_files/Image [13].png" type="image/png" data-filename="Image.png"/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>qwlr{ddneq_@dpnwzgpc%nzqqpp_*}</div></div><div>下一步是凯撒爆破：</div><div><img src="攻防世界高手区4（43-48）_files/Image [14].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>flag：<span style="text-indent: 0px;">flag{ssctf_@seclover%coffee_*}</span></div><div><br/></div><div><span style="text-indent: 0px; font-weight: bold;">047 </span><span style="font-weight: bold;">隐藏的信息</span></div><div><br/></div><div>下载得到message.txt，内容：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>0126 062 0126 0163 0142 0103 0102 0153 0142 062 065 0154 0111 0121 0157 0113 0111 0105 0132 0163 0131 0127 0143 066 0111 0105 0154 0124 0121 060 0116 067 0124 0152 0102 0146 0115 0107 065 0154 0130 062 0116 0150 0142 0154 071 0172 0144 0104 0102 0167 0130 063 0153 0167 0144 0130 060 0113</div></div><div>八进制ASCII转码得到：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>V2VsbCBkb25lIQoKIEZsYWc6IElTQ0N7TjBfMG5lX2Nhbl9zdDBwX3kwdX0K</div></div><div>base64解码得到：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>Well done!</div><div><br/></div><div><br/></div><div>Flag: ISCC{N0_0ne_can_st0p_y0u}</div></div><div>大哥这是Crypto题吧。</div><div><br/></div><div>flag：ISCC{N0_0ne_can_st0p_y0u}</div><div><br/></div><div><span style="font-weight: bold;">048 Become_a_Rockstar</span></div><div><br/></div><div>下载得到Become_a_Rockstar.rock，是个txt文本，内容：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>Leonard Adleman says star</div><div>Problem Makers is Problem Makers</div><div>Problem Makers says NCTF{</div><div><br/></div><div>God takes World</div><div>A boy says flag</div><div>The boy is Bob</div><div><br/></div><div>Evil takes your mind</div><div>A girl says no flag</div><div>The girl is Alice</div><div><br/></div><div>Truths were ctf hoster violently FUCK</div><div>Bob says ar</div><div>Adi Shamir says rock</div><div>Love takes Alice and Bob</div><div>Mallory was a eavesdroppers</div><div>Mallory's in hell</div><div><br/></div><div>Everything is literatures, potentially flag, Earth, description, soul</div><div>Alice says you</div><div><br/></div><div>Reality takes God and Evil</div><div>God was in heaven</div><div>Evil is in the world</div><div><br/></div><div>Ron Rivest says nice</div><div>You Want To takes Alice and Love and Anything</div><div>You's Loser. Without Alice, Love or Anything</div><div><br/></div><div>Listen to your heart</div><div>You were Loser</div><div>Listen to your mind</div><div>Nothing was psb unfulfilled</div><div><br/></div><div>If Truths of Nothing is Everything</div><div>Put Ron Rivest with Adi Shamir with Leonard Adleman into RSA</div><div><br/></div><div>If Everything over Nothing is Truths</div><div>Put Problem Makers with Alice into Problem Makers with Bob</div><div><br/></div><div>Say Problem Makers</div><div>The flag is in your heart</div><div>The confusion is in your mind</div><div>Shout RSA</div><div><br/></div><div>Mysterious One says }</div><div>Whisper Mysterious One</div><div><br/></div><div>This is live</div><div>This is the truth</div><div>This is reality</div><div>This is art</div><div>This is CTF</div><div>This is NOT program</div></div><div>看起来像是歌词，但有多个词语是重复出现的，且有says、is、takes等动词连接，有If语句，看起来很像是门程序语言。搜索发现<a href="https://blog.csdn.net/weixin_34109408/article/details/86720334">Rockstar编程语言</a>（<a href="https://github.com/RockstarLang/rockstar">github</a>）。</div><div>根据<a href="https://github.com/yyyyyyyan/rockstar-py">这个页面</a>的说明将其转成Python：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>Leonard_Adleman = &quot;star&quot;</div><div>Problem_Makers = 76</div><div>Problem_Makers = &quot;NCTF{&quot;</div><div>def God(World):</div><div>    a_boy = &quot;flag&quot;</div><div>    the_boy = 3</div><div>def Evil(your_mind):</div><div>    a_girl = &quot;no flag&quot;</div><div>    the_girl = 5</div><div>Truths = 3694</div><div>Bob = &quot;ar&quot;</div><div>Adi_Shamir = &quot;rock&quot;</div><div>def Love(Alice, Bob):</div><div>    Mallory = 13</div><div>    Mallory = 24</div><div>Everything = 114514</div><div>Alice = &quot;you&quot;</div><div>def Reality(God, Evil):</div><div>    God = 26</div><div>    Evil = 235</div><div>Ron_Rivest = &quot;nice&quot;</div><div>def You_Want_To(Alice, Love, Anything):</div><div>    You = 5.75428</div><div>your_heart = input()</div><div>You = 5</div><div>your_mind = input()</div><div>Nothing = 31</div><div>if Truths * Nothing == Everything:</div><div>    Rsa = Ron_Rivest + Adi_Shamir + Leonard_Adleman</div><div>if Everything / Nothing == Truths:</div><div>    Problem_Makers = Problem_Makers + Alice + Bob</div><div>print(Problem_Makers)</div><div>the_flag = 245</div><div>the_confusion = 244</div><div>print(Rsa)</div><div>Mysterious_One = &quot;}&quot;</div><div>print(Mysterious_One)</div><div>This = 4</div><div>This = 35</div><div>This = 7</div><div>This = 3</div><div>This = 3</div><div>This = 37</div></div><div>跑一遍得到flag。</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>NCTF{youar</div><div>nicerockstar</div><div>}</div></div><div><br/></div><div>flag：NCTF{youar<span style="font-size: unset; color: unset; font-family: unset;">nicerockstar</span><span style="font-size: unset; color: unset; font-family: unset;">}</span></div></span>
</div></body></html> 