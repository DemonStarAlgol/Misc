<html>
<head>
  <title>攻防世界高手区6（55-60）</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/605894 (zh-CN, DDL); Windows/6.1.1 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="1123"/>
<h1>攻防世界高手区6（55-60）</h1>
<h2><a href="https://DemonStarAlgol.github.io/Misc/">[无关链接]</a></h2>

<div>
<span><div><span style="font-weight: bold;">55 3-1</span></div><div><br/></div><div>下载得到无后缀名文件，十六进制编辑器查看，是rar压缩包。</div><div><span style="font-size: unset; color: unset; font-family: unset;">解压得到++_++文件，十六进制看了下大概是流量数据包，wireshark打开。</span></div><div>搜索字符串flag找到了flag.rar和flag.txt，再搜索52 61 72 21找到rar文件头，追踪http流后提取rar压缩包。</div><div><img src="攻防世界高手区6（55-60）_files/Image.png" type="image/png" data-filename="Image.png"/></div><div>打开发现有密码。http流中已无信息，开始追踪tcp流。这段就很可疑：</div><div><img src="攻防世界高手区6（55-60）_files/Image [1].png" type="image/png" data-filename="Image.png"/></div><div>有base64密文，有cat和ping命令，还有python代码。先看python代码：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div># coding:utf-8</div><div>__author__ = 'YFP'</div><div><br/></div><div>from Crypto import Random</div><div>from Crypto.Cipher import AES</div><div>import sys</div><div>import base64</div><div><br/></div><div>IV = 'QWERTYUIOPASDFGH'</div><div>def decrypt(encrypted):</div><div>    aes = AES.new(IV, AES.MODE_CBC, IV)</div><div>    return aes.decrypt(encrypted)</div><div><br/></div><div>def encrypt(message):</div><div>    length = 16</div><div>    count = len(message)</div><div>    padding = length - (count % length)</div><div>    message = message + '\0' * padding</div><div>    aes = AES.new(IV, AES.MODE_CBC, IV)</div><div>    return aes.encrypt(message)</div><div><br/></div><div>str = 'this is a test'</div><div>example = encrypt(str)</div><div>print(decrypt(example))</div></div><div>是一段解密代码，结合前方的base64密文，加入以下代码：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>s = '19aaFYsQQKr+hVX6hl2smAUQ5a767TsULEUebWSajEo='</div><div>flag = base64.b64decode(s)</div><div>print(decrypt(flag))</div></div><div>运行（好像只能用python2）后得到：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>passwd={No_One_Can_Decrypt_Me}aa</div></div><div>用No_One_Can_Decrypt_Me作为密码解压压缩包得到flag。</div><div><br/></div><div>flag：WDCTF{Seclab_CTF_2017}</div><div><br/></div><div><span style="font-weight: bold;">056 4-2</span></div><div><br/></div><div>下载得到txt文件。</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>Eg qnlyjtcnzydl z umaujejmjetg qeydsn eu z bsjdtx tw sgqtxegc al kdeqd mgeju tw yrzegjsoj zns nsyrzqsx kejd qeydsnjsoj</div><div>Ew ltm fgtk jds kzl tw sgqtxegc m kerr csj jds wrzc kdeqd eu qrzuueqzr-qeydsn_eu_gtj_usqmnejl_du</div></div><div>尝试简单替换加密。用<a href="https://quipqiup.com/">https://quipqiup.com/</a>，auto模式自动解密，得到：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>In cryptography a substitution cipher is a method of encoding by which units of plaintext are replaced with ciphertext If you know the way of encoding u will get the flag which is classical-cipher_is_not_security_hs</div></div><div>大哥这是Crypto题吧？</div><div><br/></div><div>flag：flag{classical-cipher_is_not_security_hs}</div><div><br/></div><div><span style="font-weight: bold;">057 5-1</span></div><div><br/></div><div>下载得到无后缀名文件，file命令也没有结果，说明是整段数据被加密了。</div><div>本题有一个新知识点：xortool工具。下载安装略，直接利用工具解密。</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>C:\Users\Administrator\Desktop\xortool-for-Windows-master\xortool&gt;python2 xortool.py -c 20 badd3e0621ff43de8cf802545bbd3ed0</div><div>// </div><div>The most probable key lengths:</div><div>   2:   12.2%</div><div>   5:   11.9%</div><div>   9:   9.8%</div><div>  13:   22.2%</div><div>  20:   6.8%</div><div>  22:   6.2%</div><div>  26:   12.8%</div><div>  30:   4.6%</div><div>  39:   7.8%</div><div>  52:   5.7%</div><div>Key-length can be 3*n</div><div>1 possible key(s) of length 13:</div><div>Good\tuckToYou</div><div>Found 1 plaintexts with 95.0%+ valid characters</div><div>See files filename-key.csv, filename-char_used-perc_valid.csv</div></div><div>猜测密钥，命令中-c指出现频率最高的字符，一般文本为20，二进制文件为00。</div><div>猜测结果，长度为13，猜测得到的密钥有一位错误，应为GoodLuckToYou。写python脚本解密：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>key = 'GoodLuckToYou'</div><div>flag = ''</div><div>c = open('C:/Users/Administrator/Desktop/badd3e0621ff43de8cf802545bbd3ed0', 'rb').read()</div><div>for i in range(len(c)):</div><div>    flag += chr(c[i] ^ ord(key[i % 13]))</div><div>print(flag)</div></div><div>运行结果：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>The opening line of the novel famously announces: &quot;It is a truth universally acknowledged, that a single man in possession of a good fortune must be in want of a wife.&quot; This sets marriage as a central subjectâand really, a central problemâfor the novel generally. Readers are poised to question whether or not these single men are, in fact, in want of a wife, or if such desires are dictated by the &quot;neighbourhood&quot; families and their daughters who require a &quot;good fortune&quot;. Marriage is a complex social activity that takes political economy, and economy more generally, into account. In the case of Charlotte Lucas, for example, the seeming success of her marriage lies in the comfortable economy of their household, while the relationship between Mr and Mrs Bennet serves to illustrate bad marriages based on an initial attraction and surface over substance (economic and psychological). The Bennets' marriage is one such example that the youngest Bennet, Lydia, will come to re-enact with Wickham, and the results are far from felicitous. wdflag{You Are Very Smart}Though the central characters, Elizabeth and Darcy, begin the novel as hostile acquaintances and unlikely friends, they eventually work to understand each other and themselves so that they can marry each other on compatible terms personally, even if their &quot;equal&quot; social status remains fraught. When Elizabeth rejects Darcy's first proposal, the argument of only marrying when one is in love is introduced. Elizabeth only accepts Darcy's proposal when she is certain she loves him and her feelings are reciprocated. Austen's complex sketching of different marriages ultimately allows readers to question what forms of alliance are desirable, especially when it comes to privileging economic, sexual, companionate attraction.</div></div><div><br/></div><div>flag：wdflag{You Are Very Smart}</div><div><br/></div><div><span style="font-weight: bold;">058 low</span></div><div><br/></div><div>下载得到low.bmp。用Windows画图保存为png格式后，Stegsolve打开，在任一plane 0处发现二维码。</div><div><img src="攻防世界高手区6（55-60）_files/Image [2].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div><span style="color: rgb(255, 0, 0); font-weight: bold;">（为什么原始的bmp图像用Stegsolve打开找不到二维码？可能是因为原图实际上是通过像素最低位的奇偶性来进行LSB隐写，隐写内容实际上是个二值黑白图像。预期解脚本如下：）</span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="color: rgb(255, 0, 0);">from PIL import Image</font></div><div><font style="color: rgb(255, 0, 0);"><br/></font></div><div><font style="color: rgb(255, 0, 0);">img = Image.open('C:/Users/Administrator/Desktop/low.bmp')</font></div><div><font style="color: rgb(255, 0, 0);">img_tmp = img.copy()</font></div><div><font style="color: rgb(255, 0, 0);">pix = img_tmp.load()</font></div><div><font style="color: rgb(255, 0, 0);">w, h = img_tmp.size</font></div><div><font style="color: rgb(255, 0, 0);"><br/></font></div><div><font style="color: rgb(255, 0, 0);">for i in range(w):</font></div><div><font style="color: rgb(255, 0, 0);">   for j in range(h):</font></div><div><font style="color: rgb(255, 0, 0);">      if pix[i, j] &amp; 1 == 0:</font></div><div><font style="color: rgb(255, 0, 0);">         pix[i, j] = 255</font></div><div><font style="color: rgb(255, 0, 0);">      else:</font></div><div><font style="color: rgb(255, 0, 0);">         pix[i, j] = 0</font></div><div><font style="color: rgb(255, 0, 0);">img_tmp.show()</font></div></div><div><br/></div><div>flag：flag{139711e8e9ed545e}</div><div><br/></div><div><span style="font-weight: bold;">059 misc1</span></div><div>题目：d4e8e1f4a0f7e1f3a0e6e1f3f4a1a0d4e8e5a0e6ece1e7a0e9f3baa0c4c4c3d4c6fbb9e1e6b3e3b9e4b3b7b7e2b6b1e4b2b6b9e2b1b1b3b3b7e6b3b3b0e3b9b3b5e6fd</div><div><br/></div><div>首先观察这串字符，显然是十六进制数字，且每两位分隔的话，每个数字都在128-255之间。尝试将每两位减去128后ASCII转码：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>a = 'd4e8e1f4a0f7e1f3a0e6e1f3f4a1a0d4e8e5a0e6ece1e7a0e9f3baa0c4c4c3d4c6fbb9e1e6b3e3b9e4b3b7b7e2b6b1e4b2b6b9e2b1b1b3b3b7e6b3b3b0e3b9b3b5e6fd'</div><div>for i in range(0, len(a), 2):</div><div>    b = int(a[i : i+2], 16) - 128</div><div>    print(chr(b), end = '')</div></div><div>运行结果：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>That was fast! The flag is: DDCTF{9af3c9d377b61d269b11337f330c935f}</div></div><div>大哥这不是Crypto题吗？</div><div><br/></div><div>flag：DDCTF{9af3c9d377b61d269b11337f330c935f}</div><div><br/></div><div><span style="font-weight: bold;">060 Miscellaneous-200</span></div><div><br/></div><div>下载得到txt文件。内容有61366（=2 x 61 x 503）行，每行是逗号分隔的三个最大为255的数字。猜测每一行是一个像素点的RGB值。python绘图：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>from PIL import Image</div><div><br/></div><div>f = open('C:/Users/Administrator/Desktop/1.txt').readlines()</div><div><br/></div><div>w = 122</div><div>h = 503</div><div>im = Image.new(&quot;RGB&quot;, (w, h))</div><div><br/></div><div>for i in range(w):</div><div>    for j in range(h):</div><div>        line = f[i + j * w]</div><div>        r = int(line[:-1:].split(',')[0])</div><div>        g = int(line[:-1:].split(',')[1])</div><div>        b = int(line[:-1:].split(',')[2])</div><div>        im.putpixel((i, j), (r, g, b))</div><div>im.save('C:/Users/Administrator/Desktop/flag.png')</div></div><div>测试各种可能的宽高值后，以宽度122、高度503绘图，得到图像：</div><div><img src="攻防世界高手区6（55-60）_files/flag.png" type="image/png" data-filename="flag.png"/></div><div><br/></div><div>flag：flag{ youc@n'tseeme }</div></span>
</div></body></html> 