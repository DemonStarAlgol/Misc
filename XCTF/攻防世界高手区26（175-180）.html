<html>
<head>
  <title>攻防世界高手区26（175-180）</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/605894 (zh-CN, DDL); Windows/6.1.1 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="10853"/>
<h1>攻防世界高手区26（175-180）</h1>
<h2><a href="https://DemonStarAlgol.github.io/Misc/">[无关链接]</a></h2>

<div>
<span><div><span style="font-weight: bold;">175 Check</span></div><div><br/></div><div>下载得到png格式文件，zsteg一把梭的过程中发现了可疑内容：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop# zsteg -a check.png</div><div>b1,rgb,lsb,xy       .. text: &quot;&amp;#x66;&amp;#x6c;&amp;#x61;&amp;#x67;&amp;#x7b;&amp;#x68;&amp;#x30;&amp;#x77;&amp;#x5f;&amp;#x34;&amp;#x62;&amp;#x6f;&amp;#x75;&amp;#x54;&amp;#x5f;&amp;#x65;&amp;#x6e;&amp;#x63;&amp;#x30;&amp;#x64;&amp;#x65;&amp;#x5f;&amp;#x34;&amp;#x6e;&amp;#x64;&amp;#x5f;&amp;#x70;&amp;#x6e;&amp;#x47;&amp;#x7d;m&quot;</div></div><div>很显然是HTML实体编码，转个码：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>flag{h0w_4bouT_enc0de_4nd_pnG}</div></div><div><br/></div><div>flag：flag{h0w_4bouT_enc0de_4nd_pnG}</div><div><br/></div><div><span style="font-weight: bold;">176 fakezip</span></div><div><br/></div><div>下载得到加密的zip格式压缩包，先尝试未加密，ZIpCenOp一把梭：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>D:\CTFToolkit-v1.1.0\暴力破解\ZipCenOp&gt;java -jar ZipCenOp.jar r 0cb6f418-26ab-40ec-86db-ec7134b27e67.zip</div></div><div>解压得到flag.png：</div><div><img src="攻防世界高手区26（175-180）_files/flag.png" type="image/png" data-filename="flag.png"/></div><div><br/></div><div>flag：flag{39281de6-fe64-11ea-adc1-0242ac120002}</div><div><br/></div><div><span style="font-weight: bold;">177 nice_bgm</span></div><div><br/></div><div>下载得到mp3格式文件。波形/频谱、MP3Stego等方式试了一遍，都没有结果，最后用010editor打开看一下每个Frame的Private Bit：</div><div><img src="攻防世界高手区26（175-180）_files/Image.png" type="image/png" data-filename="Image.png"/></div><div>前几个Frame的Private Bit确实有1又有0，尝试把这些bit提取出来。</div><div><br/></div><div>注意到每个Frame的大小是不一样的：</div><div><img src="攻防世界高手区26（175-180）_files/Image [1].png" type="image/png" data-filename="Image.png"/></div><div>因此不能直接用循环切片方式读取，需要对下一个Frame的位置进行判断。脚本：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>import re</div><div><br/></div><div>d = open('C:/Users/Administrator/Desktop/1.mp3', 'rb').read()[0x399D0: ]</div><div>res = ''</div><div>for i in range(5911):</div><div>    private_bit = d[2] &amp; 1</div><div>    res += str(private_bit)</div><div>    if d[0x1A1: 0x1A3] == b'\xFF\xFB':</div><div>        d = d[0x1A1: ]</div><div>    elif d[0x1A2: 0x1A4] == b'\xFF\xFB':</div><div>        d = d[0x1A2: ]</div><div><br/></div><div>print(bytes([int(i, 2) for i in re.findall(r'.{8}', res)]))</div></div><div><br/></div><div>flag：flag{0k4_YOu_Seem_s0_cl3ver_t0_find_f1ag!}</div><div><br/></div><div><span style="font-weight: bold;">178 Misc文件类型</span></div><div><br/></div><div>下载得到txt格式文件，内容：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>3436455341425F554573444242514141</div><div>41414941416C64434658714F7737634B</div><div>4141414143594141414149414141415A</div><div>6D78685A7935306548524C79306C4D72</div><div>7A5A49536B303253457778546B6B304D</div><div>6A5130546A593353445531534573784E</div><div>544D3054374A494E552B7A7241554155</div><div>45734241685141464141414141674143</div><div>56304956656F374474776F414141414A</div><div>674141414167414A4141414141414141</div><div>414167414141414141414141475A7359</div><div>57637564486830436741674141414141</div><div>41414241426741477845666B39697132</div><div>41456245522B54324B725941514A462B</div><div>34725971746742554573464267414141</div><div>41414241414541576741414145344141</div><div>4141414141</div></div><div>十六进制转码转一下：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>46ESAB_UEsDBBQAAAAIAAldCFXqOw7cKAAAACYAAAAIAAAAZmxhZy50eHRLy0lMrzZISk02SEwxTkk0MjQ0TjY3SDU1SEsxNTM0T7JINU+zrAUAUEsBAhQAFAAAAAgACV0IVeo7DtwoAAAAJgAAAAgAJAAAAAAAAAAgAAAAAAAAAGZsYWcudHh0CgAgAAAAAAABABgAGxEfk9iq2AEbER+T2KrYAQJF+4rYqtgBUEsFBgAAAAABAAEAWgAAAE4AAAAAAA</div></div><div>首先可以看到开头有个反过来的BASE64，那么把后面的部分base64解码一下：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>import base64</div><div><br/></div><div>s = 'UEsDBBQAAAAIAAldCFXqOw7cKAAAACYAAAAIAAAAZmxhZy50eHRLy0lMrzZISk02SEwxTkk0MjQ0TjY3SDU1SEsxNTM0T7JINU+zrAUAUEsBAhQAFAAAAAgACV0IVeo7DtwoAAAAJgAAAAgAJAAAAAAAAAAgAAAAAAAAAGZsYWcudHh0CgAgAAAAAAABABgAGxEfk9iq2AEbER+T2KrYAQJF+4rYqtgBUEsFBgAAAAABAAEAWgAAAE4AAAAAAA'</div><div>with open('C:/Users/Administrator/Desktop/2', 'wb') as f:</div><div>    f.write(base64.b64decode(s + '=' * (4 - len(s) % 4)))</div></div><div><img src="攻防世界高手区26（175-180）_files/Image [2].png" type="image/png" data-filename="Image.png"/></div><div>明显是个zip格式压缩包，直接解压拿到flag。</div><div><br/></div><div>flag：flag{0bec0ad3da2113c70e50fd5617b8e7f9}</div><div><br/></div><div><span style="font-weight: bold;">179 Time_losing</span></div><div>题目：2033-05-18 11:33:20似乎是个好时间。</div><div><br/></div><div>下载得到zip格式文件，打开看看：</div><div><img src="攻防世界高手区26（175-180）_files/Image [3].png" type="image/png" data-filename="Image.png"/></div><div>哇全是txt，但是大部分都是0字节，有内容的那几个也不包含flag。</div><div><br/></div><div>注意到所有文件的修改时间都在2033年，而且如果按照文件名排列文件，那么修改时间是乱序的。结合题目提示也涉及了时间，那么这个修改时间肯定有问题。7-zip打开，按修改时间排序，看一下最迟一个46.txt的修改时间：</div><div><img src="攻防世界高手区26（175-180）_files/Image [4].png" type="image/png" data-filename="Image.png"/></div><div>是2033-05-18 11:35:25，和2033-05-18 11:33:20正好相差125秒。同样的，看一下最早的1.txt：</div><div><img src="攻防世界高手区26（175-180）_files/Image [5].png" type="image/png" data-filename="Image.png"/></div><div>和2033-05-18 11:33:20相差72秒，都在ASCII可打印字符编码范围内。</div><div><br/></div><div>解压一下，然后用脚本来读修改时间，然后转码：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>import os, time</div><div><br/></div><div>path = 'C:/Users/Administrator/Desktop/stego/'</div><div>start = time.mktime(time.strptime('2033-05-18 11:33:20', '%Y-%m-%d %H:%M:%S'))</div><div><br/></div><div>print(bytes([int(os.path.getmtime(f'{path}{i}.txt') - start) for i in range(47)]))</div></div><div><br/></div><div>flag：XMan{seems_to_be_related_to_the_special_guests}</div><div><br/></div><div><b>180 misc_xor</b></div><div><br/></div><div>下载得到txt格式文件：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>cidb~0f&lt;f==0f634014`5g734c0=g34ag=f`fx</div></div><div>既然题目叫xor那就是异或加密，CyberChef秒了：</div><div><img src="攻防世界高手区26（175-180）_files/Image [6].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>flag：flag{5c9c885c361541e0b261f58b61db8cec}</div></span>
</div></body></html> 