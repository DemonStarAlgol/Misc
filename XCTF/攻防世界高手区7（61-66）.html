<html>
<head>
  <title>攻防世界高手区7（61-66）</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/605894 (zh-CN, DDL); Windows/6.1.1 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="1113"/>
<h1>攻防世界高手区7（61-66）</h1>
<h2><a href="https://DemonStarAlgol.github.io/Misc/">[无关链接]</a></h2>

<div>
<span><div><span style="font-weight: bold;">061 Miscellaneous-300</span></div><div><br/></div><div>下载得到zip文件，打开是这样：</div><div><img src="攻防世界高手区7（61-66）_files/Image.png" type="image/png" data-filename="Image.png"/></div><div>尝试了一下，密码就是46783。但打开46783.zip发现，其中有47096.zip，且密码也是47096。如此多层嵌套。</div><div>写个python脚本循环解压：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>import zipfile</div><div>import re</div><div><br/></div><div>path = 'C:/Users/Administrator/Desktop/zip/'</div><div>zipname = path + '1.zip'</div><div>while True:</div><div>    if zipname != path + '73168.zip':</div><div>        ts1 = zipfile.ZipFile(zipname)</div><div>        res = ts1.namelist()[0].split('.')[0]</div><div>        print(res)</div><div>        passwd = bytes(res, 'utf-8')</div><div>        ts1.extractall(path, pwd = passwd)</div><div>        zipname = path + ts1.namelist()[0]</div></div><div>对每一层自动读取下一个压缩包的文件名，然后解压上一个压缩包。最终执行到12475.zip时突然报错。</div><div><img src="攻防世界高手区7（61-66）_files/Image [1].png" type="image/png" data-filename="Image.png"/></div><div>所以和题目里提示的73168.zip好像没什么关系，12475.zip中包含mess.wav。</div><div><span style="font-weight: bold;"><a href="攻防世界高手区7（61-66）_files/12475.zip"><img src="攻防世界高手区7（61-66）_files/9c549fa800c51947034c6daedc913838.png" alt="12475.zip"></a></span></div><div>暴力破解。</div><div><span style="font-weight: bold;"><img src="攻防世界高手区7（61-66）_files/Image [2].png" type="image/png" data-filename="Image.png"/></span></div><div>得到mess.wav，audacity打开，频谱图。</div><div><img src="攻防世界高手区7（61-66）_files/Image [3].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>flag：BallsRealBolls</div><div><br/></div><div><span style="font-weight: bold;">062 Recover-Deleted-File</span></div><div><br/></div><div>下载得到disk-image文件。查看文件类型。</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop# file disk-image</div><div>disk-image: Linux rev 1.0 ext3 filesystem data, UUID=bc6c2b24-106a-4570-bc4f-ae09abbd7a88</div></div><div>直接用mount命令挂载会发现其中什么都没有，结合题目名称，猜测要恢复镜像中被删除的文件。用extundelete工具和restore-all参数，恢复成功1个文件。</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop# extundelete disk-image --restore-all</div><div><br/></div><div>NOTICE: Extended attributes are not restored.</div><div>Loading filesystem metadata ... 1 groups loaded.</div><div>Loading journal descriptors ... 17 descriptors loaded.</div><div>Searching for recoverable inodes in directory / ...</div><div>1 recoverable inodes found.</div><div>Looking through the directory structure for deleted files ...</div><div>0 recoverable inodes still lost.</div></div><div>查看恢复结果文件夹，有名为flag的ELF可执行文件：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop# cd RECOVERED_FILES/</div><div>root@kali:~/Desktop/RECOVERED_FILES# ls</div><div>flag</div><div>root@kali:~/Desktop/RECOVERED_FILES# file flag</div><div>flag: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, for GNU/Linux 2.6.26, BuildID[sha1]=1968c00b1c9b5fefa9ffcb94cb67b744aac942f4, not stripped</div></div><div>由于恢复得到的文件是只读的，直接运行会提示权限不够，先开放权限然后运行，得到flag。</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop/RECOVERED_FILES# ./flag</div><div>bash: ./flag: 权限不够</div><div>root@kali:~/Desktop/RECOVERED_FILES# chmod 777 ./flag</div><div>root@kali:~/Desktop/RECOVERED_FILES# ./flag</div><div>your flag is:</div><div>de6838252f95d3b9e803b28df33b4baa</div></div><div><br/></div><div>flag：de6838252f95d3b9e803b28df33b4baa</div><div><br/></div><div><span style="font-weight: bold;">063 normal_png</span></div><div><br/></div><div>下载得到png文件，在Kali Linux下打开提示CRC严重错误。而图片能正常显示，说明是高度被修改了。十六进制编辑器中修改高度为1000，得到flag。</div><div><img src="攻防世界高手区7（61-66）_files/Image [4].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>flag：flag{B8B68DD7007B1E406F3DF624440D31E0}</div><div><br/></div><div><span style="font-weight: bold;">064 Py-Py-Py</span></div><div><br/></div><div>下载得到pyc格式文件，反编译：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>C:\Users\Administrator\Desktop&gt;uncompyle6 -o 1.py 58cadd8d8269455ebc94690fd777c34a.pyc</div></div><div>得到python脚本：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div># uncompyle6 version 3.7.3</div><div># Python bytecode 3.6 (3379)</div><div># Decompiled from: Python 3.7.5 (tags/v3.7.5:5c02a39a0b, Oct 15 2019, 00:11:34) [MSC v.1916 64 bit (AMD64)]</div><div># Embedded file name: pystego.py</div><div># Compiled at: 2017-08-01 00:44:47</div><div># Size of source mod 2**32: 1961 bytes</div><div>import sys, os, hashlib, time, base64</div><div>fllag = '9474yeUMWODKruX7OFzD9oekO28+EqYCZHrUjWNm92NSU+eYXOPsRPEFrNMs7J+4qautoqOrvq28pLU='</div><div><br/></div><div>def crypto(string, op='encode', public_key='ddd', expirytime=0):</div><div>    ckey_lenth = 4</div><div>    public_key = public_key and public_key or ''</div><div>    key = hashlib.md5(public_key).hexdigest()</div><div>    keya = hashlib.md5(key[0:16]).hexdigest()</div><div>    keyb = hashlib.md5(key[16:32]).hexdigest()</div><div>    keyc = ckey_lenth and (op == 'decode' and string[0:ckey_lenth] or hashlib.md5(str(time.time())).hexdigest()[32 - ckey_lenth:32]) or ''</div><div>    cryptkey = keya + hashlib.md5(keya + keyc).hexdigest()</div><div>    key_lenth = len(cryptkey)</div><div>    string = op == 'decode' and base64.b64decode(string[4:]) or '0000000000' + hashlib.md5(string + keyb).hexdigest()[0:16] + string</div><div>    string_lenth = len(string)</div><div>    result = ''</div><div>    box = list(range(256))</div><div>    randkey = []</div><div>    for i in xrange(255):</div><div>        randkey.append(ord(cryptkey[(i % key_lenth)]))</div><div><br/></div><div>    for i in xrange(255):</div><div>        j = 0</div><div>        j = (j + box[i] + randkey[i]) % 256</div><div>        tmp = box[i]</div><div>        box[i] = box[j]</div><div>        box[j] = tmp</div><div><br/></div><div>    for i in xrange(string_lenth):</div><div>        a = j = 0</div><div>        a = (a + 1) % 256</div><div>        j = (j + box[a]) % 256</div><div>        tmp = box[a]</div><div>        box[a] = box[j]</div><div>        box[j] = tmp</div><div>        result += chr(ord(string[i]) ^ box[((box[a] + box[j]) % 256)])</div><div><br/></div><div>    if op == 'decode':</div><div>        if result[0:10] == '0000000000' or int(result[0:10]) - int(time.time()) &gt; 0:</div><div>            if result[10:26] == hashlib.md5(result[26:] + keyb).hexdigest()[0:16]:</div><div>                return result[26:]</div><div>        return</div><div>    else:</div><div>        return keyc + base64.b64encode(result)</div><div><br/></div><div>if __name__ == '__main__':</div><div>    while True:</div><div>        flag = raw_input('Please input your flag:')</div><div>        if flag == crypto(fllag, 'decode'):</div><div>            print('Success')</div><div>            break</div><div>        else:</div><div>            continue</div></div><div>python3运行大量报错，加入print(crypto(fllag, 'decode'))语句后python2运行，得到：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>The challenge is Steganography</div></div><div>可以确认是pyc隐写。</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>D:\CTFToolkit-v1.1.0\信息隐藏\stegosaurus-master&gt;python3 stegosaurus.py 58cadd8d8269455ebc94690fd777c34a.pyc -x</div><div>Extracted payload: Flag{HiD3_Pal0ad_1n_Python}</div></div><div><br/></div><div>flag：Flag{HiD3_Pal0ad_1n_Python}</div><div><br/></div><div><span style="font-weight: bold;">065 传感器1</span></div><div>题目：已知ID为0x8893CA58的温度传感器的未解码报文为：3EAAAAA56A69AA55A95995A569AA95565556 此时有另一个相同型号的传感器，其未解码报文为：3EAAAAA56A69AA556A965A5999596AA95656 请解出其ID，提交格式为flag{xxx}</div><div><br/></div><div><a href="https://www.cnblogs.com/zhanp/p/10931617.html">差分曼彻斯特编码</a>。先写python脚本将第一个传感器的报文解密：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>id1 = 0x8893CA58</div><div>msg1 = 0x3EAAAAA56A69AA55A95995A569AA95565556</div><div>s1 = bin(msg1)[2:]</div><div>print(s1)</div><div>result = ''</div><div>for i in range(0, len(s1), 2):</div><div>    if s1[i] == s1[i - 1]:</div><div>        result += '1'</div><div>    else:</div><div>        result += '0'</div><div>print(result)</div><div>print(hex(int(result, 2)).upper())</div></div><div>运行结果：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>30024D<font color="#FF0000">8893CA58</font>4181</div></div><div>对比一下，ID是报文解密结果的7-14位。那么对于第二个传感器同样处理：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div># id2 = ???</div><div>msg2 = 0x3EAAAAA56A69AA556A965A5999596AA95656</div><div>s2 = bin(msg2)[2:]</div><div>print(s2)</div><div>result = ''</div><div>for i in range(0, len(s2), 2):</div><div>    if s2[i] == s2[i - 1]:</div><div>        result += '1'</div><div>    else:</div><div>        result += '0'</div><div>print(result)</div><div>print(hex(int(result, 2))[2:].upper())</div></div><div>运行结果：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>30024D<font style="color: rgb(255, 0, 0);">8845ABF3</font>4119</div></div><div><br/></div><div>flag：flag{8845ABF3}</div><div><br/></div><div><span style="font-weight: bold;">066 3-11</span></div><div><br/></div><div>下载得到png文件。用Stegsolve查看，各颜色plane 0处，左上角有无规律点，可能是LSB隐写。Data Extract提取。</div><div><img src="攻防世界高手区7（61-66）_files/Image [5].png" type="image/png" data-filename="Image.png"/></div><div>根据文件头判断是zip压缩包，导出解压得到flag.txt，内容为：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>iVBORw0KGgoAAAANSUhEUgAAAPoAAAD6CAYAAACI7Fo9AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAEnQAABJ0Ad5mH3gAAAVqSURBVHhe7d1bTuRGAEDRIftfK1tIxgNRJNINbpff9xzJmvlpP6q5KpeB5u3v334Bt/bX57/AjQkdAoQOAUKHAKFDgNAhQOgQIHQIEDoECB0ChA4BQocLe39///zf9/xSCwSY0SFA6BAgdAgQOgQIHQKEDgGLv7329vb2+b/1PDqVZ8dZ67uCe13HV1sc95GRcRo9x7XeI8aZ0SFA6BAgdAgQOgR4GLdw/99d/5xz2/q61jD6Hp/pWuo2CX3NN3jrIJbuf/T6t76uNVzhHJnHrTsECB0ChM6fW/RHG/chdAgQOgQIHQJO8330Z6fx7DhrfYtni7XonHPb+rpe8eoYHHGOjDGjX9AU5twNJkLnzwz9aOM+hA4BQocAoUOA0CHAb68N7P+o1z7zaJ9r72+y1tizHzM6BAgdAoQOAZddo8/107mMrEO3eO3aRt6Lrcee/ZjRIUDoECB0CBA6BAgdAhY/dQeuw4wOAUKHAKFDgNAhQOgQIHQIEDoECB0ChA4BQocAoUOA0CFA6BAgdAgQOgQIHQKEDgFChwAfJcVDI3+cgvMZCv3RF8PaXwhb/7WQO/81kpFY5772u/E789jUuHWHAKFDgNAhQOgQcMmHcWseY/Sh09rXexaj4zK569hckRmdIVPMzzbOQ+gQIHQIEPqNTevnRxs9t/7JuDnnssUX/lnWp8+ubY9xOcsY8MGMDgFChwChQ4DQIeD0D+PmWnouIw+sJmcag69Gr22uM48BH8zoECB0CBA6BKy+Rp/rLOvEkWt45izr09E1+lbv75L9nmVMr+rUoY9GuMcxHnllSJcef+Ta5p7fVu/vkv2+Mqb8n1t3CBA6BAgdAoTO7qb19qsbY4YexgHXYEaHAKFDgNAhQOgQIHQIEDoECB0ChA4BQocAoUOA0CFA6BAgdAgQOgT4NdWTOeoz7I46Lvswo0OA0CFA6BBw6jX62uvGK6wZrdHZwmF/wGHy06GFvo451/3suCPv0RXGu0LoJ3NUOEK/N2t0CBA6BAgdAlZfo6+5LhvZ/9bntpWj1rzPjvvTMY86X15jRocAoUOAW/eT+e5WeImR8Rp1hfGuMKNDwOqhTzPDnA3YjxkdAoQOAUKHAKFDwC6/j/7o4ducwy593WTktUf67kHlluf/7LhL36fJFca7wowOAUKHAKFDwOVCn9aDczbgP4sfxo3GNPKQZ6mfjrnW8UYeQu19zf96dtyR92lkHFiXW3cIEDoECB0ChA4Bu/xk3FJHPZiCuzl16MA63LpDgNAhQOgQIHQIEDoECB0ChA4BQocAoUOA0CFA6BAgdAgQOgQIHQKEDgFChwChQ8DQJ8yMftTTWT7c5tF1rH1uI2PlQ4AYdckZfYrm6wY859YdAoQOAUKHgNUfxu3x4Gjt4+5xHSPPEfYYU+5N6L8ddR2PnOlcuA+37hcwxf91g1cIHQKEDgGH/WTcmdbUa+9vxNwxPer8uKbbhL42oXMnbt0hQOgXMM3eXzd4hdAhYGiNPtfaD7tqa3QzOKMuGfpcV4xG6GzBrTsECB0ChA4Bi9foow/ESmv0K4wV92ZGhwChQ4DQIUDoELDLD8wcxcM4+HDr0IEPbt0hQOgQIHQIEDoECB0ChA4BQocAoUOA0CFA6BAgdAgQOgQIHQKEDgFChwChQ4DQIUDoECB0CBA6BAgdAoQOAUKHAKFDgNAhQOgQIHQIEDoECB0ChA4BQocAoUOA0CFA6BAgdAgQOgQIHQKEDgFChwChQ4DQIUDoECB0CBA6BAgdAoQOAUKHAKFDgNAhQOgQIHQIEDoECB0ChA4BQocAoUOA0CFA6BAgdAgQOgQIHQKEDgFChwChw+39+vUPmuaZZgm+XxcAAAAASUVORK5CYII=</div></div><div>base64解密发现了PNG文件头。对于图片转成的base64密文，可以在开头加上</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>data:image/png;base64,</div><div>data:image/jpeg;base64,</div><div>等等</div></div><div>然后在浏览器地址栏输入直接得到解码后的图片。</div><div><img src="攻防世界高手区7（61-66）_files/1.png" type="image/png" data-filename="1.png"/></div><div>当然python脚本或Linux命令行也同样可以将base64密文转为文件。</div><div><br/></div><div>flag：FLAG{LSB_i5_SO_EASY}</div></span>
</div></body></html> 