<html>
<head>
  <title>攻防世界高手区25（169-174）</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/605894 (zh-CN, DDL); Windows/6.1.1 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="10815"/>
<h1>攻防世界高手区25（169-174）</h1>
<h2><a href="https://DemonStarAlgol.github.io/Misc/">[无关链接]</a></h2>

<div>
<span><div><span style="font-weight: bold;">169 我们生活在南京-2</span></div><div>题目：在交流过程中发声音被干扰，于是使用了更加稳定的方法（CW）</div><div><br/></div><div>下载得到mp3格式文件，根据题目提示，搜索“ 无线电 CW”等关键字，发现CW即等幅电报，一般指代利用摩斯电码进行无线电通联的活动。在audacity里打开附件音频：</div><div><img src="攻防世界高手区25（169-174）_files/Image.png" type="image/png" data-filename="Image.png"/></div><div>尝试切换到频谱，发现比较明显的摩斯电码特征：</div><div><img src="攻防世界高手区25（169-174）_files/Image [1].png" type="image/png" data-filename="Image.png"/></div><div>不是很长，手动记录一下：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>..-. .-.. .- --. -.-. .-- .. ..... ....- - .-. ....- -.. .. - .. ----- -. -- ...-- - .... ----- -..</div></div><div>转码得到：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>flagcwi54tr4diti0nm3th0d</div></div><div><br/></div><div>flag：flag{cwi54tr4diti0nm3th0d}</div><div><br/></div><div><span style="font-weight: bold;">170 再见李华1</span></div><div><br/></div><div>参见 <a href="攻防世界高手区1（1-18）.html" style="color: rgb(105, 170, 53);">第18题</a> ，一样一样的。</div><div><br/></div><div>flag：flag{Stay hungry, Stay foolish.}</div><div><br/></div><div><span style="font-weight: bold;">171 1-misc</span></div><div><br/></div><div>下载得到加密的zip格式压缩包：</div><div><img src="攻防世界高手区25（169-174）_files/Image [2].png" type="image/png" data-filename="Image.png"/></div><div>既然密码是生日，那就直接8位数字爆破，考虑到出题人特别长寿的可能性，从19000101开始。可能比生成符合日期格式的字典再爆破要慢一点点，但还是能在可接受的时间里得到结果：</div><div><img src="攻防世界高手区25（169-174）_files/Image [3].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>解压得到加密压缩包2.zip和fakeflag.jpg，妈的（删掉）好的套起来了。注意到2.zip里也有个fakeflag.jpg：</div><div><img src="攻防世界高手区25（169-174）_files/Image [4].png" type="image/png" data-filename="Image.png"/></div><div>两个jpg大小也一样，考虑明文攻击。然而明文攻击一般需要构造与密文包压缩方式和算法和压缩率已知的明文包，如果出题人从自己电脑上找个压缩软件随便打个压缩包就来当谜文包用，那就轮到做题人抓瞎了。很不幸本题就是这么一道题目，用很多版本的WinRAR和7-zip尝试都无法得到符合要求的明文包。总之我把最后成功攻击的明文包放在这里，并呼吁各位出题人，出明文攻击也就出了，但是行行好用存储压缩吧：</div><div><a href="攻防世界高手区25（169-174）_files/fakeflag.zip"><img src="攻防世界高手区25（169-174）_files/97075b9150a3f0513e5c075d2547d6cb.png" alt="fakeflag.zip"></a></div><div>然后用ARCHPR进行明文攻击，当三个密钥已经得到，开始爆破密码时就可以手动停止了，然后工具会提示保存已解密的压缩包，点确定就能拿到无加密的2.zip了。</div><div><br/></div><div>解压得到似乎加密的压缩包3.zip，注释提示没有密码，那就是伪加密，ZipCenOp一把梭：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>java -jar ZipCenOp.jar r 3.zip</div></div><div>最后解压得到flag.txt。</div><div><br/></div><div>flag：flag{159c6275f0015c037e70a118f25b9a99}</div><div><br/></div><div><span style="font-weight: bold;">172 easy_misc</span></div><div><br/></div><div>下载得到加密的zip格式压缩包，尝试爆破一下密码：</div><div><img src="攻防世界高手区25（169-174）_files/Image [5].png" type="image/png" data-filename="Image.png"/></div><div>解压得到1.png，010editor打开，模板提示CRC错误，由于图片在Windows下可以正常显示，说明宽度正常，爆破一下正确高度：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>import struct, binascii</div><div>from Crypto.Util.number import bytes_to_long</div><div><br/></div><div>img = open('C:/Users/Administrator/Desktop/1.png', 'rb').read()</div><div><br/></div><div>for i in range(0xFFFF):</div><div>    stream = img[12:20] + struct.pack('&gt;i', i) + img[24:29]</div><div>    crc = binascii.crc32(stream)</div><div>    if crc == bytes_to_long(img[29:33]):</div><div>        print(i, hex(i))</div></div><div>得到：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>223 0xdf</div></div><div>修改高度，得到图片：</div><div><img src="攻防世界高手区25（169-174）_files/1.png" type="image/png" data-filename="1.png"/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>链接：https://pan.baidu.com/s/1cG2QvYy3khpQGLfjfbYevg</div><div>提取码：cavb</div></div><div>妈的（删掉）好的套起来了。</div><div><br/></div><div>访问这个百度网盘，下载得到file.pcap，wireshark打开，有HTTP先看HTTP：</div><div><img src="攻防世界高手区25（169-174）_files/Image [6].png" type="image/png" data-filename="Image.png"/></div><div>很明显是在时间盲注。先用tshark把盲注payload提取出来：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>tshark -r file.pcap -Y &quot;http and ip.dst == 101.132.155.235&quot; -T fields -e urlencoded-form.value &gt; 1.txt</div></div><div>然后用脚本提取盲注结果。虽然是时间盲注，但实际上不需要判断请求之间间隔的时间。因为从payload来看采用的是简单穷举法，那么对于每一位，只需要提取其穷举过程中该位尝试的最后一个值即可：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>data = open('C:/Users/Administrator/Desktop/1.txt', 'r').read().split('\n')[:-1]</div><div><br/></div><div>flag, index = '', 1</div><div>for i in data:</div><div>    n = int(i.split('limit 0,1),')[1].split(',')[0])</div><div>    if n != index:</div><div>        flag += chr(c)</div><div>        index = n</div><div>    c = int(i.split(',sleep')[0].split('=')[-1])</div><div>flag += chr(c)</div><div>print(flag)</div></div><div>运行得到flag。</div><div><br/></div><div>flag：flag{cd2c3e2fea463ded9af800d7155be7aq}</div><div><br/></div><div><span style="font-weight: bold;">173 Encode</span></div><div><br/></div><div>下载得到txt格式文件，内容：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>4O595954494Q32515046324757595N534R52415653334357474R4N575955544R4O5N4Q46434S4O59474253464Q5N444R4Q51334557524O5N4S424944473542554O595N44534O324R49565746515532464O49345649564O464R4R494543504N35</div></div><div>看下其中包含的字符：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>print(set(list(s)))</div><div># {'6', 'O', '7', '5', 'R', 'N', '4', '1', 'Q', '9', '3', '0', '2', 'S'}</div></div><div>有九个数字以及NOQRS五个字母，注意到N-S在字母表里与A-F刚好处于对称位置，很明显这是一个十六进制字符串被ROT13加密后的结果。那么后续用Cyberchef梭就行了，解码步骤依次是：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>ROT13 HEX(base16) base32 base64 base85</div></div><div>得到flag。</div><div><br/></div><div>flag：flag{W0w_y0u_c4n_rea11y_enc0d1ng!}</div><div><br/></div><div><span style="font-weight: bold;">174 Wire1</span></div><div><br/></div><div>下载得到pcapng格式文件，wireshark打开，有HTTP先看HTTP：</div><div><img src="攻防世界高手区25（169-174）_files/Image [7].png" type="image/png" data-filename="Image.png"/></div><div>很明显又是在布尔盲注。</div><div><br/></div><div>先用tshark提取盲注payload：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>tshark -r timu.pcapng -Y &quot;http and ip.dst == 192.168.246.1&quot; -T fields -e http.request.uri.query &gt; 1.txt</div></div><div>然后写个脚本处理每一行，原理类似上题：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>data = open('C:/Users/Administrator/Desktop/1.txt', 'r').read().split('\n')[:-1]</div><div><br/></div><div>flag, index = '', 1</div><div>for i in data:</div><div>    n = int(i.split('%20t),')[1].split(',')[0])</div><div>    if n != index:</div><div>        flag += chr(c)</div><div>        index = n</div><div>    c = int(i.split('=')[-1].split('-')[0])</div><div>flag += chr(c)</div><div>print(flag)</div></div><div>运行得到flag。</div><div><br/></div><div>flag：flag{w1reshARK_ez_1sntit}</div></span>
</div></body></html> 