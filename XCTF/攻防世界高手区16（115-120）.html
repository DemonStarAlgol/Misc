<html>
<head>
  <title>攻防世界高手区16（115-120）</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/605894 (zh-CN, DDL); Windows/6.1.1 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="1008"/>
<h1>攻防世界高手区16（115-120）</h1>
<h2><a href="https://DemonStarAlgol.github.io/Misc/">[无关链接]</a></h2>

<div>
<span><div><div><span style="font-weight: bold;">115 Flying_High</span></div><div>题目：我们发现一个坠毁的无人机，你能够恢复这个无人机的信息吗？</div><div><br/></div><div>下载得到gz压缩包，解压得到无后缀名文件，在Linux下再解压得到image0-3.bin共四个文件。file命令查看类型：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop/flying_high# file *.bin</div><div>image0.bin: UBIfs image, sequence number 1, length 4096, CRC 0x03a905a7</div><div>image1.bin: UBIfs image, sequence number 1, length 4096, CRC 0x47b22f13</div><div>image2.bin: UBIfs image, sequence number 1, length 4096, CRC 0xf7f7a9b7</div><div>image3.bin: UBIfs image, sequence number 1, length 4096, CRC 0x68fa15bd</div></div><div>需要用到<a href="https://github.com/jrspruitt/ubi_reader">UBI Reader</a>。安装后解压四个文件：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop/flying_high# for i in `ls *.bin`; do ubireader_extract_files $i -o extracted_$i; done</div><div>Extracting files to: extracted_image0.bin</div><div>Extracting files to: extracted_image1.bin</div><div>extract_dents Warn: DEV Fail: unpack requires a string argument of length 8</div><div>extract_dents Warn: DEV Fail: unpack requires a string argument of length 8</div><div>extract_dents Warn: DEV Fail: unpack requires a string argument of length 8</div><div>extract_dents Warn: DEV Fail: unpack requires a string argument of length 8</div><div>Extracting files to: extracted_image2.bin</div><div>read Error: Block ends at 4299020519 which is greater than file size 16887808</div><div>index Fatal: LEB: 31, UBIFS offset: 4053224, error: Bad Read Offset Request</div><div>Extracting files to: extracted_image3.bin</div></div><div>在image3.bin中找到可疑信息：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop/flying_high# ls -la extracted_image3.bin/</div><div>总用量 188</div><div>drwxr-xr-x 4 root root   4096 9月  23 08:45 .</div><div>drwxr-xr-x 6 root root   4096 9月  23 08:45 ..</div><div>-rw-r--r-- 1 root root     12 8月  17  2017 accs_infos.bin</div><div>-rw-r--r-- 1 root root   5087 1月   1  2000 config.ini</div><div>-rw-r--r-- 1 root root   5080 1月   1  2000 config.ini.old</div><div>drwxr-xr-x 5 root root   4096 1月   1  2000 custom.configs</div><div>-rw-r--r-- 1 root root   5148 8月  17  2017 emergency.bin</div><div>-rw-r--r-- 1 root root 124642 9月  21  2015 ephemeris.ee</div><div>-rw-r--r-- 1 root root     12 1月   1  2000 fact_accs_infos.bin</div><div>-rw-r--r-- 1 root root     20 9月   9  2015 fact_trims.bin</div><div>-rw-r--r-- 1 root root      0 1月   1  2000 gps.log</div><div>-rw-r--r-- 1 root root      2 1月   1  2000 old_adress.txt</div><div>-rw-r--r-- 1 root root     19 1月   1  2000 random_mac.txt</div><div>-rw-r--r-- 1 root root     20 9月  17  2015 trims.bin</div><div>drwxr-xr-x 4 root root   4096 1月   1  2000 video</div></div><div>其中包含video文件夹，进一步查看，在video/usb/目录下有视频文件。</div><div><img src="攻防世界高手区16（115-120）_files/Image.png" type="image/png" data-filename="Image.png"/></div><div>打开视频找到flag。</div><div><img src="攻防世界高手区16（115-120）_files/Image [1].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>flag：HITB{96ac9a0458279711e5d61f10849e6c58}</div><div><br/></div><div><span style="font-weight: bold;">116 LooL</span></div><div>题目：iVBORw0KGgoAAAANSUhEUgAAABwAAAAUCAIAAAARPMquAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAB3RJTUUH3goNFiAI385k0QAAAPVJREFUOMuNVEESxCAIC47/Nr6cPahbpUDtCRWTEDMVKNxPAQhEoQJRAE9h6tdSCzpdUPkXaguDOI5UnmUZTT7uEuju7zLNZomaIoh327uhRAKTCRK9Iah7LScwzdWcMbjcgyMSBBoP9JoAmcugQsVIbl52DqUtBm0cuV1yFocrqE4VMa3/9ETfODylnNmVdmVFPhmn0phz9un5zIuZgOaeZobKjikDd5jWo/GHEJ4qEKgYPoFH2nylC+qju104Oz010euxD921WxSUfayaMAu3q4vZxIPLjW7G7/H7Lmc/4mHmqB6/72y7iy23H7wSt7nPxxLVH88jbs4UmdXpAAABlmlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSfvu78nIGlkPSdXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQnPz4KPHg6eG1wbWV0YSB4bWxuczp4PSdhZG9iZTpuczptZXRhLycgeDp4bXB0az0nSW1hZ2U6OkV4aWZUb29sIDkuNDYnPgo8cmRmOlJERiB4bWxuczpyZGY9J2h0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMnPgoKIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PScnCiAgeG1sbnM6ZGM9J2h0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvJz4KICA8ZGM6ZGN0Zj42ZmI1MzI5NWI1MzVlYmRmZmExYWM4ODQzZmM2YWNkZDwvZGM6ZGN0Zj4KIDwvcmRmOkRlc2NyaXB0aW9uPgo8L3JkZjpSREY+CjwveDp4bXBtZXRhPgo8P3hwYWNrZXQgZW5kPSdyJz8+KPPlkwAAAABJRU5ErkJggg==</div><div><br/></div><div>base64解密，发现PNG文件头。转码得到图片。</div><div><img src="攻防世界高手区16（115-120）_files/1.png" type="image/png" data-filename="1.png"/></div><div>十六进制编辑器打开，发现一段以dctf为标签的可疑信息：</div><div><img src="攻防世界高手区16（115-120）_files/Image [2].png" type="image/png" data-filename="Image.png"/></div><div>对6fb53295b535ebdffa1ac8843fc6acdd进行MD5反查，得到<a href="https://esolangs.org/wiki/brainloller">brainloller</a>。这是一个brainfuck的变种，从png图片的像素中提取信息，规则为：</div><table style="border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 130px;"></col><col style="width: 130px;"></col><col style="width: 276px;"></col></colgroup><tbody><tr><td style="width: 130px; padding: 8px; border: 1px solid;"><div style="background-color: rgb(255, 255, 255); font-size: 14px;"><span style="font-size: 14px; color: rgb(34, 34, 34); font-family: sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">Color</span></div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div style="background-color: rgb(255, 255, 255); font-size: 14px;"><span style="font-size: 14px; color: rgb(34, 34, 34); font-family: sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">RGB</span></div></td><td style="width: 276px; padding: 8px; border: 1px solid;"><div style="background-color: rgb(255, 255, 255); font-size: 14px;"><span style="font-size: 14px; color: rgb(34, 34, 34); font-family: sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">Function</span></div></td></tr><tr><td style="background-color: rgb(255, 0, 0); width: 130px; padding: 8px; border: 1px solid;"><div style="background-color: rgb(255, 255, 255); font-size: 14px;"><span style="font-size: 14px; color: rgb(34, 34, 34); font-family: sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">red</span></div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div style="background-color: rgb(255, 255, 255); font-size: 14px;"><span style="font-size: 14px; color: rgb(34, 34, 34); font-family: sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">(255,0,0)</span></div></td><td style="width: 276px; padding: 8px; border: 1px solid;"><div style="background-color: rgb(255, 255, 255); font-size: 14px;"><span style="background-color: rgb(248, 249, 250); border: 1px solid rgb(234, 236, 240); border-radius: 2px; font-size: 14px; color: rgb(0, 0, 0); font-family: monospace, monospace; font-variant-caps: normal; font-variant-ligatures: normal;">&gt;</span></div></td></tr><tr><td style="background-color: rgb(128, 0, 0); width: 130px; padding: 8px; border: 1px solid;"><div style="background-color: rgb(255, 255, 255); font-size: 14px;"><span style="font-size: 14px; color: rgb(34, 34, 34); font-family: sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">darkred</span></div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div style="background-color: rgb(255, 255, 255); font-size: 14px;"><span style="font-size: 14px; color: rgb(34, 34, 34); font-family: sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">(128,0,0)</span></div></td><td style="width: 276px; padding: 8px; border: 1px solid;"><div style="background-color: rgb(255, 255, 255); font-size: 14px;"><span style="background-color: rgb(248, 249, 250); border: 1px solid rgb(234, 236, 240); border-radius: 2px; font-size: 14px; color: rgb(0, 0, 0); font-family: monospace, monospace; font-variant-caps: normal; font-variant-ligatures: normal;">&lt;</span></div></td></tr><tr><td style="background-color: rgb(0, 255, 0); width: 130px; padding: 8px; border: 1px solid;"><div style="background-color: rgb(255, 255, 255); font-size: 14px;"><span style="font-size: 14px; color: rgb(34, 34, 34); font-family: sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">green</span></div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div style="background-color: rgb(255, 255, 255); font-size: 14px;"><span style="font-size: 14px; color: rgb(34, 34, 34); font-family: sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">(0,255,0)</span></div></td><td style="width: 276px; padding: 8px; border: 1px solid;"><div style="background-color: rgb(255, 255, 255); font-size: 14px;"><span style="background-color: rgb(248, 249, 250); border: 1px solid rgb(234, 236, 240); border-radius: 2px; font-size: 14px; color: rgb(0, 0, 0); font-family: monospace, monospace; font-variant-caps: normal; font-variant-ligatures: normal;">+</span></div></td></tr><tr><td style="background-color: rgb(0, 128, 0); width: 130px; padding: 8px; border: 1px solid;"><div style="background-color: rgb(255, 255, 255); font-size: 14px;"><span style="font-size: 14px; color: rgb(34, 34, 34); font-family: sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">darkgreen</span></div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div style="background-color: rgb(255, 255, 255); font-size: 14px;"><span style="font-size: 14px; color: rgb(34, 34, 34); font-family: sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">(0,128,0)</span></div></td><td style="width: 276px; padding: 8px; border: 1px solid;"><div style="background-color: rgb(255, 255, 255); font-size: 14px;"><span style="background-color: rgb(248, 249, 250); border: 1px solid rgb(234, 236, 240); border-radius: 2px; font-size: 14px; color: rgb(0, 0, 0); font-family: monospace, monospace; font-variant-caps: normal; font-variant-ligatures: normal;">-</span></div></td></tr><tr><td style="background-color: rgb(0, 0, 255); width: 130px; padding: 8px; border: 1px solid;"><div style="background-color: rgb(255, 255, 255); font-size: 14px;"><span style="font-size: 14px; color: rgb(34, 34, 34); font-family: sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">blue</span></div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div style="background-color: rgb(255, 255, 255); font-size: 14px;"><span style="font-size: 14px; color: rgb(34, 34, 34); font-family: sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">(0,0,255)</span></div></td><td style="width: 276px; padding: 8px; border: 1px solid;"><div style="background-color: rgb(255, 255, 255); font-size: 14px;"><span style="background-color: rgb(248, 249, 250); border: 1px solid rgb(234, 236, 240); border-radius: 2px; font-size: 14px; color: rgb(0, 0, 0); font-family: monospace, monospace; font-variant-caps: normal; font-variant-ligatures: normal;">.</span></div></td></tr><tr><td style="background-color: rgb(0, 0, 128); width: 130px; padding: 8px; border: 1px solid;"><div style="background-color: rgb(255, 255, 255); font-size: 14px;"><span style="font-size: 14px; color: rgb(34, 34, 34); font-family: sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">darkblue</span></div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div style="background-color: rgb(255, 255, 255); font-size: 14px;"><span style="font-size: 14px; color: rgb(34, 34, 34); font-family: sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">(0,0,128)</span></div></td><td style="width: 276px; padding: 8px; border: 1px solid;"><div style="background-color: rgb(255, 255, 255); font-size: 14px;"><span style="background-color: rgb(248, 249, 250); border: 1px solid rgb(234, 236, 240); border-radius: 2px; font-size: 14px; color: rgb(0, 0, 0); font-family: monospace, monospace; font-variant-caps: normal; font-variant-ligatures: normal;">,</span></div></td></tr><tr><td style="background-color: rgb(255, 255, 0); width: 130px; padding: 8px; border: 1px solid;"><div style="background-color: rgb(255, 255, 255); font-size: 14px;"><span style="font-size: 14px; color: rgb(34, 34, 34); font-family: sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">yellow</span></div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div style="background-color: rgb(255, 255, 255); font-size: 14px;"><span style="font-size: 14px; color: rgb(34, 34, 34); font-family: sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">(255,255,0)</span></div></td><td style="width: 276px; padding: 8px; border: 1px solid;"><div style="background-color: rgb(255, 255, 255); font-size: 14px;"><span style="background-color: rgb(248, 249, 250); border: 1px solid rgb(234, 236, 240); border-radius: 2px; font-size: 14px; color: rgb(0, 0, 0); font-family: monospace, monospace; font-variant-caps: normal; font-variant-ligatures: normal;">[</span></div></td></tr><tr><td style="background-color: rgb(128, 128, 0); width: 130px; padding: 8px; border: 1px solid;"><div style="background-color: rgb(255, 255, 255); font-size: 14px;"><span style="font-size: 14px; color: rgb(34, 34, 34); font-family: sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">darkyellow</span></div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div style="background-color: rgb(255, 255, 255); font-size: 14px;"><span style="font-size: 14px; color: rgb(34, 34, 34); font-family: sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">(128,128,0)</span></div></td><td style="width: 276px; padding: 8px; border: 1px solid;"><div style="background-color: rgb(255, 255, 255); font-size: 14px;"><span style="background-color: rgb(248, 249, 250); border: 1px solid rgb(234, 236, 240); border-radius: 2px; font-size: 14px; color: rgb(0, 0, 0); font-family: monospace, monospace; font-variant-caps: normal; font-variant-ligatures: normal;">]</span></div></td></tr><tr><td style="background-color: rgb(0, 255, 255); width: 130px; padding: 8px; border: 1px solid;"><div style="background-color: rgb(255, 255, 255); font-size: 14px;"><span style="font-size: 14px; color: rgb(34, 34, 34); font-family: sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">cyan</span></div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div style="background-color: rgb(255, 255, 255); font-size: 14px;"><span style="font-size: 14px; color: rgb(34, 34, 34); font-family: sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">(0,255,255)</span></div></td><td style="width: 276px; padding: 8px; border: 1px solid;"><div style="background-color: rgb(255, 255, 255); font-size: 14px;"><span style="font-size: 14px; color: rgb(34, 34, 34); font-family: sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">rotates the IP 90° clockwise</span></div></td></tr><tr><td style="background-color: rgb(0, 128, 128); width: 130px; padding: 8px; border: 1px solid;"><div style="background-color: rgb(255, 255, 255); font-size: 14px;"><span style="font-size: 14px; color: rgb(34, 34, 34); font-family: sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">darkcyan</span></div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div style="background-color: rgb(255, 255, 255); font-size: 14px;"><span style="font-size: 14px; color: rgb(34, 34, 34); font-family: sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">(0,128,128)</span></div></td><td style="width: 276px; padding: 8px; border: 1px solid;"><div style="font-size: 14px;"><span style="font-size: 14px; color: rgb(34, 34, 34); font-family: sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">rotates the IP 90° counter-clockwise</span></div></td></tr></tbody></table><div>结合最后两行，可以看出图片读取方向是第一行从左往右，第二行从右往左，依次循环的。写出Python脚本：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>from PIL import Image</div><div>img = Image.open('C:/Users/Administrator/Desktop/1.png')</div><div><br/></div><div>def brainfuck(i):</div><div>     if i == (255, 0, 0):</div><div>          print('&gt;', end='')</div><div>     elif i == (128, 0, 0):</div><div>          print('&lt;', end='')</div><div>     elif i == (0, 255, 0):</div><div>          print('+', end='')</div><div>     elif i == (0, 128, 0):</div><div>          print('-', end='')</div><div>     elif i == (0, 0, 255):</div><div>          print('.', end='')</div><div>     elif i == (0, 0, 128):</div><div>          print('.', end='')</div><div>     elif i == (255, 255, 0):</div><div>          print('[', end='')</div><div>     elif i == (128, 128, 0):</div><div>          print(']', end='')</div><div><br/></div><div>for y in range(20):</div><div>    if y % 2 == 0:</div><div>        for x in range(28):</div><div>            res = img.getpixel((x, y))</div><div>            brainfuck(res)</div><div>    elif y % 2 != 0:</div><div>        for x in range(28):</div><div>            res = img.getpixel((27 - x, y))</div><div>            brainfuck(res)</div></div><div>运行得到：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>++++++++[&gt;+&gt;++&gt;+++&gt;++++&gt;+++++&gt;++++++&gt;+++++++&gt;++++++++&gt;+++++++++&gt;++++++++++&gt;+++++++++++&gt;++++++++++++&gt;+++++++++++++&gt;++++++++++++++&gt;+++++++++++++++&gt;++++++++++++++++&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+.-&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;-.+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;---.+++&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;----.++++&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+.-&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;----.++++&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;-.+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;---.+++&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;----.++++&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;----.++++&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;.</div></div><div>再Brainfuck运行得到：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>youdidwell</div></div><div><br/></div><div>此外，Brainloller还有一个在线的<a href="https://minond.xyz/brainloller/">运行和编译器</a>。也可以使用BFtools来解码brainloller图像并运行brainfuck程序：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>D:\CTFToolkit-v1.1.0\信息隐藏\bftools&gt;bftools.exe decode brainloller 1.png</div><div>++++++++[&gt;+&gt;++&gt;+++&gt;++++&gt;+++++&gt;++++++&gt;+++++++&gt;++++++++&gt;+++++++++&gt;++++++++++&gt;+++++</div><div>++++++&gt;++++++++++++&gt;+++++++++++++&gt;++++++++++++++&gt;+++++++++++++++&gt;+++++++++++++++</div><div>+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+.-&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;-.+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;</div><div>&lt;&lt;&lt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;---.+++&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;----.++++&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&gt;&gt;&gt;&gt;&gt;</div><div>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+.-&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;----.++++&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;-.+&lt;&lt;&lt;</div><div>&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;---.+++&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;----.++++&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;</div><div>&lt;&lt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;----.++++&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;.</div><div><br/></div><div>D:\CTFToolkit-v1.1.0\信息隐藏\bftools&gt;bftools.exe decode brainloller 1.png &gt; out.txt</div><div><br/></div><div>D:\CTFToolkit-v1.1.0\信息隐藏\bftools&gt;bftools.exe run out.txt</div><div>youdidwell</div></div><div><br/></div><div>flag：youdidwell</div><div><br/></div><div><span style="font-weight: bold;">117 Unknown-format</span></div><div><br/></div><div>下载得到pcap文件，wireshark打开，发现大量USB协议流量包。在某个较大的流量包中发现了SP01和FC04字串。</div><div><img src="攻防世界高手区16（115-120）_files/Image [3].png" type="image/png" data-filename="Image.png"/></div><div>搜索得知此类数据头可能来自Kindle，并找到<a href="https://github.com/NiLuJe/KindleTool">KindleTool</a>工具。</div><div>接下来依次执行以下命令：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>kindletool dm usb_sniff.pcap out</div><div># 从流量包中提取数据到out文件</div><div><br/></div><div>binwalk -e out</div><div>DECIMAL       HEXADECIMAL     DESCRIPTION</div><div>--------------------------------------------------------------------------------</div><div>2005          0x7D5           gzip compressed data, from Unix, last modified: 2016-12-31 20:20:49</div><div># 用binwalk分离out文件得到gzip压缩包</div><div><br/></div><div>tar -xvf 7D5</div><div>kindle_out/</div><div>kindle_out/rootfs_md5_list.tar.gz</div><div>kindle_out/2540270001-2692310002.ffs</div><div>kindle_out/flag.txt</div><div>kindle_out/update-patches.tar.gz</div><div>tar: Unexpected EOF in archive</div><div>tar: Unexpected EOF in archive</div><div>tar: Error is not recoverable: exiting now</div><div># tar解压分离得到的gzip压缩包，可以看到已经得到了flag.txt文件</div><div><br/></div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;"># 查看flag.txt文件得到flag</span></div></div><div><br/></div><div>flag：ALEXCTF{Wh0_N33d5_K1nDl3_t0_3X7R4Ct_K1ND13_F1rMw4R3}</div><div><br/></div><div><span style="font-weight: bold;">118 Make-similar</span></div><div><br/></div><div>下载得到ogg文件。Olympic CTF 2014原题有提示120 LPM，对应Radiofax。需要将ogg格式文件转换成wav格式音频后，用OS X下的软件<a href="http://www.blackcatsystems.com/software/multimode/fax.html#HOWREC">Multimode</a>转换成单色传真图像：</div><div><img src="攻防世界高手区16（115-120）_files/fax.jpg" type="image/jpeg" data-filename="fax.jpg"/></div><div>文字部分为：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>section 1 of 1 of file rfax_man</div><div>begin 644 rfax_man</div><div>h5sg60BSxwp62+57aMLVTPK3i9b-t+5pGLKyPA-FxxuysvFs+BT8+o0dVsM24</div><div>hcZHRaWYEHRBGFGtqk-cMV7oqqQRzbobGRB9Kwc-pTHzCDSSMJorR8d-pxdqd</div><div>hLWpvQWRv-N33mFwEicqz+UFkDYsbDvrfOC7tko5g1JrrSX0swhn64neLsohr</div><div>h26K1mSxnS+TF1Cta8GHHQ-t1Cfp7nh-oZeFuVi5MEynqyzX8kMtXcAynSLQx</div><div>hg4o56Pu4YUZHMqDGtczKeCwXU8PZEc4lY0FbDfFfgZpJFC-a-sHGLtGJgCMZ</div><div>hksr6XNTedEUdVJqxOO5VaReoH68eEPJ2m6d9mKhlhVE7zw4Yru4DUWRCJH28</div><div>hyeth+l2I0gPnEfrTLwAc+-TPS0YKYY3K0np58gVPgdAN8RY7+rQfRDin9JSa</div><div>hPG32WG7-rTl3uthvrnDO-wD09GDIRCniuoefs8UsfiWZOLq+0awOrQxAPM+C</div><div>hxLwOJ9VUKwdn7dJduLn1KhBucvL1pr5lGiBFfUbL79cFFex+G27kT+fsQ7X5</div><div>h87mgPivWhDSQHKPXqpKGniDkYsIYpg66ZWbHp4PfcgtPukElDWENlQPSuNAQ</div><div>hnboE4Bd8kyyokt67GgfGvBVS45sMFPtlgKRlG-QPFSgbMHujA3qYemxnuqGx</div><div>hp97aXpdKpvAE8zx-oUzazoVFz32X3OxAuiWJhKEjaYKpM7f95yv1S62v+k++</div><div>+</div><div>end</div><div>sum —r/size 7468/769 section (from &quot;begin&quot; to &quot;end&quot;)</div><div>sum —r/size 36513/540 entire input file</div></div><div>这种每行均以小写h开头的密文很类似xxencode，解码后结果中有rfax_man.py字符串。用<a href="http://www.webutils.pl/XXencode">在线工具</a>将解密结果保存为文件。<span style="font-size: unset; color: unset; font-family: unset;">根据其文件头1F 8B 08判定为gzip压缩包，解压得到rfax_man.py文件，内容为：</span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>import socket,os,sys,hashlib</div><div><br/></div><div>KEY  = &quot;CTF{4BDF4498E4922B88642D4915C528DA8F}&quot; # DO NOT SHARE THIS!</div><div>HOST = '109.233.61.11'</div><div>PORT = 8001</div><div>（后略）</div></div><div>KEY变量即为flag。</div><div><br/></div><div>flag：CTF{4BDF4498E4922B88642D4915C528DA8F}</div><div><br/></div><div><span style="font-weight: bold;">119 Pixel-Princess</span></div><div><br/></div><div>下载得到无后缀名文件。</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop# file af77f2a7ff524a7aa36d34f3637ecf6c</div><div>af77f2a7ff524a7aa36d34f3637ecf6c: POSIX tar archive (GNU)</div></div><div>在Linux下解压得到bowser.jpg。</div><div><img src="攻防世界高手区16（115-120）_files/bowser.jpg" type="image/jpeg" data-filename="bowser.jpg"/></div><div>顺便用foremost分离这张jpg，得到zip压缩包。压缩包内有MarioCastle.jpg文件。</div><div><img src="攻防世界高手区16（115-120）_files/MarioCastle.jpg" type="image/jpeg" data-filename="MarioCastle.jpg"/></div><div><span style="font-size: unset; color: unset; font-family: unset;">得到密码：BaD_DR4G0N。这并不是flag，考虑使用了另一种需要密码的图片隐写工具。</span></div><div><span style="font-size: unset; color: unset; font-family: unset;">最后尝试发现对bowser.jpg使用Steghide可以得到1.tar.gz。</span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>D:\CTFToolkit-v1.1.0\信息隐藏\steghide&gt;steghide extract -sf bowser.jpg</div><div>Enter passphrase:</div><div>wrote extracted data to &quot;l.tar.gz&quot;.</div></div><div><span style="font-size: unset; color: unset; font-family: unset;">解压得到flaga.jpg。</span></div><div><img src="攻防世界高手区16（115-120）_files/flaga.jpg" type="image/jpeg" data-filename="flaga.jpg"/></div><div><span style="font-size: unset;"><br/></span></div><div><span style="font-size: unset; color: unset; font-family: unset;">flag：flag{You_F0unD_M3}</span></div><div><span style="font-size: unset;"><br/></span></div><div><span style="font-size: unset;"><span style="font-size: unset; color: unset; font-family: unset; font-weight: bold;">120 Hidden_secret</span></span></div><div><span style="font-size: unset;"><br/></span></div><div><span style="font-size: unset; color: unset; font-family: unset;">下载得到</span>Hidden secret文件夹，内含1、2、3三个文件。查看后发现内容均为大量十六进制数字。</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>1：</div><div>03 04 0A 00 00 00 00 00 BB 6B 28 4F……</div><div>2：</div><div>01 02 1F 00 14 00 00 00 08 00 AB 6B……</div><div>3：</div><div>05 06 00 00 00 00 03 00 03 00 06 01……</div></div><div>观察开头数字，联想到zip压缩源文件数据区开头50 4B 03 04，压缩源文件目录区开头50 4B 01 02和压缩源文件目录结束标志50 4B 05 06。<span style="font-size: unset; color: unset; font-family: unset;">分别添加50 4B后在十六进制编辑器中拼接成一个文件，保存为zip格式。解压得到1.jpg和2.txt。</span></div><div><img src="攻防世界高手区16（115-120）_files/Image [4].png" type="image/png" data-filename="Image.png"/></div><div>2.txt中有提示：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>1.txt behind 1.jpg</div></div><div>但NTFS流隐写无效，查Writeup，说是本题题目出问题了，后来修改了题目。</div><div>修改后可以从1.jpg中分离得到1.txt，内容为：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>K&lt;jslc7b5'gBA&amp;]_5MF!h5+E.@IQ&amp;A%EExEzp\\X#9YhiSHV#</div></div><div>base92解码得到flag。</div><div><br/></div><div>flag：unctf{cca1a567c3145b1801a4f3273342c622}</div></div><div><br/></div></span>
</div></body></html> 