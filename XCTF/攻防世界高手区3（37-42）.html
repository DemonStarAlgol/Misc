<html>
<head>
  <title>攻防世界高手区3（37-42）</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/605894 (zh-CN, DDL); Windows/6.1.1 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="1166"/>
<h1>攻防世界高手区3（37-42）</h1>
<h2><a href="https://DemonStarAlgol.github.io/Misc/">[无关链接]</a></h2>

<div>
<span><div><span style="font-weight: bold;">037 就在其中</span></div><div><br/></div><div>下载得到Misc-03.pcapng。通过foremost可以分离出一些图片、pdf和zip文件。zip压缩包中包含key.txt，但大部分文件都损坏无法打开。</div><div>wireshark打开原文件，搜索字符串key.txt，在对应数据包追踪TCP流。</div><div><img src="攻防世界高手区3（37-42）_files/Image.png" type="image/png" data-filename="Image.png"/></div><div>继续搜索十六进制字符串50 4B 03 04，找到key.zip，提取并解压得到key.txt。</div><div><img src="攻防世界高手区3（37-42）_files/Image [1].png" type="image/png" data-filename="Image.png"/></div><div>发现规律，过滤协议ftp-data，逐个查看数据包，找到pub.key所在位置。</div><div><img src="攻防世界高手区3（37-42）_files/Image [2].png" type="image/png" data-filename="Image.png"/></div><div>实际上再继续还能找到私钥test.key。</div><div><img src="攻防世界高手区3（37-42）_files/Image [3].png" type="image/png" data-filename="Image.png"/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>-----BEGIN RSA PRIVATE KEY-----</div><div>MIICXgIBAAKBgQD0UN0A+70iM0VCJ1ni0n/U1BRj0u8yMWH4Qi+xTbjHgbE7wOuk</div><div>OaO+2PyQXiqIzZnf5jCkJuVDYjALGcKrZM4OCQBBd85B/LTc36XZ7JVfX5kGy5tI</div><div>R3tquuPIVKNdAsHlSqh9S7YSS39RdnSa5rOUyGhrLzxwzzM9IO4e+QQ+CQIDAQAB</div><div>AoGADiaw5mGubtCxbkeBOVYf+V/fXnjVSf76QbrzsD1kOooUjfV6sKR2C5Pd7S7H</div><div>H+1owENBBgEKvoBtb/cqA2tvU9vQ4l5TMBJcHv6LEcb9WPpnMxPV2GNjO+DTPGPy</div><div>Xnu1UZlZjwx+NaF5rESoSSVS2ZaaIixBs4RWRXk+lHEbTFECQQD6Rp6jMweRgPHO</div><div>pR3mgIK83zL+kzqYM5isIPv3DIC5JQN2kXqK73IDQCFVlfXnr9lAAVRzLDsAXLqv</div><div>le/o6yQLAkEA+edY+GERlLuD1t2k9Js0Dc7EwnLcxoFUE60ivj8Gf9jzLskGHxsv</div><div>0IV6J5OHwPh54kAxAnqCjSqNRAWGNzr+uwJBALYEjDUm1LdGrxXZ0jAkgHC6Z0zs</div><div>aK3uwHdXGcinqCp+t9EQpq3KzQF+L4AeKxRQONEq5m9I2LQ/vGocwrmD4dcCQQDb</div><div>rTyOinWz8upAFPKOe2hUwvA/pkzgyosoCMhDyI9kD0gmVlvlODbd7Jem9o8dWM97</div><div>zcXHUf41LbSkmN6U6m1FAkEAqmZbr35bPfkeoiikwNl6OVQytg12TZjw2vIbvfub</div><div>f9Rvti8Lh/tbrmhZroiz8/l3aAZmugI1NBcbeZR0gz8ggg==</div><div>-----END RSA PRIVATE KEY-----</div></div><div>将私钥保存为test.key，密文保存为key.txt，openssl解密。</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>openssl rsautl -decrypt -in key.txt -inkey test.key -out flag.txt</div></div><div>得到：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>hi, boys and girls! flag is {haPPy_Use_0penSsI}</div></div><div><br/></div><div>flag：flag{haPPy_Use_0penSsI}</div><div><br/></div><div><span style="font-weight: bold;">038 肥宅快乐题</span></div><div>题目：真正的快乐的游戏题，打通就给flag哦，与肥宅快乐水搭配更佳。 Flash游戏，通关后，注意与NPC的对话哦;)</div><div><br/></div><div>下载得到swf文件。新建html文件输入以下内容后可以在Chrome浏览器打开该文件。</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>&lt;object&gt;</div><div>&lt;embed src=&quot;C:\Users\Administrator\Desktop\a9d62dc7154f4323b40f346642b1689b.swf&quot; width=&quot;100%&quot;height=&quot;100%&quot;&gt;&lt;/embed&gt;</div><div>&lt;/object&gt;</div></div><div>但是这样只能从头开始玩游戏了。</div><div>查WP，可以用PotPlayer打开逐帧播放，到57帧有如下信息：</div><div><img src="攻防世界高手区3（37-42）_files/Image [4].png" type="image/png" data-filename="Image.png"/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>U1lDe0YzaVpoYWlfa3U0aWxlX1QxMTF9</div></div><div>Base64解密得到flag。<span style="color: rgb(255, 0, 0); font-weight: bold;">但我安装的PotPlayer好像打不开这个文件，KMPlayer也不行。</span></div><div><br/></div><div>不过可以用FFDec反编译swf文件后，在P-code中找到对话文本部分的代码，并找到这段对话。</div><div><img src="攻防世界高手区3（37-42）_files/Image [5].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>flag：SYC{F3iZhai_ku4ile_T111}</div><div><br/></div><div><span style="font-weight: bold;">039 warmup</span></div><div><br/></div><div>下载解压得到warmup_3D87119B1FD69603E77BA1292A007C4B.zip和open_forum.png。</div><div>压缩包内是加密的open_forum.png、fuli.png和fuli2.png。有同样的文件，ARCHPR<span style="font-size: unset; color: unset; font-family: unset;">明文爆破。</span></div><div><img src="攻防世界高手区3（37-42）_files/Image [6].png" type="image/png" data-filename="Image.png"/></div><div>稍微运行几分钟手动停止，然后跳出窗口另存为即可得到解密后的zip压缩包，无需等待工具将明文密码计算出来。然后解压得到fuli.png和fuli2.png。</div><div>Stegsolve的Image Combiner对比两图，XOR模式下有大量排列成横线的小点，怀疑是盲水印。</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>python bwm.py decode fuli.png fuli2.png flag.png</div></div><div><img src="攻防世界高手区3（37-42）_files/flag.png" type="image/png" data-filename="flag.png"/></div><div><br/></div><div>flag：flag{bWm_Are_Wonderfu1}</div><div><br/></div><div><span style="font-weight: bold;">040 miscmisc</span></div><div><br/></div><div>下载得到png格式文件。十六进制编辑器查看，文件尾后明显有zip压缩包数据。</div><div><img src="攻防世界高手区3（37-42）_files/Image [7].png" type="image/png" data-filename="Image.png"/></div><div>foremost提取，得到zip格式压缩包。解压得到chayidian.jpg和chadiand.zip。</div><div><br/></div><div>先看chayidian.jpg，十六进制编辑器打开，发现实际上是PNG格式图像，且文件尾后有zip压缩包。</div><div><img src="攻防世界高手区3（37-42）_files/Image [8].png" type="image/png" data-filename="Image.png"/></div><div>提取并解压，得到flag.txt，内容为：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>假的flag&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;柠檬精出题人</div></div><div><br/></div><div>再看chadiand.zip，这是一个加密压缩包，内含flag.zip和flag.txt。注意到flag.txt文件CRC32值为ADCED8F9，和chayidian.jpg中得到的flag.txt一样。说明两个文件是相同的，尝试明文爆破攻击。</div><div>使用AZPR进行明文爆破，虽然无法还原出密码，但是可以得到已解密的压缩包，耗时18分钟左右。</div><div><img src="攻防世界高手区3（37-42）_files/Image [9].png" type="image/png" data-filename="Image.png"/></div><div><a href="攻防世界高手区3（37-42）_files/UnEncrypted.zip"><img src="攻防世界高手区3（37-42）_files/0cd9006a232dcb0a80e6da0ef1f0949a.png" alt="UnEncrypted.zip"></a></div><div><br/></div><div>解压得到flag.zip。其中包含whoami.zip、world.doc和world1.png。其中whoami.zip是加密压缩包。</div><div>先看world1.png：</div><div><img src="攻防世界高手区3（37-42）_files/world1.png" type="image/png" data-filename="world1.png"/></div><div>提示pass in world，说明密码与world.doc有关。此外利用zsteg可以发现图片中有LSB隐写：</div><div><img src="攻防世界高手区3（37-42）_files/Image [10].png" type="image/png" data-filename="Image.png"/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>pass:z^ea</div></div><div><br/></div><div>然后看world.doc。直接打开只有“除了这个就差一点点了”，右键-字体-取消隐藏后得到隐藏字符。</div><div><img src="攻防世界高手区3（37-42）_files/Image [11].png" type="image/png" data-filename="Image.png"/></div><div>接下来是最后的脑洞部分，whoami.zip的密码是LSB隐写得到的pass内容加上这段隐藏文字每行的最后一个字符，即：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>z^ea4zaa3azf8</div></div><div>解压得到whoami.txt，内容即为flag。</div><div><br/></div><div>flag：flag{12sad7eaf46a84fe9q4fasf48e6q4f6as4f864q9e48f9q4fa6sf6f48}</div><div><br/></div><div><span style="font-weight: bold;">041 flag_universe</span></div><div><br/></div><div>下载得到pcapng格式文件，wireshark打开。统计-协议分级：</div><div><img src="攻防世界高手区3（37-42）_files/Image [12].png" type="image/png" data-filename="Image.png"/></div><div>可以看到FTP协议占据的字节百分比最大，过滤ftp or ftp-data，按数据包长度排序：</div><div><img src="攻防世界高手区3（37-42）_files/Image [13].png" type="image/png" data-filename="Image.png"/></div><div>发现主要涉及universe.png和new_universe.png两张图片。通过追踪TCP流-显示为原始数据-保存为png格式文件的方式将其导出。</div><div><br/></div><div>两张图片的内容看似是一样的，首先尝试双图隐写。用Stegsolve的Image Combiner功能对比两张图片，发现在SUB模式下，左上角出现了一排小点。</div><div><img src="攻防世界高手区3（37-42）_files/Image [14].png" type="image/png" data-filename="Image.png"/></div><div>这表示很可能并非双图隐写，而是其中一张图片存在LSB隐写（另一张则是隐写前的原图）。用zsteg分别查看两张图片：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop# zsteg new_universe.png</div><div>imagedata           .. text: &quot;\n\n\n111???&quot;</div><div>b1,r,lsb,xy         .. text: &quot;F2&amp;*rq.9Qz&quot;</div><div>b1,rgb,lsb,xy       .. text: &quot;<font style="color: rgb(255, 0, 0);">flag{Plate_err_klaus_Mail_Life}\n</font>&quot;</div><div>b3,g,msb,xy         .. file: PGP Secret Sub-key -</div><div>b3,b,msb,xy         .. text: &quot;zC`)XUWS&quot;</div></div><div>在new_universe.png中找到了LSB隐写信息。</div><div><br/></div><div>flag：flag{Plate_err_klaus_Mail_Life}</div><div><br/></div><div><span style="font-weight: bold;">042 Get-the-key.txt</span></div><div><br/></div><div>下载得到无后缀名文件forensic100。file命令查看文件类型：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop# file forensic100</div><div>forensic100: Linux rev 1.0 ext2 filesystem data, UUID=0b92a753-7ec9-4b20-8c0b-79c1fa140869</div></div><div>ext2文件系统镜像可以用7-Zip等压缩软件直接打开，打开后得到了1-244共244个无后缀名的文件。</div><div><img src="攻防世界高手区3（37-42）_files/Image [15].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>也尝试一下在Linux下操作，用mount命令将其挂载：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop# mount forensic100 ./mnt</div></div><div>然后查看所有文件的类型：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop# cd mnt</div><div>root@kali:~/Desktop/mnt# file *</div><div>1:          gzip compressed data, was &quot;key.txt&quot;, last modified: Wed Oct  1 06:00:52 2014, from Unix, original size modulo 2^32 30</div><div>10:         gzip compressed data, was &quot;key106.txt&quot;, last modified: Wed Oct  1 05:59:41 2014, from Unix, original size modulo 2^32 33</div><div>100:        gzip compressed data, was &quot;key188.txt&quot;, last modified: Wed Oct  1 05:59:41 2014, from Unix, original size modulo 2^32 31</div><div>101:        gzip compressed data, was &quot;key189.txt&quot;, last modified: Wed Oct  1 05:59:41 2014, from Unix, original size modulo 2^32 33</div><div>102:        gzip compressed data, was &quot;key19.txt&quot;, last modified: Wed Oct  1 05:59:41 2014, from Unix, original size modulo 2^32 29</div><div>103:        gzip compressed data, was &quot;key190.txt&quot;, last modified: Wed Oct  1 05:59:41 2014, from Unix, original size modulo 2^32 31</div><div>104:        gzip compressed data, was &quot;key191.txt&quot;, last modified: Wed Oct  1 05:59:41 2014, from Unix, original size modulo 2^32 27</div><div>……（后略）</div></div><div>可以看到所有文件都是gzip压缩包，其中包含的都是txt文本。根据题目名称，需要找到key.txt。从file命令的结果中可以看出，key.txt就在文件1中。或者也可以使用grep命令：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop/mnt# grep -r key.txt</div><div>匹配到二进制文件 1</div></div><div>然后用gunzip命令查看其内容：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop/mnt# gunzip &lt; 1</div><div>SECCON{@]NL7n+-s75FrET]vU=7Z}</div></div><div><br/></div><div>当然如果一开始就用7-Zip直接一路打开文件也是可以的。</div><div><img src="攻防世界高手区3（37-42）_files/Image [16].png" type="image/png" data-filename="Image.png"/></div><div>但定位key.txt只能靠逐个文件打开查看，如果flag藏在中间某个压缩包里，可能会花较长时间。</div><div><br/></div><div>flag：SECCON{@]NL7n+-s75FrET]vU=7Z}</div></span>
</div></body></html> 