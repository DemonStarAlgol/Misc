<html>
<head>
  <title>Bugku Misc 4（25-32）</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/605894 (zh-CN, DDL); Windows/6.1.1 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="549"/>
<h1>Bugku Misc 4（25-32）</h1>
<h2><a href="https://DemonStarAlgol.github.io/Misc/">[无关链接]</a></h2>

<div>
<span><div><span style="font-weight: bold;">25 多彩</span></div><div><br/></div><div>下载得到lipstick.png文件，zsteg查看，存在LSB隐写：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop# zsteg lipstick.png</div><div>b1,bgr,lsb,xy       .. <font color="#FF0000">text: &quot;flag.txt&quot;</font></div><div>b2,g,lsb,xy         .. file: 5View capture file</div><div>b2,g,msb,xy         .. file: VISX image file</div><div>b2,b,msb,xy         .. text: &quot;UUuUUWUUUUUuUUUU&quot;</div><div>b2,bgr,lsb,xy       .. text: &quot;AAAP@QUDQ&quot;</div><div>b3,b,lsb,xy         .. file: GLS_BINARY_MSB_FIRST</div><div>b4,r,lsb,xy         .. text: &quot;UDTTUEEDDEDEUEDDTEDETDEDDEDDDDTDUEEETDUDEUDDDDDDDDDDDDUDDDDDDDDDDDDDDDDDDDD\&quot;322\&quot;223##\&quot;\&quot;\&quot;\&quot;\&quot;\&quot;\&quot;\&quot;\&quot;\&quot;\&quot;\&quot;#\&quot;#\&quot;\&quot;\&quot;3\&quot;#&quot;</div><div>b4,r,msb,xy         .. text: &quot;333333333;&quot;</div><div>b4,g,lsb,xy         .. file: 5View capture file</div><div>b4,g,msb,xy         .. file: VISX image file</div><div>b4,b,msb,xy         .. text: [&quot;w&quot; repeated 12 times]</div></div><div>用Stegsolve的Data Extract功能查看，发现隐写信息是开头添加了8字节无效信息的zip格式压缩包：</div><div><img src="Bugku Misc 4（25-32）_files/Image.png" type="image/png" data-filename="Image.png"/></div><div>Save Bin将其导出，或用zsteg提取：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop# zsteg -E &quot;b1,bgr,lsb,xy&quot; lipstick.png &gt; out</div></div><div>去掉无效字节，得到加密zip压缩包。非伪加密，爆破也失败，接下来开始寻找密码。</div><div><br/></div><div>图片大小为3150x500，由21个150x500的色块组成。用Stegsolve在Red plane 0处发现隐藏LOGO：</div><div><img src="Bugku Misc 4（25-32）_files/Image [1].png" type="image/png" data-filename="Image.png"/></div><div>结合图片文件名lipstick，猜测和YSL的口红有关。搜索“YSL lipstick”关键字找到YSL官方网站，<a href="https://www.yslbeautyus.com/makeup/lips/lipstick">口红商品列表页面</a>。查看<a href="https://www.yslbeautyus.com/makeup/lips/lipstick/rouge-pur-couture-lipstick/194YSL.html">颜色最多的口红商品页面</a>，发现口红色号与图片色块颜色是类似的。同时，每个色号都有一个数字编号。</div><div><img src="Bugku Misc 4（25-32）_files/Image [2].png" type="image/png" data-filename="Image.png"/></div><div>猜测接下来需要将图片色块转为对应的色号数字编号。</div><div><br/></div><div>但由于本题是<a href="https://ctftime.org/task/5498">N1CTF 2018的原题</a>，相比出题当时，目前YSL的口红页面提供的色号变少了，部分色块对应的色号已经无法找到，生成色号与编号的完整对应列表已经不可能。注意到YSL官网的色卡是以如下网页代码生成的：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>&lt;span class=&quot;swatch_color&quot; style=&quot;background-color: <font color="#FF0000">#BC0B28</font>&quot; title=&quot;1 Le Rouge - Blood Red (Satin)&quot;&gt;</div></div><div>首先提取lipstick.png中每个色块的RGB值（由于存在LSB隐写，要取靠下方的像素点），并转为十六进制形式：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>from PIL import Image</div><div><br/></div><div>lip = Image.open('C:/Users/Administrator/Desktop/lipstick.png')</div><div>for i in range(21):</div><div>    c = lip.getpixel((i * 150, 149))</div><div>    for j in c:</div><div>        print(str(hex(j))[2:].zfill(2).upper(), end = '')</div><div>    print(' ')</div></div><div>输出结果：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>BC0B28</div><div>D04179</div><div>D47A6F</div><div>C2696F</div><div>EB8262</div><div>CF1A77</div><div>C0083E</div><div>BC0B28</div><div>BC0B28</div><div>D13274</div><div>6A1319</div><div>BC0B28</div><div>BC0B28</div><div>D4121D</div><div>D75B59</div><div>DD8885</div><div>CE0A4A</div><div>D4121D</div><div>7E453A</div><div>D75B59</div><div>DD8885 </div></div><div>检查<a href="https://www.yslbeautyus.com/makeup/lips/lipstick/rouge-pur-couture-lipstick/194YSL.html">ROUGE PUR COUTURE LIPSTICK页面</a>的源代码，逐项搜索这21个颜色值，得到其中部分颜色编号：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>BC0B28 1 Le Rouge - Blood Red (Satin)</div><div>D04179</div><div>D47A6F 59 Golden Melon - Golden Orange (Satin)</div><div>C2696F</div><div>EB8262</div><div>CF1A77 7 Le Fuchsia - Pure Saturated Fuschia (Satin)</div><div>C0083E 57 Luminous Pink - Magenta (Satin)</div><div>BC0B28 1 Le Rouge - Blood Red (Satin)</div><div>BC0B28 1 Le Rouge - Blood Red (Satin)</div><div>D13274</div><div>6A1319 222 Black Red Code &amp;ndash; Rust Red (Matte)</div><div>BC0B28 1 Le Rouge - Blood Red (Satin)</div><div>BC0B28 1 Le Rouge - Blood Red (Satin)</div><div>D4121D 50 Rouge Neon - Bright Red (Satin)</div><div>D75B59</div><div>DD8885</div><div>CE0A4A</div><div>D4121D 50 Rouge Neon - Bright Red (Satin)</div><div>7E453A 53 Beige Promenade - Brown Red (Satin)</div><div>D75B59</div><div>DD8885</div></div><div>理论上剩余的颜色值也可以通过与页面下方的“FIND THE PERFECT SHADE”实物图对比得到：</div><div><img src="Bugku Misc 4（25-32）_files/Image [3].png" type="image/png" data-filename="Image.png"/></div><div>但口红这种东西实物照片受光照影响太大，和标准色号很难对比，如果采用肉眼观察，有些颜色又太像了……总之通过查Writeup的方法得到了完整的色号编码结果：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>1 27 59 11 23 7 57 1 1 76 222 1 1 50 214 6 77 50 53 214 6</div></div><div>根据原题提示“bin2text”，先将数字转换为二进制。尝试后发现，如果把每个数字均转换为开头不带0的二进制数，拼接后正好为96位：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>s = '1 27 59 11 23 7 57 1 1 76 222 1 1 50 214 6 77 50 53 214 6'.split(' ')</div><div><br/></div><div>for i in s:</div><div>    n = int(i)</div><div>    print(str(bin(n))[2:], end = '')</div></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>111011111011101110111111111001111001100110111101111001011010110110100110111001011010111010110110</div></div><div>尝试每8位ASCII转码，但显然存在非ASCII可打印字符范围内的数字。转十六进制观察特征：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>EF BB BF E7 99 BD E5 AD A6 E5 AE B6</div></div><div>搜索发现EF BB BF是<a href="https://www.cnblogs.com/sparkdev/p/5676654.html">UTF-8的BOM头</a>，很可能需要进行UTF-8转码。用十六进制编辑器将其保存为txt格式文件：</div><div><img src="Bugku Misc 4（25-32）_files/Image [4].png" type="image/png" data-filename="Image.png"/></div><div>直接打开得到结果：</div><div><img src="Bugku Misc 4（25-32）_files/Image [5].png" type="image/png" data-filename="Image.png"/></div><div>最后用密码“白学家”解压LSB隐写得到的加密压缩包，得到flag。</div><div><br/></div><div>flag：flag{White_Album_is_Really_worth_watching_on_White_Valentine's_Day}</div><div><br/></div><div><span style="font-weight: bold;">26 旋转跳跃</span></div><div>题目：熟悉的声音中貌似又隐藏着啥，key：syclovergeek</div><div><br/></div><div>下载得到mp3格式文件。题目给出了key，说明是某种需要密码的隐写方式。尝试MP3Stego：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>D:\CTFToolkit-v1.1.0\信息隐藏\MP3Stego_1_1_18\MP3Stego&gt;Decode.exe -X -P syclovergeek sycgeek-mp3.mp3</div><div>MP3StegoEncoder 1.1.17</div><div>See README file for copyright info</div><div>Input file = 'sycgeek-mp3.mp3'  output file = 'sycgeek-mp3.mp3.pcm'</div><div>Will attempt to extract hidden information. Output: sycgeek-mp3.mp3.txt</div><div>the bit stream file sycgeek-mp3.mp3 is a BINARY file</div><div>HDR: s=FFF, id=1, l=3, ep=off, br=9, sf=0, pd=1, pr=0, m=0, js=0, c=0, o=0, e=0</div><div>alg.=MPEG-1, layer=III, tot bitrate=128, sfrq=44.1</div><div>mode=stereo, sblim=32, jsbd=32, ch=2</div><div>[Frame 5932]Avg slots/frame = 417.889; b/smp = 2.90; br = 127.979 kbps</div><div>Decoding of &quot;sycgeek-mp3.mp3&quot; is finished</div><div>The decoded PCM output file name is &quot;sycgeek-mp3.mp3.pcm&quot;</div></div><div>输出结果为txt格式文件，内容即为flag。</div><div><br/></div><div>flag：SYC{Mp3_B15b1uBiu_W0W}</div><div><br/></div><div><span style="font-weight: bold;">27 普通的二维码</span></div><div><br/></div><div>下载得到bmp格式文件：</div><div><img src="Bugku Misc 4（25-32）_files/misc100.bmp" type="image/bmp" data-filename="misc100.bmp"/></div><div>直接扫码得到：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>哈哈!就不告诉你flag就在这里!</div></div><div>十六进制编辑器打开，发现在文件尾后还有一段数据：</div><div><img src="Bugku Misc 4（25-32）_files/Image [6].png" type="image/png" data-filename="Image.png"/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>146154141147173110141166145137171060125137120171137163143162151160164137117164143137124157137124145156137101163143151151041175@xjseck!</div></div><div>将数字部分每3位八进制ASCII转码，得到flag。</div><div><br/></div><div>flag：flag{Have_y0U_Py_script_Otc_To_Ten_Ascii!}</div><div><br/></div><div><span style="font-weight: bold;">28 乌云邀请码</span></div><div><br/></div><div>下载得到png格式文件：</div><div><img src="Bugku Misc 4（25-32）_files/misc50.png" type="image/png" data-filename="misc50.png"/></div><div>用zsteg查看隐写信息：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop# zsteg misc50.png</div><div>b1,bgr,lsb,xy       .. text: &quot;<font color="#FF0000">flag{Png_Lsb_Y0u_K0nw!}</font>&quot;</div><div>b2,rgb,lsb,xy       .. file: SoftQuad DESC or font file binary</div><div>b2,rgb,msb,xy       .. file: VISX image file</div><div>b2,bgr,lsb,xy       .. file: SoftQuad DESC or font file binary</div><div>b2,bgr,msb,xy       .. file: VISX image file</div></div><div><br/></div><div>flag：flag{Png_Lsb_Y0u_K0nw!}</div><div><br/></div><div><span style="font-weight: bold;">29 神秘的文件</span></div><div><br/></div><div>下载得到flag.zip和logo.png。前者是加密压缩包，且包含加密的logo.png：</div><div><img src="Bugku Misc 4（25-32）_files/Image [7].png" type="image/png" data-filename="Image.png"/></div><div>尝试明文爆破。首先需要生成与加密压缩包使用相同加密算法，且包含同一文件的非加密压缩包：</div><div>1、复制一份加密压缩包的副本；</div><div>2、打开副本，删除logo.png；</div><div>3、把logo.png拖进副本中压缩；</div><div>4、删除副本中的其他文件。</div><div><br/></div><div>然后用AZPR进行爆破：</div><div><img src="Bugku Misc 4（25-32）_files/Image [8].png" type="image/png" data-filename="Image.png"/></div><div>爆破结果：</div><div><img src="Bugku Misc 4（25-32）_files/Image [9].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>解压得到docx格式文件。直接打开报错。将其作为zip压缩包打开，在\docProps\目录下发现flag.txt：</div><div><img src="Bugku Misc 4（25-32）_files/Image [10].png" type="image/png" data-filename="Image.png"/></div><div>其内容为：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>ZmxhZ3tkMGNYXzFzX3ppUF9maWxlfQ==</div></div><div>base64转码得到flag。</div><div><br/></div><div>flag：flag{d0cX_1s_ziP_file}</div><div><br/></div><div><span style="font-weight: bold;">30 论剑</span></div><div><br/></div><div>下载得到jpg格式文件，十六进制编辑器打开，文件尾后有额外数据：</div><div><img src="Bugku Misc 4（25-32）_files/Image [11].png" type="image/png" data-filename="Image.png"/></div><div>首先是一段二进制数字串：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>01101101 01111001 01101110 01100001 01101101 01100101 01101001 01110011 01101011 01100101 01111001 00100001 00100001 00100001 01101000 01101000 01101000</div></div><div>二进制ASCII转码得到：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>mynameiskey!!!hhh</div></div><div><br/></div><div>然后用foremost分离file.jpg，得到另一张jpg格式图片。用十六进制编辑器定位这张图片的数据在原始附件中的位置：</div><div><img src="Bugku Misc 4（25-32）_files/Image [12].png" type="image/png" data-filename="Image.png"/></div><div>可以看出，原始附件的数据结构是：jpg格式图片+二进制数字串+<span style="font-weight: bold;">未知数据</span>+第二张jpg格式图片。即，在二进制数字串和第二张jpg格式图片之间还有一段额外数据。观察这段数据的开头部分：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>38 7B BC AF 27 1C</div></div><div>联想到7z格式压缩文件的文件头：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>37 7A BC AF 27 1C</div></div><div>将这段数据提取后修复文件头，得到加密的7z格式压缩包。用密码“mynameiskey!!!hhh”解压，得到ljc2.jpg。</div><div><br/></div><div>现在我们已经得到三张jpg格式图片：原始附件，foremost分离得到的第二张，以及7z压缩包解压得到的第三张。观察三张图片发现，内容均为CTF论剑场的LOGO，但图片宽高均不相同。因此很可能不是双图隐写，尝试发现，第一和第三张图片修改高度后均有隐藏信息：</div><div><img src="Bugku Misc 4（25-32）_files/Image [13].png" type="image/png" data-filename="Image.png"/></div><div><img src="Bugku Misc 4（25-32）_files/Image [14].png" type="image/png" data-filename="Image.png"/></div><div>结合两张图片中的字符串得到：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>not flag{666c61677B6D795F6E616D655F482121487D}</div></div><div>对括号内字符串进行十六进制ASCII转码：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>flag{my_name_H!!H}</div></div><div><br/></div><div>flag：flag{my_name_H!!H}</div><div><br/></div><div><span style="font-weight: bold;">31 图穷匕见</span></div><div><br/></div><div>下载得到jpg格式文件。十六进制编辑器打开，文件尾后有额外数据：</div><div><img src="Bugku Misc 4（25-32）_files/Image [15].png" type="image/png" data-filename="Image.png"/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>28372c37290a28372c38290a28372c39290a28372c3130290a28372c3131290a28372c3132290a</div><div>……（后略）</div></div><div>十六进制ASCII转码得到：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>(7,7)</div><div>(7,8)</div><div>(7,9)</div><div>(7,10)</div><div>(7,11)</div><div>(7,12)</div></div><div>是从(7,7)到(271,271)的大量坐标。尝试用Python脚本将对应的像素画出来：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>from PIL import Image</div><div>f = open('C:/Users/Administrator/Desktop/1.txt', 'r').readlines()</div><div><br/></div><div>res = Image.new('RGB', (280, 280), (255, 255, 255))</div><div>for line in f:</div><div>    x = int(line.split(',')[0][1:])</div><div>    y = int(line.split(',')[1].split(')')[0])</div><div>    res.putpixel((x, y), (0, 0, 0))</div><div>res.save('C:/Users/Administrator/Desktop/1.png')</div></div><div>得到二维码：</div><div><img src="Bugku Misc 4（25-32）_files/1.png" type="image/png" data-filename="1.png"/></div><div>扫码得到flag。</div><div><br/></div><div>flag：flag{40fc0a979f759c8892f4dc045e28b820}</div><div><br/></div><div><span style="font-weight: bold;">32 convert</span></div><div><br/></div><div>下载得到txt格式文件，内容为0和1组成的字符串：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>01010010011000010111001000100001000110100000011100000000110011111001000001110011000000000000000000001101000000000000000000000000000000000000000000000000000000001111011111</div><div>……（后略）</div></div><div>尝试将开头部分进行二进制ASCII转码：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>01010010 01100001 01110010 00100001</div><div>Rar!</div></div><div>得到了RAR格式压缩文件的文件头。将字符串每8位转换成十六进制：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>f = open('C:/Users/Administrator/Desktop/1.txt', 'r').read()</div><div><br/></div><div>for i in range(0, len(f), 8):</div><div>    n = int(f[i: i+8], 2)</div><div>    print(str(hex(n))[2:].zfill(2), end = '')</div></div><div>然后将输出结果在十六进制编辑器内保存为rar格式文件，解压得到key.jpg：</div><div><img src="Bugku Misc 4（25-32）_files/key.jpg" type="image/jpeg" data-filename="key.jpg"/></div><div>查看exif信息，在主题栏得到字符串：</div><div><img src="Bugku Misc 4（25-32）_files/Image [16].png" type="image/png" data-filename="Image.png"/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>ZmxhZ3swMWEyNWVhM2ZkNjM0OWM2ZTYzNWExZDAxOTZlNzVmYn0=</div></div><div>将其base64解码得到flag。</div><div><br/></div><div>flag：flag{01a25ea3fd6349c6e635a1d0196e75fb}</div></span>
</div></body></html> 