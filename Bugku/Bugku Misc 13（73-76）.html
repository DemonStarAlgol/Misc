<html>
<head>
  <title>Bugku Misc 13（73-76）</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/605894 (zh-CN, DDL); Windows/6.1.1 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="3498"/>
<h1>Bugku Misc 13（73-76）</h1>
<h2><a href="https://DemonStarAlgol.github.io/Misc/">[无关链接]</a></h2>

<div>
<span><div><span style="font-weight: bold;">73 欢乐牛年</span></div><div><br/></div><div>下载得到zip格式文件，为加密压缩包。查看注释：</div><div><img src="Bugku Misc 13（73-76）_files/Image.png" type="image/png" data-filename="Image.png"/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>this is password:</div><div>y 20 p m 12 9 c 1</div><div><br/></div><div>pay attention:</div><div>alphabet(lower case)---&gt;num</div><div>num---&gt;alphabet(capital letter)</div><div>/*no hint more happiness*/</div></div><div>根据提示，小写字母转数字，数字转大写字母，得到：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>25T1613LI3A</div></div><div><br/></div><div>解压得到secret.pcapng和 棋盘入门.zip。后者是加密压缩包，先看前者。wireshark打开：</div><div><img src="Bugku Misc 13（73-76）_files/Image [1].png" type="image/png" data-filename="Image.png"/></div><div>显然是USB鼠标输入流量，用脚本提取输入内容：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop# tshark -r secret.pcapng -T fields -e usb.capdata &gt; data</div><div>root@kali:~/Desktop# python usb.py &gt; plot.txt</div><div>root@kali:~/Desktop# gnuplot</div><div><br/></div><div>        G N U P L O T</div><div>        Version 5.2 patchlevel 8    last modified 2019-12-01</div><div><br/></div><div>        Copyright (C) 1986-1993, 1998, 2004, 2007-2019</div><div>        Thomas Williams, Colin Kelley and many others</div><div><br/></div><div>        gnuplot home:     http://www.gnuplot.info</div><div>        faq, bugs, etc:   type &quot;help FAQ&quot;</div><div>        immediate help:   type &quot;help&quot;  (plot window: hit 'h')</div><div><br/></div><div>Terminal type is now 'qt'</div><div>gnuplot&gt; plot &quot;plot.txt&quot;</div><div>qt5ct: using qt5ct plugin</div></div><div>其中usb.py脚本的内容为：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>nums = []</div><div>keys = open('data','r')</div><div>posx = 0</div><div>posy = 0</div><div>for line in keys:</div><div>    if len(line) != 13:</div><div>         continue</div><div>    x = int(line[4:6],16)</div><div>    y = int(line[6:8],16)</div><div>    if x &gt; 127 :</div><div>        x -= 256</div><div>    if y &gt; 130 :</div><div>        y -= 265</div><div>    posx += x</div><div>    posy += y</div><div>    btn_flag = int(line[2:4],16)</div><div>    if btn_flag == 1:   # 1 for left , 2 for right , 0 for nothing</div><div>        print posx ,posy</div><div>keys.close()</div></div><div>绘图结果：</div><div><img src="Bugku Misc 13（73-76）_files/Image [2].png" type="image/png" data-filename="Image.png"/></div><div>翻转一下：</div><div><img src="Bugku Misc 13（73-76）_files/Image [3].png" type="image/png" data-filename="Image.png"/></div><div>得到密码为：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>N65t92c8</div></div><div><br/></div><div>解压棋盘入门.zip得到 牛年大吉.txt 和 棋盘-入门.zip。先看前者，十六进制编辑器下发现大量零宽字符：</div><div><img src="Bugku Misc 13（73-76）_files/Image [4].png" type="image/png" data-filename="Image.png"/></div><div>用<a href="https://offdev.net/demos/zwsp-steg-js">Offdev.net - Zero-width space steganography javascript demo</a>解码，得到：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>lower than 64 and the word is:3sm140dhF01RABnzSQTxQqtMu9</div></div><div>base36解码，得到：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>password:happyoxday</div></div><div><br/></div><div>解压 棋盘-入门.zip 得到 flag.rar和 棋盘-入门.jpg。十六进制编辑器查看后者，文件尾后发现额外数据：</div><div><img src="Bugku Misc 13（73-76）_files/Image [5].png" type="image/png" data-filename="Image.png"/></div><div>提取后解压，得到 密码本.docx ，同时取消隐藏字体：</div><div><img src="Bugku Misc 13（73-76）_files/Image [6].png" type="image/png" data-filename="Image.png"/></div><div>根据以上规则，对应棋盘图片，得到密码为：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>htpchbar</div></div><div><br/></div><div>解压flag.rar，得到flag.gif和 题目描述.txt。后者内容为：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>az</div><div>啊这</div><div><br/></div><div>据说flag需要和图片进行xxoor然后才能得到</div><div>55Sa6Iez5bCx6L+e5Ye66aKY5Lq66YO955WZ5LiL5LqG5LiA5q616K+dKGhpbnTliY05Ke+8mgpISVFXRUJJV1FUTlJUUVpOWlpISldOREpTQUlPSEJJTkZTSlRQT0FEU05ET0VaWk5aRkpJQlRPV0FISkZOUERTQVVGVEhVUEFTRkRUQVNCVUhaWkZCWk9VQURUU0hOWkZJREFIU0hIRkhBWlpPSU5CVUVaSVdIQlRFUUFUVFdRQUVXT0hRWldIQk9QVEdBQkpaVk5PWlhaTkZISU9BV0JaTlRFSU9CV1FQSklEWlRBU1BITlVWWUlXWkVJVVpCSFVCQkhEU1RBT0ZKSVNBT0hORkRQT1dRTkhUVVFFV09OR0RISE5TSlpOVlVET0lIRklXSEVVWklPVEJFV0FVSUpORkRTT0FQSkZJQURTUE1IUU9QRUpUVUlPTlVOQllTQUJGVVRISVNJU0hJTlRZT05aRUVEQ09OSEVOVU1CRVJJQkdIVUlUU0FCREdPSUJPVEVIV0FIVEJIT0hIV05RUklRTkVUV0lVUkhCTlVJSFFXQkdaVUJFV05BSEhISU9TQk5GWkRJTkJGSUFETlNGSURaU05GQVNHRFNIQUlIVkJTREFVVVRJRU9BV1FIT1VPVEJFV1FJVEZIVEhEU0lBQkZJRFNPQU5GSUFETkhTQlVaRkhFWklXWlVHVVdBWlRCREdBRFRTTkZVRVdOUFFOR1VURUlIUVdaTkFHSVdRVE5IR0hOSURaQlpIU05BT0dCREFaU0lGQlpFV09CWlRHRVdVWkJGQkFEVFNPWkhVVEVXWlFUWkhUVFVPRVdVUVROVUFXTlBTT0tQSlZOQUtTT0ROQUdKQURTUEhUR1pQVUhFV1VBSEZVR1dUQUlUT1BHSERBU1VVSUdPSFdFVUhBVFBUSFlVRVdRUFlUV0lIVkNYTlRaVkJaVFhDTU5HQlNGR0hBRFNISElIRk9FV1FJVFJFWnR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHRlZWVlZWVlZWVlZWVlZWVlZWVlZWVlZWVlZWVlZWVlZWVlZWVlZWVlZWVjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjYw==</div></div><div>base64解码得到：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>甚至就连出题人都留下了一段话(hint前9)：</div><div>HIQWEBIWQTNRTQZNZZHJWNDJSAIOHBINFSJTPOADSNDOEZZNZFJIBTOWAHJFNPDSAUFTHUPASFDTASBUHZZFBZOUADTSHNZFIDAHSHHFHAZZOINBUEZIWHBTEQATTWQAEWOHQZWHBOPTGABJZVNOZXZNFHIOAWBZNTEIOBWQPJIDZTASPHNUVYIWZEIUZBHUBBHDSTAOFJISAOHNFDPOWQNHTUQEWONGDHHNSJZNVUDOIHFIWHEUZIOTBEWAUIJNFDSOAPJFIADSPMHQOPEJTUIONUNBYSABFUTHISISHINTYONZEEDCONHENUMBERIBGHUITSABDGOIBOTEHWAHTBHOHHWNQRIQNETWIURHBNUIHQWBGZUBEWNAHHHIOSBNFZDINBFIADNSFIDZSNFASGDSHAIHVBSDAUUTIEOAWQHOUOTBEWQITFHTHDSIABFIDSOANFIADNHSBUZFHEZIWZUGUWAZTBDGADTSNFUEWNPQNGUTEIHQWZNAGIWQTNHGHNIDZBZHSNAOGBDAZSIFBZEWOBZTGEWUZBFBADTSOZHUTEWZQTZHTTUOEWUQTNUAWNPSOKPJVNAKSODNAGJADSPHTGZPUHEWUAHFUGWTAITOPGHDASUUIGOHWEUHATPTHYUEWQPYTWIHVCXNTZVBZTXCMNGBSFGHADSHHIHFOEWQITREZttttttttttttttttttttttttttttttttttttttttttteeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeccccccccccccccccccccccccccccccccccccccccc</div></div><div>提取字频：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>from collections import Counter</div><div><br/></div><div>c = 'HIQWEBIWQTNRTQZNZZHJWNDJSAIOHBINFSJTPOADSNDOEZZNZFJIBTOWAHJFNPDSAUFTHUPASFDTASBUHZZFBZOUADTSHNZFIDAHSHHFHAZZOINBUEZIWHBTEQATTWQAEWOHQZWHBOPTGABJZVNOZXZNFHIOAWBZNTEIOBWQPJIDZTASPHNUVYIWZEIUZBHUBBHDSTAOFJISAOHNFDPOWQNHTUQEWONGDHHNSJZNVUDOIHFIWHEUZIOTBEWAUIJNFDSOAPJFIADSPMHQOPEJTUIONUNBYSABFUTHISISHINTYONZEEDCONHENUMBERIBGHUITSABDGOIBOTEHWAHTBHOHHWNQRIQNETWIURHBNUIHQWBGZUBEWNAHHHIOSBNFZDINBFIADNSFIDZSNFASGDSHAIHVBSDAUUTIEOAWQHOUOTBEWQITFHTHDSIABFIDSOANFIADNHSBUZFHEZIWZUGUWAZTBDGADTSNFUEWNPQNGUTEIHQWZNAGIWQTNHGHNIDZBZHSNAOGBDAZSIFBZEWOBZTGEWUZBFBADTSOZHUTEWZQTZHTTUOEWUQTNUAWNPSOKPJVNAKSODNAGJADSPHTGZPUHEWUAHFUGWTAITOPGHDASUUIGOHWEUHATPTHYUEWQPYTWIHVCXNTZVBZTXCMNGBSFGHADSHHIHFOEWQITREZttttttttttttttttttttttttttttttttttttttttttteeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeccccccccccccccccccccccccccccccccccccccccc'</div><div>c = Counter(c)</div><div>c = c.most_common()</div><div><br/></div><div>for i in range(9):</div><div>    print(c[i][0], end = '')</div></div><div>输出结果：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>HINTAZtec</div></div><div>提示本身没什么意义，因为flag.gif很明显就是Aztec码：</div><div><img src="Bugku Misc 13（73-76）_files/flag.gif" type="image/gif" data-filename="flag.gif"/></div><div>直接扫码得到flag。</div><div><br/></div><div>flag：bugku{az_th1s_1s_A_AZtec}</div><div><br/></div><div><span style="font-weight: bold;">74 扭转乾坤</span></div><div><br/></div><div>下载得到png格式文件，Stegsolve查看，在R/G/B Plane 0处发现LSB隐写痕迹：</div><div><img src="Bugku Misc 13（73-76）_files/Image [7].png" type="image/png" data-filename="Image.png"/></div><div>用Data Extract功能提取隐写信息：</div><div><img src="Bugku Misc 13（73-76）_files/Image [8].png" type="image/png" data-filename="Image.png"/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>D3D315A5 A7A485A5</div><div>2365D636 00000000</div><div>30FC0000 00BB0020</div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">……（中间略）</span></div><div>00D4D9B2 D3BB2554</div><div>17DD0080 00000041</div><div>4030B405</div></div><div>是一长串十六进制数字，注意到末尾的4030B405，联想到zip格式压缩包的文件头50 4B 03 04。将整段字符串去掉空格和换行后全部倒序，并在十六进制编辑器中保存为zip格式文件：</div><div><img src="Bugku Misc 13（73-76）_files/Image [9].png" type="image/png" data-filename="Image.png"/></div><div>文件尾有字符串：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>cmV2ZXJzZQ==</div></div><div>base64转码得到：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>reverse</div></div><div>提示倒转，但是已经倒转过了。</div><div><br/></div><div>解压zip压缩包，得到flag128.gif和 注意事项.txt 。先看后者：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>内容开头为字母(即bugku)</div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;"><br/></span></div><div>lost：</div><div>前3后1</div></div><div>再看前者：</div><div><img src="Bugku Misc 13（73-76）_files/flag128.png" type="image/png" data-filename="flag128.png"/></div><div>显然是Code128编码格式的条形码，但直接扫描没有结果，联想到提示“lost前3后1”，猜测可能有部分条形码缺失。由于Code128编码是从左往右逐字符编码的，而flag的开头和结尾可以确定为bugku{ 和 } ，因此可以用<a href="https://barcode.tec-it.com/en/Code128?data=bugku%7B%7D">在线工具</a>生成内容为bugku{}的Code128条形码进行对比：</div><div><img src="Bugku Misc 13（73-76）_files/下载.gif" type="image/gif" data-filename="下载.gif"/></div><div>可以看到开头和结尾部分非常相似，且flag128.gif确实缺少了左端的3个竖条和右端的1个竖条，将其补全：</div><div><img src="Bugku Misc 13（73-76）_files/flag129.png" type="image/png" data-filename="flag129.png"/></div><div><a href="https://zxing.org/w/decode.jspx">ZXing</a>扫描得到flag。</div><div><br/></div><div>flag：bugku{9o0d_Luck_1n_Ox_year}</div><div><br/></div><div><span style="font-weight: bold;">75 社工-进阶收集</span></div><div>题目：小明当年为了追求小美想尽办法获得小美的地址。直到有一天小美发了一条说说，小明觉得希望来了。flag{小美小区名字拼音}。</div><div><br/></div><div>下载得到png格式文件：</div><div><img src="Bugku Misc 13（73-76）_files/qq.png" type="image/png" data-filename="qq.png"/></div><div>从图片内容可以确定的信息是：小美家距离某条地铁路线的始发站800余米，距离始发站的下一站1000米以上，且始发站到图中地点距离为7站，中间需要转乘一次。因此首先需要找到照片中的地点，截取照片后利用以图搜图引擎搜索：</div><div><img src="Bugku Misc 13（73-76）_files/Image [10].png" type="image/png" data-filename="Image.png"/></div><div>从而得到照片中的地点为西安大雁塔。</div><div><br/></div><div>从西安地铁的<a href="https://www.xianrail.com/#/index">官方网站</a>获得地铁路线图，寻找符合条件（距离大雁塔7站且需要转乘一次）的始发站。由于大雁塔站位于3号线和4号线的交点，不需要转乘，可以排除这两条线，从而符合条件的仅有2号线始发站韦曲南。条件可以进一步锁定为：距离韦曲南800余米，距离其下一站航天城1000米以上。在地图上找到这两个站点：</div><div><img src="Bugku Misc 13（73-76）_files/Image [11].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>在百度地图上根据距离画圆可以通过如下操作进行，首先在圆心地点右键，选择“在此点附近找”：</div><div><img src="Bugku Misc 13（73-76）_files/Image [12].png" type="image/png" data-filename="Image.png"/></div><div>随便填写搜索关键词，点击“搜索”：</div><div><img src="Bugku Misc 13（73-76）_files/Image [13].png" type="image/png" data-filename="Image.png"/></div><div>然后拖动箭头即可调整距离：</div><div><img src="Bugku Misc 13（73-76）_files/Image [14].png" type="image/png" data-filename="Image.png"/></div><div>不过说实话不是很好用……总之小美所在的小区应该在距离韦曲南800-1000米的圆（一开始使用了800-900米的条件但找不到，说明小美的距离感可能不太好，或者刚好住在小区靠近韦曲南站的那一边），以及距离航天城1000-2000米圆环的重叠区域内。根据这一条件筛选附近的居民小区，确定符合条件的地点为兰乔国际城：</div><div><img src="Bugku Misc 13（73-76）_files/Image [15].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>flag：flag{lanqiaoguojicheng}</div><div><br/></div><div><span style="font-weight: bold;">76 想要种子吗</span></div><div><br/></div><div>下载得到jpg格式文件。在右键-属性-详细信息（exiftool查看exif信息也可以）中找到提示Steghide：</div><div><img src="Bugku Misc 13（73-76）_files/Image [16].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>使用Steghide提取隐写信息，密码留空：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>D:\CTFToolkit-v1.1.0\信息隐藏\steghide&gt;steghide.exe extract -sf torrent.jpg</div><div>Enter passphrase:<font color="#FF0000">（无需填写直接回车）</font></div><div>wrote extracted data to &quot;123.txt&quot;.</div></div><div>得到：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>https://pan.baidu.com/s/1oXOf-mKm5TOrbNWg0suWfg m6qn</div></div><div>怎么说呢就很套娃。</div><div><br/></div><div>到百度网盘下载得到123.zip，内含hint.txt和加密的123.png：</div><div><img src="Bugku Misc 13（73-76）_files/Image [17].png" type="image/png" data-filename="Image.png"/></div><div>先看前者：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>six six six</div></div><div>那就6位数字爆破一下：</div><div><img src="Bugku Misc 13（73-76）_files/Image [18].png" type="image/png" data-filename="Image.png"/></div><div>解压得到123.png。十六进制编辑器查看，文件尾部发现额外数据：</div><div><img src="Bugku Misc 13（73-76）_files/Image [19].png" type="image/png" data-filename="Image.png"/></div><div>提取得到zip格式压缩包，解压得到flag.png。图片内容和前两张图类似但仅有上半部分，且提示CRC错误，说明图片高度被修改过。按前两张图把高度改为282，得到：</div><div><img src="Bugku Misc 13（73-76）_files/flag.png" type="image/png" data-filename="flag.png"/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>fkyg{SfirgsXmuqRoqpemr}</div></div><div>同时flag.png文件尾后有额外数据：</div><div><img src="Bugku Misc 13（73-76）_files/Image [20].png" type="image/png" data-filename="Image.png"/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>https://www.guballa.de/vigenere-solver</div></div><div>这是一个无密钥破解维吉尼亚密码的在线工具，预期可能是用该工具爆破密钥。但既然确定是维吉尼亚密码，且密文和明文的第1、4个字母同为f和g，猜测密钥长度为3，且第1个字母为a。写个Python脚本：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>import string</div><div><br/></div><div>m = 'fkygSfirgsXmuqRoqpemr'</div><div>key = [0, ord('k') - ord('l'), ord('y') - ord('a')]</div><div><br/></div><div>for i in range(len(m)):</div><div>    dic = string.ascii_lowercase if m[i] in string.ascii_lowercase else string.ascii_uppercase</div><div>    print(dic[(dic.find(m[i]) - key[i % 3]) % 26], end = '')</div></div><div>输出结果：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>flagThisisYourTorrent</div></div><div>当然直接在线工具爆破也很快：</div><div><img src="Bugku Misc 13（73-76）_files/Image [21].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>flag：flag{ThisisYourTorrent}</div></span>
</div></body></html> 