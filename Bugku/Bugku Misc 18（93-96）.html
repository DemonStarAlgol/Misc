<html>
<head>
  <title>Bugku Misc 18（93-96）</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/605894 (zh-CN, DDL); Windows/6.1.1 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="4058"/>
<h1>Bugku Misc 18（93-96）</h1>
<h2><a href="https://DemonStarAlgol.github.io/Misc/">[无关链接]</a></h2>

<div><span><div><span style="font-weight: bold;">93 南城旧梦</span></div><div><br/></div><div>建议平台加强质量审核，或者另外开个Musc分类，尽量不要把阴间工具题、暴力套娃题、搬运缝合题、中老年棋牌题、QQ群自嗨题都往Misc分类塞。</div><div><br/></div><div>下载得到加密的RAR压缩包和mmz.bmp。先看后者，十六进制编辑器打开，文件尾有额外字符串：</div><div><img src="Bugku Misc 18（93-96）_files/Image.png" type="image/png" data-filename="Image.png" width="825"/><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>DE@@=&lt;6J:DB625K4</div></div><div>ROT47解码：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>stoolkeyisqeadzc</div></div><div><img src="Bugku Misc 18（93-96）_files/Image [1].png" type="image/png" data-filename="Image.png" style="color: unset; font-family: unset; font-size: unset;" width="383"/><br/></div><div>还挺合适。</div><div><br/></div><div>同时可以发现这张bmp图片是一张包含调色板的256色图片，其背景对应的颜色编号为255，但前几行和右数第二列出现了一些颜色编号为248的小点。对比两个编号的二进制数值，可以猜测这是一种在256色bmp图片上进行的LSB隐写。但是以上分析都没有用，因为出题人大概就是随便找了个感觉大家没见过的超古代文明隐写工具来出题，并不关心原理是什么。根据ROT47解码结果，搜索到这一步使用的阴间工具S-tools。下载和使用方法可以参考<a href="https://www.cs.vu.nl/~ast/books/mos2/zebras.html">这个链接</a>。</div><div><img src="Bugku Misc 18（93-96）_files/Image [2].png" type="image/png" data-filename="Image.png" width="1152"/><br/></div><div>然后用给出的密码提取隐写数据，得到Key.txt：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>mmzbudaiwowuwuwu~~~##</div></div><div><br/></div><div>解压加密压缩包，得到九菊.docx、倾听.txt和加密压缩包 眼花缭乱.rar。先看docx：</div><div><img src="Bugku Misc 18（93-96）_files/Image [3].png" type="image/png" data-filename="Image.png" width="721"/><br/></div><div>强行在misc题里引入莫名其妙的猜谜，同时用了几十个汉字还没能描述清楚规则，挺好。</div><div><br/></div><div>总之先去找密码表，可以发现倾听.txt中有大量空格和Tab组成的空行：</div><div><img src="Bugku Misc 18（93-96）_files/Image [4].png" type="image/png" data-filename="Image.png" width="948"/><br/></div><div><img src="Bugku Misc 18（93-96）_files/Image [5].png" type="image/png" data-filename="Image.png" width="641"/><br/></div><div>当你觉得这应该是某种二进制信息时，就落入圈套了。实际上出题人可能并不关心隐写的实现效果，只是随便找个了他觉得比较厉害的工具来一把梭——在这里对应的工具是SNOW。</div><div>可能有人要问“但是SNOW隐写工具的开发目的不是为了达成在部分文本编辑器里不可见的隐写效果吗，不然为什么人家要把特地在文档里说明隐写数据都在源文件末尾，在最后的空行下面加文字岂不是根本和SNOW的目的背道而驰了吗，既然这样为什么还要用SNOW呢”。但这就是工具题的精髓，表象、特征、线索、原理全都不重要，你要做的事情就是猜工具。</div><div>那么假设我们猜到工具了，就可以提取密码表了：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>D:\CTFToolkit-v1.1.0\信息隐藏\snow&gt;SNOW.EXE -C qingting.txt &gt; 1.txt</div></div><div>提取结果：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>(1)1 2 3 4 5 6                    (2)1 2 3 4 5 6                  (3)1 2 3 4 5 6</div><div>   ! @ # $ % ^                       p f f d e h                     v f s a e y</div><div><br/></div><div>(4)1 2 3 4 5 6                    (5)1 2 3 4 5 6                  (6)1 2 3 4 5 6</div><div>   / * - + . ?                       F G S F H H                     &quot; &quot; / \ | :    </div><div><br/></div><div>(7)1 2 3 4 5 6                    (8)1 2 3 4 5 6                  (9)1 2 3 4 5 6</div><div>   r o k u g s                       f J L Y G W                     J O P N G W</div><div><br/></div><div>(10)1 2 3 4 5 6</div><div>    F S A S D T</div></div><div><br/></div><div>那么接下来就按照跟没有差不多的说明玩骰子游戏。随便搜索一段喝酒骰子的规则，并祈祷它恰好和出题人知道的规则是一样的：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>每人一个骰盅5个骰子，最少要两个人玩。以两个人为例，两人摇了骰盅后正式开始。每人喊一个数字，两人最少从二开始，如两个三。如果对方不信认为你讲大话就可以开你，如果加起来的筛子没有两个三的话就算你讲大话，你输。如果对方相信就继续玩下去，就轮到你喊，但是你喊的数字要比前面喊的大。如果前面喊二个三，你就只能喊二个五或者三个二之类，依此类推。一点可以作任何数，但是如果一点被喊过了就只能当作一点了。</div></div><div>对照前面的骰子图和对话，要比对方喊的“四个四”更大且要赢，只能喊“四个五”，开了之后两个五和两个一凑成四个五，从而对方输掉。但这样一来又会产生一个疑惑：这和密码本又要怎么对应起来呢？是第四组的第五个字符吗，还是第五组的第四个字符？</div><div><span style="font-size: unset; color: unset; font-family: unset;">然而神奇的地方来了，以上答案都不对，正确做法是从十组字符里找四个编号为5的字符，组合起来得到密码，这样一个完全没有一句话提到过，看起来也并不是十分明确的神奇规则。不免让人觉得出题人可能是想要靠这道题找到自己失散已久但心意相通的双胞胎兄弟之类的。</span></div><div><span style="font-size: unset; color: unset; font-family: unset;">但更神奇的地方还在后面，那就是这一步其实还</span><span style="font-size: unset; color: unset; font-family: unset; font-weight: bold;">出错了</span><span style="font-size: unset; color: unset; font-family: unset;">，密码变成了五位……这就让人很好奇这题到底怎么通过的审核还放到公开平台上给人做的。真的，要找人不管贴个寻人启事还是找公安局都比较方便，靠出题效率实在有点低。</span></div><div><span style="font-size: unset;"><br/></span></div><div><span style="font-size: unset; color: unset; font-family: unset;">试一下用爆破的方法做这一步，以密码表里出现过的全部字符组成字符表，用</span>Accent OFFICE Password Recovery爆破，可以得到密码为 %ee.H 。再次解压得到key和gpg两个文件。先看前者：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>;3%5;3%5;3%5;2 ;5 ; ;%4;3%5;4 ;5</div><div>;2 ;open _ ,$0;2 ; ;5 ; ;3;2 ;1%2;4 ; ;5 ;3 ;5</div><div>;2 ;7 ;5 ; ;;while (&lt;_&gt;) { ;5 ; ;5 ;1%6;2</div><div>;3%5;2%7; ;7 ;2;s;%; ;g;3 ;1%7;2; ;5</div><div>;8 ; ;;s'([; ])(\d)' $1x$2 ; 'ge;; ; s'\S';'g; ;4;</div><div>s; ;#;g; ; ;5 ; ;5 ; ;5 ; ;5 ; s;\;; ;g; ;3 ;</div><div>;3%5;3%5;3%5;3%5;; print ;}%5;5%3;2</div></div><div>Google搜索&quot;open _ ,$0;2&quot;找到<a href="http://www.retas.de/thomas/computer/programs/useless/secunet_contest/entry_1/index.html">代码来源</a>，一模一样，完全没改。这是一种混淆过的Perl代码，可以在Kali下直接运行：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop# perl key</div><div>   #####   #####   #####  #     # # ####   #####    #     </div><div>  #     # #     # #     # #     # ##    # #     #   #     </div><div>  #       #     # #       #     # #     # #     # ######  </div><div>   #####  ####### #       #     # #     # #######   #     </div><div>        # #       #       #     # #     # #         #     </div><div>  #     # #     # #     # #     # #     # #     #   #   #</div><div>   #####   #####   #####   #####  #     #  #####     ###  </div></div><div>得到secunet。再用gpg解密另一个文件：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop# gpg -d gpg1</div><div>gpg: AES encrypted data</div></div><div>在弹出的对话框中输入密码secunet：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>gpg: 以 1 个密码加密</div><div>bugku{mmz_Won@nshEn_Kuailai_Jiji@n$%!!!}gpg: 签名建立于 2021年03月31日 星期三 13时37分49秒 UTC</div><div>gpg:               使用 RSA 密钥 0113DEE65D4D7969B1801A64A985FD02A220FC1F</div><div>gpg: 无法检查签名：No public key</div></div><div>从而得到flag。</div><div><br/></div><div>flag：bugku{mmz_Won@nshEn_Kuailai_Jiji@n$%!!!}</div><div><br/></div><div><span style="font-weight: bold;">94 复眼</span></div><div><br/></div><div>不会，告辞。</div><div><br/></div><div><span style="font-weight: bold;">95 Licking dog diary</span></div><div><br/></div><div>又是套娃缝合题。出题人4月19日在BUUCTF做了羊城杯2020的几道题，没两天就缝成套娃署上自己名字投稿了，效率很高。而且这次不但缝考点，连“舔狗”这个要素都是从<a href="https://buuoj.cn/challenges#[%E7%BE%8A%E5%9F%8E%E6%9D%AF%202020]%E9%80%83%E7%A6%BB%E4%B8%9C%E5%8D%97%E4%BA%9A">[羊城杯 2020]逃离东南亚</a>里抄的。怎么说呢，建议审核上点心。</div><div><br/></div><div>下载得到xka.rar和my_baby.png，前者是加密压缩包，先看后者。首先注意到存在iTXt块：</div><div><img src="Bugku Misc 18（93-96）_files/Image [6].png" type="image/png" data-filename="Image.png" width="1006"/><br/></div><div>用Stegsolve查看，在R/G/B Plane 0处有LSB隐写痕迹：</div><div><img src="Bugku Misc 18（93-96）_files/Image [7].png" type="image/png" data-filename="Image.png" width="459"/><br/></div><div>使用Data Extract功能，Bit Plane Order选择BGR，可以看到JFIF等字样，疑似为jpg格式图片：</div><div><img src="Bugku Misc 18（93-96）_files/Image [8].png" type="image/png" data-filename="Image.png" width="738"/><br/></div><div>十六进制编辑器打开。如果直接去掉前两个字节，可以得到jpg文件头，但无法正常显示图片。注意到第0140h行有.ELF字样：</div><div><img src="Bugku Misc 18（93-96）_files/Image [9].png" type="image/png" data-filename="Image.png" width="819"/><br/></div><div>继续往后也能看到很明显的ELF格式特征：</div><div><img src="Bugku Misc 18（93-96）_files/Image [10].png" type="image/png" data-filename="Image.png" width="820"/><br/></div><div>预期可能是需要修复ELF并反编译——因为“参考”来源<a href="https://buuoj.cn/challenges#[%E7%BE%8A%E5%9F%8E%E6%9D%AF%202020]%E9%80%83%E7%A6%BB%E4%B8%9C%E5%8D%97%E4%BA%9A">[羊城杯 2020]逃离东南亚</a>就是这样的——但实际上可以很明显地看到文件中间存在大量的空格，以及空格中间的一段UTF-8字符：</div><div><img src="Bugku Misc 18（93-96）_files/Image [11].png" type="image/png" data-filename="Image.png" width="822"/><br/></div><div>直接转码得到：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>↕↱↕↕↔↙↕↙↔↓↕→↕→↔↗↔↘↕↺↕↲↔↗↔↕↔↗↔↕↔↗↔↕=</div></div><div>千千秀字的<a href="https://www.qqxiuzi.cn/bianma/wenbenjiami.php?s=jiantou">箭头加解密</a>：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>keyisbbwxnlwuwuwu</div></div><div><br/></div><div>解压xka.rar，得到加密压缩包last.rar，以及 敬爱此文.txt 和文件夹 敬爱此码。先看txt：</div><div><img src="Bugku Misc 18（93-96）_files/Image [12].png" type="image/png" data-filename="Image.png" width="349"/><br/></div><div>很明显中间某几行存在空格和Tab组成的密文，将空格替换为0，Tab替换为1，取这几行的前8个空白字符，得到：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>01101011</div><div>01100101</div><div>01111001</div><div>00110001</div><div>00111010</div><div>01101101</div><div>01101101</div><div>01111010</div><div>01110111</div><div>01101100</div><div>01110000</div></div><div>二进制ASCII转码，得到：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>key1:mmzwlp</div></div><div>虽然这个考点在<a href="https://buuoj.cn/challenges#[%E7%BE%8A%E5%9F%8E%E6%9D%AF%202020]%E9%80%83%E7%A6%BB%E4%B8%9C%E5%8D%97%E4%BA%9A">[羊城杯 2020]逃离东南亚</a>里也有，但毕竟是个常见点，姑且没什么可说的。</div><div><br/></div><div>再看文件夹，借助Everything可以看出有部分文件的修改时间与其他文件完全不同：</div><div><img src="Bugku Misc 18（93-96）_files/Image [13].png" type="image/png" data-filename="Image.png" width="1044"/><br/></div><div>这应该就是出题的时间。而这一段考点完完全全是抄袭自<a href="https://buuoj.cn/challenges#[%E7%BE%8A%E5%9F%8E%E6%9D%AF%202020]%E9%80%83%E7%A6%BB%E4%B8%9C%E5%8D%97%E4%BA%9A">[羊城杯 2020]逃离东南亚</a>，还缺少了原题的提示。做题时间4月19日，出题时间4月20日，很想问一下出题人，对着WP把题目做完然后抄一份劣化版当成自己出的题到底有什么意义？</div><div>用RouteNameConstant.php中的代码在github搜索，找到源码来自<a href="https://github.com/zdhxiong/mdclub">mdclub</a>项目：</div><div><img src="Bugku Misc 18（93-96）_files/Image [14].png" type="image/png" data-filename="Image.png" width="831"/><br/></div><div>下载得到项目源码，删掉除config、public、src、templates以外的其他文件夹和文件，然后用Beyond Compare进行比对，找到文件中修改过的部分。注意这里要先设置会话为不比较时间戳：</div><div><img src="Bugku Misc 18（93-96）_files/Image [15].png" type="image/png" data-filename="Image.png" width="707"/><br/></div><div>比较结果，可以发现修改后的文件大小均比源码小：</div><div><img src="Bugku Misc 18（93-96）_files/Image [16].png" type="image/png" data-filename="Image.png" width="1632"/><br/></div><div>查看差异内容，以OptionConstant.php为例，可以看到字母K被删除了：</div><div><img src="Bugku Misc 18（93-96）_files/Image [17].png" type="image/png" data-filename="Image.png" width="1632"/><br/></div><div>依次查看所有差异文件，被删除的字符分别是：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>K e y 2 MM z wbb</div></div><div>与Key1拼接得到解压密码：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>mmzwlpMMzwbb</div></div><div><br/></div><div>解压last.rar得到无扩展名的文件finally，十六进制编辑器查看：</div><div><img src="Bugku Misc 18（93-96）_files/Image [18].png" type="image/png" data-filename="Image.png" width="815"/><br/></div><div>是RAR格式压缩包，重命名后打开：</div><div><img src="Bugku Misc 18（93-96）_files/Image [19].png" type="image/png" data-filename="Image.png" width="970"/><br/></div><div>根据注释猜测，解压密码可能为6位，且前三位是QAQ。这里估计是又缝了<a href="https://buuoj.cn/challenges#[%E7%BE%8A%E5%9F%8E%E6%9D%AF%202020]image_rar">[羊城杯 2020]image_rar</a>，虽然考点很常见，但既然其他考点也是“参考”的羊城杯Misc题，这个大概也八九不离十。个人的建议是不会出题就不要出，总参考别人的算怎么回事。接下来用rar2john提取hash后，再用hashcat的掩码模式爆破密码：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop# rar2john finally.rar</div><div>finally.rar:$rar5$16$c78153e437209d4f354f059ebcd8a0b4$15$6f730637152fee6bb6833dbc3a4a4419$8$a83f158880b7c1c0</div></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>D:\CTFToolkit-v1.1.0\密码工具\hashcat-6.1.1&gt;hashcat.exe -m 13000 -a 3 $rar5$16$c78153e437209d4f354f059ebcd8a0b4$15$6f730637152fee6bb6833dbc3a4a4419$8$a83f158880b7c1c0 QAQ?a?a?a</div></div><div>得到解压密码：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>QAQ%#!</div></div><div><br/></div><div>最后解压得到无扩展名文件flag，十六进制编辑器查看文件头，为jpg格式图片：</div><div><img src="Bugku Misc 18（93-96）_files/flag.jpg" type="image/jpeg" data-filename="flag.jpg" width="440"/><br/></div><div>这一步说明本题还是存在一定原创部分的，因为抄题肯定抄不出这么恶心的做法。题目说明、页面以及附件中没有任何一句提示告诉做题者图片上这句中文就是flag内容——而且要转成拼音。除了刻意刁难以外我想不出任何这么做的意义。</div><div><br/></div><div>总结一下：本题是出题人4月19日仅用了1小时就做完了羊城杯2020的四道Misc题后，第二天就把其中两道涉及的考点，包括ELF藏字符串、github项目源码比对、空格和Tab转01再转二进制ASCII码、RAR5加密压缩包的掩码爆破，全部劣化后用加密压缩包缝合成了一道套娃题，甚至连题目里的“舔狗”要素都模仿自原题。唯一的原创部分则纯属于恶意刁难，故意隐瞒关于flag内容和格式的说明，完全不顾出题人与做题人之间的公平原则。至于题目里的其他内容，我个人不作评价。</div><div><br/></div><div>flag：bugku{huiyuelaiyuehaode}</div><div>本题flag我没有尝试提交（包括同出题人的上一题也是），不保证一定正确。说实话，不太想让这种题目出现在自己的刷题记录里。</div><div><br/></div><div><span style="font-weight: bold;">96 悲伤的故事</span></div><div><br/></div><div>下载得到zip格式文件。解压得到加密的zip格式压缩包和无扩展名的 你有看过这个电影吗 文件。先看前者：</div><div><img src="Bugku Misc 18（93-96）_files/Image [20].png" type="image/png" data-filename="Image.png" width="970"/><br/></div><div>提示了密码为九个汉字。再看后者，十六进制编辑器打开：</div><div><img src="Bugku Misc 18（93-96）_files/Image [21].png" type="image/png" data-filename="Image.png" width="817"/><br/></div><div>很明显是webp格式图片。重命名后以图搜图：</div><div><img src="Bugku Misc 18（93-96）_files/Image [22].png" type="image/png" data-filename="Image.png" width="781"/><br/></div><div>找到电影名为《比悲伤更悲伤的故事》。</div><div><br/></div><div>解压得到加密的rar格式压缩包：</div><div><img src="Bugku Misc 18（93-96）_files/Image [23].png" type="image/png" data-filename="Image.png" width="1245"/><br/></div><div>根据注释提示，生成全年所有日期的字典后进行爆破：</div><div><img src="Bugku Misc 18（93-96）_files/Image [24].png" type="image/png" data-filename="Image.png" width="533"/><br/></div><div>得到密码为 7yue21ri 。</div><div><br/></div><div>再次解压得到exe格式和flac格式文件。前者很明显是pyinstaller库打包成的，参考 <a href="evernote:///view/30668439/s39/efcce1a9-ccf2-484d-9b62-4d89055df103/efcce1a9-ccf2-484d-9b62-4d89055df103/" style="color: rgb(105, 170, 53);">CTFshow Misc 11（41-44）</a>中44题，将其反编译，得到：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>while True:</div><div>    a = input('请输入那串我永远忘不掉的数字：')</div><div>    if a == '83721':</div><div>        print('flag{1_I0ve_7ou_F0ever}')</div><div>        z = input('请按任意键退出…')</div><div>        break</div><div>    else:</div><div>        print('看来你并不了解我，再给你一次机会吧！')</div></div><div><br/></div><div>flag：flag{1_I0ve_7ou_F0ever}</div></span>
</div></body></html> 