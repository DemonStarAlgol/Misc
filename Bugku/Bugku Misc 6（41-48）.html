<html>
<head>
  <title>Bugku Misc 6（41-48）</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/605894 (zh-CN, DDL); Windows/6.1.1 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="521"/>
<h1>Bugku Misc 6（41-48）</h1>
<h2><a href="https://DemonStarAlgol.github.io/Misc/">[无关链接]</a></h2>

<div>
<span><div><span style="font-weight: bold;">41 一枝独秀</span></div><div>提示：翻过四个栅栏即可得到flag</div><div><br/></div><div>下载得到png格式文件，直接打开提示文件损坏。用十六进制编辑器查看文件头或file命令可以看出实际为zip格式压缩包：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop# file 一枝独秀.png</div><div>一枝独秀.png: Zip archive data, at least v2.0 to extract</div></div><div>重命名后打开，其中包含flower(1)-(123).jpg共123个加密压缩的jpg格式图片。注意到仅有flower(81).jpg的大小和修改时间都与其他文件不同。</div><div><img src="Bugku Misc 6（41-48）_files/Image.png" type="image/png" data-filename="Image.png"/></div><div>尝试用ARCHPR暴力破解，范围选择数字，长度1-8，成功爆破得到解压密码：</div><div><img src="Bugku Misc 6（41-48）_files/Image [1].png" type="image/png" data-filename="Image.png"/></div><div>解压得到flower(81).jpg。</div><div><br/></div><div>Stegsolve打开，在R/G/B Plane 0处的黑色背景部分发现了方格马赛克图案，这是JPHS工具隐写的特征：</div><div><img src="Bugku Misc 6（41-48）_files/Image [2].png" type="image/png" data-filename="Image.png"/></div><div>同时在exif信息中发现字符串flowers：</div><div><img src="Bugku Misc 6（41-48）_files/Image [3].png" type="image/png" data-filename="Image.png"/></div><div>用JPHS工具提取出隐写内容，密码为flowers：</div><div><img src="Bugku Misc 6（41-48）_files/Image [4].png" type="image/png" data-filename="Image.png"/></div><div>十六进制编辑器查看提取结果的文件头，判断为zip格式压缩包，解压得到 参悟佛法.txt：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>从一朵花中看到一个世界，那从一段佛文中能看到什么呢？</div><div>你站在4楼的栏杆上眺望远方，如果参悟不出来就打算跳下去</div><div><br/></div><div>佛曰：阿罰豆缽娑提諳竟諳迦亦侄栗侄大梵尼朋梵彌哆耨除怛奢般是諳爍悉哆爍冥參特參怯涅皤吉缽阿藝耶諳勝侄竟離諳諸尼缽曰。梵究呐耨盧他姪明漫究呐得哆藐集能冥盡滅知俱朋怯室神奢羅姪豆罰帝遠蘇明梵苦奢密侄曰缽者特哆呼勝蘇不冥死等那阿冥悉奢薩豆涅缽波罰。罰摩侄故罰夢缽恐皤寫諳闍舍哆得波苦奢即罰恐冥道一哆究梵呼冥闍哆上罰南訶諳寫冥依皤者哆諦故死哆夷菩侄曰呐逝至皤佛諳耶</div></div><div>用<a href="http://www.keyfc.net/bbs/tools/tudoucode.aspx">与佛论禅</a>在线工具解密，得到：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>H-hDs10OZL3lhIZZbeRSbbbVRZNm32W2X33mGm3Txt999RdV9hx0</div></div><div>根据“四个栅栏”、“4楼栏杆”等提示，尝试栅栏密码解密，分为4组，得到：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>HINT-ZmxhZ3tDb29seW91R290SXROb3dZb3VLbm93VGhlRmxhZ30</div></div><div>然后base64解码：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>flag{CoolyouGotItNowYouKnowTheFlag}</div></div><div><br/></div><div>flag：flag{CoolyouGotItNowYouKnowTheFlag}</div><div><br/></div><div><span style="font-weight: bold;">42 小猪佩奇</span></div><div><br/></div><div>下载得到png格式文件。Stegsolve打开，在R/G/B Plane 0处发现LSB隐写痕迹：</div><div><img src="Bugku Misc 6（41-48）_files/Image [5].png" type="image/png" data-filename="Image.png"/></div><div>但直接用Data Extract等功能无法提取到有效信息，考虑<a href="https://github.com/livz/cloacked-pixel">带密码的LSB隐写</a>，但找不到密码线索，可能需要爆破。通过搜索找到了<a href="https://blog.csdn.net/valecalida/article/details/103129052">出题人给出的提示</a>，密码是7位字母，字典为<a href="https://github.com/danielmiessler/SecLists/blob/master/Passwords/darkweb2017-top10000.txt">darkweb2017-top1000</a>，且倒过来用比较快。</div><div><br/></div><div>从而得出解题思路：利用该密码字典，筛选7位字母密码，对附件图片进行LSB隐写爆破，对爆破得到的结果，检查其是否包含flag格式或常见文件类型的文件头，若包含则将其输出。写出Python脚本：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>from lsb import extract</div><div>import re</div><div>import os</div><div><br/></div><div>f = open('darkweb2017-top10000.txt','r+').readlines()</div><div>for line in f:</div><div>    p = line.replace('\n', '')</div><div>    if len(p) == 7 and re.search('[^a-zA-Z]', p) == None:</div><div>        out = './res/' + p</div><div>        extract('pig.png', out, p)</div><div>        o = open(out).read()</div><div>        if 'flag{' in o:</div><div>            print('txt: ' + p)</div><div>            os.rename(out, out + '.txt')</div><div>            break</div><div>        o = open(out, 'rb').read()[0:4]</div><div>        if o == b'\x50\x4b\x03\x04':</div><div>            print('zip: ' + p)</div><div>            os.rename(out, out + '.zip')</div><div>            break</div><div>        if o == b'\x52\x61\x72\x21':</div><div>            print('rar: '+ p)</div><div>            os.rename(out, out + '.rar')</div><div>            break</div><div>        if o == b'\x89\x50\x4e\x47':</div><div>            print('png: ' + p)</div><div>            os.rename(out, out + '.png')</div><div>            break</div><div>        if o[0:3] == b'\xff\xd8\xff':</div><div>            print('jpg: ' + p)</div><div>            os.rename(out, out + '.jpg')</div><div>            break</div></div><div>将字典文件和Python脚本都放到cloacked-pixel-master目录下，并建立res目录后用Python2运行脚本，输出结果：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop/cloacked-pixel-master# python 1.py</div><div>[+] Image size: 630x359 pixels.</div><div>[+] Written extracted data to ./res/zxcvbnm.</div><div>[+] Image size: 630x359 pixels.</div><div>[+] Written extracted data to ./res/fuckyou.</div><div>[+] Image size: 630x359 pixels.</div><div>[+] Written extracted data to ./res/michael.</div><div>[+] Image size: 630x359 pixels.</div><div>……（中略）</div><div>[+] Written extracted data to ./res/mnbvcxz.</div><div>[+] Image size: 630x359 pixels.</div><div>[+] Written extracted data to ./res/jackass.</div><div>[+] Image size: 630x359 pixels.</div><div>[+] Written extracted data to ./res/raiders.</div><div>png: raiders</div></div><div>在res目录下找到raiders.png：</div><div><img src="Bugku Misc 6（41-48）_files/raiders.png" type="image/png" data-filename="raiders.png"/></div><div>扫码得到：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>flag{37d9704c-9752-434c-8891-ee15e1800490}</div></div><div><br/></div><div>flag：flag{37d9704c-9752-434c-8891-ee15e1800490}</div><div><br/></div><div><span style="font-weight: bold;">43 皇家马德里</span></div><div>提示：好像用到了好几次base</div><div><br/></div><div>下载得到falg.zip和key.zip。后者是伪加密，ZipCenOp处理：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>D:\CTFToolkit-v1.1.0\暴力破解\ZipCenOp&gt;java -jar ZipCenOp.jar r key.zip</div><div>success 1 flag(s) found</div></div><div>解压得到falg.jpg，实际是个文本文件，内容为：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>BBAA</div><div>AA</div><div>ABBA</div><div>BABA</div><div>ABA</div><div>BABB</div><div>ABBA</div><div>B</div><div>BBB</div></div><div>以B为长音，A为短音，摩斯电码转码得到：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>ZIPCRYPTO</div></div><div><br/></div><div>用该密码解压falg.zip，得到flag.png和密码.jpg。先看前者，用Stegsolve查看，在R/G/B Plane 0可以看到最上方有明显的LSB隐写痕迹：</div><div><img src="Bugku Misc 6（41-48）_files/Image [6].png" type="image/png" data-filename="Image.png"/></div><div>但直接使用Data Extract功能没有结果，考虑带密码的LSB隐写，首先需要找出密码。查看密码.jpg：</div><div><img src="Bugku Misc 6（41-48）_files/密码.jpg" type="image/jpeg" data-filename="密码.jpg"/></div><div>说明LSB隐写密码的线索在该图片中，十六进制编辑器打开，发现文件尾后有额外数据：</div><div><img src="Bugku Misc 6（41-48）_files/Image [7].png" type="image/png" data-filename="Image.png"/></div><div>可以看到提示了base加密，由于base后的字节是ASCII不可打印字符，猜测base密文为：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>5':{hAY:[UvvR</div></div><div>根据字符范围判断为base92，解码得到：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>6281M:Z;wS</div></div><div>继续base91解码：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>lsbjiami</div></div><div>提取LSB隐写内容：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop/lsb# python lsb.py extract flag.png flag.txt lsbjiami</div><div>[+] Image size: 580x580 pixels.</div><div>[+] Written extracted data to flag.txt.</div></div><div>打开flag.txt，在最后一行找到flag。</div><div><br/></div><div>flag：flag{tianxiu__Duang}</div><div><br/></div><div><span style="font-weight: bold;">44 好多压缩包</span></div><div><br/></div><div>下载得到out0-67.zip共68个zip格式压缩包：</div><div><img src="Bugku Misc 6（41-48）_files/Image [8].png" type="image/png" data-filename="Image.png"/></div><div>观察特征，每个压缩包都包含加密的data.txt文件，且大小均为4字节：</div><div><img src="Bugku Misc 6（41-48）_files/Image [9].png" type="image/png" data-filename="Image.png"/></div><div>尝试提取每个压缩包中data.txt的CRC32值，通过CRC32爆破得到文件内容：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>import zipfile</div><div>import string</div><div>import binascii</div><div>path = 'C:/Users/Administrator/Desktop/file/out'</div><div><br/></div><div>crcs = [''] * 68</div><div>txts = [''] * 68</div><div><br/></div><div>for i in range(68):</div><div>    file = path + str(i) + '.zip'</div><div>    f = zipfile.ZipFile(file, 'r')</div><div>    crcs[i] = f.getinfo('data.txt').CRC</div><div><br/></div><div>dic = string.printable[:-6]</div><div>num = 0</div><div>for i in dic:</div><div>    for j in dic:</div><div>        for k in dic:</div><div>            for l in dic:</div><div>                s = i + j + k + l</div><div>                c = binascii.crc32(s.encode('utf-8'))</div><div>                for n in range(68):</div><div>                    if c == crcs[n]:</div><div>                        txts[n] = s</div><div>                        print('No.%d is %s' %(n, s))</div><div>                        num += 1</div><div>                if num == 68:</div><div>                    print(txts)</div><div>                    print(''.join(txts))</div><div>                    break</div><div>            else:</div><div>                continue</div><div>            break</div><div>        else:</div><div>            continue</div><div>        break</div><div>    else:</div><div>        continue</div><div>    break</div></div><div>输出结果：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>No.46 is 0efV</div><div>No.35 is 1YJ0</div><div>No.34 is 3k1K</div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">……（中略）</span></div><div>No.59 is ZSBh</div><div>No.63 is ZSBm</div><div>['z5Bz', 'AAAN', 'AAAA', 'AAAA', 'AKo+', 'egCA', 'IwBJ', 'AAAA', 'VAAA', 'AAKG', 'NKv+', 'a2Md', 'SR0z', 'AwAB', 'AAAA', 'Q01U', 'CRUU', 'y91B', 'T5Uk', 'SNPo', 'j5hF', 'EVFB', 'Rvef', 'HSBC', 'fG0r', 'uGnK', 'nygs', 'Myj8', 'SBaZ', 'HxsY', 'HY84', 'LEZ2', '4cXt', 'Z01y', '3k1K', '1YJ0', 'vpK9', 'HwqU', 'zb6u', '9z8i', 'gEr3', 'dCCQ', 'LQAd', 'AAAA', 'HQAA', 'AAJi', '0efV', 'T2Md', 'SR0w', 'CAAg', 'AAAA', 'Zmxh', 'Zy50', 'eHQA', 'sDRp', 'ZmZp', 'eCB0', 'aGUg', 'Zmls', 'ZSBh', 'bmQg', 'Z2V0', 'IHRo', 'ZSBm', 'bGFn', 'xD17', 'AEAH', 'AA==']</div><div>z5BzAAANAAAAAAAAAKo+egCAIwBJAAAAVAAAAAKGNKv+a2MdSR0zAwABAAAAQ01UCRUUy91BT5UkSNPoj5hFEVFBRvefHSBCfG0ruGnKnygsMyj8SBaZHxsYHY84LEZ24cXtZ01y3k1K1YJ0vpK9HwqUzb6u9z8igEr3dCCQLQAdAAAAHQAAAAJi0efVT2MdSR0wCAAgAAAAZmxhZy50eHQAsDRpZmZpeCB0aGUgZmlsZSBhbmQgZ2V0IHRoZSBmbGFnxD17AEAHAA==</div></div><div>最终得到68个4字节长度的字符串，按顺序拼接后明显为base64密文。解码为字符串，发现存在不可打印字符。在Linux下将其解码为文件：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop# echo &quot;z5BzAAANAAAAAAAAAKo+egCAIwBJAAAAVAAAAAKGNKv+a2MdSR0zAwABAAAAQ01UCRUUy91BT5UkSNPoj5hFEVFBRvefHSBCfG0ruGnKnygsMyj8SBaZHxsYHY84LEZ24cXtZ01y3k1K1YJ0vpK9HwqUzb6u9z8igEr3dCCQLQAdAAAAHQAAAAJi0efVT2MdSR0wCAAgAAAAZmxhZy50eHQAsDRpZmZpeCB0aGUgZmlsZSBhbmQgZ2V0IHRoZSBmbGFnxD17AEAHAA==&quot; | base64 -d &gt; out</div></div><div>十六进制编辑器打开：</div><div><img src="Bugku Misc 6（41-48）_files/Image [10].png" type="image/png" data-filename="Image.png"/></div><div>可以看到flag.txt和 fix the file and get the flag 字样。猜测需要将文件修复为某格式压缩包后解压得到flag.txt。观察文件头部字节CF 90 73，联想到RAR格式文件头52 61 72 21 1A 07 00 CF 90 73，尝试补全文件头，得到RAR格式压缩包：</div><div><img src="Bugku Misc 6（41-48）_files/Image [11].png" type="image/png" data-filename="Image.png"/></div><div>打开压缩包，在注释中找到flag：</div><div><img src="Bugku Misc 6（41-48）_files/Image [12].png" type="image/png" data-filename="Image.png"/></div><div>flag.txt中的内容实际上是之前看到的 fix the file and get the flag 。</div><div><br/></div><div>flag：flag{nev3r_enc0de_t00_sm4ll_fil3_w1th_zip}</div><div><br/></div><div><span style="font-weight: bold;">45 一个普通的压缩包(xp0intCTF)</span></div><div><br/></div><div>下载得到rar格式文件，打开后提示secret.png文件头损坏无法解压。flag.txt文件正常，内容为flag is not here。</div><div>十六进制编辑器查看rar文件，参考<a href="https://blog.csdn.net/Claming_D/article/details/105899397">RAR文件格式分析</a>中的说明：</div><div><br/></div><div><img src="Bugku Misc 6（41-48）_files/Image [13].png" type="image/png" data-filename="Image.png"/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>hex值左边是低位，右边是高位，比如52 61 实际上就是0x6152</div><div>D5 56 ：HEAD_CRC，2字节，也就是文件头部分的crc校验值</div><div>74 ：HEAD_TYPE，1字节，块类型，74表示块类型是文件头</div><div>20 90 ：HEAD_FLAGS，2字节，位标记，这块在资料上没找到对应的数值，不知道20 90代表什么意思。</div><div>2D 00 ：HEAD_SIZE，2字节，文件头的全部大小（包含文件名和注释）</div><div>00 10 00 00 ：PACK_SIZE，4字节，已压缩文件大小</div><div>00 10 00 00 ：UNP_SIZE，4字节，未压缩文件大小</div><div>02：HOST_OS，1字节，保存压缩文件使用的操作系统，02代表windows</div><div>C7 88 67 36：FILE_CRC，4字节，文件的CRC值</div><div>6D BB 4E 4B ：FTIME，4字节，MS DOS 标准格式的日期和时间</div><div>1D：UNP_VER，1字节，解压文件所需要的最低RAR版本</div><div>30：METHOD，1字节，压缩方式，这里是存储压缩</div><div>08 00 ：NAME_SIZE，2字节，表示文件名大小，这里文件名大小是8字节（flag.txt）</div><div>20 00 00 00 ：ATTR，4字节，表示文件属性这里是txt文件</div><div>66 6C 61 67 2E 74 78 74：FILE_NAME（文件名） ，NAME_SIZE字节大小，这里NAME_SIZE大小为8</div><div>再往后是txt文件内容，一直到第六行 65 结束，下面是另一个文件块的开始</div><div>这个块中存在两个crc值，一个是文件头块中从块类型到文件名这38个字节的校验，后一个则是压缩包中所包含文件的crc校验，解压时，会计算解压后生成文件的crc值，如果等于这里的crc，则解压完成，如果不同，则报错中断。</div></div><div>观察secret.png的文件头，发现第3个字节是7A，指子块，这里实际应为文件块，改为74后保存。发现可以正常解压，得到secret.png。</div><div><span style="font-size: unset;"><br/></span></div><div><span style="font-size: unset; color: unset; font-family: unset;">十六进制编辑器打开secret.png，发现文件头是GIF89a（47 49 46 38 39 61）。用Stegsolve的帧查看功能也能确认文件有2帧。</span><span style="font-size: unset; color: unset; font-family: unset;">第1帧的Red plane 0：</span></div><div><img src="Bugku Misc 6（41-48）_files/Image [14].png" type="image/png" data-filename="Image.png"/></div><div>用工具提取出第2帧，Stegsolve打开找到Red plane 0：</div><div><img src="Bugku Misc 6（41-48）_files/Image [15].png" type="image/png" data-filename="Image.png"/></div><div>将两幅二维码拼接后补全定位点：</div><div><img src="Bugku Misc 6（41-48）_files/Image [16].png" type="image/png" data-filename="Image.png"/></div><div>扫码得到flag。</div><div><br/></div><div>flag：flag{yanji4n_bu_we1shi}</div><div><br/></div><div><span style="font-weight: bold;">46 QAQ</span></div><div><br/></div><div>下载得到无后缀名文件QAQ，十六进制编辑器打开：</div><div><img src="Bugku Misc 6（41-48）_files/Image [17].png" type="image/png" data-filename="Image.png"/></div><div>可能是pyc格式文件的文件头。尝试重命名后反编译：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>C:\Users\Administrator\Desktop&gt;uncompyle6 QAQ.pyc &gt; 1.py</div></div><div>得到Python脚本：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>def encryt(key, plain):</div><div>    cipher = ''</div><div>    for i in range(len(plain)):</div><div>        cipher += chr(ord(key[(i % len(key))]) ^ ord(plain[i]))</div><div><br/></div><div>    return cipher</div><div><br/></div><div>def getPlainText():</div><div>    plain = ''</div><div>    with open('plain.txt') as (f):</div><div>        while True:</div><div>            line = f.readline()</div><div>            if line:</div><div>                plain += line</div><div>            else:</div><div>                break</div><div><br/></div><div>    return plain</div><div><br/></div><div>def main():</div><div>    key = 'LordCasser'</div><div>    plain = getPlainText()</div><div>    cipher = encryt(key, plain)</div><div>    with open('cipher.txt', 'w') as (f):</div><div>        f.write(cipher.encode('base_64'))</div><div><br/></div><div>if __name__ == '__main__':</div><div>    main()</div></div><div>脚本内容为从文件中读入明文，加密后转base64编码输出。加密函数为encryt，输出密文在题目页面另行给出：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>FSAnRAIzNlMjPQMjNyBJNTs6NlIFPFIqDDVTJy0zGE8rKxZBJDIrJkYoPUQML1M3MDYJZTElFyI7 UzE6DTtSNxckNDw2Mxk9Jzc=</div></div><div><br/></div><div>对应写出解密脚本：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>import base64</div><div><br/></div><div>def decryt(key, cipher):</div><div>    plain = ''</div><div>    for i in range(len(cipher)):</div><div>        plain += chr(ord(key[(i % len(key))]) ^ int(cipher[i]))</div><div>    return plain</div><div><br/></div><div>str = 'FSAnRAIzNlMjPQMjNyBJNTs6NlIFPFIqDDVTJy0zGE8rKxZBJDIrJkYoPUQML1M3MDYJZTElFyI7UzE6DTtSNxckNDw2Mxk9Jzc='</div><div>key = 'LordCasser'</div><div><br/></div><div>s = base64.b64decode(str)</div><div>print(decryt(key, s))</div></div><div>输出结果：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>YOU ARE FOOLED</div><div>THIS IS NOT THAT YOU WANT</div><div>GO ON DUDE</div><div>CATCH THAT STEGOSAURUS</div></div><div>说明该题实际是pyc隐写。利用stegosaurus工具：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>D:\CTFToolkit-v1.1.0\信息隐藏\stegosaurus-master&gt;python3 stegosaurus.py -x QAQ.pyc</div><div>Extracted payload: flag{fin4lly_z3r0_d34d}</div></div><div><br/></div><div>flag：flag{fin4lly_z3r0_d34d}</div><div><br/></div><div><span style="font-weight: bold;">47 妹子的陌陌</span></div><div><br/></div><div>下载得到jpg格式文件，十六进制编辑器打开，文件尾后有额外数据：</div><div><img src="Bugku Misc 6（41-48）_files/Image [18].png" type="image/png" data-filename="Image.png"/></div><div>提取得到加密的RAR压缩包，尝试后发现解压密码是图片上的文字“喜欢我吗.”，解压得到momo.txt：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>嘟嘟嘟嘟</div><div>士兵：报告首长！已截获纳粹的加密电报！</div><div>首长：拿来看看</div><div><br/></div><div>电报内容：</div><div>..../-/-/.--./---.../-..-./-..-././-./-.-./---/-.././.-.-.-/-.-./..../.-/..../..-/---/.-.-.-/-.-./---/--/-..-.</div><div><br/></div><div>首长：我操你在逗我吗？你确定是他们纳粹发的吗？</div><div>士兵：难道我弄错了？哦。。。等等是这一条</div><div><br/></div><div>内容：http://c.bugku.com/U2FsdGVkX18tl8Yi7FaGiv6jK1SBxKD30eYb52onYe0=</div><div>      AES Key：@#@#￥%……￥￥%%……&amp;￥</div><div><br/></div><div>士兵：二维码真的扫不出来吗？？肯定可以扫出来</div></div><div><br/></div><div>首先电报内容为摩斯电码，解码得到：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>HTTP://ENCODE.CHAHUO.COM/</div></div><div>访问该网址，是一个在线加密解密工具。使用AES解密功能，密文为：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>U2FsdGVkX18tl8Yi7FaGiv6jK1SBxKD30eYb52onYe0=</div></div><div>密钥为：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>@#@#￥%……￥￥%%……&amp;￥</div></div><div>解密得到：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>momoj2j.png</div></div><div>拼接URL得到：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>http://c.bugku.com/momoj2j.png</div></div><div>访问得到反色的二维码图片：</div><div><img src="Bugku Misc 6（41-48）_files/momoj2j.png" type="image/png" data-filename="momoj2j.png"/></div><div>扫码得到：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>KEY{nitmzhen6}</div></div><div><br/></div><div>flag：KEY{nitmzhen6}</div><div><br/></div><div><span style="font-weight: bold;">48 就五层你能解开吗</span></div><div>提示：第一层：CRC32 碰撞 第二层：维吉尼亚密码 第三层：sha1 碰撞 第四层：md5 相同文件不同 第五层：RSA</div><div><br/></div><div><span style="color: rgb(255, 0, 0); font-weight: bold;">第一层。</span>下载得到加密的7z格式压缩包：</div><div><img src="Bugku Misc 6（41-48）_files/Image [19].png" type="image/png" data-filename="Image.png"/></div><div>可以看到pwd1-3.txt的大小均为6字节，使用<a href="https://github.com/theonlypwner/crc32/blob/master/crc32.py">CRC32 tools by Victor</a>进行CRC32碰撞得到文件内容：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop# python crc32.py reverse 0x7C2DF918</div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;"><br/></span></div><div>alternative 6 bytes:</div><div>alternative: 5EJeBD (OK)</div><div>alternative: 74bFvQ (OK)</div><div>alternative: D4WldU (OK)</div><div>alternative: Jvea5S (OK)</div><div>alternative: OSgAFe (OK)</div><div>alternative: WtUlWB (OK)</div><div>alternative: XgD1qA (OK)</div><div>alternative: _3n26b (OK)</div><div><font style="color: rgb(255, 0, 0);">alternative: _CRC32 (OK)</font></div><div>alternative: aSKHAn (OK)</div><div>alternative: dvIh2X (OK)</div><div>alternative: fJLvkE (OK)</div><div>alternative: hESFWK (OK)</div><div>alternative: l1r6Sx (OK)</div><div>alternative: pbakFl (OK)</div><div>alternative: uGcK5Z (OK)</div><div>alternative: vgh8vJ (OK)</div><div>alternative: xt8TKP (OK)</div><div>alternative: ytyePI (OK)</div></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop# python crc32.py reverse 0xA58A1926</div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;"><br/></span></div><div>alternative 6 bytes:</div><div>alternative: 1Jnhwi (OK)</div><div>alternative: 3W5fG8 (OK)</div><div>alternative: LEDrYc (OK)</div><div>alternative: N4lQmv (OK)</div><div>alternative: Tbv_HD (OK)</div><div>alternative: ZmiotJ (OK)</div><div><font style="color: rgb(255, 0, 0);">alternative: _i5_n0 (OK)</font></div><div>alternative: bxy760 (OK)</div><div>alternative: jS1DST (OK)</div><div>alternative: kSpuHM (OK)</div><div>alternative: lJwKbf (OK)</div><div>alternative: rhL5Cg (OK)</div><div>alternative: s9oe4b (OK)</div><div>alternative: stBXYj (OK)</div><div>alternative: tmEfsA (OK)</div><div>alternative: zbZVOO (OK)</div></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop# python crc32.py reverse 0x4DAD5967</div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;"><br/></span></div><div>alternative 6 bytes:</div><div>alternative: 9rNYn3 (OK)</div><div>alternative: Ay8sZC (OK)</div><div>alternative: QHSaFX (OK)</div><div>alternative: TmQA5n (OK)</div><div>alternative: VQT_ls (OK)</div><div>alternative: X28BT9 (OK)</div><div>alternative: _GLQzV (OK)</div><div>alternative: goMEPt (OK)</div><div>alternative: nyUKFQ (OK)</div><div><font style="color: rgb(255, 0, 0);">alternative: t_s4f3 (OK)</font></div><div>alternative: xQxVkx (OK)</div><div>alternative: yQ9gpa (OK)</div></div><div>参考<a href="https://zh.wikipedia.org/wiki/Leet">LEET书写规范</a>选择有意义的字符串，得到：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>_CRC32_i5_n0t_s4f3</div></div><div>并以此为密码解压得到CRC32 Collision.7z。</div><div><br/></div><div><span style="color: rgb(255, 0, 0); font-weight: bold;">第二层。</span>进一步解压得到加密压缩包Find password.7z和三个txt文本文件：</div><div><img src="Bugku Misc 6（41-48）_files/Image [20].png" type="image/png" data-filename="Image.png"/></div><div>先看tips.txt：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>你知道维吉尼亚密码吗？</div><div>我们给了keys.txt，唯一的密钥就在其中，那么解密ciphertext.txt里的密文吧！</div><div>解压密码就在明文里，祝你好运！</div><div><br/></div><div>Do you know the Vigenére Ciphers?</div><div>We gave the keys.txt, Only have a key in it, So decrypts ciphertext.txt!</div><div>Unzip Password in plaintext, good luck to you!</div></div><div>提示维吉尼亚密码，密文在ciphertext.txt中：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>rla xymijgpf ppsoto wq u nncwel ff tfqlgnxwzz sgnlwduzmy vcyg ib bhfbe u tnaxua ff satzmpibf vszqen eyvlatq cnzhk dk hfy mnciuzj ou s yygusfp bl dq e okcvpa hmsz vi wdimyfqqjqubzc hmpmbgxifbgi qs lciyaktb jf clntkspy drywuz wucfm</div></div><div>密钥在keys.txt中，但这是一个10000行的文本，每行都有40位长的密钥，需要从中找到正确的密钥：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>ZVVOKMTHJNWFPFRLDWGWOPMDHMDDDMSHWJMNNKXZ</div><div>ZSWKILXTWXOTAEISBTOBMRWBCODLSAOEHLKDGWDB</div><div>KAMQYTOMBEUGOIMROKOTXPXUTOREHDHLFDIWCVPY</div><div>ITBENEXUYTDZPXAWIWZIADYNMDGFEOSLCYMYXSKP</div><div>QFLXKEBGTEFGAISNRPUJJHIORMICAFPDDQPKXVJG</div><div>……（后略）</div></div><div>这一步可以用两种方法解决。</div><div><br/></div><div>1、爆破法：</div><div>写出Python脚本，依次用每行密钥解密密文，判断得到的明文中是否存在特定的有意义字符串，若有则输出结果：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>from pycipher import Vigenere</div><div><br/></div><div>cipher = open('C:/Users/Administrator/Desktop/ciphertext.txt').read()</div><div>key = open('C:/Users/Administrator/Desktop/keys.txt').readlines()</div><div><br/></div><div>for i in key:</div><div>    i = i.replace('\n', '')</div><div>    res = Vigenere(i).decipher(cipher)</div><div>    if 'PASSWORD' in res:</div><div>        print(res)</div></div><div>输出结果：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>THEVIGENERECIPHERISAMETHODOFENCRYPTINGALPHABETICTEXTBYUSINGASERIESOFDIFFERENTCAESARCIPHERSBASEDONTHELETTERSOFAKEYWORDITISASIMPLEFORMOFPOLYALPHABETICSUBSTITUTIONSOPASSWORDISVIGENERECIPHERFUNNY</div></div><div>转小写加空格：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>the vigenere cipher is a method of encrypting alphabetic text by using a series of different caesar ciphers based on the letters of a keyword it is a simple form of polyalphabetic substitution so password is vigenere cipher funny</div></div><div>从而密码为：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>vigenere cipher funny</div></div><div><br/></div><div>2、手动猜测尝试法解维吉尼亚密码</div><div>首先观察密文，已经用空格进行了分词：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>rla xymijgpf ppsoto wq u nncwel ff tfqlgnxwzz sgnlwduzmy vcyg ib bhfbe u tnaxua ff satzmpibf vszqen eyvlatq cnzhk dk hfy mnciuzj ou s yygusfp bl dq e okcvpa hmsz vi wdimyfqqjqubzc hmpmbgxifbgi qs lciyaktb jf clntkspy drywuz wucfm</div></div><div>已知密钥的长度为40，因此位数相差40的字母是用同一位密钥加密的。同时注意到密文的第20位、第60位均为单字母词u，正好相隔40位，是同一位密钥加密，从而明文第20、60位也是相同的单字母词。常见单字母词只有a和I，前者更为常见，先假设明文中这两位是a。从而密钥的第20位是U。同理，从密文110位s，猜测密钥30位是S，密文122位e，猜测密钥第2位是E。</div><div>注意到密文的第一个单词rla，共3个字母。根据假设，密钥第2位是E，倒推得明文第2位是h。出现在句首、第2个字母为h的三字母词，根据英文词频，最常见的是the。倒推得到密钥的前3位是YEW。</div><div>根据以上条件，在keys.txt中筛选，发现符合条件的仅有一行：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>YEWCQGEWCYBNHDHPXOYUBJJPQIRAPSOUIYEOMTSV</div></div><div>尝试用该密钥解密密文，得到同样结果：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>the vigenere cipher is a method of encrypting alphabetic text by using a series of different caesar ciphers based on the letters of a keyword it is a simple form of polyalphabetic substitution so password is <font style="color: rgb(255, 0, 0);">vigenere cipher funny</font></div></div><div><br/></div><div><span style="color: rgb(255, 0, 0); font-weight: bold;">第三层。</span>解压Find password.7z得到加密压缩包Easy SHA1.7z和U need unzip password.txt。</div><div><img src="Bugku Misc 6（41-48）_files/Image [21].png" type="image/png" data-filename="Image.png"/></div><div>后者内容为：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>恭喜!</div><div><br/></div><div>现在我们遇到一个问题,我们有一个zip文件,但我们不知道完整的解压密码。</div><div>幸好我们知道解压密码的一部分sha1值。</div><div>你能帮我们找到的密码吗?</div><div><br/></div><div>不完整的密码：&quot;*7*5-*4*3?&quot;  *代表可打印字符</div><div><br/></div><div>不完整的sha1：&quot;619c20c*a4de755*9be9a8b*b7cbfa5*e8b4365*&quot;  *代表可打印字符</div><div><br/></div><div>人生苦短，我用Python。</div><div><br/></div><div>Congratulations!</div><div>Now we run into a problem,We have a zip file, but we don't know the complete unzip password.</div><div>Fortunately, we know that part of the unzip password of sha1 value.</div><div>can you help us to find the password?</div><div><br/></div><div>Incomplete password is &quot;*7*5-*4*3?&quot;   * in the range of ASCII printable characters</div><div><br/></div><div>Incomplete sha1 is &quot;619c20c*a4de755*9be9a8b*b7cbfa5*e8b4365*&quot;    * in the range of ASCII printable characters</div><div><br/></div><div>Life is short, you need Python.</div></div><div>需要通过爆破SHA1的方法找到符合条件的字符串。Python脚本：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>import hashlib</div><div>import string</div><div><br/></div><div>dic = string.printable</div><div>for i in dic:</div><div>    for j in dic:</div><div>        for k in dic:</div><div>            for l in dic:</div><div>                s = i + '7' + j + '5-' + k + '4' + l + '3?'</div><div>                sha = hashlib.sha1(s.encode('utf-8')).hexdigest()</div><div>                if sha[0:7] == '619c20c' and sha[8:15] == 'a4de755' and sha[16:23] == '9be9a8b' and sha[24:31] == 'b7cbfa5' and sha[32:39] == 'e8b4365':</div><div>                    print(s, sha)</div></div><div>输出结果：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="color: rgb(255, 0, 0);">I7~5-s4F3?</font> 619c20c4a4de75519be9a8b7b7cbfa54e8b4365b</div></div><div><br/></div><div><span style="color: rgb(255, 0, 0); font-weight: bold;">第四层。</span>解压Easy SHA1.7z得到加密压缩包Vulnerable RSA.7z和MD5_is_really_safe？.txt：</div><div><img src="Bugku Misc 6（41-48）_files/Image [22].png" type="image/png" data-filename="Image.png"/></div><div>后者内容：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>Hello World ;-)</div><div>MD5校验真的安全吗？</div><div>有没有两个不同的程序MD5却相同呢？</div><div>如果有的话另一个程序输出是什么呢？</div><div>解压密码为单行输出结果。</div><div><br/></div><div>Hello World ;-)</div><div>MD5 check is really safe?</div><div>There are two different procedures MD5 is the same?</div><div>If so what is the output of another program?</div><div>The decompression password is a single-line output.</div></div><div>需要找到两个MD5值相同但输出结果不同的程序，搜索“different executable files MD5 hashclash”，找到：</div><div><a href="https://www.win.tue.nl/hashclash/SoftIntCodeSign/">https://www.win.tue.nl/hashclash/SoftIntCodeSign/</a></div><div>其中给出的 HelloWorld-colliding.exe 和 GoodbyeWorld-colliding.exe，输出结果分别为：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>Hello World ;-)</div><div><font style="color: rgb(255, 0, 0);">Goodbye World :-(</font></div></div><div>后者即为解压密码。</div><div><br/></div><div>第五层。解压得到flag.enc和rsa_public_key.pem：</div><div><img src="Bugku Misc 6（41-48）_files/Image [23].png" type="image/png" data-filename="Image.png"/></div><div>直接用RsaCtfTool：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop/RsaCtfTool# python3 RsaCtfTool.py --publickey rsa_public_key.pem --uncipherfile flag.enc</div><div>private argument is not set, the private key will not be displayed, even if recovered.</div><div><br/></div><div>[*] Testing key rsa_public_key.pem.</div><div>[*] Performing siqs attack on rsa_public_key.pem.</div><div>[!] Warning: Modulus too large for SIQS attack module</div><div>[*] Performing cube_root attack on rsa_public_key.pem.</div><div>[*] Performing primefac attack on rsa_public_key.pem.</div><div>[*] Performing pastctfprimes attack on rsa_public_key.pem.</div><div>[*] Performing partial_q attack on rsa_public_key.pem.</div><div>[*] Performing noveltyprimes attack on rsa_public_key.pem.</div><div>[*] Performing wiener attack on rsa_public_key.pem.</div><div><br/></div><div>Results for rsa_public_key.pem:</div><div><br/></div><div>Unciphered data :</div><div>b'\x00\x02\xb3\xf3\xc6W8\xb5\x81S/cwr\xe8\xd3\xb5Cf\xe4\xe5w\x81h\t\x82\x8cd\x85D}\xec7\xec!\xe4;\x89\xb3w\xa4Uf\xf5\xd9%\xcb\x96\x85\x10\x11B\x9a&lt;&quot;QS\x05\x84\x80{\xb1.\x82\xcc\x1c\xf6\x87z@\x91\x9e\xf6h\xe7\xa1\x8f\x96\x9d%&amp;\xa4\xcd\xf0\'\x16J\xf4!\x9c\'h8!Y\xa1o(H\xea}\x00<font style="color: rgb(255, 0, 0);">flag{W0rld_Of_Crypt0gr@phy}</font>'</div></div><div><br/></div><div>flag：flag{W0rld_Of_Crypt0gr@phy}</div></span>
</div></body></html> 