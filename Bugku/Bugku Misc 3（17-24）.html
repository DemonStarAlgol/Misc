<html>
<head>
  <title>Bugku Misc 3（17-24）</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/605894 (zh-CN, DDL); Windows/6.1.1 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="572"/>
<h1>Bugku Misc 3（17-24）</h1>
<h2><a href="https://DemonStarAlgol.github.io/Misc/">[无关链接]</a></h2>

<div>
<span><div><span style="font-weight: bold;">17 隐写3</span></div><div><br/></div><div>下载得到png格式文件。Linux下查看提示CRC错误，爆破高度：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>import struct</div><div>import binascii</div><div>from Crypto.Util.number import bytes_to_long</div><div><br/></div><div>img = open('C:/Users/Administrator/Desktop/dabai.png', 'rb').read()</div><div><br/></div><div>for i in range(0xFFFF):</div><div>    stream = img[12:20] + struct.pack('&gt;i', i) + img[24:29]</div><div>    crc = binascii.crc32(stream)</div><div>    if crc == bytes_to_long(img[29:33]):</div><div>        print(hex(i))</div></div><div>输出结果：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>0x1df</div></div><div>十六进制编辑器里修改高度，得到图片：</div><div><img src="Bugku Misc 3（17-24）_files/dabai.png" type="image/png" data-filename="dabai.png"/></div><div><br/></div><div>flag：flag{He1l0_d4_ba1}</div><div><br/></div><div><span style="font-weight: bold;">18 做个游戏(08067CTF)</span></div><div><br/></div><div>下载得到jar格式文件，打开后是个躲避弹幕游戏：</div><div><img src="Bugku Misc 3（17-24）_files/Image.png" type="image/png" data-filename="Image.png"/></div><div>还是挺难的……</div><div><img src="Bugku Misc 3（17-24）_files/Image [1].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>jadx打开jar包，查看源代码，在cn.bjsxt.plane.PlaneGameFrame中找到游戏结束时判断时间的部分：</div><div><img src="Bugku Misc 3（17-24）_files/Image [2].png" type="image/png" data-filename="Image.png"/></div><div>可以看出，如果坚持时间大于60秒，就会显示flag：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>flag{RGFqaURhbGlfSmlud2FuQ2hpamk=}</div></div><div>括号中的部分base64解码得到：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>DajiDali_JinwanChiji</div></div><div><br/></div><div>flag：flag{DajiDali_JinwanChiji}</div><div><br/></div><div><span style="font-weight: bold;">19 想蹭网先解开密码</span></div><div>flag格式：flag{你破解的WiFi密码}</div><div>tips：密码为手机号，为了不为难你，大佬特地让我悄悄地把前七位告诉你 <span style="font-size: unset; color: unset; font-family: unset;">1391040**</span></div><div><span style="font-size: unset;"><br/></span></div><div>下载得到wifi.cap，wireshark打开，过滤发现有4个eapol协议的数据包：</div><div><img src="Bugku Misc 3（17-24）_files/Image [3].png" type="image/png" data-filename="Image.png"/>这是wifi连接认证时WPA的四次握手包，通过握手包可以对wifi密码进行爆破。</div><div><br/></div><div>根据提示，先生成1391040开头的11位数字作为字典：</div><div><img src="Bugku Misc 3（17-24）_files/Image [4].png" type="image/png" data-filename="Image.png"/></div><div>然后在Linux下用aircrack-ng爆破wifi密码：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop# aircrack-ng -a2 wifi.cap -w superdic.txt</div><div><br/></div><div>Reading packets, please wait...</div><div>Opening wifi.cap</div><div>Read 4257 packets.</div><div><br/></div><div>   #  BSSID              ESSID                     Encryption</div><div><br/></div><div>   1  3C:E5:A6:20:91:60  CATR                      WPA (0 handshake)</div><div>   2  3C:E5:A6:20:91:61  CATR-GUEST                WPA (0 handshake)</div><div>   3  BC:F6:85:9E:4E:A3  D-Link_DIR-600A           WPA (1 handshake, with PMKID)</div><div><br/></div><div>Index number of target network ? <font color="#FF0000">3</font></div></div><div><img src="Bugku Misc 3（17-24）_files/Image [5].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>flag：flag{13910407686}</div><div><br/></div><div><span style="font-weight: bold;">20 Linux2</span></div><div>给你点提示吧：key的格式是KEY{}</div><div><br/></div><div>下载得到无扩展名的brave文件，file命令查看文件类型：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop# file brave</div><div>brave: Linux rev 1.0 ext3 filesystem data, UUID=cf6d7bff-c377-403f-84ae-956ce3c99aaa</div></div><div>是ext3文件系统镜像，尝试挂载：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop# mount brave ./mnt</div></div><div>根据flag格式，在挂载目录中查找内容包含字符串KEY的文件：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop# grep -r 'KEY' ./mnt</div><div>./mnt/o8/huas.txt:KEY{24f3627a86fc740a7f36ee2c7a1c124a}</div></div><div><br/></div><div>flag：KEY{24f3627a86fc740a7f36ee2c7a1c124a}</div><div><br/></div><div><b>20 zip伪加密</b></div><div><br/></div><div>下载得到file.zip，直接打开显示为加密压缩包：</div><div><img src="Bugku Misc 3（17-24）_files/Image [6].png" type="image/png" data-filename="Image.png"/></div><div>根据题目可知其为伪加密，ZipCenOp处理：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>D:\CTFToolkit-v1.1.0\暴力破解\ZipCenOp&gt;java -jar ZipCenOp.jar r file.zip</div><div>success 1 flag(s) found</div></div><div>然后解压得到flag。</div><div><br/></div><div>flag：flag{Adm1N-B2G-kU-SZIP}</div><div><br/></div><div><b>21 Linux2</b></div><div><br/></div><div>下载得到无后缀名文件brave，用file命令查看文件类型：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop# file brave</div><div>brave: Linux rev 1.0 ext3 filesystem data, UUID=cf6d7bff-c377-403f-84ae-956ce3c99aaa</div></div><div>是ext3格式磁盘镜像，用mount命令挂载：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop# mount brave ./mnt</div></div><div>打开目录发现大量文件和文件夹：</div><div><img src="Bugku Misc 3（17-24）_files/Image [7].png" type="image/png" data-filename="Image.png"/></div><div>根据flag格式说明，在该目录下所有txt文件中查找字符串“KEY”：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop/mnt# find . -name &quot;*.txt&quot; | xargs grep -ri &quot;KEY&quot;</div><div>./o8/huas.txt:KEY{24f3627a86fc740a7f36ee2c7a1c124a}</div></div><div>得到flag。</div><div><br/></div><div>更简单的方法是用十六进制编辑器打开brave文件，搜索字符串“KEY”：</div><div><img src="Bugku Misc 3（17-24）_files/Image [8].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>flag：KEY{24f3627a86fc740a7f36ee2c7a1c124a}</div><div><br/></div><div><span style="font-weight: bold;">22 细心的大象</span></div><div><br/></div><div>下载得到jpg格式文件，十六进制编辑器打开，文件尾后有额外数据：</div><div><img src="Bugku Misc 3（17-24）_files/Image [9].png" type="image/png" data-filename="Image.png"/></div><div>提取得到加密的RAR压缩包，内含2.png。寻找密码，发现在原图片的exif信息中有线索：</div><div><img src="Bugku Misc 3（17-24）_files/Image [10].png" type="image/png" data-filename="Image.png"/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>TVNEUzQ1NkFTRDEyM3p6</div></div><div>base64解码得到：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>MSDS456ASD123zz</div></div><div>作为密码解压RAR压缩包，得到2.png。在Linux下查看提示CRC错误，爆破高度：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>import struct</div><div>import binascii</div><div>from Crypto.Util.number import bytes_to_long</div><div><br/></div><div>img = open('C:/Users/Administrator/Desktop/2.png', 'rb').read()</div><div><br/></div><div>for i in range(0xFFFF):</div><div>    stream = img[12:20] + struct.pack('&gt;i', i) + img[24:29]</div><div>    crc = binascii.crc32(stream)</div><div>    if crc == bytes_to_long(img[29:33]):</div><div>        print(hex(i))</div></div><div>输出结果：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>0x1f4</div></div><div>修改高度得到图片：</div><div><img src="Bugku Misc 3（17-24）_files/2.png" type="image/png" data-filename="2.png"/></div><div><br/></div><div>flag：BUGKU{a1e5aSA}</div><div><br/></div><div><span style="font-weight: bold;">23 爆照(08067CTF)</span></div><div><br/></div><div>下载得到jpg格式文件。十六进制编辑器查看，文件尾后有额外数据：</div><div><img src="Bugku Misc 3（17-24）_files/Image [11].png" type="image/png" data-filename="Image.png"/></div><div>分离得到zip格式压缩包，内容为8-88888888八个文件及gif图片：</div><div><img src="Bugku Misc 3（17-24）_files/Image [12].png" type="image/png" data-filename="Image.png"/></div><div>其中后五个文件大小一致，且修改时间均较早。观察88、888和8888三个文件，通过查看文件头或file命令可以确定它们均为jpg格式图片。<span style="font-size: unset; color: unset; font-family: unset;">重命名后，先看88.jpg：</span></div><div><img src="Bugku Misc 3（17-24）_files/88.jpg" type="image/jpeg" data-filename="88.jpg"/></div><div>有二维码，扫码得到：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>bilibili</div></div><div>查看888.jpg的exif信息：</div><div><img src="Bugku Misc 3（17-24）_files/Image [13].png" type="image/png" data-filename="Image.png"/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>c2lsaXNpbGk=</div></div><div>base64解码得到：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>silisili</div></div><div>十六进制编辑器打开8888.jpg，文件尾后同样有额外数据：</div><div><img src="Bugku Misc 3（17-24）_files/Image [14].png" type="image/png" data-filename="Image.png"/></div><div>提取得到zip格式压缩包，解压得到1509126368.png：</div><div><img src="Bugku Misc 3（17-24）_files/1509126368.png" type="image/png" data-filename="1509126368.png"/></div><div>扫码得到：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>panama</div></div><div>根据题目给出flag格式拼接三段字符串得到flag。</div><div><br/></div><div>flag：flag{bilibili_silisili_panama}</div><div><br/></div><div><span style="font-weight: bold;">23 猫片(安恒)</span></div><div>hint:LSB BGR NTFS</div><div><br/></div><div>下载得到png格式文件。根据提示，存在LSB隐写，用Stegsolve的Data Extract功能，颜色通道顺序设置为BGR：</div><div><img src="Bugku Misc 3（17-24）_files/Image [15].png" type="image/png" data-filename="Image.png"/></div><div>可以看到明显的PNG文件头，Save Bin将其保存后去掉开头的两个字节FF FE，得到图片：</div><div><img src="Bugku Misc 3（17-24）_files/Image [16].png" type="image/png" data-filename="Image.png"/></div><div>在Linux下查看提示CRC错误，爆破高度：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>import struct</div><div>import binascii</div><div>from Crypto.Util.number import bytes_to_long</div><div><br/></div><div>img = open('C:/Users/Administrator/Desktop/2.png', 'rb').read()</div><div><br/></div><div>for i in range(0xFFFF):</div><div>    stream = img[12:20] + struct.pack('&gt;i', i) + img[24:29]</div><div>    crc = binascii.crc32(stream)</div><div>    if crc == bytes_to_long(img[29:33]):</div><div>        print(hex(i))</div></div><div>输出结果：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>0x118</div></div><div>十六进制编辑器中修改高度得到完整二维码图片：</div><div><img src="Bugku Misc 3（17-24）_files/2 [1].png" type="image/png" data-filename="2.png"/></div><div>扫码得到：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>https://pan.baidu.com/s/1pLT2J4f</div></div><div>访问后下载得到flag.rar，解压得到flag.txt，内容为：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>flag不在这里哦  你猜猜flag在哪里呢？  找找看吧</div></div><div>联想到提示给出的NTFS，应为NTFS流隐写。解压后用NtfsStreamsEditor查看：</div><div><img src="Bugku Misc 3（17-24）_files/Image [17].png" type="image/png" data-filename="Image.png"/></div><div>导出得到flag.pyc，直接运行没有结果，用uncompyle6将其反编译：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>C:\Users\Administrator\Desktop&gt;uncompyle6 flag.pyc &gt; flag.py</div></div><div>得到源码：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>import base64</div><div><br/></div><div>def encode():</div><div>    flag = '*************'</div><div>    ciphertext = []</div><div>    for i in range(len(flag)):</div><div>        s = chr(i ^ ord(flag[i]))</div><div>        if i % 2 == 0:</div><div>            s = ord(s) + 10</div><div>        else:</div><div>            s = ord(s) - 10</div><div>        ciphertext.append(str(s))</div><div><br/></div><div>    return ciphertext[::-1]</div><div><br/></div><div>ciphertext = [</div><div>'96', '65', '93', '123', '91', '97', '22', '93', '70', '102', '94', '132', '46', '112', '64', '97', '88', '80', '82', '137', '90', '109', '99', '112']</div></div><div>编写解密脚本：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>ciphertext = ['96', '65', '93', '123', '91', '97', '22', '93', '70', '102', '94', '132', '46', '112', '64', '97', '88', '80', '82', '137', '90', '109', '99', '112']</div><div>ciphertext = ciphertext[::-1]</div><div><br/></div><div>for i in range(len(ciphertext)):</div><div>    s = int(ciphertext[i])</div><div>    if i % 2 == 0:</div><div>        s -= 10</div><div>    else:</div><div>        s += 10</div><div>    print(chr(i ^ s), end = '')</div></div><div>输出结果：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>flag{Y@e_Cl3veR_C1Ever!}</div></div><div><br/></div><div>flag：flag{Y@e_Cl3veR_C1Ever!}</div><div><br/></div><div><span style="font-weight: bold;">XX 账号被盗了</span></div><div><br/></div><div>本题是Bugku早期平台的题目，且靶机链接已经失效。先记录一下Writeup：</div><div><a href="https://blog.csdn.net/zyh18851473527/article/details/96486542">https://blog.csdn.net/zyh18851473527/article/details/96486542</a></div><div><br/></div><div>flag：flag{182100518+725593795416}</div></span>
</div></body></html> 