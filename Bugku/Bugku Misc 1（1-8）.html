<html>
<head>
  <title>Bugku Misc 1（1-8）</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/605894 (zh-CN, DDL); Windows/6.1.1 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="641"/>
<h1>Bugku Misc 1（1-8）</h1>
<h2><a href="https://DemonStarAlgol.github.io/Misc/">[无关链接]</a></h2>

<div>
<span><div><span style="font-weight: bold;">1 签到题</span></div><div><br/></div><div>扫码关注微信公众号Bugku，公众号会把flag发过来<span style="font-size: unset; color: unset; font-family: unset;">。</span></div><div><span style="font-size: unset;"><br/></span></div><div><span style="font-size: unset; color: unset; font-family: unset;">flag：flag{BugKu-Sec-pwn!}</span></div><div><span style="font-size: unset;"><br/></span></div><div><span style="font-size: unset; color: unset; font-family: unset; font-weight: bold;">2 </span><span style="font-weight: bold;">这是一张单纯的图片</span></div><div><br/></div><div>下载得到jpg格式文件。十六进制编辑器打开，发现文件尾部有可疑字符串：</div><div><img src="Bugku Misc 1（1-8）_files/Image.png" type="image/png" data-filename="Image.png"/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>&amp;#107;&amp;#101;&amp;#121;&amp;#123;&amp;#121;&amp;#111;&amp;#117;&amp;#32;&amp;#97;&amp;#114;&amp;#101;&amp;#32;&amp;#114;&amp;#105;&amp;#103;&amp;#104;&amp;#116;&amp;#125;</div></div><div>Html Entity转码得到：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>key{you are right}</div></div><div><br/></div><div>flag：key{you are right}</div><div><br/></div><div><span style="font-weight: bold;">3 隐写</span></div><div><br/></div><div>下载得到png格式文件。Linux下查看提示CRC错误，Windows下可以正常查看，说明高度被修改过。爆破高度：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>import struct</div><div>import binascii</div><div>from Crypto.Util.number import bytes_to_long</div><div><br/></div><div>img = open('C:/Users/Administrator/Desktop/2.png', 'rb').read()</div><div><br/></div><div>for i in range(0xFFFF):</div><div>    stream = img[12:20] + struct.pack('&gt;i', i) + img[24:29]</div><div>    crc = binascii.crc32(stream)</div><div>    if crc == bytes_to_long(img[29:33]):</div><div>        print(hex(i))</div></div><div>输出结果：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>0x1f4</div></div><div>在十六进制编辑器里修改高度，得到图片：</div><div><img src="Bugku Misc 1（1-8）_files/2.png" type="image/png" data-filename="2.png"/></div><div><br/></div><div>flag：BUGKU{a1e5aSA}</div><div><br/></div><div><span style="font-weight: bold;">4 telnet</span></div><div><br/></div><div>下载得到pcap格式文件，wireshark打开，发现仅有一条TCP流。追踪该流：</div><div><img src="Bugku Misc 1（1-8）_files/Image [1].png" type="image/png" data-filename="Image.png"/></div><div>Telnet的连接密码即为flag。</div><div><br/></div><div>本题也可以wireshark打开后直接搜索字符串“flag”、“{”等找到flag，在第41号数据包中。或者用strings命令：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop# strings networking.pcap | grep '{'</div><div>flag{d316759c281bf925d600be698a4973d5}</div></div><div><br/></div><div>flag：flag{d316759c281bf925d600be698a4973d5}</div><div><br/></div><div><span style="font-weight: bold;">5 眼见非实(ISCCCTF)</span></div><div><br/></div><div>下载得到docx格式文件。直接打开报错：</div><div><img src="Bugku Misc 1（1-8）_files/Image [2].png" type="image/png" data-filename="Image.png"/></div><div>将docx文件作为zip压缩包，用7-Zip打开：</div><div><img src="Bugku Misc 1（1-8）_files/Image [3].png" type="image/png" data-filename="Image.png"/></div><div>发现问题所在：docx格式虽然实际上是zip压缩包，但其中的[Content_Types].xml文件和word等文件夹应当直接在压缩包的第一层路径下。而这里显然多嵌套了一层文件夹，将该文件夹解压，接下来有两种做法。</div><div><br/></div><div>1、在整个文件夹中全局搜索字符“}”：</div><div><img src="Bugku Misc 1（1-8）_files/Image [4].png" type="image/png" data-filename="Image.png"/></div><div>在/word/document.xml中可以找到flag。</div><div><br/></div><div>2、进入该文件夹，将所有文件和文件夹压缩为zip格式，然后修改扩展名为docx：</div><div><img src="Bugku Misc 1（1-8）_files/Image [5].png" type="image/png" data-filename="Image.png"/></div><div>然后就可以正常打开这个docx文件：</div><div><img src="Bugku Misc 1（1-8）_files/Image [6].png" type="image/png" data-filename="Image.png"/></div><div>全选，右键-字体，发现有隐藏字符：</div><div><img src="Bugku Misc 1（1-8）_files/Image [7].png" type="image/png" data-filename="Image.png"/></div><div>取消“隐藏”的勾选，得到flag：</div><div><img src="Bugku Misc 1（1-8）_files/Image [8].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>flag：flag{F1@g}</div><div><br/></div><div><span style="font-weight: bold;">6 啊哒</span></div><div><br/></div><div>下载得到jpg格式文件。十六进制编辑器打开，发现文件尾部有额外数据：</div><div><img src="Bugku Misc 1（1-8）_files/Image [9].png" type="image/png" data-filename="Image.png"/></div><div>提取并保存，得到加密zip压缩包：</div><div><img src="Bugku Misc 1（1-8）_files/Image [10].png" type="image/png" data-filename="Image.png"/></div><div>查看exif信息，在图片属性-详细信息-照相机型号中找到十六进制数字串：</div><div><img src="Bugku Misc 1（1-8）_files/Image [11].png" type="image/png" data-filename="Image.png"/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>73646E6973635F32303138</div></div><div>十六进制ASCII转码得到：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>sdnisc_2018</div></div><div>以此作为密码，解压zip压缩包得到flag。</div><div><br/></div><div>flag：flag{3XiF_iNf0rM@ti0n}</div><div><br/></div><div><span style="font-weight: bold;">7 又一张图片，还单纯吗</span></div><div><br/></div><div>下载得到jpg格式文件。十六进制编辑器打开，文件尾后有额外数据：</div><div><img src="Bugku Misc 1（1-8）_files/Image [12].png" type="image/png" data-filename="Image.png"/></div><div>提取并保存为jpg图片：</div><div><img src="Bugku Misc 1（1-8）_files/3.jpg" type="image/jpeg" data-filename="3.jpg"/></div><div><br/></div><div>flag：falg{NSCTF_e6532a34928a3d1dadd0b049d5a3cc57}</div><div><br/></div><div><span style="font-weight: bold;">8 猜</span></div><div>flag格式key{某人名字全拼}</div><div><br/></div><div>下载得到png格式文件，内容为一名女性的照片，但截掉了上面一部分。根据题意，可能需要找出图中人物的名字。尝试使用Google图片搜索以图搜图：</div><div><img src="Bugku Misc 1（1-8）_files/Image [13].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>flag：key{liuyifei}</div></span>
</div></body></html> 