<html>
<head>
  <title>BMZCTF Misc 21（101-104）</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/605894 (zh-CN, DDL); Windows/6.1.1 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="7137"/>
<h1>BMZCTF Misc 21（101-104）</h1>
<h2><a href="https://DemonStarAlgol.github.io/Misc/">[无关链接]</a></h2>

<div>
<span><div><span style="font-weight: bold;">101 [2021-MAR-DASCTF]雾都孤儿</span></div><div><br/></div><div>下载得到1.png和Oliver Twist.docx，先看前者：</div><div><img src="BMZCTF Misc 21（101-104）_files/1.png" type="image/png" data-filename="1.png"/></div><div>很明显是个<a href="https://esolangs.org/wiki/Piet">Piet</a>程序，用<a href="http://www.bertnase.de/npiet/">npiet</a>运行一下（注意，这门esolang叫Piet，npiet是它的一种解释器）：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>D:\CTFToolkit-v1.1.0\信息隐藏\npiet-1.3a-win32&gt;npiet.exe 1.png</div><div>Tetris</div></div><div><br/></div><div>再看docx，尝试常见文档隐写方法均无结果，但文档中有一张图片。将文档作为压缩包打开，从word\media\中解压得到image1.jpeg：</div><div><img src="BMZCTF Misc 21（101-104）_files/image1.jpeg" type="image/jpeg" data-filename="image1.jpeg"/></div><div>尝试各种需要密钥的JPG图像隐写方法，发现为Outguess，重命名图片后提取隐写信息：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop# outguess -r image1.jpg -k Tetris out.txt</div><div>Reading image1.jpg....</div><div>Extracting usable bits:   28938 bits</div><div>Steg retrieve: seed: 218, len: 390</div></div><div>得到：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>100000001001</div><div>11010101110</div><div>10000001101</div><div>100000001010</div><div>110101010</div><div>1101010110111</div><div>100000001000</div><div>110101010</div><div>0001</div><div>0100</div><div>11011</div><div>11010100110</div><div>110101000</div><div>11011</div><div>11010100110</div><div>11010101111</div><div>1100100</div><div>101101</div><div>101101</div><div>1001</div><div>101110</div><div>11010100110</div><div>100000001001</div><div>0100</div><div>101111</div><div>11010110</div><div>001</div><div>0101</div><div>11011</div><div>11010100110</div><div>11011</div><div>001</div><div>101111</div><div>0000</div><div>001</div><div>1010</div><div>11010100110</div><div>1000000111</div><div>1000000111</div><div>110101011000</div></div><div>观察一下特征，合计40行，每行均由0和1组成，最长和最短的行字符数分别为13和3，与任意一种常见的二值编码都不相符。继续观察，注意到以下两对：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>11010101<font color="#FF0000">0</font></div><div>11010101<font color="#FF0000">10111</font></div><div><br/></div><div>11010100<font color="#FF0000">110</font></div><div>11010100<font color="#FF0000">0</font></div></div><div>有个可能不太容易看出来的共同点，这两对编码都有同样的特征，即开头部分是一样的，从某一位后开始出现差异，且这两对编码的开头部分本身也仅在最后一位存在差异。更进一步可以发现，所有编码中不存在这样的情况：某一行编码正好是另一行编码的开头，由此有理由怀疑这些编码很可能来自某个二叉树。由二叉树容易联想到，这可能是<a href="https://zh.wikipedia.org/wiki/%E9%9C%8D%E5%A4%AB%E6%9B%BC%E7%BC%96%E7%A0%81">霍夫曼编码</a>。</div><div><br/></div><div>题目中给出的信息目前仅有docx里的文章尚未使用，且文本中出现了不自然的额外花括号：</div><div><img src="BMZCTF Misc 21（101-104）_files/Image.png" type="image/png" data-filename="Image.png"/></div><div>猜测需要从文本生成霍夫曼编码后再对照解码。从github找个<a href="https://github.com/huchangchun/learn-python3/blob/master/leetcode/huffuman-compress/huffmanTree.py">脚本</a>然后稍微改一下：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div># -*- coding:utf-8</div><div># Tree-Node Type</div><div>class Node:</div><div>    def __init__(self, freq):</div><div>        self.left = None</div><div>        self.right = None</div><div>        self.father = None</div><div>        self.freq = freq</div><div><br/></div><div>    def isLeft(self):</div><div>        return self.father.left == self</div><div><br/></div><div># create nodes创建叶子节点</div><div>def createNodes(freqs):</div><div>    return [Node(freq) for freq in freqs]</div><div><br/></div><div># create Huffman-Tree创建Huffman树</div><div>def createHuffmanTree(nodes):</div><div>    &quot;&quot;&quot;</div><div>    创建Huffman树的思想是:每次都pop排序(这里采用从小到大)后的两个节点生成父节点，然后append父节点</div><div>    直到只有一个节点;</div><div><br/></div><div>    获取所有节点存放在queue中</div><div>    while循环直到queue长度为1</div><div>    {</div><div>        对queue进行从小到大排序:排序能保证每次更新后的queue都是从小到大排序，</div><div>        pop两个节点出来作为左右孩子节点l,r</div><div>        创建父节点f</div><div>        l,r的父节点指向父节点f</div><div>        父节点f的左右孩子分别指向l,r</div><div>        queue增加父节点</div><div>    }</div><div>    循环结束后queue中只剩一个节点，该节点的权重是最大的一个，即根节点，根节点的父节点置空</div><div>    &quot;&quot;&quot;</div><div>    queue = nodes[:]  # 切片赋值后生成新的对象，如果queue=nodes直接赋值，修改queue会改动原有的nodes</div><div>    while (len(queue)) &gt; 1:</div><div>        queue.sort(key=lambda item: item.freq)</div><div>        left_node = queue.pop(0)</div><div>        right_node = queue.pop(0)</div><div>        father_node = Node(left_node.freq + right_node.freq)</div><div>        father_node.left = left_node</div><div>        father_node.right = right_node</div><div>        left_node.father = father_node</div><div>        right_node.father = father_node</div><div>        queue.append(father_node)</div><div>    queue[0].father = None</div><div>    return queue[0]</div><div><br/></div><div># Huffman编码</div><div>def huffmanEncoding(nodes, root):</div><div>    &quot;&quot;&quot;</div><div>    生成一个list用于存放节点的编码</div><div>    遍历nodes，对每个node进行向上编码，直到父节点为根节点，如果父节点不是根节点：</div><div>    若为左孩子节点则编码为1，若为右孩子节点则编码为0</div><div>    编码表</div><div>    &quot;&quot;&quot;</div><div><br/></div><div>    codes = [&quot;&quot;] * len(nodes)</div><div>    for i, item in enumerate(nodes):</div><div>        while item != root:</div><div>            if item.isLeft():</div><div>                codes[i] = '0' + codes[i]</div><div>            else:</div><div>                codes[i] = &quot;1&quot; + codes[i]  # 原脚本的1和0需要调换一下</div><div>            item = item.father</div><div>    return codes</div><div><br/></div><div># 上面是抄来的轮子，下面是解题脚本</div><div><br/></div><div>from docx import Document</div><div>from collections import Counter</div><div><br/></div><div>document = Document('C:/Users/Administrator/Desktop/Oliver Twist.docx')</div><div>text = '\n'.join([paragraph.text for paragraph in document.paragraphs])</div><div><br/></div><div>c = Counter(text)</div><div>chars_freqs = [(i, c[i]) for i in c]</div><div>nodes = createNodes([item[1] for item in chars_freqs])</div><div>root = createHuffmanTree(nodes)</div><div>codes = huffmanEncoding(nodes, root)</div><div><br/></div><div>out = open('C:/Users/Administrator/Desktop/out.txt', 'r').read().rstrip().split('\n')</div><div>for i in out:</div><div>    print(list(c.keys())[codes.index(i)], end='')</div></div><div>运行得到flag。</div><div><br/></div><div>flag：DASCTF{This_Is_Hvffam_Dickens_secret_!!}</div><div><br/></div><div><span style="font-weight: bold;">102 [2021-MAR-DASCTF]小田的秘密</span></div><div><br/></div><div>下载得到加密的zip格式压缩包和pcapng格式文件。<span style="font-size: unset; color: unset; font-family: unset;">压缩包misc.zip并非未加密，那么密码很可能在流量包misc.pcapng当中。wireshark打开，统计-协议分级：</span></div><div><img src="BMZCTF Misc 21（101-104）_files/Image [1].png" type="image/png" data-filename="Image.png"/></div><div>按字节百分比，占比最高的是HTTP协议。尝试导出HTTP对象，按大小排列：</div><div><img src="BMZCTF Misc 21（101-104）_files/Image [2].png" type="image/png" data-filename="Image.png"/></div><div>看起来稍微比较可疑的就是995号数据包，定位过去之后追踪一下流：</div><div><img src="BMZCTF Misc 21（101-104）_files/Image [3].png" type="image/png" data-filename="Image.png"/></div><div>上传了某个名叫gift的文件，内容就是图中选中的一段，将其导出：</div><div><img src="BMZCTF Misc 21（101-104）_files/Image [4].png" type="image/png" data-filename="Image.png"/></div><div>发现是段夹杂着英文和十六进制数字的emoji：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>🐇 🌷 🍇🍉🐇 🌺 🌷 🍇🍉🏁 🍇🍿🔤first🔤 ➡️ 🔤c0f1b6a831c399e2🔤🔤second🔤 ➡️ 🔤9b675bd57058fd46🔤🔤third🔤➡️🔤e6ae2fec3ad71c77🔤🔤fourth🔤 ➡️ 🔤89f58062f10dd731🔤🔤fifth🔤 ➡️ 🔤6316e53c8cdd9d99🔤🍆 ➡️ dic↪️ 🐽dic 🔤first🔤❗️ ➡️ aa 🍇😀 aa❗️🍉😀 🔤+🔤❗️🍿 🔤9ac6133c88aedbd6🔤 🔤26602a67be14ea8c🔤 🔤73b5f8d8ccd5ad31🔤 🔤c42125f82a562231🔤 🍆 ➡️ 🖍️🆕sdasca🐹 sdasca❗️😀 🐽sdasca 0❗️❗️🍉🐇 🐟 🍇🔑 🆕 🍇🍉❗️ 🙋 🍇😀 🔤a109e294d1e8155be8aa4🔤❗️🍉🍉🐇 🐡 🐟 🍇🔑 🆕 🍇 ⤴️🆕❗️ 🍉✒️ ❗️ 🙋 🍇😀 🔤8adf7f2f76030877🔤❗️🍉🍉🐇 🐋 🐟 🍇🔑 🆕 🍇 ⤴️🆕❗️ 🍉✒️ ❗️ 🙋 🍇😀 🔤eba66e10fba74dbf🔤❗️🍉🍉🐇 🐠 🐟 🍇🔑 🆕 🍇 ⤴️🆕❗️ 🍉✒️❗️ 🙋 🍇😀 🔤a7749e813e9e2dba🔤❗️ 🍉🍉</div></div><div>根据这个特征，可以找到<a href="https://www.emojicode.org/">emojicode</a>。编译运行一下上述代码：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop/Emojicode-1.0-beta.2-Linux-x86_64# ./emojicodec gift.emojic</div><div><br/></div><div>root@kali:~/Desktop/Emojicode-1.0-beta.2-Linux-x86_64# ./gift</div><div>c0f1b6a831c399e2</div><div>+</div><div>26602a67be14ea8c</div><div>root@kali:~/Desktop/Emojicode-1.0-beta.2-Linux-x86_64# ./gift</div><div>c0f1b6a831c399e2</div><div>+</div><div>73b5f8d8ccd5ad31</div><div>root@kali:~/Desktop/Emojicode-1.0-beta.2-Linux-x86_64# ./gift</div><div>c0f1b6a831c399e2</div><div>+</div><div>9ac6133c88aedbd6</div><div>root@kali:~/Desktop/Emojicode-1.0-beta.2-Linux-x86_64# ./gift</div><div>c0f1b6a831c399e2</div><div>+</div><div>26602a67be14ea8c</div><div>root@kali:~/Desktop/Emojicode-1.0-beta.2-Linux-x86_64# ./gift</div><div>c0f1b6a831c399e2</div><div>+</div><div>c42125f82a562231</div><div>root@kali:~/Desktop/Emojicode-1.0-beta.2-Linux-x86_64# ./gift</div><div>c0f1b6a831c399e2</div><div>+</div><div>9ac6133c88aedbd6</div><div>root@kali:~/Desktop/Emojicode-1.0-beta.2-Linux-x86_64# ./gift</div><div>c0f1b6a831c399e2</div><div>+</div><div>26602a67be14ea8c</div><div>root@kali:~/Desktop/Emojicode-1.0-beta.2-Linux-x86_64# ./gift</div><div>c0f1b6a831c399e2</div><div>+</div><div>9ac6133c88aedbd6</div><div>root@kali:~/Desktop/Emojicode-1.0-beta.2-Linux-x86_64# ./gift</div><div>c0f1b6a831c399e2</div><div>+</div><div>73b5f8d8ccd5ad31</div></div><div>竟还是随机化输出，惊了。手动试了一下，解压密码是：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>c0f1b6a831c399e226602a67be14ea8c</div></div><div><br/></div><div>解压得到加密压缩包flag.rar和无扩展名文件64。好的，套起来了。看一下64，实际是个文本：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>10?:A=356142:GOSUB20:A=762:GOSUB20:A=222440:GOSUB20:END</div><div>20A=RND(-A)</div><div>30A=INT(RND(A)*22):IF A THEN ?CHR$(A+64);:GOTO30</div><div>40?&quot; &quot;;:RETURN</div><div><br/></div><div>RUN</div></div><div>开头的10到40看起来是行号，各种等号、GOSUB、INT、RND、IF-THEN看起来像是某种程序语言或者命令。搜索一下可以发现，这实际上是<a href="https://zh.wikipedia.org/wiki/%E5%BA%B7%E6%87%8B%E9%81%9464">Commodore 64</a>家用电脑上的<a href="https://zhuanlan.zhihu.com/p/73285559">BASIC语言</a>（而不是Commodore 64语言）。那么接下来找到一个<a href="https://virtualconsoles.com/online-emulators/c64/">C64的模拟器</a>，然后把代码敲进去。部分符号可能要用模拟器提供的键盘，此外代码里虽然都是大写字母，但敲的时候直接输入小写就行，因为大写被C64用来表示符号了：</div><div><img src="BMZCTF Misc 21（101-104）_files/Image [5].png" type="image/png" data-filename="Image.png"/></div><div>运行，输出了结果：</div><div><img src="BMZCTF Misc 21（101-104）_files/Image [6].png" type="image/png" data-filename="Image.png"/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>NOT AN EGG</div></div><div>解压得到flag.txt：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>6bffd0d9321df3c229cdff714bb5a0b0</div></div><div><br/></div><div>flag：DASCTF{6bffd0d9321df3c229cdff714bb5a0b0}</div><div><br/></div><div><span style="font-weight: bold;">103 </span><span style="font-weight: bold;">[2021CISCN线上赛]running_pixel</span></div><div><br/></div><div>下载得到gif格式文件，GIFFrame打开查看，可以观察到如下特征：</div><div>1、整个动画共有382帧，但每10帧的内容是几乎一致的，因此多余的帧中必然隐藏着信息，可以从帧的属性或内容着手寻找；</div><div>2、部分帧中出现了额外的小点，如376帧（从第1帧开始算）的围巾上边缘部分：</div><div><img src="BMZCTF Misc 21（101-104）_files/Image [7].png" type="image/png" data-filename="Image.png"/></div><div>注意到375帧的围巾部分也存在这样的小点，且位置与376帧的正好邻接，猜测其他帧很可能也有类似的小点，只不过大部分位于背景区域难以肉眼观察到。这个小点很可能就是携带隐藏信息的载体，且携带隐藏信息的方式可能是通过点的位置。</div><div><br/></div><div>为了验证猜测，用Stegsolve打开图像第一帧，切换到Random Colour Map，可以看到靠前的手上方的背景处确实也存在一个不同颜色的小点：</div><div><img src="BMZCTF Misc 21（101-104）_files/Image [8].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>接下来需要找到这个小点的特征，并将其位置信息逐帧提取。用Stegsolve的Frame Browser功能提取上述帧，得到BMP格式图像，再在Windows画图中用取色器查看小点的颜色值，发现均为 (233, 233, 233)：</div><div><img src="BMZCTF Misc 21（101-104）_files/Image [9].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>写个脚本逐帧取色，找到小点的位置后画到一起：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>from PIL import Image, ImageSequence</div><div><br/></div><div>img = Image.open('C:/Users/Administrator/Desktop/running_pixel.gif')</div><div>w, h = img.size</div><div><br/></div><div>def findpixel(frame):</div><div>    f = ImageSequence.Iterator(img)[frame].convert('RGB')</div><div>    for x in range(w):</div><div>        for y in range(h):</div><div>            p = f.getpixel((x, y))</div><div>            if p == (233, 233, 233):</div><div>                return tuple([x, y])</div><div><br/></div><div>res = Image.new('1', (w, h), 255)</div><div>for i in range(382):</div><div>    try:</div><div>        res.putpixel(findpixel(i), 0)</div><div>    except:</div><div>        pass</div><div>res.save('C:/Users/Administrator/Desktop/res.png')</div></div><div>输出结果：</div><div><img src="BMZCTF Misc 21（101-104）_files/res.png" type="image/png" data-filename="res.png"/></div><div>可以看到很多类似字母和符号的形状，但问题是没有顺序……</div><div><br/></div><div>改一下脚本，让结果按原gif图片的帧顺序输出，顺便改一下坐标让字母数字和符号变为正确方向：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>from PIL import Image, ImageSequence</div><div><br/></div><div>img = Image.open('C:/Users/Administrator/Desktop/running_pixel.gif')</div><div>w, h = img.size</div><div><br/></div><div>def findpixel(frame):</div><div>    f = ImageSequence.Iterator(img)[frame].convert('RGB')</div><div>    for x in range(w):</div><div>        for y in range(h):</div><div>            p = f.getpixel((x, y))</div><div>            if p == (233, 233, 233):</div><div>                return tuple([y, x])</div><div><br/></div><div>res = Image.new('L', (w, h), 255)</div><div>l = []</div><div>for i in range(382):</div><div>    try:</div><div>        res.putpixel(findpixel(i), 0)</div><div>    except:</div><div>        pass</div><div>    l += [res.copy()]</div><div>l[0].save('C:/Users/Administrator/Desktop/res.gif', save_all=True, append_images=l[1:])</div></div><div>输出结果：</div><div><img src="BMZCTF Misc 21（101-104）_files/res.gif" type="image/gif" data-filename="res.gif"/></div><div>逐帧查看输出的gif并依次记录出现的字符（并转小写），得到flag。可能有人要问有必要输出成gif动画吗，其实没什么必要，把每帧单独写入一个文件也没问题甚至可能更方便，但要问就是我喜欢，而且你看这多好看。</div><div><br/></div><div>flag：CISCN{12504d0f-9de1-4b00-87a5-a5fdd0986a00}</div><div><br/></div><div><span style="font-weight: bold;">104 </span><span style="font-size: medium;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">隔空传话</span></span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><br style="box-sizing: border-box; -webkit-tap-highlight-color: transparent;"/></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">下载得到txt格式文件：</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 8px; font-size: 12px; border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15); letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">0011000D91685130402400F00000AA1BE8329BFD6689DFE2D01D1DA683D273101D5D0699D9E1F30F</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">00010005910180F6000045747419644ECBE774103C2CA783DE66101D5D0699D9E133283D07D1D16590392D9FD3413810397D4ED3E7A0B719947FD7E52038FAED2E83DCF5B6B82C07</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">0011000D91685130402400F00008AB0C90A351764ED690E852065462</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">……（后略）</span></div></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">共有618行十六进制字符串。直接搜一下开头部分：</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="font-size: medium; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;"><img src="BMZCTF Misc 21（101-104）_files/Image [10].png" type="image/png" data-filename="Image.png" style="box-sizing: content-box; -webkit-tap-highlight-color: transparent; cursor: default; position: relative; display: inline-block; padding: 1px; margin: 0px; vertical-align: text-bottom; max-width: 100%; height: auto;"/></span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">所以是某种短信的数据格式，进一步搜索可以得知是</span><a href="https://www.cnblogs.com/polar-lights/p/8457814.html" style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 238); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal; text-decoration: underline;">PDU模式</a><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">的短信数据，以及</span><a href="http://www.sendsms.cn/pdu/" style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 238); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal; text-decoration: underline;">在线解码工具</a><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">：</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="font-size: medium; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;"><img src="BMZCTF Misc 21（101-104）_files/Image [11].png" type="image/png" data-filename="Image.png" style="box-sizing: content-box; -webkit-tap-highlight-color: transparent; cursor: default; position: relative; display: inline-block; padding: 1px; margin: 0px; vertical-align: text-bottom; max-width: 100%; height: auto;"/></span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">审查网页，找到解码使用的JS函数：</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="font-size: medium; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;"><img src="BMZCTF Misc 21（101-104）_files/Image [12].png" type="image/png" data-filename="Image.png" style="box-sizing: content-box; -webkit-tap-highlight-color: transparent; cursor: default; position: relative; display: inline-block; padding: 1px; margin: 0px; vertical-align: text-bottom; max-width: 100%; height: auto;"/></span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">写个脚本把原始数据转成JS解码命令：</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 8px; font-size: 12px; border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15); letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">s = open('C:/Users/Administrator/Desktop/data.txt').readlines()</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">new = open('C:/Users/Administrator/Desktop/new.txt', 'w')</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><br style="box-sizing: border-box; -webkit-tap-highlight-color: transparent;"/></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">tmp = 'getPDUMetaInfo(&quot;' + s[0][:-1] + '&quot;) '</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">for i in s[1:]:</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">    tmp += '+ &quot;splitmark_cheyenne&quot; + '</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">    tmp += 'getPDUMetaInfo(&quot;' + i[:-1] + '&quot;) '</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">new.write(tmp)</span></div></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">网页控制台运行：</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="font-size: medium; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;"><img src="BMZCTF Misc 21（101-104）_files/Image [13].png" type="image/png" data-filename="Image.png" style="box-sizing: content-box; -webkit-tap-highlight-color: transparent; cursor: default; position: relative; display: inline-block; padding: 1px; margin: 0px; vertical-align: text-bottom; max-width: 100%; height: auto;"/></span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">复制运行结果得到解码后的短信数据，保存为txt。</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><br style="box-sizing: border-box; -webkit-tap-highlight-color: transparent;"/></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">整理一下数据格式：</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 8px; font-size: 12px; border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15); letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">s = open('C:/Users/Administrator/Desktop/data2.txt', 'rb').read().decode('utf-8')</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">s = s.split('splitmark_cheyenne')</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">for i in range(len(s)):</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">    s[i] = s[i].split(r'\n')</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">for i in range(10):</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">    print(s[i])</span></div></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">输出结果：</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 8px; font-size: 12px; border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15); letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">['&quot;SMSC#', 'Receipient:+8615030442000', 'Validity:Rel 4d ', 'TP_PID:00', 'TP_DCS:00', 'TP_DCS-popis:Uncompressed Text', 'No class', 'Alphabet:Default', '', 'hello,bob!what is the flag?', 'Length:27']</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">['SMSC#', 'Receipient:+10086', 'Validity:Not Present', 'TP_PID:00', 'TP_DCS:00', 'TP_DCS-popis:Uncompressed Text', 'No class', 'Alphabet:Default', '', 'the first part of the flag is the first 8 digits of your phone number', 'Length:69']</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">['SMSC#', 'Receipient:+8615030442000', 'Validity:Rel 5d ', 'TP_PID:00', 'TP_DCS:08', 'TP_DCS-popis:Uncompressed Text', 'No class', 'Alphabet:UCS2(16)bit', '', '那其他部分呢', 'Length:6']</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">['SMSC#', 'Receipient:+8615030442000', 'Validity:Rel 1h ', 'TP_PID:00', 'TP_DCS:08', 'TP_DCS-popis:Uncompressed Text', 'No class', 'Alphabet:UCS2(16)bit', '', '看看你能从这些数据里发现什么？w465', 'Length:16.5']</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">['SMSC#+10086', 'Sender:+8615030442000', 'TimeStamp:25/04/21 19:43:59 GMT ?', 'TP_PID:00', 'TP_DCS:00', 'TP_DCS-popis:Uncompressed Text', 'No class', 'Alphabet:Default', '', '5b4c4ce7b6d5edd6d5cb961fca84f193ca71471db155b62c9df5ea1ebed933929de07bebcdb7853ddaf6303ac6fbaaa0fff6bb23cbfefbecd716028173e1259796fbeebf3f12f43ea54fcfeee54f11c8', 'Length:160']</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">['SMSC#+10086', 'Sender:+8615030442000', 'TimeStamp:25/04/21 19:44:43 GMT ?', 'TP_PID:00', 'TP_DCS:00', 'TP_DCS-popis:Uncompressed Text', 'No class', 'Alphabet:Default', '', 'f5a91d7cb54fd0b83e927bbfbe7d6a121d32649748f453ca0fbffe56162c5e5c4e3f757804e9aeb17a8b441513c78591c43c9493bb2567c6a475e69c59912c9e2f0785fe43761a523efa7c7479effdbf', 'Length:160']</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">['SMSC#+10086', 'Sender:+8615030442000', 'TimeStamp:25/04/21 19:39:48 GMT ?', 'TP_PID:00', 'TP_DCS:00', 'TP_DCS-popis:Uncompressed Text', 'No class', 'Alphabet:Default', '', 'd047dbb980e75a1b99d12493c2aee4500fc691ddd083075f3c00032fe55607df115d7e8156f254d4ab232b1dd4a1bf64a944b03cc6625b890acc9d6db174d9ca08cc2d8149881296246ad5a84e8294f0', 'Length:160']</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">['SMSC#+10086', 'Sender:+8615030442000', 'TimeStamp:25/04/21 19:40:23 GMT ?', 'TP_PID:00', 'TP_DCS:00', 'TP_DCS-popis:Uncompressed Text', 'No class', 'Alphabet:Default', '', 'a724badf3e0794e51114c80f971ce0d9c835d9f048ddd1c0873d9cc383f3d1c79fd53afa80cb89125cedf400cf3e64415f1b3df193bc382f3b9994a0c5f69c3c032978b41534d357b24ff31a7db0f0f0', 'Length:160']</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">['SMSC#+10086', 'Sender:+8615030442000', 'TimeStamp:25/04/21 19:43:30 GMT ?', 'TP_PID:00', 'TP_DCS:00', 'TP_DCS-popis:Uncompressed Text', 'No class', 'Alphabet:Default', '', '952fc043db79c6b1d46b79e8b02982ecb2f0a31b6fb8a1ec366448d971fb4165fbfe7dcb39679d592ebef0a2725ac87bfcb1c796fd2308efbdd79ee5c003f62fcf3eff62b5a142cea591c0c5d5953169', 'Length:160']</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">['SMSC#+10086', 'Sender:+8615030442000', 'TimeStamp:25/04/21 19:45:51 GMT ?', 'TP_PID:00', 'TP_DCS:00', 'TP_DCS-popis:Uncompressed Text', 'No class', 'Alphabet:Default', '', '7ec29741bb7d63d77dc7f6593efcdd67fcbafcfd9fff8a89cbed5bb775df7ee79d5879b5077824dbcd917c6dc14e9e32adbcfada1bf5bdd39973fdf3d6f4f2a7b34fabf7693de55abfd71b78120eddd8', 'Length:160']</span></div></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">首先从第二段短信可知，flag前半段是手机号的前八位，即15030442。后半段需要从第五段短信开始给出的十六进制字节数据中取得，且给出了一个 w465 的提示。另一方面，注意到短信带有的时间戳，说明这些短信并不是按时间顺序排列的。尝试按时间顺序将短信中的十六进制字符串转为字节数据，然后拼接起来：</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 8px; font-size: 12px; border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15); letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">import time as tm</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><br style="box-sizing: border-box; -webkit-tap-highlight-color: transparent;"/></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">s = open('C:/Users/Administrator/Desktop/data2.txt', 'rb').read().decode('utf-8')</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">s = s.split('splitmark_cheyenne')</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">for i in range(len(s)):</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">    s[i] = s[i].split(r'\n')</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><br style="box-sizing: border-box; -webkit-tap-highlight-color: transparent;"/></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">time, data = [], []</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">for i in s[4:]:</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">    temp_t = i[2][10:27]</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">    temp_t = tm.strptime(temp_t, &quot;%d/%m/%y %H:%M:%S&quot;)</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">    time += [tm.mktime(temp_t)]</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">    temp_d = i[9]</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">    temp_l = len(temp_d) // 2</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">    temp_d = int(temp_d, 16).to_bytes(temp_l, 'big')</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">    data += [temp_d]</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><br style="box-sizing: border-box; -webkit-tap-highlight-color: transparent;"/></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">res = b''</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">sort_time = sorted(time)</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">for i in sort_time:</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">    idx = time.index(i)</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">    res += data[idx]</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">with open('C:/Users/Administrator/Desktop/res', 'wb') as r:</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">    r.write(res)</span></div></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">得到的文件用十六进制编辑器查看，可以明显看到PNG格式特征：</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="font-size: medium; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;"><img src="BMZCTF Misc 21（101-104）_files/Image [14].png" type="image/png" data-filename="Image.png" style="box-sizing: content-box; -webkit-tap-highlight-color: transparent; cursor: default; position: relative; display: inline-block; padding: 1px; margin: 0px; vertical-align: text-bottom; max-width: 100%; height: auto;"/></span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">修改扩展名为png，发现图片内容无法识别，同时010Editor模板会提示IHDR块的CRC错误。考虑图片内容无法识别很可能是被修改了宽度，尝试同时爆破宽高：</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 8px; font-size: 12px; border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15); letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">import zlib</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">import struct</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><br style="box-sizing: border-box; -webkit-tap-highlight-color: transparent;"/></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;"># 同时爆破宽度和高度</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">filename = 'C:/Users/Administrator/Desktop/res.png'</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">with open(filename, 'rb') as f:</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">    all_b = f.read()</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">    crc32key = int(all_b[29:33].hex(), 16)</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">    data = bytearray(all_b[12:29])</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">    n = 4095</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">    for w in range(n):</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">        width = bytearray(struct.pack('&gt;i', w))</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">        for h in range(n):</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">            height = bytearray(struct.pack('&gt;i', h))</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">            for x in range(4):</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">                data[x+4] = width[x]</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">                data[x+8] = height[x]</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">            crc32result = zlib.crc32(data)</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">            if crc32result == crc32key:</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">                print(&quot;宽为：&quot;, end = '')</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">                print(width, end = ' ')</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">                print(int.from_bytes(width, byteorder='big'))</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">                print(&quot;高为：&quot;, end = '')</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">                print(height, end = ' ')</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">                print(int.from_bytes(height, byteorder='big'))</span></div></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">运行结果：</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 8px; font-size: 12px; border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15); letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">宽为：bytearray(b'\x00\x00\x01\xd1') 465</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">高为：bytearray(b'\x00\x00\x00?') 63</span></div></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">所以之前给出的w465实际上是在提示宽度。在十六进制编辑器中修改宽度后得到图片：</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="font-size: medium; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;"><img src="BMZCTF Misc 21（101-104）_files/res [1].png" type="image/png" data-filename="res.png" style="box-sizing: content-box; -webkit-tap-highlight-color: transparent; cursor: default; position: relative; display: inline-block; padding: 1px; margin: 0px; vertical-align: text-bottom; max-width: 100%; height: auto;"/></span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">从而有flag的后半段。</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><br style="box-sizing: border-box; -webkit-tap-highlight-color: transparent;"/></div><div>flag：CISCN{15030442_b586_4c9e_b436_26def12293e4}</div></span>
</div></body></html> 