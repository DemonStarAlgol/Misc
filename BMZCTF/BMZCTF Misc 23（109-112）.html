<html>
<head>
  <title>BMZCTF Misc 23（109-112）</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/605894 (zh-CN, DDL); Windows/6.1.1 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="8588"/>
<h1>BMZCTF Misc 23（109-112）</h1>
<h2><a href="https://DemonStarAlgol.github.io/Misc/">[无关链接]</a></h2>

<div>
<span><div><span style="font-weight: bold;">109 [2021强网拟态]BlueWhale</span></div><div><br/></div><div>下载得到加密的zip格式压缩包：</div><div><img src="BMZCTF Misc 23（109-112）_files/Image.png" type="image/png" data-filename="Image.png"/></div><div><span style="font-size: unset; color: unset; font-family: unset;">其中outside是伪加密，ZipCenOp可以直接处理。inside不知道是不是伪加密，不过因为压缩类型是存储，可以直接用十六进制编辑器把内容剪切出来……得到了又一个加密压缩包：</span></div><div><img src="BMZCTF Misc 23（109-112）_files/Image [1].png" type="image/png" data-filename="Image.png"/></div><div><span style="font-size: unset; color: unset; font-family: unset;">但inside.zip似乎是真加密，那么先看流量包。</span></div><div><span style="font-size: unset;"><br/></span></div><div><span style="font-size: unset; color: unset; font-family: unset;">用wireshark打开outside.pcapng，追踪一下TCP流，在最后一个流里找到可疑信息：</span></div><div><img src="BMZCTF Misc 23（109-112）_files/Image [2].png" type="image/png" data-filename="Image.png"/></div><div>注意这段密码：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>th1sIsThEpassw0rD</div></div><div>其长度为17，CRC32为8CA352BA，与inside.zip里的password.txt完全一致。那么可以进行明文攻击：</div><div><img src="BMZCTF Misc 23（109-112）_files/Image [3].png" type="image/png" data-filename="Image.png"/></div><div>得到解压密码（当然实际操作中只需要三个8位的十六进制密钥出来了就行，不需要爆破出原始密码）。</div><div><br/></div><div>进一步解压，得到newaurora.png-stego.png：</div><div><img src="BMZCTF Misc 23（109-112）_files/newaurora.png-stego.png" type="image/png" data-filename="newaurora.png-stego.png"/></div><div>直接上zsteg一把梭：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop# zsteg newaurora.png-stego.png</div><div>b1,rgb,lsb,xy       .. text: &quot;flag{F1nallY_y0uve_f0unD_1t}&quot;</div><div>……（后略）</div></div><div><br/></div><div>flag：flag{F1nallY_y0uve_f0unD_1t}</div><div><br/></div><div><span style="font-weight: bold;">110 [2021强网拟态]WeirdPhoto</span></div><div><br/></div><div>下载得到加密压缩包out.zip和1.png。后者用010editor打开提示CRC错误，且显示内容不正常，很可能被修改了宽度和高度。爆破一下正确宽高：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>import zlib</div><div>import struct</div><div><br/></div><div># 同时爆破宽度和高度</div><div>filename = 'C:/Users/Administrator/Desktop/1.png'</div><div>with open(filename, 'rb') as f:</div><div>    all_b = f.read()</div><div>    crc32key = int(all_b[29:33].hex(), 16)</div><div>    data = bytearray(all_b[12:29])</div><div>    n = 4095</div><div>    for w in range(n):</div><div>        width = bytearray(struct.pack('&gt;i', w))</div><div>        for h in range(n):</div><div>            height = bytearray(struct.pack('&gt;i', h))</div><div>            for x in range(4):</div><div>                data[x+4] = width[x]</div><div>                data[x+8] = height[x]</div><div>            crc32result = zlib.crc32(data)</div><div>            if crc32result == crc32key:</div><div>                print(&quot;宽为：&quot;, end = '')</div><div>                print(width, end = ' ')</div><div>                print(int.from_bytes(width, byteorder='big'))</div><div>                print(&quot;高为：&quot;, end = '')</div><div>                print(height, end = ' ')</div><div>                print(int.from_bytes(height, byteorder='big'))</div></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>宽为：bytearray(b'\x00\x00\x05\x8c') 1420</div><div>高为：bytearray(b'\x00\x00\x01\xf4') 500</div></div><div><br/></div><div>十六进制编辑器内修改宽高得到正常图像：</div><div><img src="BMZCTF Misc 23（109-112）_files/1.png" type="image/png" data-filename="1.png"/></div><div>有一段字符串：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>TIEWOFTHSAEOUI</div><div>ITNRBCOSHSTSAN</div></div><div>穷举法试了一遍发现是栅栏：</div><div><img src="BMZCTF Misc 23（109-112）_files/Image [4].png" type="image/png" data-filename="Image.png"/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>THISISTHEANSWERTOOBSFUCATION</div></div><div><br/></div><div>解压得到out文件，十六进制编辑器看一下：</div><div><img src="BMZCTF Misc 23（109-112）_files/Image [5].png" type="image/png" data-filename="Image.png"/></div><div>明显是PDF文件的开头四个字节被改成了00。修复为25 50 44 46，然后各种方法穷举一遍发现是wbStego：</div><div><img src="BMZCTF Misc 23（109-112）_files/Image [6].png" type="image/png" data-filename="Image.png"/></div><div>得到flag。</div><div><br/></div><div>flag：flag{th1s_ls_thE_f1n4l_F14g_y0u_want}</div><div><br/></div><div><span style="font-weight: bold;">111 【2021强网杯】ISO1995</span></div><div>题目：We follow ISO1995. ISO1995 has many problems though. One known problem is a time.</div><div><br/></div><div>下载得到无扩展名的iso1995文件，file命令看一下文件类型：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop# file iso1995</div><div>iso1995: ISO 9660 CD-ROM filesystem data 'Debian 10.6.0 AMD64 Network'</div></div><div>是ISO光盘镜像文件，重命名后打开看看：</div><div><img src="BMZCTF Misc 23（109-112）_files/Image [7].png" type="image/png" data-filename="Image.png"/><img src="BMZCTF Misc 23（109-112）_files/Image [8].png" type="image/png" data-filename="Image.png"/></div><div>可以发现光盘内共有1024个1字节的文件，且文件内容均为单个可打印字符，此外还有1024个编了号的空目录。顺带一提这里是IsoBuster打开的结果，用其他工具（例如UltraISO、FTK Imager、Kali下使用mount命令等）可能会得到其他形式的结果，原因未知，有空再研究。</div><div><br/></div><div>尝试按顺序提取这些1字节文件的内容。先查看扇区：</div><div><img src="BMZCTF Misc 23（109-112）_files/Image [9].png" type="image/png" data-filename="Image.png"/></div><div>对应在十六进制编辑器中找到相应数据：</div><div><img src="BMZCTF Misc 23（109-112）_files/Image [10].png" type="image/png" data-filename="Image.png"/></div><div>注意，从这里开始每0x800字节是下一个文件的内容，可以作为定位辅助参考。写个脚本：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>f = open('C:/Users/Administrator/Desktop/iso1995.iso', 'rb').read()</div><div>s = b''.join([f[0x26800 + i * 0x800].to_bytes(1, 'big') for i in range(1024)])</div><div>print(s.decode())</div></div><div>输出结果：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>!=gF~B.@YB01.%DYzb^-1}jH&amp;@,K[7t/LOi*5b)L'&lt;pW'am\W4LH@\toGKE1{&quot;oDW0qf2{l{W_0V-m:af8AO4^iCT_+ $W3cz(LO)L_-s8'_&lt;Ic/KFP9vrr~6\ni{~#g5cs#7z2s++Y1BbYQV'iSl=DZ__|3T1QxWEwX}NJ@_3SdKK]91b?s-rS6gQwBs@4#5IGxW#&amp;ArDw~_x&quot;!_I^O`x5o'.s5)+c9RU'/%_b[rjiOP0y!&amp;/)WjKR#IjWh0\,Dr!@PH^Nf%,YoWEJ(2wXj/u~Y@gh%&amp;_Gz5U`A=0pAV$E/ &gt;1Kg:@4tS:V4ZB`1_x*.17B&amp;:&lt;xn0rW|2TY_DSN&lt;zvbKCj7+6w'r}Lo8':fYC@FvJ02VbO)noQlMI3#AZ+]U3##P|W{V&gt;z,G5[s r|Ra~-P'&gt;oYJ{O{B&quot;oh=VG*SB2KoNt1 7|,*r#d!=N'%O$1Tron:7}6C(yVSIZmtw8Xza]6D,nn*q&amp;KHNK,PW .b&lt;h E$){Kw_)h,=m41LAv'f6l:I xN:4z0{&gt;&amp;F5(cRg|:M9RMX $,8/1vq-][?a/H}1&quot;X;((,MZ(=WJ4o&lt;/_8.D9Q8~S&quot;aA:RNTxpsC8LKW+Pfgw&lt;NTqmy_8G6Np%c-9tAG-em&amp;]1IYtz\IJa1KD&amp;z&lt;k'w7vH Fr--py2uH=;3l*iuisp39+m;&quot;1:xPJB@*LB8;x*?G.'`n^[Pib$KM&gt;RFG#vDrwlk@QC0ebUkG,~fw+xH[W&lt;{:eJmcbx,Yi6KcZ~}vH_R,t{F =}gTKX&amp;;^_Fv1b,DezJ1N}6q)76a]Us=\u8tY;t*#}zSGo`-h64=u2bGZ)I(&amp;%K68&amp;!nQke&amp;+gX=L4TmMy$5nHC&amp;+#&lt;486HKF4f0d%1?I:1=M[p~DxBLtCKh\&gt;4&lt;Qf+cj?a3p0F`4*-%%7*&lt;~'^+KkQ&lt;*z9oUgrgO$:NC.Di&lt;.$`s+69Pn7:IgO`^\T%n |Q'G&amp;9Tx-@!6W&lt;VK_5tH/#i&gt;$7SKKH[Dki-o{b{?j?4.Zw+aV!|Zi{2oTqk*#!O0h$-6oCbPpaZbPfi</div></div><div>尝试各种编码均没有得到有意义的结果。</div><div><br/></div><div>容易想到，可能需要按照特定的顺序排列这些字符得到下一步信息。题目中提到过time，那么首先考虑根据时间顺序排列。十六进制编辑器中找到FLAGFOLD文件的时间戳：</div><div><img src="BMZCTF Misc 23（109-112）_files/Image [11].png" type="image/png" data-filename="Image.png"/></div><div>注意到所有的时间戳都是78 0B 02 14 33 05 08，测试了一下对应时间如下：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>78：年份，1900 + 0x78 = 2020</div><div>0B：月份，0x0B = 11</div><div>02：日期，0x02 = 2</div><div>14：小时，0x14 = 20</div><div>33：分钟，0x33 = 51</div><div>05：秒钟，0x05 = 5</div><div>08：时区，以15分钟为单位，0x08 = 8，即 +2:00 时区</div></div><div>也就是东二区的2020年11月2日20:51:05，换算为东八区2020年11月3日2:51:05，和上述截图中IsoBuster读取到的文件更新时间一致。当然上述分析没有什么用，因为即使仅看十六进制下的时间戳，也可以发现所有时间戳都完全一致，无法作为排序标志。</div><div><br/></div><div>那么继续找其他的时间戳，注意到空目录flag_fxxxxx的更新时间：</div><div><img src="BMZCTF Misc 23（109-112）_files/Image [12].png" type="image/png" data-filename="Image.png"/></div><div>虽然看起来也全都一致，但这个大到不正常的时间实际上是非法数据导致溢出了（从上面的分析也可以看出来，时间戳的部分字节是有取值限制的，一旦超出就会溢出）。在十六进制编辑器里找到对应位置：</div><div><img src="BMZCTF Misc 23（109-112）_files/Image [13].png" type="image/png" data-filename="Image.png"/></div><div>可以看到每个空目录flag_fxxxxx对应的时间戳均为FF FF FF FF XX XX 08的形式，部分位的数值在合法范围外造成了溢出。注意到其中第五、六两位字节对每个空目录是不同的，猜测要根据时间戳中这两字节对FLAGFOLDER文件内容进行排序。写个脚本：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>f = open('C:/Users/Administrator/Desktop/iso1995.iso', 'rb').read()</div><div>s = [f[0x26800 + i * 0x800].to_bytes(1, 'big') for i in range(1024)]</div><div><br/></div><div>res = b''</div><div>f = f[0x16050: ]</div><div>for i in range(1024):</div><div>    tmp = f.index(0xFFFFFFFF.to_bytes(4, 'big'))</div><div>    res += s[int.from_bytes(f[tmp+4: tmp+6], 'big')]</div><div>    f = f[tmp+4: ]</div><div>print(res.decode())</div></div><div>运行结果：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>!Sdk*t eiW!BJ9$QpR. pIk{V#t:NE;J8M{Qi&gt;W%|1vw&lt;9_*2AG\SX_6{)'n4)GwcPx8gp[6Z_'.#Y(=zCs/2*^DwpC6@=KBz\+0ngA@C(cJSiE'ShHjW,*Xu{Y&gt;5rGyMWX_mY,htG1KLE`pNNMYd?U\SF&lt;%O,qeVflr$,CO@V.s-%.@C'&amp;I2[36?&lt;k)N^Z0~IgP-k=L-Ip0URu_&lt;P6T?/LF\~K~q6%76}!_WR&amp;nojVK`KGYZwx&quot;G4^4=&amp;cOO0&amp;%:QWo~cBBUM#LD$gLK?887&lt;a$z/Xh=V(J`jus9Jw-Pmp1=[|b5;&quot;Z{[qNI&amp;9/.2@b&gt;'Vxo {1)xT_'3FoRIP~O`&amp;!K'ZAKM&lt;Hrg$D_*&gt;8G%UT{oN41|4P42S~6*g2KJ}o,8j/]&amp;FimP0V2c::+{#;Bj@Cd\w9ioA&amp;is#g#6!_9SI4Xx6rKoN ZhzD##,4!/bbB(v/Q(6ez{bKoH'-B'*hg5xq$n0xz 0v9wfbGs|[K-ana]D!+*\+`abDa7w16BySRx-#D/-a1O55Q`F&lt;75{8f)4rlgQW]K=oT1J$Ar= W$LW9!~TphteN=b&amp;s}.714G_8W~!@8=%gh%&quot;K:&lt;@7o*5+y+}+fCF'NEYN0{P4T_hz(3|Y7ZA1fsu\B6bxi#_+wKPs^C1^Ywa,{'&amp;i]Hq+P8&lt;WQ5sKu!ab<font color="#FF0000">FLAG{Dir3ct0ry_jYa_n41}</font>R:k_#z^'mT?,3$H &quot;W+xr-Yzn-D-ribi,wKf|&amp;$2:/q?8:jmcI|4L:+`KDx])5+A_m13/7R1VQ:[Dc&amp;.TcvPv$tOb}X&amp;-K'f:.&lt;,bO~0r,=olgKP&amp;x U %(HFjNtCDaJiHW+N1WK=(Ho_*K2&lt;^&gt;b&lt;&lt;_]~4rn=k#7i,3YHK_Z;o%8[xZy;:&lt;1}OT1IHSn&gt;gn`n;YI9[M't@v%}Iz0fmVl#ls+aI\: 6?|VvGHD~Q0O4{-.siztGve H&lt;f@kXEt@WWHW&quot;,81m*S1lbQZ+mK9rB'TD^)-)0TzO6tUGf5#6bFo&gt;L7,*oJ&amp;wL*}.7pRx&quot;t1vzM):FL3r@:-C1</div></div><div>得到flag。</div><div><br/></div><div>flag：FLAG{Dir3ct0ry_jYa_n41}</div><div><br/></div><div><span style="font-weight: bold;">112 【2021强网杯】Cipherman</span></div><div>题目：The attacker malicously accessed the user's PC and encrypted specific volumes. How to decrypto the volume?</div><div><br/></div><div>下载得到memory和Secret两个文件。根据题目内容及文件特征，可以判断Secret是被加密后的磁盘，进一步尝试可以确定是BitLocker加密：</div><div><img src="BMZCTF Misc 23（109-112）_files/Image [14].png" type="image/png" data-filename="Image.png"/></div><div>需要密码或密钥。看一下memory：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop# strings memory | grep BitLocker</div><div>BitLockerAuthData</div><div>Description: read/write encrypted BitLocker volumes</div><div>Dislocker has been designed to read BitLocker encrypted partitions under</div><div>versions of the Vista to 10 and BitLocker-To-Go encrypted partitions,that's</div><div>file will change the underlying BitLocker partition content.</div><div>Description: BitLocker Drive Encryption access library -- development files</div><div>Description: Tools to access the BitLocker Drive Encryption format.</div><div>Description: BitLocker Drive Encryption access library</div><div>Description: read/write encrypted BitLocker volumes (development files)</div><div>Dislocker has been designed to read BitLocker encrypted partitions under</div><div>versions of the Vista to 10 and BitLocker-To-Go encrypted partitions,that's</div><div>file will change the underlying BitLocker partition content.</div><div>Description: read/write encrypted BitLocker volumes (shared library)</div><div>Dislocker has been designed to read BitLocker encrypted partitions under</div><div>versions of the Vista to 10 and BitLocker-To-Go encrypted partitions,that's</div><div>file will change the underlying BitLocker partition content.</div></div><div>确实有与BitLocker相关的内容，那么密码或密钥的线索很可能在其中。</div><div><br/></div><div>根据文件名和文件特征，猜测memory可能是内存镜像文件。那么volatility梭一把：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop# volatility -f memory imageinfo</div><div>Volatility Foundation Volatility Framework 2.6</div><div>INFO    : volatility.debug    : Determining profile based on KDBG search...</div><div>          Suggested Profile(s) : Win7SP1x86_23418, Win7SP0x86, Win7SP1x86_24000, Win7SP1x86</div><div>                     AS Layer1 : IA32PagedMemoryPae (Kernel AS)</div><div>                     AS Layer2 : FileAddressSpace (/root/Desktop/memory)</div><div>                      PAE type : PAE</div><div>                           DTB : 0x185000L</div><div>                          KDBG : 0x82d72c28L</div><div>          Number of Processors : 1</div><div>     Image Type (Service Pack) : 1</div><div>                KPCR for CPU 0 : 0x82d73c00L</div><div>             KUSER_SHARED_DATA : 0xffdf0000L</div><div>           Image date and time : 2018-08-06 08:41:18 UTC+0000</div><div>     Image local date and time : 2018-08-06 17:41:18 +0900</div></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop# volatility -f memory --profile=Win7SP1x86_23418 pslist</div><div>root@kali:~/Desktop# volatility -f memory --profile=Win7SP1x86_23418 hivelist</div><div>root@kali:~/Desktop# volatility -f memory --profile=Win7SP1x86_23418 cmdline</div><div>root@kali:~/Desktop# volatility -f memory --profile=Win7SP1x86_23418 screenshot --dump-dir=./</div></div><div>均未得到结果，常用插件继续梭：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop# volatility -f memory --profile=Win7SP1x86_23418 iehistory</div><div>Volatility Foundation Volatility Framework 2.6</div><div>**************************************************</div><div>Process: 1960 explorer.exe</div><div>Cache type &quot;URL &quot; at 0x3785000</div><div>Record length: 0x100</div><div>Location: Visited: RockAndRoll@file:///C:/Users/RockAndRoll/Desktop/plzdecrypt.vhd</div><div>Last modified: 2018-08-06 07:34:17 UTC+0000</div><div>Last accessed: 2018-08-06 07:34:17 UTC+0000</div><div>File Offset: 0x100, Data Offset: 0x0, Data Length: 0xb4</div><div>**************************************************</div><div>Process: 1960 explorer.exe</div><div>Cache type &quot;URL &quot; at 0x3785100</div><div>Record length: 0x100</div><div>Location: Visited: RockAndRoll@file:///C:/Users/RockAndRoll/Desktop/Secret.vhd</div><div>Last modified: 2018-08-06 07:44:13 UTC+0000</div><div>Last accessed: 2018-08-06 07:44:13 UTC+0000</div><div>File Offset: 0x100, Data Offset: 0x0, Data Length: 0xb0</div><div>**************************************************</div><div>Process: 1960 explorer.exe</div><div>Cache type &quot;URL &quot; at 0x3785200</div><div>Record length: 0x100</div><div>Location: Visited: RockAndRoll@file:///E:/README.txt</div><div>Last modified: 2018-08-06 08:38:07 UTC+0000</div><div>Last accessed: 2018-08-06 08:38:07 UTC+0000</div><div>File Offset: 0x100, Data Offset: 0x0, Data Length: 0x94</div><div>**************************************************</div><div>Process: 1960 explorer.exe</div><div>Cache type &quot;URL &quot; at 0x3785300</div><div>Record length: 0x200</div><div>Location: Visited: RockAndRoll@file:///C:/Users/RockAndRoll/Desktop/BitLocker%20%EB%B3%B5%EA%B5%AC%20%ED%82%A4%20168F1291-82C1-4BF2-B634-9CCCEC63E9ED.txt</div><div>Last modified: 2018-08-06 08:41:04 UTC+0000</div><div>Last accessed: 2018-08-06 08:41:04 UTC+0000</div><div>File Offset: 0x200, Data Offset: 0x0, Data Length: 0xf8</div><div>**************************************************</div><div>Process: 1960 explorer.exe</div><div>Cache type &quot;URL &quot; at 0x3786000</div><div>Record length: 0x200</div><div>Location: Visited: RockAndRoll@file:///C:/Users/RockAndRoll/Desktop/BitLocker%20%EB%B3%B5%EA%B5%AC%20%ED%82%A4%209885FD83-F212-486A-9DCD-F7B8078EB3B9.txt</div><div>Last modified: 2018-08-06 07:45:16 UTC+0000</div><div>Last accessed: 2018-08-06 07:45:16 UTC+0000</div><div>File Offset: 0x200, Data Offset: 0x0, Data Length: 0xf8</div><div>**************************************************</div><div>Process: 1960 explorer.exe</div><div>Cache type &quot;URL &quot; at 0x3795000</div><div>Record length: 0x100</div><div>Location: :2018080620180807: RockAndRoll@file:///C:/Users/RockAndRoll/Desktop/plzdecrypt.vhd</div><div>Last modified: 2018-08-06 16:34:17 UTC+0000</div><div>Last accessed: 2018-08-06 07:34:17 UTC+0000</div><div>File Offset: 0x100, Data Offset: 0x0, Data Length: 0x0</div><div>**************************************************</div><div>Process: 1960 explorer.exe</div><div>Cache type &quot;URL &quot; at 0x3795100</div><div>Record length: 0x100</div><div>Location: :2018080620180807: RockAndRoll@:Host: ?????????</div><div>Last modified: 2018-08-06 16:34:17 UTC+0000</div><div>Last accessed: 2018-08-06 07:34:17 UTC+0000</div><div>File Offset: 0x100, Data Offset: 0x0, Data Length: 0x0</div><div>**************************************************</div><div>Process: 1960 explorer.exe</div><div>Cache type &quot;URL &quot; at 0x3795200</div><div>Record length: 0x100</div><div>Location: :2018080620180807: RockAndRoll@file:///C:/Users/RockAndRoll/Desktop/Secret.vhd</div><div>Last modified: 2018-08-06 16:44:13 UTC+0000</div><div>Last accessed: 2018-08-06 07:44:13 UTC+0000</div><div>File Offset: 0x100, Data Offset: 0x0, Data Length: 0x0</div><div>**************************************************</div><div>Process: 1960 explorer.exe</div><div>Cache type &quot;URL &quot; at 0x3795300</div><div>Record length: 0x100</div><div>Location: :2018080620180807: RockAndRoll@file:///E:/README.txt</div><div>Last modified: 2018-08-06 17:38:07 UTC+0000</div><div>Last accessed: 2018-08-06 08:38:07 UTC+0000</div><div>File Offset: 0x100, Data Offset: 0x0, Data Length: 0x0</div><div>**************************************************</div><div>Process: 1960 explorer.exe</div><div>Cache type &quot;URL &quot; at 0x3795400</div><div>Record length: 0x180</div><div>Location: :2018080620180807: RockAndRoll@file:///<font color="#FF0000">C:/Users/RockAndRoll/Desktop/BitLocker%20%EB%B3%B5%EA%B5%AC%20%ED%82%A4%20168F1291-82C1-4BF2-B634-9CCCEC63E9ED.txt</font></div><div>Last modified: 2018-08-06 17:41:04 UTC+0000</div><div>Last accessed: 2018-08-06 08:41:04 UTC+0000</div><div>File Offset: 0x180, Data Offset: 0x0, Data Length: 0x0</div><div>**************************************************</div><div>Process: 1960 explorer.exe</div><div>Cache type &quot;URL &quot; at 0x3796000</div><div>Record length: 0x180</div><div>Location: :2018080620180807: RockAndRoll@file:///<font color="#FF0000">C:/Users/RockAndRoll/Desktop/BitLocker%20%EB%B3%B5%EA%B5%AC%20%ED%82%A4%209885FD83-F212-486A-9DCD-F7B8078EB3B9.txt</font></div><div>Last modified: 2018-08-06 16:45:16 UTC+0000</div><div>Last accessed: 2018-08-06 07:45:16 UTC+0000</div><div>File Offset: 0x180, Data Offset: 0x0, Data Length: 0x0</div></div><div>结果在查看IE浏览器历史记录时发现有一个本地的txt文件地址，且文件名包含BitLocker。用专业的filescan再看一下：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop# volatility -f memory --profile=Win7SP1x86_23418 filescan | grep BitLocker</div><div>Volatility Foundation Volatility Framework 2.6</div><div><font color="#FF0000">0x000000007e02af80      8      0 -W---- \Device\HarddiskVolume2\Users\RockAndRoll\Desktop\BitLocker 복구 키 168F1291-82C1-4BF2-B634-9CCCEC63E9ED.txt</font></div><div>0x000000007e8ce7b0      7      0 R--r-d \Device\HarddiskVolume2\Windows\System32\BitLockerWizard.exe</div><div>0x000000007f581460      8      0 R--r-d \Device\HarddiskVolume2\Windows\System32\ko-KR\BitLockerWizard.exe.mui</div></div><div>发现目标后dump出来：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop# volatility -f memory --profile=Win7SP1x86_23418 dumpfiles -Q 0x000000007e02af80 -D ./</div><div>Volatility Foundation Volatility Framework 2.6</div><div>DataSectionObject 0x7e02af80   None   \Device\HarddiskVolume2\Users\RockAndRoll\Desktop\BitLocker 복구 키 168F1291-82C1-4BF2-B634-9CCCEC63E9ED.txt</div></div><div><br/></div><div>打开txt看一下：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>BitLocker 드라이브 암호화 복구 키</div><div><br/></div><div>복구 키는 BitLocker로 보호되는 드라이브에서 데이터를 검색하기 위해 사용됩니다.</div><div><br/></div><div>이 키가 올바른 복구 키인지 확인하려면 복구 화면에 표시된 것과 ID를 비교하십시오.</div><div><br/></div><div>복구 키 ID: 168F1291-82C1-4B</div><div>전체 복구 키 ID: 168F1291-82C1-4BF2-B634-9CCCEC63E9ED</div><div><br/></div><div>BitLocker 복구 키:</div><div>221628-533357-667392-449185-516428-718443-190674-375100</div></div><div><b>唐 突 谚 文</b>。快去请万能的Google Translate：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>BitLocker 驱动器加密恢复密钥</div><div><br/></div><div>恢复密钥用于从受 BitLocker 保护的驱动器中检索数据。</div><div><br/></div><div>将 ID 与恢复屏幕上显示的 ID 进行比较，以验证这是正确的恢复密钥。</div><div><br/></div><div>恢复密钥 ID：168F1291-82C1-4B</div><div>完整恢复密钥 ID：168F1291-82C1-4BF2-B634-9CCCEC63E9ED</div><div><br/></div><div>BitLocker 恢复密钥：</div><div><font style="color: rgb(255, 0, 0);">221628-533357-667392-449185-516428-718443-190674-375100</font></div></div><div>有恢复密钥，那就到DiskGenius里输入一下：</div><div><img src="BMZCTF Misc 23（109-112）_files/Image [15].png" type="image/png" data-filename="Image.png"/></div><div>解锁完查看文件列表，只有一个txt：</div><div><img src="BMZCTF Misc 23（109-112）_files/Image [16].png" type="image/png" data-filename="Image.png"/></div><div>内容：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>Wow, you have a great ability. How did you solve this? Are you a hacker? Please give me a lesson later.</div></div><div><br/></div><div>flag：Wow, you have a great ability. How did you solve this? Are you a hacker? Please give me a lesson later.</div><div><br/></div><div><br/></div></span>
</div></body></html> 