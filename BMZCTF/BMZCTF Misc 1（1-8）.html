<html>
<head>
  <title>BMZCTF Misc 1（1-8）</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/605894 (zh-CN, DDL); Windows/6.1.1 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="4873"/>
<h1>BMZCTF Misc 1（1-8）</h1>
<h2><a href="https://DemonStarAlgol.github.io/Misc/">[无关链接]</a></h2>

<div>
<span><div><span style="font-weight: bold;">1 真正的CTFer</span></div><div><br/></div><div>下载得到png格式文件。用010Editor或TweakPNG打开，IHDR块的CRC会报错：</div><div><img src="BMZCTF Misc 1（1-8）_files/Image.png" type="image/png" data-filename="Image.png"/></div><div><span style="font-size: unset;"><br/></span></div><div><span style="font-size: unset; color: unset; font-family: unset;">而图片在Windows下能正常查看，说明图片高度很可能被修改过。爆破一下真实高度：</span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>import struct</div><div>import binascii</div><div>from Crypto.Util.number import bytes_to_long</div><div><br/></div><div>img = open('C:/Users/Administrator/Desktop/1.png', 'rb').read()</div><div><br/></div><div>for i in range(0xFFFF):</div><div>    stream = img[12:20] + struct.pack('&gt;i', i) + img[24:29]</div><div>    crc = binascii.crc32(stream)</div><div>    if crc == bytes_to_long(img[29:33]):</div><div>        print(i, hex(i))</div></div><div>运行结果：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>2532 0x9e4</div></div><div>在十六进制编辑器中修改图片高度后使劲放大图片，就能用强劲的CTFer之眼看到flag：</div><div><img src="BMZCTF Misc 1（1-8）_files/Image [1].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>flag：flag{d2b5543c2f8aa8229057872dd85ce5a9}</div><div><br/></div><div><span style="font-weight: bold;">2 2018 HEBTUCTF 签到题</span></div><div><br/></div><div>下载得到没有扩展名的type文件。十六进制编辑器看一下文件头：</div><div><img src="BMZCTF Misc 1（1-8）_files/Image [2].png" type="image/png" data-filename="Image.png"/></div><div>明显是JPG格式图片。Linux下用file命令也可以得到同样结果：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop# file type</div><div>type: JPEG image data, JFIF standard 1.01, resolution (DPI), density 72x72, segment length 16, baseline, precision 8, 690x690, components 3</div></div><div>但即使修改文件扩展名查看图片也没有用，因为本题的flag其实在文件尾部，用十六进制编辑器可以看到：</div><div><img src="BMZCTF Misc 1（1-8）_files/Image [3].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>flag：HEBTUCTF{lkfdlfnqwnoidasfmaklmf}</div><div><br/></div><div><span style="font-weight: bold;">3 2018 HEBTUCTF 你可能需要一个wireshark</span></div><div><br/></div><div>下载得到pcapng格式文件。wireshark打开，尝试搜索关键词flag：</div><div><img src="BMZCTF Misc 1（1-8）_files/Image [4].png" type="image/png" data-filename="Image.png"/></div><div>可以看到352号包中出现了flag.txt，查看分组字节：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>-----------------------------41184676334</div><div>Content-Disposition: form-data; name=&quot;MAX_FILE_SIZE&quot;</div><div>100000</div><div>-----------------------------41184676334</div><div>Content-Disposition: form-data; name=&quot;uploaded&quot;; filename=&quot;flag.txt&quot;</div><div>Content-Type: text/plain</div><div><font style="color: rgb(255, 0, 0);">SEVCVFVDVEYlN0JmMWFnXzFzX3czbl9kNG8lN0Q=</font></div><div>-----------------------------41184676334</div><div>Content-Disposition: form-data; name=&quot;Upload&quot;</div><div>Upload</div><div>-----------------------------41184676334--</div></div><div>明显有base64编码，解码得到：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>HEBTUCTF%7Bf1ag_1s_w3n_d4o%7D</div></div><div>再进行一次URL编码解码：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>HEBTUCTF{f1ag_1s_w3n_d4o}</div></div><div><br/></div><div>flag：<span style="text-indent: 0px;">HEBTUCTF{f1ag_1s_w3n_d4o}</span></div><div><br/></div><div><span style="text-indent: 0px; font-weight: bold;">4 </span><span style="font-weight: bold;">MISC_你猜猜flag</span></div><div><br/></div><div>下载得到exe格式文件。查看属性，可以判断这是一个ZIP自解压文件：</div><div><img src="BMZCTF Misc 1（1-8）_files/Image [5].png" type="image/png" data-filename="Image.png"/></div><div>用7-zip可以直接打开，但解压需要密码：</div><div><img src="BMZCTF Misc 1（1-8）_files/Image [6].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>十六进制编辑器打开，查找zip格式文件头 50 4B 03 04，发现文件头附近有解压密码：</div><div><img src="BMZCTF Misc 1（1-8）_files/Image [7].png" type="image/png" data-filename="Image.png"/></div><div>但尝试解压发现密码错误，继续寻找会发现文件中还包含多个其他“密码”：</div><div><img src="BMZCTF Misc 1（1-8）_files/Image [8].png" type="image/png" data-filename="Image.png"/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>Z1P P3ssw0rd 1s:ZmxhZ+WlveWDj+WPr+S7peeMnOWHuuadpQ==</div><div>Z1P P3ssw0rd 1s:57uG5b+D54K55L2g5bCx5Lya5Y+R546w5a+G56CB5LiN5a+55ZKv</div></div><div>两段base64编码解码结果分别是：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>flag好像可以猜出来</div><div>细心点你就会发现密码不对咯</div></div><div>进一步尝试发现正确密码为：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>ZmxhZ+WlveWDj+WPr+S7peeMnOWHuuadpQ==</div></div><div>当然，上述两段base64编码字符串实际可以通过直接运行flag.exe然后穷举输入数字得到。</div><div><br/></div><div>解压得到两个txt格式文件和一个mdb格式文件。逐个查看，txt文件中没有任何有效信息，查看mdb数据库文件。没有安装数据库软件也没关系，可以用文本编辑器打开或直接用strings命令：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop# strings Misc\ So\ easy.mdb</div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">（中略）</span></div><div>flag:                      flag{D1d y0u 8u3ss?}</div><div>（后略）</div></div><div><br/></div><div>flag：flag{D1d y0u 8u3ss?}</div><div><br/></div><div><span style="font-weight: bold;">5 2018 护网杯 迟来的签到题</span></div><div>题目：easy xor???</div><div><br/></div><div>下载得到txt格式文件，内含base64编码格式的密文：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>AAoHAR1TIiIkUFUjUFQgVyInVSVQJVFRUSNRX1YgXiJSVyJQVRs=</div></div><div>根据题目内容，尝试爆破单字节异或加密密钥：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>import base64, string</div><div><br/></div><div>s = base64.b64decode('AAoHAR1TIiIkUFUjUFQgVyInVSVQJVFRUSNRX1YgXiJSVyJQVRs='.encode())</div><div>for i in range(256):</div><div>    res = ''</div><div>    for j in s:</div><div>        tmp = int(j ^ i).to_bytes(1, 'big').decode()</div><div>        if tmp not in string.printable:</div><div>            break</div><div>        else:</div><div>            res += tmp</div><div>    if len(res) == len(s):</div><div>        print(i, res)</div></div><div>输出结果中可以筛选得到flag：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>102 flag{5DDB63E62F1DA3C6C777E790F8D41D63}</div></div><div><br/></div><div>flag：flag{5DDB63E62F1DA3C6C777E790F8D41D63}</div><div><br/></div><div><span style="font-weight: bold;">6 签到题</span></div><div>题目：关注公众号：白帽子社区，回复关键字：BMZCTF 获取flag</div><div><br/></div><div>按题目说的做就行了。</div><div><br/></div><div>flag：BMZCTF{W3lc0me_t0_BMZCTF!}</div><div><br/></div><div><span style="font-weight: bold;">7 flag就在这</span></div><div><br/></div><div>下载得到加密的zip格式压缩包。十六进制编辑器打开，发现文件头被破坏：</div><div><img src="BMZCTF Misc 1（1-8）_files/Image [9].png" type="image/png" data-filename="Image.png"/></div><div>修复为50 4B 03 04后爆破密码：</div><div><img src="BMZCTF Misc 1（1-8）_files/Image [10].png" type="image/png" data-filename="Image.png"/></div><div>解压得到flag。</div><div><br/></div><div>flag：flag{3a845dd9-4e8a-5b6b-38c7-a78d66e8a055}</div><div><br/></div><div><span style="font-weight: bold;">8 flag</span></div><div><br/></div><div>下载得到png格式文件。直接打开提示图片损坏，十六进制编辑器查看，发现实际上是文本：</div><div><img src="BMZCTF Misc 1（1-8）_files/Image [11].png" type="image/png" data-filename="Image.png"/></div><div>很明显是base64编码，且从开头可以判断，这是PNG格式图片字节数据被base64编码后的结果。</div><div><br/></div><div>有多种方法可以将上述base64编码转回图片。</div><div>1、使用Python脚本：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>import base64</div><div><br/></div><div>s = open('C:/Users/Administrator/Desktop/flag.png', 'rb').read()</div><div>with open('C:/Users/Administrator/Desktop/res.png', 'wb') as f:</div><div>    f.write(base64.b64decode(s))</div></div><div>2、使用Linux下的base64命令：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop# cat flag.png | base64 -d &gt; res.png</div></div><div>3、使用Data URI scheme，在base64编码前添加协议头：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>data:image/png;base64,</div></div><div>然后在浏览器地址栏中访问即可。</div><div><br/></div><div>以上三种方法均可得到图片：</div><div><img src="BMZCTF Misc 1（1-8）_files/res.png" type="image/png" data-filename="res.png"/></div><div><br/></div><div>flag：flag{base64_wow}</div></span>
</div></body></html> 