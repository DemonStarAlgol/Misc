<html>
<head>
  <title>BMZCTF Misc 5（33-40）</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/605894 (zh-CN, DDL); Windows/6.1.1 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="5269"/>
<h1>BMZCTF Misc 5（33-40）</h1>
<h2><a href="https://DemonStarAlgol.github.io/Misc/">[无关链接]</a></h2>

<div>
<span><div><span style="font-weight: bold;">33 泰湖杯-MISC</span></div><div><br/></div><div>下载得到zip格式压缩包，内含加密压缩文件。实际上为伪加密，修复后解压，得到<span style="font-size: unset; color: unset; font-family: unset;">omisc.docx和未加密的fun.zip，后者内含加密压缩的fun.wav。先看docx文件：</span></div><div><img src="BMZCTF Misc 5（33-40）_files/Image.png" type="image/png" data-filename="Image.png"/></div><div>最后两行各有一段隐藏字体（标红部分）：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>U2FsdGVkX194m4B5HqBSGYPLTS4bywdKDJh13lrSj/OcwgSAoHBw9X/p2IdEtGx7</div><div>EdJFR6rcjyPA+M+aKLZvqE7h7EBFA5LyHYk/5Cns4LV02vM7Dk+T70FlWOlJ3XeA</div><div>9pJwFdAWzeN/0A74u+hLG/oLF1g3djo77yVTCBCs0r7khTOWahv0SYR33tHSq3Yz</div><div>JGTBS1Zsj2i/sGC8tTnNfsLl0SQ2JeTJhP/aNU2LmPVTyc3y4kTx+ysw8vasHwen</div><div>WoBXFtOe2WkorJOCrqdQ8Qqd78TzZ0jRMv6MJO2ytUy/3mebHU9LAlWKFluNEh5t</div><div>/cUVvtigLS6PquYRX5ziEx52HDkW+WgfRnum/AregLJ4c4f6AvG2gBjHVKO6sGEi</div><div>uh59jcyN1SvsQEvXd7cOD/KWZjE5gqVGUJqXyhauqWPVYUlcuHH6abtQwNuDb+jZ</div><div>xMg5QaDzwPhpGRly7NhKU5OgCdhdK17TX7z2/RuNYj6pyfRYNZmQdOFl9B28+law</div><div>KO8l5b18WF5JV6chou7riwwDLqQrKMDjUUKZUtdMn0ReDQbR8reeqw/u+Lkyhl6w</div><div>+222QWgQ2yRd2dhHb1kqNncUInAEqTPNKRBnia8F/+FycBv+KAwCFPwx9oNTFBYN</div><div>4EJL/RjiXEkkSCnyH48VynuuOeX2uNlAti214mCbWWH+pxLn4PHIWf3JK819kiDc</div><div>jqyQ5y3v+EUEr9Sb1WVwiITDW5XtzVP+Yr/IJ0ikl41zMu9BAQPermoa8hZJdE8m</div><div>b3oSet+pAM7PtnyI7FGJ5Ynkpq05AiJMrN+UgV0E/ELc0UhWw3O0c4u+eYtQkzu/</div><div>9+UCRy1Fi+QWFlO3cuWBA4GMGTE1FHWnqnZ683FwrM5bcb6TTu3/Q5sppFmqNrOX</div><div>+ctx5b5xiYeSZ8XFI2ks6L7aFrQYu833GiERnIiZEX8vFqjdnD+tcuQ6Zg9Z7oxh</div><div>ATDP9H5d1e9IaxwOA/fDP0qvdKJ+OS5OPljnboywCPp7QqFHZfyC7d2GIraadSOL</div><div>+eIwfavCqgfGwpWMW5H359IKZASi/HexzEcYrA7OZ8GzSxO9Lmk/ea4BD4JD2law</div><div>EIiDE7yhJApimzJ4IG8EMXFn/rOM3O2PkuSTKFsXu7/XZ3ozAJsPun5RJcMuUFXQ</div><div>X++DqXqe6Kbo/hEKwHETq0VbL6qEKkQKf5ce3i6tuZG8OqqPsye0Ku5D2LREqqGG</div><div>ysshULZWmvlx4u2FUtj4Xg==</div><div><font style="color: rgb(255, 0, 0);">waoootu.epj,nv o</font></div><div><font style="color: rgb(255, 0, 0);">www.verymuch.net</font>Wish everybody have fun!!!!!!</div></div><div><br/></div><div>首先，U2Fs开头的base64形式编码很可能是AES/DES/Rabbit等现代密码密文的base64编码，解密时需要密钥。可以猜测密钥来自两段隐藏字体的字符串，其特征为两段字符串长度相同，且除小写字母外还出现了 . , 和空格三种字符。但实际上本题完全是个工具题，此步骤用到的是特定网站的<a href="http://www.atoolbox.net/Tool.php?Id=914">特定希尔密码在线工具</a>：</div><div><img src="BMZCTF Misc 5（33-40）_files/Image [1].png" type="image/png" data-filename="Image.png"/></div><div>得到密钥：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>love and peaceee</div></div><div>既然是工具题，那么接下来手动尝试AES、DES、3DES和Rabbit等加密的在线工具，最后确定为<a href="http://www.jsons.cn/rabbitencrypt/">Rabbit加密</a>：</div><div><img src="BMZCTF Misc 5（33-40）_files/Image [2].png" type="image/png" data-filename="Image.png"/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>LR2TMNLCGBOHKNDGGVRFY5JWGZTDAXDVMZTDCYK4OU4GCZRYLR2TSNTCHBOHKNJUMM4VY5JVGBSTOXDVHE3DIZC4OU2TIM3ELR2TQYLGHBOHKOJWGQYFY5JWGQ3DSXDVHE3GEOC4OU2TAZJXLR2TOZRTMROHKOBVME4VY5JVGRQTIXDVHAYDEOC4OU4GCZRYLR2TSNTCHBOHKNRRGY3VY5JVHA2WKXDVHAZDOMS4OU2WGMDBLR2TKNDDHFOHKODGMU3FY5JYMFSTMXDVG5QTOYK4OU3DENBQLR2TSNRUMROHKNRSGEYVY5JVMZTDKXDVHE3GEOC4OU3TSNJXLR2TQYLFGZOHKNLGMY2VY5JVGRRTSXDVHE3DIMC4OU2TMYRULR2TKNDDHFOHKNJWMM4VY5JUMZSWKXDVGU4TGN24OU4TMM3GLR2TMY3FGJOHKOBSG4ZFY5JYGM4GCXDVGVRGGMS4OU4GCZJWLR2TKOBVMVOHKNJUHEZFY5JYGM4GCXDVG43TGZK4OU3DEMJRLR2TKNDDHFOHKNRSGQYFY5JUMYYGMXDVHAYDKZK4OU4DKYJZLR2TSNTCHBOHKNRRGBSFY5JZGVRWIXDVGU2DGNS4OU3DENBQLR2TIZTFMVOHKNRWGJTFY5JYGI3TEXDVGY2DMOK4OU4GCMZWLR2TKNTCGROHKNJUMM4VY5JZHA2TQXDVGYYTAZC4OU2TIYZZLR2TKMZXGNOHKNDGMVSVY5JVGRRTSXDVG5QTOYK4OU4DOMLDLR2TSNRUGBOHKNJWMM4VY5JUMYYGMXDVGVTGMNK4OU2TIYZZLR2TMNBWHFOHKNJUMM4VY5JUMVQTMXDVHAZTQYK4OU2TIYZZLR2TONZTMVOHKNJUME2FY5JVHE4DEXDVHE4DKOC4OU2TSOBS</div></div><div><br/></div><div>接下来依次base32 - Unicode编码 - <a href="http://hi.pcmoe.net/buddha.html">新佛曰</a>得到：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>Live beautifully, dream passionately, love completely.</div></div><div>还记得一开始的fun.zip吗，回去用这段密码解压，得到fun.wav。然后audacity打开，切换到频谱图：</div><div><img src="BMZCTF Misc 5（33-40）_files/Image [3].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>flag：flag{m1sc_1s_funny2333}</div><div>猜工具题强行按头funny，我也只能临题涕零，不知所云了。</div><div><br/></div><div><span style="font-weight: bold;">34 pcap</span></div><div>题目：请分析附件中的dnp3协议 。</div><div><br/></div><div>下载得到pcapng格式文件，wireshark打开，过滤dnp3协议，追踪TCP流：</div><div><img src="BMZCTF Misc 5（33-40）_files/Image [4].png" type="image/png" data-filename="Image.png"/></div><div>可以看到所有dnp3协议数据包均在同一个TCP流中，且发现了疑似flag的内容。</div><div><br/></div><div>反向查看这几个字符所在的数据包，可以发现其共同特征为：</div><div>1、数据从192.168.74.1发往192.168.74.132；</div><div>2、数据包长度为91；</div><div>3、对应字符出现在Count字段。</div><div><img src="BMZCTF Misc 5（33-40）_files/Image [5].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>到这里其实已经可以手动获取flag了，那么下面是tshark练习时间：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop# tshark -r challenge2.pcapng -Y &quot;dnp3 and ip.src == 192.168.74.1 and frame.len == 91&quot; -T fields -e &quot;dnp3.al.cnt&quot;</div><div><br/></div><div>-r challenge2.pcapng 指定读取的流量包文件名</div><div>-Y &quot;dnp3 and ip.src == 192.168.74.1 and frame.len == 91&quot; 指定过滤器筛选条件，其中：</div><div>        dnp3 DNP3.0协议</div><div>        ip.src == 192.168.74.1 数据从192.168.74.1主机发出</div><div>        frame.len == 91 数据包的长度为91</div><div>        注意：这里的条件语句和wireshark里是通用的</div><div>-T fields 以fields形式输出，配合后续-e参数指定要输出的字段</div><div>-e &quot;dnp3.al.cnt&quot; 指定要输出的字段，字段名可以通过指定-T json输出json格式文件后从中取得</div></div><div>上述命令输出结果是每行一个十进制ASCII值：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop# tshark -r challenge2.pcapng -Y &quot;dnp3 and ip.src == 192.168.74.1 and frame.len == 91&quot;  -T fields -e &quot;dnp3.al.cnt&quot;</div><div>Running as user &quot;root&quot; and group &quot;root&quot;. This could be dangerous.</div><div>102</div><div>108</div><div>97</div><div>103</div><div>……（后略）</div></div><div>任意方法转为字符即得到flag。</div><div><br/></div><div>flag：flag{d989e2b92ea671f5d30efb8956eab1427625c}</div><div><br/></div><div><span style="font-weight: bold;">35 MISC_tiga</span></div><div><br/></div><div>下载得到加密压缩包misc.zip和文本Tiga.txt。先看后者，十六进制编辑器打开：</div><div><img src="BMZCTF Misc 5（33-40）_files/Image [6].png" type="image/png" data-filename="Image.png"/></div><div>扑面而来的Unicode零宽操作符，大概率是Unicode零宽字符隐写。但零宽隐写的工具和编码方式很多，需要找到出题人用的特定的那一个才行。观察零宽字符，出现了E2 80 8F即U+200F，从而可以排除<a href="http://330k.github.io/misc_tools/unicode_steganography.html">Unicode Steganography with Zero-Width Characters</a>，尝试后发现基于摩斯码和Unicode编码的<a href="http://zero.rovelast.com/">零宽隐藏字符加密</a>也不是。而<a href="https://github.com/offdev/zwsp-steg-js">zwsp-steg-js</a>的在线demo早就已经被在QQ群里说句话都要带零宽隐写的套神Mumuzi用坏，整个网站都挂掉了，至今尚未恢复（顺带一提他之所以选择用坏这个而不是其他工具的原因是这个不需要勾选使用哪些零宽字符比较方便，也许这就是挖别人的路让别人无路可走吧，不愧是套神）。通过坚持不懈的搜索，最终找到出题人使用的工具<a href="https://yuanfux.github.io/zero-width-web/">Zero Width Lib</a>：</div><div><img src="BMZCTF Misc 5（33-40）_files/Image [7].png" type="image/png" data-filename="Image.png"/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>Password: GiveTiGaGuang!</div></div><div><br/></div><div>解压misc.zip得到加密压缩包file.zip和迪迦.jpg，好的套起来了。十六进制编辑器查看jpg图片，文件尾有额外数据：</div><div><img src="BMZCTF Misc 5（33-40）_files/Image [8].png" type="image/png" data-filename="Image.png"/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>youcanalso.zip password isten numbers</div></div><div>但叫这个名字的zip压缩包还在file.zip里没解压出来。回头来看file.zip，其中有个Password目录：</div><div><img src="BMZCTF Misc 5（33-40）_files/Image [9].png" type="image/png" data-filename="Image.png"/></div><div>七个txt文本文件大小都是3字节，CRC32碰撞：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>import binascii, string, itertools</div><div><br/></div><div>dic = string.printable</div><div>crc = ['14433530', 'AF251007', 'D554E7B6', '0EBB3156', 'BB474D49', '2CB8A39B', '75FE76F0']</div><div><br/></div><div>def CRCcrack(c):</div><div>    for i in itertools.product(dic, repeat=3):</div><div>        s = ''.join(i)</div><div>        crc32 = hex(binascii.crc32(s.encode())).upper()[2:].zfill(8)</div><div>        if crc32 == c:</div><div>            return(s)</div><div><br/></div><div>for i in crc:</div><div>    print(CRCcrack(i), end='')</div></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>T&amp;hg%WL0^rm@c!VK$xEt~</div></div><div>以此为密码解压得到youcanalso.zip，然后根据提示，爆破十位数字密码：</div><div><img src="BMZCTF Misc 5（33-40）_files/Image [10].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>继续解压得到加密压缩包flag.zip和youcanalso.jpg。注意到压缩包内也有名为youcanalso.jpg的文件，对比后发现两者的CRC32是完全相同的，可以尝试明文攻击。然而这里又出现了一个很奇妙的情况，我用7-zip和WinRAR均无法获得与原压缩包压缩率一致的明文压缩包，复件替换法也失效，不知道出题人到底用的是什么压缩软件（从其他题目的截图里看得出来是Bandzip，但我懒得装）。总之在此推荐各位出题人，就当是可怜可怜我们刷题的，要考察明文攻击的话还是多用用压缩比100%的存储模式吧。总之这里强行进行一个爆破：</div><div><img src="BMZCTF Misc 5（33-40）_files/Image [11].png" type="image/png" data-filename="Image.png"/></div><div>得到密码为：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>1amT1G@</div></div><div>另一个思路是注意到youcanalso.zip中的youcanalso.jpg压缩后大小与flag.zip中相同，因此可以直接把youcanalso.zip转为未加密压缩包，然后删掉其中的flag.zip，仅保留youcanalso.jpg，以此作为明文压缩包。</div><div><br/></div><div>解压得到flag.txt，打开看一下：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>504b03040a0000000000874ee24000000000000000000000000009000000646f6350726f70732f504b0304140000000800874ee24026b4d5445c0100007102000010000000646f6350726f70732f6170702e78</div><div>……（后略）</div></div><div>很明显是个zip格式压缩包的十六进制字节，直接粘贴进十六进制编辑器，发现实际上是个Microsoft Word文档：</div><div><img src="BMZCTF Misc 5（33-40）_files/Image [12].png" type="image/png" data-filename="Image.png"/></div><div>保存为docx格式打开：</div><div><img src="BMZCTF Misc 5（33-40）_files/Image [13].png" type="image/png" data-filename="Image.png"/></div><div>出现的字符共有85种，同时可以发现存在隐藏字体：</div><div><img src="BMZCTF Misc 5（33-40）_files/Image [14].png" type="image/png" data-filename="Image.png"/></div><div>取消隐藏后复制所有字符，尝试base85解码，得到另一端base85编码。重复手动尝试后发现是base16、base32、base64和base85的套娃编码。写脚本跑一下：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>import base64, re</div><div><br/></div><div>s = b'略'</div><div>base16_dic = r'^[A-F0-9=]*$'</div><div>base32_dic = r'^[A-Z2-7=]*$'</div><div>base64_dic = r'^[A-Za-z0-9/+=]*$'</div><div><br/></div><div>n = 0</div><div>while True:</div><div>    n += 1</div><div>    t = s.decode()</div><div>    if 'flag{' in t:</div><div>        print(t)</div><div>        break</div><div>    elif re.match(base16_dic, t):</div><div>        s = base64.b16decode(s)</div><div>        print(str(n) + ' base16')</div><div>    elif re.match(base32_dic, t):</div><div>        s = base64.b32decode(s)</div><div>        print(str(n) + ' base32')</div><div>    elif re.match(base64_dic, t):</div><div>        s = base64.b64decode(s)</div><div>        print(str(n) + ' base64')</div><div>    else:</div><div>        s = base64.b85decode(s)</div><div>        print(str(n) + ' base85')</div></div><div>输出结果：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>1 base85</div><div>2 base85</div><div>3 base85</div><div>4 base32</div><div>5 base85</div><div>6 base16</div><div>7 base32</div><div>8 base32</div><div>9 base64</div><div>10 base32</div><div>11 base16</div><div>12 base32</div><div>13 base85</div><div>14 base64</div><div>15 base85</div><div>flag{8fa3e8c4-0121-4f2a-a7f0-0a60032e3763}</div></div><div><br/></div><div>flag：flag{8fa3e8c4-0121-4f2a-a7f0-0a60032e3763}</div><div><br/></div><div><span style="font-weight: bold;">36 2018 SUCTF single-dog</span></div><div><br/></div><div>下载得到jpg格式文件，十六进制编辑器打开，文件尾后有zip压缩包。提取解压得到1.txt，内容：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>ﾟωﾟﾉ= /｀ｍ´）ﾉ ~┻━┻   //*´∇｀*/ ['_']; o=(ﾟｰﾟ)  =_=3; c=(ﾟΘﾟ) =(ﾟｰﾟ)-(ﾟｰﾟ); (ﾟДﾟ) =(ﾟΘﾟ)= (o^_^o)/ (o^_^o);(ﾟДﾟ)={ﾟΘﾟ: '_' ,ﾟωﾟﾉ : ((ﾟωﾟﾉ==3) +'_') [ﾟΘﾟ] ,ﾟｰﾟﾉ :(ﾟωﾟﾉ+ '_')[o^_^o -(ﾟΘﾟ)] ,ﾟДﾟﾉ:((ﾟｰﾟ==3) +'_')[ﾟｰﾟ] }; (ﾟДﾟ) [ﾟΘﾟ] =((ﾟωﾟﾉ==3) +'_') [c^_^o];(ﾟДﾟ) ['c'] = ((ﾟДﾟ)+'_') [ (ﾟｰﾟ)+(ﾟｰﾟ)-(ﾟΘﾟ) ];(ﾟДﾟ) ['o'] = ((ﾟДﾟ)+'_') [ﾟΘﾟ];(ﾟoﾟ)=(ﾟДﾟ) ['c']+(ﾟДﾟ) ['o']+(ﾟωﾟﾉ +'_')[ﾟΘﾟ]+ ((ﾟωﾟﾉ==3) +'_') [ﾟｰﾟ] + ((ﾟДﾟ) +'_') [(ﾟｰﾟ)+(ﾟｰﾟ)]+ ((ﾟｰﾟ==3) +'_') [ﾟΘﾟ]+((ﾟｰﾟ==3) +'_') [(ﾟｰﾟ) - (ﾟΘﾟ)]+(ﾟДﾟ) ['c']+((ﾟДﾟ)+'_') [(ﾟｰﾟ)+(ﾟｰﾟ)]+ (ﾟДﾟ) ['o']+((ﾟｰﾟ==3) +'_') [ﾟΘﾟ];(ﾟДﾟ) ['_'] =(o^_^o) [ﾟoﾟ] [ﾟoﾟ];(ﾟεﾟ)=((ﾟｰﾟ==3) +'_') [ﾟΘﾟ]+ (ﾟДﾟ) .ﾟДﾟﾉ+((ﾟДﾟ)+'_') [(ﾟｰﾟ) + (ﾟｰﾟ)]+((ﾟｰﾟ==3) +'_') [o^_^o -ﾟΘﾟ]+((ﾟｰﾟ==3) +'_') [ﾟΘﾟ]+ (ﾟωﾟﾉ +'_') [ﾟΘﾟ]; (ﾟｰﾟ)+=(ﾟΘﾟ); (ﾟДﾟ)[ﾟεﾟ]='\\'; (ﾟДﾟ).ﾟΘﾟﾉ=(ﾟДﾟ+ ﾟｰﾟ)[o^_^o -(ﾟΘﾟ)];(oﾟｰﾟo)=(ﾟωﾟﾉ +'_')[c^_^o];(ﾟДﾟ) [ﾟoﾟ]='\&quot;';(ﾟДﾟ) ['_'] ( (ﾟДﾟ) ['_'] (ﾟεﾟ+(ﾟДﾟ)[ﾟoﾟ]+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ ((o^_^o) +(o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((o^_^o) +(o^_^o))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o^_^o) +(o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ (o^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((o^_^o) +(o^_^o))+ (ﾟｰﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o^_^o) +(o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ (c^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ (c^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((o^_^o) - (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (o^_^o))+ (o^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((o^_^o) - (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((o^_^o) +(o^_^o))+ ((o^_^o) +(o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((o^_^o) +(o^_^o))+ ((o^_^o) - (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ (c^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (o^_^o))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ ((o^_^o) - (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((o^_^o) - (ﾟΘﾟ))+ (o^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((o^_^o) - (ﾟΘﾟ))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (c^_^o)+ (o^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((o^_^o) - (ﾟΘﾟ))+ (ﾟｰﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (c^_^o)+ ((o^_^o) +(o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (o^_^o))+ (o^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (c^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((o^_^o) +(o^_^o))+ (c^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((o^_^o) +(o^_^o))+ (c^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (o^_^o))+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ (c^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ (ﾟｰﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((o^_^o) +(o^_^o))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ ((o^_^o) - (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟｰﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ (c^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟｰﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((o^_^o) +(o^_^o))+ ((o^_^o) +(o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o^_^o) +(o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (o^_^o))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ ((o^_^o) - (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (o^_^o))+ (o^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((o^_^o) - (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟｰﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((o^_^o) +(o^_^o))+ ((o^_^o) - (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((o^_^o) +(o^_^o))+ (ﾟｰﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ (c^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ ((o^_^o) - (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(oﾟｰﾟo)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (o^_^o)+ (ﾟДﾟ) ['c']+ (ﾟДﾟ) ['c']+ (ﾟДﾟ)[ﾟεﾟ]+(oﾟｰﾟo)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (o^_^o)+ (ﾟｰﾟ)+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(oﾟｰﾟo)+ (ﾟｰﾟ)+ (ﾟДﾟ) .ﾟДﾟﾉ+ (c^_^o)+ (c^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+(oﾟｰﾟo)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ) [ﾟΘﾟ]+ (ﾟДﾟ) .ﾟДﾟﾉ+ (ﾟДﾟ) .ﾟΘﾟﾉ+ (ﾟДﾟ)[ﾟεﾟ]+(oﾟｰﾟo)+ (ﾟｰﾟ)+ (ﾟДﾟ) .ﾟДﾟﾉ+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (c^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ ((o^_^o) - (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (o^_^o))+ (o^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((o^_^o) - (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (o^_^o))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((o^_^o) - (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ (c^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (o^_^o))+ (o^_^o)+ (ﾟДﾟ)[ﾟoﾟ]) (ﾟΘﾟ)) ('_');</div></div><div><br/></div><div>这是aaencode，是一种Javascript代码混淆，会把JS代码混淆成颜文字形式。这类代码可以直接作为JS代码运行，例如在浏览器控制台Console中运行这段代码：</div><div><img src="BMZCTF Misc 5（33-40）_files/Image [15].png" type="image/png" data-filename="Image.png"/></div><div>弹出了对话框，但并没有flag，说明flag可能隐藏在JS代码的其他部分。<span style="font-size: unset; color: unset; font-family: unset;">用</span><a href="https://www.qtool.net/decode" style="font-size: unset; font-family: unset;">在线工具</a>将这段aaencode还原为正常JS代码<span style="font-size: unset; color: unset; font-family: unset;">：</span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>function a()</div><div>{</div><div>var a=&quot;SUCTF{happy double eleven}&quot;;</div><div>alert(&quot;双十一快乐&quot;);</div><div>}</div><div>a();</div></div><div><br/></div><div>flag：SUCTF{happy double eleven}</div><div><br/></div><div><span style="font-weight: bold;">37 SDNISC2020_CTF的起源</span></div><div><br/></div><div>下载得到txt格式文件，看一下内容：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>Q1RGIChDYXB0dXJlIFRoZSBGbGFnKSBpcyBvcmlnaW5hdGVkIG==</div><div>aW4gdGhlIDE5OTYgREVGQ09OIEdsb2JhbCBIYWNraW5nIENvbmZlcmVuY2UsIG==</div><div>YSBjb21wZXRpdGl2ZSBnYW1lIGFtb25nIGN5YmVyc2VjdXJpdHkgZW50aHVzaWFzdHMu</div><div>VGhlIENURiBjb21wZXRpdGlvbiBjb3ZlcnMgYSB3aWRl</div><div>cmFuZ2Ugb2YgZmllbGRzIGFuZCBoYXMgYSB=</div><div>Y29tcGxleCBjb250ZW50LiBBdCB0aGUgc2FtZSB0aW1lLCC=</div></div><div>有很多行base64编码，联想到base64隐写，其特征是，末尾带有=的行，解码后再编码，末尾部分字符会出现差异。那么就来验证一下：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>原文：Q1RGIChDYXB0dXJlIFRoZSBGbGFnKSBpcyBvcmlnaW5hdGVkI<font color="#FF0000">G</font>==</div><div>解码：CTF (Capture The Flag) is originated</div><div>编码：Q1RGIChDYXB0dXJlIFRoZSBGbGFnKSBpcyBvcmlnaW5hdGVkI<font color="#FF0000">A</font>==</div></div><div><br/></div><div>判定为base64隐写，这样一来就不需要每行解码，直接套base64隐写脚本即可：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>import re</div><div>import base64</div><div><br/></div><div>b64chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'</div><div><br/></div><div>f = open('base64stego.txt', 'r')</div><div>base64str = f.readline()</div><div><br/></div><div>pattern2 = r'(\S)==$'</div><div>pattern1 = r'(\S)=$'</div><div><br/></div><div>binstring = ''</div><div><br/></div><div>while(base64str):</div><div>    if re.compile(pattern2).findall(base64str):</div><div>        mstr = re.compile(pattern2).findall(base64str)[0]</div><div>        mbin = bin(b64chars.find(mstr))</div><div>        mbin2 = mbin[0:2] + mbin[2:].zfill(6)</div><div>        stegobin = mbin2[-4:]</div><div>        binstring += stegobin</div><div>    elif re.compile(pattern1).findall(base64str):</div><div>        mstr = re.compile(pattern1).findall(base64str)[0]</div><div>        mbin = bin(b64chars.find(mstr))</div><div>        mbin2 = mbin[0:2] + mbin[2:].zfill(6)</div><div>        stegobin = mbin2[-2:]</div><div>        binstring += stegobin</div><div>    base64str = f.readline()</div><div>for i in range(0, len(binstring), 8):</div><div>    print(chr(int(binstring[i:i+8], 2)), end='')</div></div><div>运行结果：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>flag{944776b2c95a350bb27d7038d42b273a</div></div><div><br/></div><div>flag：flag{944776b2c95a350bb27d7038d42b273a}</div><div><br/></div><div><span style="font-weight: bold;">38 headache</span></div><div><br/></div><div>下载得到zip格式加密压缩包，随便爆破一下密码：</div><div><img src="BMZCTF Misc 5（33-40）_files/Image [16].png" type="image/png" data-filename="Image.png"/></div><div>解压得到flag.txt和文件名为单个空格的奇妙文件，先看前者：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>flag{uh, I feel not good... I can't remember the flag. Maybe you can help me..</div><div>Here is my prescription: JFIF</div></div><div><br/></div><div>后者重命名一下，十六进制编辑器打开：</div><div><img src="BMZCTF Misc 5（33-40）_files/Image [17].png" type="image/png" data-filename="Image.png"/></div><div>注意到FF E0、FF DB、FF DA等字节，分别是JPEG格式图像的APP0、DQT和SOS标记码，文件末尾的两字节为FF D9，也是JPEG图像格式的文件尾。结合提示中的JFIF，即JPEG文件交换格式（JPEG File Interchange Format），判定该文件为缺失了部分文件头的JPG图片文件，与题目名称“头痛”也能对应上。</div><div><br/></div><div>根据JPEG图像格式规范，补上2字节的文件头FF D8，得到图片：</div><div><img src="BMZCTF Misc 5（33-40）_files/1.jpg" type="image/jpeg" data-filename="1.jpg"/></div><div><br/></div><div>flag：flag{C13H18O2}</div><div><br/></div><div><span style="font-weight: bold;">39 技协杯-我的密码呢</span></div><div><br/></div><div>下载得到zip格式压缩包，解压得到photo.jpg、加密压缩包giveU.zip和一个cap格式文件。先看图：</div><div><img src="BMZCTF Misc 5（33-40）_files/Image [18].png" type="image/png" data-filename="Image.png"/></div><div>是一段末尾被涂掉的字符串：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>C3m67uup*******</div></div><div>尝试用这段字符串对GiveU.zip进行掩码爆破，因为ARCHPR等软件不支持该zip版本，尝试用john提取hash后以hashcat爆破。<span style="font-size: unset; color: unset; font-family: unset;">被涂掉的位数未知，先从两位开始逐步尝试，最后发现应为三位：</span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop# zip2john giveU.zip</div><div>giveU.zip/giveU.txt:$zip2$*0*3*0*5cf0b02371d4102974912ad9a88a24c7*feb6*25*998c382a12c415d38f56ce5f8bcf548b8a1af476d9f7878916a5c207cb70651182bad7c9e3*20e23e137cfbfd0d3ff8*$/zip2$:giveU.txt:giveU.zip:giveU.zip</div><div>ver 81.9 giveU.zip/giveU.txt is not encrypted, or stored with non-handled compression type</div></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>D:\CTFToolkit-v1.1.0\密码工具\hashcat-6.1.1&gt;hashcat.exe -m 13600 -a 3 $zip2$*0*3*0*5cf0b02371d4102974912ad9a88a24c7*feb6*25*998c382a12c415d38f56ce5f8bcf548b8a1af476d9f7878916a5c207cb70651182bad7c9e3*20e23e137cfbfd0d3ff8*$/zip2$ C3m67uup?a?a?a</div></div><div><img src="BMZCTF Misc 5（33-40）_files/Image [19].png" type="image/png" data-filename="Image.png"/></div><div>得到解压密码：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>C3m67uup8Qs</div></div><div>解压giveU.zip得到giveU.txt，内容：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>flag{t0y_h4sh3d_aNd_hav3_fun_f0r_1t!}</div></div><div>尝试一下发现这就是flag。所以另外一个cap格式文件是干嘛用的？</div><div><br/></div><div>flag：flag{t0y_h4sh3d_aNd_hav3_fun_f0r_1t!}</div><div><br/></div><div><span style="font-weight: bold;">40 2018 HEBTUCTF ZIP安全</span></div><div><br/></div><div>下载得到加密的zip格式压缩包。没有其他提示，那么伪加密或者爆破的可能性比较高，尝试发现不是伪加密，那就爆它：</div><div><img src="BMZCTF Misc 5（33-40）_files/Image [20].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>解压得到两个zip格式加密压缩包，Flag.zip和PartFlag&amp;hint.zip。后者是伪加密，ZipCenOp处理一下，解压得到txt，直接查看发现其中包含不可打印字符，十六进制编辑器打开：</div><div><img src="BMZCTF Misc 5（33-40）_files/Image [21].png" type="image/png" data-filename="Image.png"/></div><div>可以看到部分flag和一段zip格式压缩包的文件尾部数据。</div><div><br/></div><div>另一方面，十六进制编辑器打开Flag.zip：</div><div><img src="BMZCTF Misc 5（33-40）_files/Image [22].png" type="image/png" data-filename="Image.png"/></div><div>可以看到一段明文，比对长度和CRC32后发现这就是hint.txt的内容。那么问题来了，加密压缩包的数据里为何会有被加密压缩的文件的明文内容？再往下看：</div><div><img src="BMZCTF Misc 5（33-40）_files/Image [23].png" type="image/png" data-filename="Image.png"/></div><div>注意到另有两个分别对应flag.txt和hint.txt的zipfile record头，这才是加密压缩包中两个文件对应的数据。重新分析上半部分文件结构，会发现前160字节其实是另一个包含hint.txt的未加密压缩包的zipfile record和dirEntry数据，联想到之前得到的zipfile endLocator部分，可以拼装出一个完整的包含hint.txt的未加密压缩包，从而进行明文攻击。</div><div><br/></div><div>接下来的步骤是先组装明文压缩包：</div><div><img src="BMZCTF Misc 5（33-40）_files/Image [24].png" type="image/png" data-filename="Image.png"/></div><div>然后去掉Flag.zip的多余部分，进行明文攻击：</div><div><img src="BMZCTF Misc 5（33-40）_files/Image [25].png" type="image/png" data-filename="Image.png"/></div><div>得到密码：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>ZipC00l!</div></div><div>解压得到flag.txt：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>HEBTUCTF{Z1p_so_}                              </div></div><div>加上PartFlag&amp;hint.txt中的另一部分得到完整flag。</div><div><br/></div><div>flag：HEBTUCTF{Z1p_so_Comp1ex}</div></span>
</div></body></html> 